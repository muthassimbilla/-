function _mergeNamespaces(e,s){for(var a=0;a<s.length;a++){const i=s[a];if(typeof i!="string"&&!Array.isArray(i)){for(const o in i)if(o!=="default"&&!(o in e)){const c=Object.getOwnPropertyDescriptor(i,o);c&&Object.defineProperty(e,o,c.get?c:{enumerable:!0,get:()=>i[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=a(o);fetch(o.href,c)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var s=e.default;if(typeof s=="function"){var a=function i(){return this instanceof i?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};a.prototype=s.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var o=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(a,i,o.get?o:{enumerable:!0,get:function(){return e[i]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,s,a){this.props=e,this.context=s,this.refs=D$1,this.updater=a||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,s,a){this.props=e,this.context=s,this.refs=D$1,this.updater=a||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,s,a){var i,o={},c=null,d=null;if(s!=null)for(i in s.ref!==void 0&&(d=s.ref),s.key!==void 0&&(c=""+s.key),s)J.call(s,i)&&!L$1.hasOwnProperty(i)&&(o[i]=s[i]);var h=arguments.length-2;if(h===1)o.children=a;else if(1<h){for(var g=Array(h),_=0;_<h;_++)g[_]=arguments[_+2];o.children=g}if(e&&e.defaultProps)for(i in h=e.defaultProps,h)o[i]===void 0&&(o[i]=h[i]);return{$$typeof:l$1,type:e,key:c,ref:d,props:o,_owner:K$1.current}}function N$1(e,s){return{$$typeof:l$1,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return s[a]})}var P$1=/\/+/g;function Q$1(e,s){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):s.toString(36)}function R$1(e,s,a,i,o){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=e,o=o(d),e=i===""?"."+Q$1(d,0):i,I$1(o)?(a="",e!=null&&(a=e.replace(P$1,"$&/")+"/"),R$1(o,s,a,"",function(_){return _})):o!=null&&(O$1(o)&&(o=N$1(o,a+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(P$1,"$&/")+"/")+e)),s.push(o)),1;if(d=0,i=i===""?".":i+":",I$1(e))for(var h=0;h<e.length;h++){c=e[h];var g=i+Q$1(c,h);d+=R$1(c,s,a,g,o)}else if(g=A$1(e),typeof g=="function")for(e=g.call(e),h=0;!(c=e.next()).done;)c=c.value,g=i+Q$1(c,h++),d+=R$1(c,s,a,g,o);else if(c==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(e,s,a){if(e==null)return e;var i=[],o=0;return R$1(e,i,"","",function(c){return s.call(a,c,o++)}),i}function T$1(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,s,a){S$1(e,function(){s.apply(this,arguments)},a)},count:function(e){var s=0;return S$1(e,function(){s++}),s},toArray:function(e){return S$1(e,function(s){return s})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$2;react_production_min.cloneElement=function(e,s,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=C$1({},e.props),o=e.key,c=e.ref,d=e._owner;if(s!=null){if(s.ref!==void 0&&(c=s.ref,d=K$1.current),s.key!==void 0&&(o=""+s.key),e.type&&e.type.defaultProps)var h=e.type.defaultProps;for(g in s)J.call(s,g)&&!L$1.hasOwnProperty(g)&&(i[g]=s[g]===void 0&&h!==void 0?h[g]:s[g])}var g=arguments.length-2;if(g===1)i.children=a;else if(1<g){h=Array(g);for(var _=0;_<g;_++)h[_]=arguments[_+2];i.children=h}return{$$typeof:l$1,type:e.type,key:o,ref:c,props:i,_owner:d}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var s=M$1.bind(null,e);return s.type=e,s};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,s){return{$$typeof:x,type:e,compare:s===void 0?null:s}};react_production_min.startTransition=function(e){var s=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=s}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(e,s){return U$1.current.useCallback(e,s)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,s){return U$1.current.useEffect(e,s)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,s,a){return U$1.current.useImperativeHandle(e,s,a)};react_production_min.useInsertionEffect=function(e,s){return U$1.current.useInsertionEffect(e,s)};react_production_min.useLayoutEffect=function(e,s){return U$1.current.useLayoutEffect(e,s)};react_production_min.useMemo=function(e,s){return U$1.current.useMemo(e,s)};react_production_min.useReducer=function(e,s,a){return U$1.current.useReducer(e,s,a)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,s,a){return U$1.current.useSyncExternalStore(e,s,a)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,s,a){var i,o={},c=null,d=null;a!==void 0&&(c=""+a),s.key!==void 0&&(c=""+s.key),s.ref!==void 0&&(d=s.ref);for(i in s)m$1.call(s,i)&&!p$1.hasOwnProperty(i)&&(o[i]=s[i]);if(e&&e.defaultProps)for(i in s=e.defaultProps,s)o[i]===void 0&&(o[i]=s[i]);return{$$typeof:k,type:e,key:c,ref:d,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(jt,ut){var Lt=jt.length;jt.push(ut);e:for(;0<Lt;){var Pt=Lt-1>>>1,ft=jt[Pt];if(0<o(ft,ut))jt[Pt]=ut,jt[Lt]=ft,Lt=Pt;else break e}}function a(jt){return jt.length===0?null:jt[0]}function i(jt){if(jt.length===0)return null;var ut=jt[0],Lt=jt.pop();if(Lt!==ut){jt[0]=Lt;e:for(var Pt=0,ft=jt.length,Rt=ft>>>1;Pt<Rt;){var bt=2*(Pt+1)-1,At=jt[bt],Ut=bt+1,Xt=jt[Ut];if(0>o(At,Lt))Ut<ft&&0>o(Xt,At)?(jt[Pt]=Xt,jt[Ut]=Lt,Pt=Ut):(jt[Pt]=At,jt[bt]=Lt,Pt=bt);else if(Ut<ft&&0>o(Xt,Lt))jt[Pt]=Xt,jt[Ut]=Lt,Pt=Ut;else break e}}return ut}function o(jt,ut){var Lt=jt.sortIndex-ut.sortIndex;return Lt!==0?Lt:jt.id-ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();e.unstable_now=function(){return d.now()-h}}var g=[],_=[],b=1,j=null,_e=3,tt=!1,rt=!1,et=!1,st=typeof setTimeout=="function"?setTimeout:null,at=typeof clearTimeout=="function"?clearTimeout:null,it=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function nt(jt){for(var ut=a(_);ut!==null;){if(ut.callback===null)i(_);else if(ut.startTime<=jt)i(_),ut.sortIndex=ut.expirationTime,s(g,ut);else break;ut=a(_)}}function ot(jt){if(et=!1,nt(jt),!rt)if(a(g)!==null)rt=!0,Ct(dt);else{var ut=a(_);ut!==null&&kt(ot,ut.startTime-jt)}}function dt(jt,ut){rt=!1,et&&(et=!1,at(gt),gt=-1),tt=!0;var Lt=_e;try{for(nt(ut),j=a(g);j!==null&&(!(j.expirationTime>ut)||jt&&!mt());){var Pt=j.callback;if(typeof Pt=="function"){j.callback=null,_e=j.priorityLevel;var ft=Pt(j.expirationTime<=ut);ut=e.unstable_now(),typeof ft=="function"?j.callback=ft:j===a(g)&&i(g),nt(ut)}else i(g);j=a(g)}if(j!==null)var Rt=!0;else{var bt=a(_);bt!==null&&kt(ot,bt.startTime-ut),Rt=!1}return Rt}finally{j=null,_e=Lt,tt=!1}}var ht=!1,lt=null,gt=-1,yt=5,Tt=-1;function mt(){return!(e.unstable_now()-Tt<yt)}function Et(){if(lt!==null){var jt=e.unstable_now();Tt=jt;var ut=!0;try{ut=lt(!0,jt)}finally{ut?Ft():(ht=!1,lt=null)}}else ht=!1}var Ft;if(typeof it=="function")Ft=function(){it(Et)};else if(typeof MessageChannel<"u"){var Vt=new MessageChannel,Mt=Vt.port2;Vt.port1.onmessage=Et,Ft=function(){Mt.postMessage(null)}}else Ft=function(){st(Et,0)};function Ct(jt){lt=jt,ht||(ht=!0,Ft())}function kt(jt,ut){gt=st(function(){jt(e.unstable_now())},ut)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(jt){jt.callback=null},e.unstable_continueExecution=function(){rt||tt||(rt=!0,Ct(dt))},e.unstable_forceFrameRate=function(jt){0>jt||125<jt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):yt=0<jt?Math.floor(1e3/jt):5},e.unstable_getCurrentPriorityLevel=function(){return _e},e.unstable_getFirstCallbackNode=function(){return a(g)},e.unstable_next=function(jt){switch(_e){case 1:case 2:case 3:var ut=3;break;default:ut=_e}var Lt=_e;_e=ut;try{return jt()}finally{_e=Lt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(jt,ut){switch(jt){case 1:case 2:case 3:case 4:case 5:break;default:jt=3}var Lt=_e;_e=jt;try{return ut()}finally{_e=Lt}},e.unstable_scheduleCallback=function(jt,ut,Lt){var Pt=e.unstable_now();switch(typeof Lt=="object"&&Lt!==null?(Lt=Lt.delay,Lt=typeof Lt=="number"&&0<Lt?Pt+Lt:Pt):Lt=Pt,jt){case 1:var ft=-1;break;case 2:ft=250;break;case 5:ft=1073741823;break;case 4:ft=1e4;break;default:ft=5e3}return ft=Lt+ft,jt={id:b++,callback:ut,priorityLevel:jt,startTime:Lt,expirationTime:ft,sortIndex:-1},Lt>Pt?(jt.sortIndex=Lt,s(_,jt),a(g)===null&&jt===a(_)&&(et?(at(gt),gt=-1):et=!0,kt(ot,Lt-Pt))):(jt.sortIndex=ft,s(g,jt),rt||tt||(rt=!0,Ct(dt))),jt},e.unstable_shouldYield=mt,e.unstable_wrapCallback=function(jt){var ut=_e;return function(){var Lt=_e;_e=ut;try{return jt.apply(this,arguments)}finally{_e=Lt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,s){ha(e,s),ha(e+"Capture",s)}function ha(e,s){for(ea[e]=s,e=0;e<s.length;e++)da.add(s[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,s,a,i){if(a!==null&&a.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return i?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,s,a,i){if(s===null||typeof s>"u"||pa(e,s,a,i))return!0;if(i)return!1;if(a!==null)switch(a.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function v(e,s,a,i,o,c,d){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=a,this.propertyName=e,this.type=s,this.sanitizeURL=c,this.removeEmptyString=d}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];z[s]=new v(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(ra,sa);z[s]=new v(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(ra,sa);z[s]=new v(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(ra,sa);z[s]=new v(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,s,a,i){var o=z.hasOwnProperty(s)?z[s]:null;(o!==null?o.type!==0:i||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(qa(s,a,o,i)&&(a=null),i||o===null?oa(s)&&(a===null?e.removeAttribute(s):e.setAttribute(s,""+a)):o.mustUseProperty?e[o.propertyName]=a===null?o.type===3?!1:"":a:(s=o.attributeName,i=o.attributeNamespace,a===null?e.removeAttribute(s):(o=o.type,a=o===3||o===4&&a===!0?"":""+a,i?e.setAttributeNS(i,s,a):e.setAttribute(s,a))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);La=s&&s[1]||""}return`
`+La+e}var Na=!1;function Oa(e,s){if(!e||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(_){var i=_}Reflect.construct(e,[],s)}else{try{s.call()}catch(_){i=_}e.call(s.prototype)}else{try{throw Error()}catch(_){i=_}e()}}catch(_){if(_&&i&&typeof _.stack=="string"){for(var o=_.stack.split(`
`),c=i.stack.split(`
`),d=o.length-1,h=c.length-1;1<=d&&0<=h&&o[d]!==c[h];)h--;for(;1<=d&&0<=h;d--,h--)if(o[d]!==c[h]){if(d!==1||h!==1)do if(d--,h--,0>h||o[d]!==c[h]){var g=`
`+o[d].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=d&&0<=h);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return s=e.displayName||null,s!==null?s:Qa(e.type)||"Memo";case Ha:s=e._payload,e=e._init;try{return Qa(e(s))}catch{}}return null}function Ra(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(s);case 8:return s===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ua(e){var s=Ta(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),i=""+e[s];if(!e.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var o=a.get,c=a.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return o.call(this)},set:function(d){i=""+d,c.call(this,d)}}),Object.defineProperty(e,s,{enumerable:a.enumerable}),{getValue:function(){return i},setValue:function(d){i=""+d},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var a=s.getValue(),i="";return e&&(i=Ta(e)?e.checked?"true":"false":e.value),e=i,e!==a?(s.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,s){var a=s.checked;return A({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Za(e,s){var a=s.defaultValue==null?"":s.defaultValue,i=s.checked!=null?s.checked:s.defaultChecked;a=Sa(s.value!=null?s.value:a),e._wrapperState={initialChecked:i,initialValue:a,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ab(e,s){s=s.checked,s!=null&&ta(e,"checked",s,!1)}function bb(e,s){ab(e,s);var a=Sa(s.value),i=s.type;if(a!=null)i==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?cb(e,s.type,a):s.hasOwnProperty("defaultValue")&&cb(e,s.type,Sa(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function db(e,s,a){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var i=s.type;if(!(i!=="submit"&&i!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,a||s===e.value||(e.value=s),e.defaultValue=s}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function cb(e,s,a){(s!=="number"||Xa(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var eb=Array.isArray;function fb(e,s,a,i){if(e=e.options,s){s={};for(var o=0;o<a.length;o++)s["$"+a[o]]=!0;for(a=0;a<e.length;a++)o=s.hasOwnProperty("$"+e[a].value),e[a].selected!==o&&(e[a].selected=o),o&&i&&(e[a].defaultSelected=!0)}else{for(a=""+Sa(a),s=null,o=0;o<e.length;o++){if(e[o].value===a){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}s!==null||e[o].disabled||(s=e[o])}s!==null&&(s.selected=!0)}}function gb(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,s){var a=s.value;if(a==null){if(a=s.children,s=s.defaultValue,a!=null){if(s!=null)throw Error(p(92));if(eb(a)){if(1<a.length)throw Error(p(93));a=a[0]}s=a}s==null&&(s=""),a=s}e._wrapperState={initialValue:Sa(a)}}function ib(e,s){var a=Sa(s.value),i=Sa(s.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),s.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),i!=null&&(e.defaultValue=""+i)}function jb(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,a,i,o){MSApp.execUnsafeLocalFunction(function(){return e(s,a,i,o)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function ob(e,s){if(s){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=s;return}}e.textContent=s}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),pb[s]=pb[e]})});function rb(e,s,a){return s==null||typeof s=="boolean"||s===""?"":a||typeof s!="number"||s===0||pb.hasOwnProperty(e)&&pb[e]?(""+s).trim():s+"px"}function sb(e,s){e=e.style;for(var a in s)if(s.hasOwnProperty(a)){var i=a.indexOf("--")===0,o=rb(a,s[a],i);a==="float"&&(a="cssFloat"),i?e.setProperty(a,o):e[a]=o}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,s){if(s){if(tb[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(p(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(p(61))}if(s.style!=null&&typeof s.style!="object")throw Error(p(62))}}function vb(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var s=e.stateNode;s&&(s=Db(s),yb(e.stateNode,e.type,s))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,s=Ab;if(Ab=zb=null,Bb(e),s)for(e=0;e<s.length;e++)Bb(s[e])}}function Gb(e,s){return e(s)}function Hb(){}var Ib=!1;function Jb(e,s,a){if(Ib)return e(s,a);Ib=!0;try{return Gb(e,s,a)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,s){var a=e.stateNode;if(a===null)return null;var i=Db(a);if(i===null)return null;a=i[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(p(231,s,typeof a));return a}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,s,a,i,o,c,d,h,g){var _=Array.prototype.slice.call(arguments,3);try{s.apply(a,_)}catch(b){this.onError(b)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,s,a,i,o,c,d,h,g){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,s,a,i,o,c,d,h,g){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_)}}function Vb(e){var s=e,a=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(a=s.return),e=s.return;while(e)}return s.tag===3?a:null}function Wb(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var s=e.alternate;if(!s){if(s=Vb(e),s===null)throw Error(p(188));return s!==e?null:e}for(var a=e,i=s;;){var o=a.return;if(o===null)break;var c=o.alternate;if(c===null){if(i=o.return,i!==null){a=i;continue}break}if(o.child===c.child){for(c=o.child;c;){if(c===a)return Xb(o),e;if(c===i)return Xb(o),s;c=c.sibling}throw Error(p(188))}if(a.return!==i.return)a=o,i=c;else{for(var d=!1,h=o.child;h;){if(h===a){d=!0,a=o,i=c;break}if(h===i){d=!0,i=o,a=c;break}h=h.sibling}if(!d){for(h=c.child;h;){if(h===a){d=!0,a=c,i=o;break}if(h===i){d=!0,i=c,a=o;break}h=h.sibling}if(!d)throw Error(p(189))}}if(a.alternate!==i)throw Error(p(190))}if(a.tag!==3)throw Error(p(188));return a.stateNode.current===a?e:s}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=$b(e);if(s!==null)return s;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,s){var a=e.pendingLanes;if(a===0)return 0;var i=0,o=e.suspendedLanes,c=e.pingedLanes,d=a&268435455;if(d!==0){var h=d&~o;h!==0?i=tc(h):(c&=d,c!==0&&(i=tc(c)))}else d=a&~o,d!==0?i=tc(d):c!==0&&(i=tc(c));if(i===0)return 0;if(s!==0&&s!==i&&!(s&o)&&(o=i&-i,c=s&-s,o>=c||o===16&&(c&4194240)!==0))return s;if(i&4&&(i|=a&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=i;0<s;)a=31-oc(s),o=1<<a,i|=e[a],s&=~o;return i}function vc(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,s){for(var a=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,c=e.pendingLanes;0<c;){var d=31-oc(c),h=1<<d,g=o[d];g===-1?(!(h&a)||h&i)&&(o[d]=vc(h,s)):g<=s&&(e.expiredLanes|=h),c&=~h}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var s=[],a=0;31>a;a++)s.push(e);return s}function Ac(e,s,a){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-oc(s),e[s]=a}function Bc(e,s){var a=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<a;){var o=31-oc(a),c=1<<o;s[o]=0,i[o]=-1,e[o]=-1,a&=~c}}function Cc(e,s){var a=e.entangledLanes|=s;for(e=e.entanglements;a;){var i=31-oc(a),o=1<<i;o&s|e[i]&s&&(e[i]|=s),a&=~o}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,s){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(s.pointerId)}}function Tc(e,s,a,i,o,c){return e===null||e.nativeEvent!==c?(e={blockedOn:s,domEventName:a,eventSystemFlags:i,nativeEvent:c,targetContainers:[o]},s!==null&&(s=Cb(s),s!==null&&Fc(s)),e):(e.eventSystemFlags|=i,s=e.targetContainers,o!==null&&s.indexOf(o)===-1&&s.push(o),e)}function Uc(e,s,a,i,o){switch(s){case"focusin":return Lc=Tc(Lc,e,s,a,i,o),!0;case"dragenter":return Mc=Tc(Mc,e,s,a,i,o),!0;case"mouseover":return Nc=Tc(Nc,e,s,a,i,o),!0;case"pointerover":var c=o.pointerId;return Oc.set(c,Tc(Oc.get(c)||null,e,s,a,i,o)),!0;case"gotpointercapture":return c=o.pointerId,Pc.set(c,Tc(Pc.get(c)||null,e,s,a,i,o)),!0}return!1}function Vc(e){var s=Wc(e.target);if(s!==null){var a=Vb(s);if(a!==null){if(s=a.tag,s===13){if(s=Wb(a),s!==null){e.blockedOn=s,Ic(e.priority,function(){Gc(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var a=Yc(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var i=new a.constructor(a.type,a);wb=i,a.target.dispatchEvent(i),wb=null}else return s=Cb(a),s!==null&&Fc(s),e.blockedOn=a,!1;s.shift()}return!0}function Zc(e,s,a){Xc(e)&&a.delete(s)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,s){e.blockedOn===s&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function s(o){return ad(o,e)}if(0<Kc.length){ad(Kc[0],e);for(var a=1;a<Kc.length;a++){var i=Kc[a];i.blockedOn===e&&(i.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(s),Pc.forEach(s),a=0;a<Qc.length;a++)i=Qc[a],i.blockedOn===e&&(i.blockedOn=null);for(;0<Qc.length&&(a=Qc[0],a.blockedOn===null);)Vc(a),a.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,s,a,i){var o=C,c=cd.transition;cd.transition=null;try{C=1,fd(e,s,a,i)}finally{C=o,cd.transition=c}}function gd(e,s,a,i){var o=C,c=cd.transition;cd.transition=null;try{C=4,fd(e,s,a,i)}finally{C=o,cd.transition=c}}function fd(e,s,a,i){if(dd){var o=Yc(e,s,a,i);if(o===null)hd(e,s,i,id,a),Sc(e,i);else if(Uc(o,e,s,a,i))i.stopPropagation();else if(Sc(e,i),s&4&&-1<Rc.indexOf(e)){for(;o!==null;){var c=Cb(o);if(c!==null&&Ec(c),c=Yc(e,s,a,i),c===null&&hd(e,s,i,id,a),c===o)break;o=c}o!==null&&i.stopPropagation()}else hd(e,s,i,null,a)}}var id=null;function Yc(e,s,a,i){if(id=null,e=xb(i),e=Wc(e),e!==null)if(s=Vb(e),s===null)e=null;else if(a=s.tag,a===13){if(e=Wb(s),e!==null)return e;e=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,s=ld,a=s.length,i,o="value"in kd?kd.value:kd.textContent,c=o.length;for(e=0;e<a&&s[e]===o[e];e++);var d=a-e;for(i=1;i<=d&&s[a-i]===o[c-i];i++);return md=o.slice(e,1<i?1-i:void 0)}function od(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function s(a,i,o,c,d){this._reactName=a,this._targetInst=o,this.type=i,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var h in e)e.hasOwnProperty(h)&&(a=e[h],this[h]=a?a(c):c[h]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),s}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=Od[e])?!!s[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var s=Md[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,s){switch(e){case"keyup":return $d.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,s){switch(e){case"compositionend":return he(s);case"keypress":return s.which!==32?null:(fe=!0,ee);case"textInput":return e=s.data,e===ee&&fe?null:e;default:return null}}function ke(e,s){if(ie)return e==="compositionend"||!ae&&ge(e,s)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return de&&s.locale!=="ko"?null:s.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!le[e.type]:s==="textarea"}function ne(e,s,a,i){Eb(i),s=oe(s,"onChange"),0<s.length&&(a=new td("onChange","change",null,a,i),e.push({event:a,listeners:s}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var s=ue(e);if(Wa(s))return e}function ve(e,s){if(e==="change")return s}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var s=[];ne(s,qe,e,xb(e)),Jb(re,s)}}function Ce(e,s,a){e==="focusin"?(Ae(),pe=s,qe=a,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,s){if(e==="click")return te(s)}function Fe(e,s){if(e==="input"||e==="change")return te(s)}function Ge(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,s){if(He(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var a=Object.keys(e),i=Object.keys(s);if(a.length!==i.length)return!1;for(i=0;i<a.length;i++){var o=a[i];if(!ja.call(s,o)||!He(e[o],s[o]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,s){var a=Je(e);e=0;for(var i;a;){if(a.nodeType===3){if(i=e+a.textContent.length,e<=s&&i>=s)return{node:a,offset:s-e};e=i}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Je(a)}}function Le(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?Le(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function Me(){for(var e=window,s=Xa();s instanceof e.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)e=s.contentWindow;else break;s=Xa(e.document)}return s}function Ne(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function Oe(e){var s=Me(),a=e.focusedElem,i=e.selectionRange;if(s!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(i!==null&&Ne(a)){if(s=i.start,e=i.end,e===void 0&&(e=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(e,a.value.length);else if(e=(s=a.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var o=a.textContent.length,c=Math.min(i.start,o);i=i.end===void 0?c:Math.min(i.end,o),!e.extend&&c>i&&(o=i,i=c,c=o),o=Ke(a,c);var d=Ke(a,i);o&&d&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(s=s.createRange(),s.setStart(o.node,o.offset),e.removeAllRanges(),c>i?(e.addRange(s),e.extend(d.node,d.offset)):(s.setEnd(d.node,d.offset),e.addRange(s)))}}for(s=[],e=a;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)e=s[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,s,a){var i=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe==null||Qe!==Xa(i)||(i=Qe,"selectionStart"in i&&Ne(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Se&&Ie(Se,i)||(Se=i,i=oe(Re,"onSelect"),0<i.length&&(s=new td("onSelect","select",null,s,a),e.push({event:s,listeners:i}),s.target=Qe)))}function Ve(e,s){var a={};return a[e.toLowerCase()]=s.toLowerCase(),a["Webkit"+e]="webkit"+s,a["Moz"+e]="moz"+s,a}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var s=We[e],a;for(a in s)if(s.hasOwnProperty(a)&&a in Ye)return Xe[e]=s[a];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,s){df.set(e,s),fa(s,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,s,a){var i=e.type||"unknown-event";e.currentTarget=a,Ub(i,s,void 0,e),e.currentTarget=null}function se(e,s){s=(s&4)!==0;for(var a=0;a<e.length;a++){var i=e[a],o=i.event;i=i.listeners;e:{var c=void 0;if(s)for(var d=i.length-1;0<=d;d--){var h=i[d],g=h.instance,_=h.currentTarget;if(h=h.listener,g!==c&&o.isPropagationStopped())break e;nf(o,h,_),c=g}else for(d=0;d<i.length;d++){if(h=i[d],g=h.instance,_=h.currentTarget,h=h.listener,g!==c&&o.isPropagationStopped())break e;nf(o,h,_),c=g}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,s){var a=s[of];a===void 0&&(a=s[of]=new Set);var i=e+"__bubble";a.has(i)||(pf(s,e,2,!1),a.add(i))}function qf(e,s,a){var i=0;s&&(i|=4),pf(a,e,i,s)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(a){a!=="selectionchange"&&(mf.has(a)||qf(a,!1,e),qf(a,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[rf]||(s[rf]=!0,qf("selectionchange",!1,s))}}function pf(e,s,a,i){switch(jd(s)){case 1:var o=ed;break;case 4:o=gd;break;default:o=fd}a=o.bind(null,s,a,e),o=void 0,!Lb||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(s,a,{capture:!0,passive:o}):e.addEventListener(s,a,!0):o!==void 0?e.addEventListener(s,a,{passive:o}):e.addEventListener(s,a,!1)}function hd(e,s,a,i,o){var c=i;if(!(s&1)&&!(s&2)&&i!==null)e:for(;;){if(i===null)return;var d=i.tag;if(d===3||d===4){var h=i.stateNode.containerInfo;if(h===o||h.nodeType===8&&h.parentNode===o)break;if(d===4)for(d=i.return;d!==null;){var g=d.tag;if((g===3||g===4)&&(g=d.stateNode.containerInfo,g===o||g.nodeType===8&&g.parentNode===o))return;d=d.return}for(;h!==null;){if(d=Wc(h),d===null)return;if(g=d.tag,g===5||g===6){i=c=d;continue e}h=h.parentNode}}i=i.return}Jb(function(){var _=c,b=xb(a),j=[];e:{var _e=df.get(e);if(_e!==void 0){var tt=td,rt=e;switch(e){case"keypress":if(od(a)===0)break e;case"keydown":case"keyup":tt=Rd;break;case"focusin":rt="focus",tt=Fd;break;case"focusout":rt="blur",tt=Fd;break;case"beforeblur":case"afterblur":tt=Fd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=Vd;break;case $e:case af:case bf:tt=Hd;break;case cf:tt=Xd;break;case"scroll":tt=vd;break;case"wheel":tt=Zd;break;case"copy":case"cut":case"paste":tt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=Td}var et=(s&4)!==0,st=!et&&e==="scroll",at=et?_e!==null?_e+"Capture":null:_e;et=[];for(var it=_,nt;it!==null;){nt=it;var ot=nt.stateNode;if(nt.tag===5&&ot!==null&&(nt=ot,at!==null&&(ot=Kb(it,at),ot!=null&&et.push(tf(it,ot,nt)))),st)break;it=it.return}0<et.length&&(_e=new tt(_e,rt,null,a,b),j.push({event:_e,listeners:et}))}}if(!(s&7)){e:{if(_e=e==="mouseover"||e==="pointerover",tt=e==="mouseout"||e==="pointerout",_e&&a!==wb&&(rt=a.relatedTarget||a.fromElement)&&(Wc(rt)||rt[uf]))break e;if((tt||_e)&&(_e=b.window===b?b:(_e=b.ownerDocument)?_e.defaultView||_e.parentWindow:window,tt?(rt=a.relatedTarget||a.toElement,tt=_,rt=rt?Wc(rt):null,rt!==null&&(st=Vb(rt),rt!==st||rt.tag!==5&&rt.tag!==6)&&(rt=null)):(tt=null,rt=_),tt!==rt)){if(et=Bd,ot="onMouseLeave",at="onMouseEnter",it="mouse",(e==="pointerout"||e==="pointerover")&&(et=Td,ot="onPointerLeave",at="onPointerEnter",it="pointer"),st=tt==null?_e:ue(tt),nt=rt==null?_e:ue(rt),_e=new et(ot,it+"leave",tt,a,b),_e.target=st,_e.relatedTarget=nt,ot=null,Wc(b)===_&&(et=new et(at,it+"enter",rt,a,b),et.target=nt,et.relatedTarget=st,ot=et),st=ot,tt&&rt)t:{for(et=tt,at=rt,it=0,nt=et;nt;nt=vf(nt))it++;for(nt=0,ot=at;ot;ot=vf(ot))nt++;for(;0<it-nt;)et=vf(et),it--;for(;0<nt-it;)at=vf(at),nt--;for(;it--;){if(et===at||at!==null&&et===at.alternate)break t;et=vf(et),at=vf(at)}et=null}else et=null;tt!==null&&wf(j,_e,tt,et,!1),rt!==null&&st!==null&&wf(j,st,rt,et,!0)}}e:{if(_e=_?ue(_):window,tt=_e.nodeName&&_e.nodeName.toLowerCase(),tt==="select"||tt==="input"&&_e.type==="file")var dt=ve;else if(me(_e))if(we)dt=Fe;else{dt=De;var ht=Ce}else(tt=_e.nodeName)&&tt.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&(dt=Ee);if(dt&&(dt=dt(e,_))){ne(j,dt,a,b);break e}ht&&ht(e,_e,_),e==="focusout"&&(ht=_e._wrapperState)&&ht.controlled&&_e.type==="number"&&cb(_e,"number",_e.value)}switch(ht=_?ue(_):window,e){case"focusin":(me(ht)||ht.contentEditable==="true")&&(Qe=ht,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(j,a,b);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(j,a,b)}var lt;if(ae)e:{switch(e){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else ie?ge(e,a)&&(gt="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(gt="onCompositionStart");gt&&(de&&a.locale!=="ko"&&(ie||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&ie&&(lt=nd()):(kd=b,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ht=oe(_,gt),0<ht.length&&(gt=new Ld(gt,e,null,a,b),j.push({event:gt,listeners:ht}),lt?gt.data=lt:(lt=he(a),lt!==null&&(gt.data=lt)))),(lt=ce?je(e,a):ke(e,a))&&(_=oe(_,"onBeforeInput"),0<_.length&&(b=new Ld("onBeforeInput","beforeinput",null,a,b),j.push({event:b,listeners:_}),b.data=lt))}se(j,s)})}function tf(e,s,a){return{instance:e,listener:s,currentTarget:a}}function oe(e,s){for(var a=s+"Capture",i=[];e!==null;){var o=e,c=o.stateNode;o.tag===5&&c!==null&&(o=c,c=Kb(e,a),c!=null&&i.unshift(tf(e,c,o)),c=Kb(e,s),c!=null&&i.push(tf(e,c,o))),e=e.return}return i}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,s,a,i,o){for(var c=s._reactName,d=[];a!==null&&a!==i;){var h=a,g=h.alternate,_=h.stateNode;if(g!==null&&g===i)break;h.tag===5&&_!==null&&(h=_,o?(g=Kb(a,c),g!=null&&d.unshift(tf(a,g,h))):o||(g=Kb(a,c),g!=null&&d.push(tf(a,g,h)))),a=a.return}d.length!==0&&e.push({event:s,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,s,a){if(s=zf(s),zf(e)!==s&&a)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,s){var a=s,i=0;do{var o=a.nextSibling;if(e.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(i===0){e.removeChild(o),bd(s);return}i--}else a!=="$"&&a!=="$?"&&a!=="$!"||i++;a=o}while(a);bd(s)}function Lf(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return e;s--}else a==="/$"&&s++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var s=e[Of];if(s)return s;for(var a=e.parentNode;a;){if(s=a[uf]||a[Of]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(e=Mf(e);e!==null;){if(a=e[Of])return a;e=Mf(e)}return s}e=a,a=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,s){Tf++,Sf[Tf]=e.current,e.current=s}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,s){var a=e.type.contextTypes;if(!a)return Vf;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===s)return i.__reactInternalMemoizedMaskedChildContext;var o={},c;for(c in a)o[c]=s[c];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,s,a){if(H.current!==Vf)throw Error(p(168));G(H,s),G(Wf,a)}function bg(e,s,a){var i=e.stateNode;if(s=s.childContextTypes,typeof i.getChildContext!="function")return a;i=i.getChildContext();for(var o in i)if(!(o in s))throw Error(p(108,Ra(e)||"Unknown",o));return A({},a,i)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,s,a){var i=e.stateNode;if(!i)throw Error(p(169));a?(e=bg(e,s,Xf),i.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,a)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,s=C;try{var a=eg;for(C=1;e<a.length;e++){var i=a[e];do i=i(!0);while(i!==null)}eg=null,fg=!1}catch(o){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),o}finally{C=s,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,s){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=s}function ug(e,s,a){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var i=rg;e=sg;var o=32-oc(i)-1;i&=~(1<<o),a+=1;var c=32-oc(s)+o;if(30<c){var d=o-o%5;c=(i&(1<<d)-1).toString(32),i>>=d,o-=d,rg=1<<32-oc(s)+o|a<<o|i,sg=c+e}else rg=1<<c|a<<o|i,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,s){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=s,a.return=e,s=e.deletions,s===null?(e.deletions=[a],e.flags|=16):s.push(a)}function Cg(e,s){switch(e.tag){case 5:var a=e.type;return s=s.nodeType!==1||a.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,xg=e,yg=Lf(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,xg=e,yg=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(a=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:s,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=s,a.return=e,e.child=a,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var s=yg;if(s){var a=s;if(!Cg(e,s)){if(Dg(e))throw Error(p(418));s=Lf(a.nextSibling);var i=xg;s&&Cg(e,s)?Ag(i,a):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!Ef(e.type,e.memoizedProps)),s&&(s=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;s;)Ag(e,s),s=Lf(s.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(s===0){yg=Lf(e.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,s,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p(309));var i=a.stateNode}if(!i)throw Error(p(147,e));var o=i,c=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===c?s.ref:(s=function(d){var h=o.refs;d===null?delete h[c]:h[c]=d},s._stringRef=c,s)}if(typeof e!="string")throw Error(p(284));if(!a._owner)throw Error(p(290,e))}return e}function Mg(e,s){throw e=Object.prototype.toString.call(s),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function Ng(e){var s=e._init;return s(e._payload)}function Og(e){function s(at,it){if(e){var nt=at.deletions;nt===null?(at.deletions=[it],at.flags|=16):nt.push(it)}}function a(at,it){if(!e)return null;for(;it!==null;)s(at,it),it=it.sibling;return null}function i(at,it){for(at=new Map;it!==null;)it.key!==null?at.set(it.key,it):at.set(it.index,it),it=it.sibling;return at}function o(at,it){return at=Pg(at,it),at.index=0,at.sibling=null,at}function c(at,it,nt){return at.index=nt,e?(nt=at.alternate,nt!==null?(nt=nt.index,nt<it?(at.flags|=2,it):nt):(at.flags|=2,it)):(at.flags|=1048576,it)}function d(at){return e&&at.alternate===null&&(at.flags|=2),at}function h(at,it,nt,ot){return it===null||it.tag!==6?(it=Qg(nt,at.mode,ot),it.return=at,it):(it=o(it,nt),it.return=at,it)}function g(at,it,nt,ot){var dt=nt.type;return dt===ya?b(at,it,nt.props.children,ot,nt.key):it!==null&&(it.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===it.type)?(ot=o(it,nt.props),ot.ref=Lg(at,it,nt),ot.return=at,ot):(ot=Rg(nt.type,nt.key,nt.props,null,at.mode,ot),ot.ref=Lg(at,it,nt),ot.return=at,ot)}function _(at,it,nt,ot){return it===null||it.tag!==4||it.stateNode.containerInfo!==nt.containerInfo||it.stateNode.implementation!==nt.implementation?(it=Sg(nt,at.mode,ot),it.return=at,it):(it=o(it,nt.children||[]),it.return=at,it)}function b(at,it,nt,ot,dt){return it===null||it.tag!==7?(it=Tg(nt,at.mode,ot,dt),it.return=at,it):(it=o(it,nt),it.return=at,it)}function j(at,it,nt){if(typeof it=="string"&&it!==""||typeof it=="number")return it=Qg(""+it,at.mode,nt),it.return=at,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case va:return nt=Rg(it.type,it.key,it.props,null,at.mode,nt),nt.ref=Lg(at,null,it),nt.return=at,nt;case wa:return it=Sg(it,at.mode,nt),it.return=at,it;case Ha:var ot=it._init;return j(at,ot(it._payload),nt)}if(eb(it)||Ka(it))return it=Tg(it,at.mode,nt,null),it.return=at,it;Mg(at,it)}return null}function _e(at,it,nt,ot){var dt=it!==null?it.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number")return dt!==null?null:h(at,it,""+nt,ot);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case va:return nt.key===dt?g(at,it,nt,ot):null;case wa:return nt.key===dt?_(at,it,nt,ot):null;case Ha:return dt=nt._init,_e(at,it,dt(nt._payload),ot)}if(eb(nt)||Ka(nt))return dt!==null?null:b(at,it,nt,ot,null);Mg(at,nt)}return null}function tt(at,it,nt,ot,dt){if(typeof ot=="string"&&ot!==""||typeof ot=="number")return at=at.get(nt)||null,h(it,at,""+ot,dt);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case va:return at=at.get(ot.key===null?nt:ot.key)||null,g(it,at,ot,dt);case wa:return at=at.get(ot.key===null?nt:ot.key)||null,_(it,at,ot,dt);case Ha:var ht=ot._init;return tt(at,it,nt,ht(ot._payload),dt)}if(eb(ot)||Ka(ot))return at=at.get(nt)||null,b(it,at,ot,dt,null);Mg(it,ot)}return null}function rt(at,it,nt,ot){for(var dt=null,ht=null,lt=it,gt=it=0,yt=null;lt!==null&&gt<nt.length;gt++){lt.index>gt?(yt=lt,lt=null):yt=lt.sibling;var Tt=_e(at,lt,nt[gt],ot);if(Tt===null){lt===null&&(lt=yt);break}e&&lt&&Tt.alternate===null&&s(at,lt),it=c(Tt,it,gt),ht===null?dt=Tt:ht.sibling=Tt,ht=Tt,lt=yt}if(gt===nt.length)return a(at,lt),I&&tg(at,gt),dt;if(lt===null){for(;gt<nt.length;gt++)lt=j(at,nt[gt],ot),lt!==null&&(it=c(lt,it,gt),ht===null?dt=lt:ht.sibling=lt,ht=lt);return I&&tg(at,gt),dt}for(lt=i(at,lt);gt<nt.length;gt++)yt=tt(lt,at,gt,nt[gt],ot),yt!==null&&(e&&yt.alternate!==null&&lt.delete(yt.key===null?gt:yt.key),it=c(yt,it,gt),ht===null?dt=yt:ht.sibling=yt,ht=yt);return e&&lt.forEach(function(mt){return s(at,mt)}),I&&tg(at,gt),dt}function et(at,it,nt,ot){var dt=Ka(nt);if(typeof dt!="function")throw Error(p(150));if(nt=dt.call(nt),nt==null)throw Error(p(151));for(var ht=dt=null,lt=it,gt=it=0,yt=null,Tt=nt.next();lt!==null&&!Tt.done;gt++,Tt=nt.next()){lt.index>gt?(yt=lt,lt=null):yt=lt.sibling;var mt=_e(at,lt,Tt.value,ot);if(mt===null){lt===null&&(lt=yt);break}e&&lt&&mt.alternate===null&&s(at,lt),it=c(mt,it,gt),ht===null?dt=mt:ht.sibling=mt,ht=mt,lt=yt}if(Tt.done)return a(at,lt),I&&tg(at,gt),dt;if(lt===null){for(;!Tt.done;gt++,Tt=nt.next())Tt=j(at,Tt.value,ot),Tt!==null&&(it=c(Tt,it,gt),ht===null?dt=Tt:ht.sibling=Tt,ht=Tt);return I&&tg(at,gt),dt}for(lt=i(at,lt);!Tt.done;gt++,Tt=nt.next())Tt=tt(lt,at,gt,Tt.value,ot),Tt!==null&&(e&&Tt.alternate!==null&&lt.delete(Tt.key===null?gt:Tt.key),it=c(Tt,it,gt),ht===null?dt=Tt:ht.sibling=Tt,ht=Tt);return e&&lt.forEach(function(Et){return s(at,Et)}),I&&tg(at,gt),dt}function st(at,it,nt,ot){if(typeof nt=="object"&&nt!==null&&nt.type===ya&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case va:e:{for(var dt=nt.key,ht=it;ht!==null;){if(ht.key===dt){if(dt=nt.type,dt===ya){if(ht.tag===7){a(at,ht.sibling),it=o(ht,nt.props.children),it.return=at,at=it;break e}}else if(ht.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===ht.type){a(at,ht.sibling),it=o(ht,nt.props),it.ref=Lg(at,ht,nt),it.return=at,at=it;break e}a(at,ht);break}else s(at,ht);ht=ht.sibling}nt.type===ya?(it=Tg(nt.props.children,at.mode,ot,nt.key),it.return=at,at=it):(ot=Rg(nt.type,nt.key,nt.props,null,at.mode,ot),ot.ref=Lg(at,it,nt),ot.return=at,at=ot)}return d(at);case wa:e:{for(ht=nt.key;it!==null;){if(it.key===ht)if(it.tag===4&&it.stateNode.containerInfo===nt.containerInfo&&it.stateNode.implementation===nt.implementation){a(at,it.sibling),it=o(it,nt.children||[]),it.return=at,at=it;break e}else{a(at,it);break}else s(at,it);it=it.sibling}it=Sg(nt,at.mode,ot),it.return=at,at=it}return d(at);case Ha:return ht=nt._init,st(at,it,ht(nt._payload),ot)}if(eb(nt))return rt(at,it,nt,ot);if(Ka(nt))return et(at,it,nt,ot);Mg(at,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"?(nt=""+nt,it!==null&&it.tag===6?(a(at,it.sibling),it=o(it,nt),it.return=at,at=it):(a(at,it),it=Qg(nt,at.mode,ot),it.return=at,at=it),d(at)):a(at,it)}return st}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var s=Wg.current;E(Wg),e._currentValue=s}function bh(e,s,a){for(;e!==null;){var i=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,i!==null&&(i.childLanes|=s)):i!==null&&(i.childLanes&s)!==s&&(i.childLanes|=s),e===a)break;e=e.return}}function ch(e,s){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(dh=!0),e.firstContext=null)}function eh(e){var s=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:s,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return s}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,s,a,i){var o=s.interleaved;return o===null?(a.next=a,gh(s)):(a.next=o.next,o.next=a),s.interleaved=a,ih(e,i)}function ih(e,s){e.lanes|=s;var a=e.alternate;for(a!==null&&(a.lanes|=s),a=e,e=e.return;e!==null;)e.childLanes|=s,a=e.alternate,a!==null&&(a.childLanes|=s),a=e,e=e.return;return a.tag===3?a.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function nh(e,s,a){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,K&2){var o=i.pending;return o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s,ih(e,a)}return o=i.interleaved,o===null?(s.next=s,gh(i)):(s.next=o.next,o.next=s),i.interleaved=s,ih(e,a)}function oh(e,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194240)!==0)){var i=s.lanes;i&=e.pendingLanes,a|=i,s.lanes=a,Cc(e,a)}}function ph(e,s){var a=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,a===i)){var o=null,c=null;if(a=a.firstBaseUpdate,a!==null){do{var d={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};c===null?o=c=d:c=c.next=d,a=a.next}while(a!==null);c===null?o=c=s:c=c.next=s}else o=c=s;a={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:c,shared:i.shared,effects:i.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=s:e.next=s,a.lastBaseUpdate=s}function qh(e,s,a,i){var o=e.updateQueue;jh=!1;var c=o.firstBaseUpdate,d=o.lastBaseUpdate,h=o.shared.pending;if(h!==null){o.shared.pending=null;var g=h,_=g.next;g.next=null,d===null?c=_:d.next=_,d=g;var b=e.alternate;b!==null&&(b=b.updateQueue,h=b.lastBaseUpdate,h!==d&&(h===null?b.firstBaseUpdate=_:h.next=_,b.lastBaseUpdate=g))}if(c!==null){var j=o.baseState;d=0,b=_=g=null,h=c;do{var _e=h.lane,tt=h.eventTime;if((i&_e)===_e){b!==null&&(b=b.next={eventTime:tt,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var rt=e,et=h;switch(_e=s,tt=a,et.tag){case 1:if(rt=et.payload,typeof rt=="function"){j=rt.call(tt,j,_e);break e}j=rt;break e;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=et.payload,_e=typeof rt=="function"?rt.call(tt,j,_e):rt,_e==null)break e;j=A({},j,_e);break e;case 2:jh=!0}}h.callback!==null&&h.lane!==0&&(e.flags|=64,_e=o.effects,_e===null?o.effects=[h]:_e.push(h))}else tt={eventTime:tt,lane:_e,tag:h.tag,payload:h.payload,callback:h.callback,next:null},b===null?(_=b=tt,g=j):b=b.next=tt,d|=_e;if(h=h.next,h===null){if(h=o.shared.pending,h===null)break;_e=h,h=_e.next,_e.next=null,o.lastBaseUpdate=_e,o.shared.pending=null}}while(!0);if(b===null&&(g=j),o.baseState=g,o.firstBaseUpdate=_,o.lastBaseUpdate=b,s=o.shared.interleaved,s!==null){o=s;do d|=o.lane,o=o.next;while(o!==s)}else c===null&&(o.shared.lanes=0);rh|=d,e.lanes=d,e.memoizedState=j}}function sh(e,s,a){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var i=e[s],o=i.callback;if(o!==null){if(i.callback=null,i=a,typeof o!="function")throw Error(p(191,o));o.call(i)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,s){switch(G(wh,s),G(vh,e),G(uh,th),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:lb(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=lb(s,e)}E(uh),G(uh,s)}function zh(){E(uh),E(vh),E(wh)}function Ah(e){xh(wh.current);var s=xh(uh.current),a=lb(s,e.type);s!==a&&(G(vh,e),G(uh,a))}function Bh(e){vh.current===e&&(E(uh),E(vh))}var L=Uf(0);function Ch(e){for(var s=e;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(e,s){if(s===null)return!1;for(var a=0;a<s.length&&a<e.length;a++)if(!He(e[a],s[a]))return!1;return!0}function Nh(e,s,a,i,o,c){if(Hh=c,M=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=a(i,o),Jh){c=0;do{if(Jh=!1,Kh=0,25<=c)throw Error(p(301));c+=1,O=N=null,s.updateQueue=null,Fh.current=Qh,e=a(i,o)}while(Jh)}if(Fh.current=Rh,s=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,s)throw Error(p(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var s=O===null?M.memoizedState:O.next;if(s!==null)O=s,N=e;else{if(e===null)throw Error(p(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,s){return typeof s=="function"?s(e):s}function Wh(e){var s=Uh(),a=s.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=e;var i=N,o=i.baseQueue,c=a.pending;if(c!==null){if(o!==null){var d=o.next;o.next=c.next,c.next=d}i.baseQueue=o=c,a.pending=null}if(o!==null){c=o.next,i=i.baseState;var h=d=null,g=null,_=c;do{var b=_.lane;if((Hh&b)===b)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),i=_.hasEagerState?_.eagerState:e(i,_.action);else{var j={lane:b,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(h=g=j,d=i):g=g.next=j,M.lanes|=b,rh|=b}_=_.next}while(_!==null&&_!==c);g===null?d=i:g.next=h,He(i,s.memoizedState)||(dh=!0),s.memoizedState=i,s.baseState=d,s.baseQueue=g,a.lastRenderedState=i}if(e=a.interleaved,e!==null){o=e;do c=o.lane,M.lanes|=c,rh|=c,o=o.next;while(o!==e)}else o===null&&(a.lanes=0);return[s.memoizedState,a.dispatch]}function Xh(e){var s=Uh(),a=s.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=e;var i=a.dispatch,o=a.pending,c=s.memoizedState;if(o!==null){a.pending=null;var d=o=o.next;do c=e(c,d.action),d=d.next;while(d!==o);He(c,s.memoizedState)||(dh=!0),s.memoizedState=c,s.baseQueue===null&&(s.baseState=c),a.lastRenderedState=c}return[c,i]}function Yh(){}function Zh(e,s){var a=M,i=Uh(),o=s(),c=!He(i.memoizedState,o);if(c&&(i.memoizedState=o,dh=!0),i=i.queue,$h(ai.bind(null,a,i,e),[e]),i.getSnapshot!==s||c||O!==null&&O.memoizedState.tag&1){if(a.flags|=2048,bi(9,ci.bind(null,a,i,o,s),void 0,null),Q===null)throw Error(p(349));Hh&30||di(a,s,o)}return o}function di(e,s,a){e.flags|=16384,e={getSnapshot:s,value:a},s=M.updateQueue,s===null?(s={lastEffect:null,stores:null},M.updateQueue=s,s.stores=[e]):(a=s.stores,a===null?s.stores=[e]:a.push(e))}function ci(e,s,a,i){s.value=a,s.getSnapshot=i,ei(s)&&fi(e)}function ai(e,s,a){return a(function(){ei(s)&&fi(e)})}function ei(e){var s=e.getSnapshot;e=e.value;try{var a=s();return!He(e,a)}catch{return!0}}function fi(e){var s=ih(e,1);s!==null&&gi(s,e,1,-1)}function hi(e){var s=Th();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},s.queue=e,e=e.dispatch=ii.bind(null,M,e),[s.memoizedState,e]}function bi(e,s,a,i){return e={tag:e,create:s,destroy:a,deps:i,next:null},s=M.updateQueue,s===null?(s={lastEffect:null,stores:null},M.updateQueue=s,s.lastEffect=e.next=e):(a=s.lastEffect,a===null?s.lastEffect=e.next=e:(i=a.next,a.next=e,e.next=i,s.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,s,a,i){var o=Th();M.flags|=e,o.memoizedState=bi(1|s,a,void 0,i===void 0?null:i)}function li(e,s,a,i){var o=Uh();i=i===void 0?null:i;var c=void 0;if(N!==null){var d=N.memoizedState;if(c=d.destroy,i!==null&&Mh(i,d.deps)){o.memoizedState=bi(s,a,c,i);return}}M.flags|=e,o.memoizedState=bi(1|s,a,c,i)}function mi(e,s){return ki(8390656,8,e,s)}function $h(e,s){return li(2048,8,e,s)}function ni(e,s){return li(4,2,e,s)}function oi(e,s){return li(4,4,e,s)}function pi(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function qi(e,s,a){return a=a!=null?a.concat([e]):null,li(4,4,pi.bind(null,s,e),a)}function ri(){}function si(e,s){var a=Uh();s=s===void 0?null:s;var i=a.memoizedState;return i!==null&&s!==null&&Mh(s,i[1])?i[0]:(a.memoizedState=[e,s],e)}function ti(e,s){var a=Uh();s=s===void 0?null:s;var i=a.memoizedState;return i!==null&&s!==null&&Mh(s,i[1])?i[0]:(e=e(),a.memoizedState=[e,s],e)}function ui(e,s,a){return Hh&21?(He(a,s)||(a=yc(),M.lanes|=a,rh|=a,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=a)}function vi(e,s){var a=C;C=a!==0&&4>a?a:4,e(!0);var i=Gh.transition;Gh.transition={};try{e(!1),s()}finally{C=a,Gh.transition=i}}function wi(){return Uh().memoizedState}function xi(e,s,a){var i=yi(e);if(a={lane:i,action:a,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(s,a);else if(a=hh(e,s,a,i),a!==null){var o=R();gi(a,e,i,o),Bi(a,s,i)}}function ii(e,s,a){var i=yi(e),o={lane:i,action:a,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(s,o);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=s.lastRenderedReducer,c!==null))try{var d=s.lastRenderedState,h=c(d,a);if(o.hasEagerState=!0,o.eagerState=h,He(h,d)){var g=s.interleaved;g===null?(o.next=o,gh(s)):(o.next=g.next,g.next=o),s.interleaved=o;return}}catch{}finally{}a=hh(e,s,o,i),a!==null&&(o=R(),gi(a,e,i,o),Bi(a,s,i))}}function zi(e){var s=e.alternate;return e===M||s!==null&&s===M}function Ai(e,s){Jh=Ih=!0;var a=e.pending;a===null?s.next=s:(s.next=a.next,a.next=s),e.pending=s}function Bi(e,s,a){if(a&4194240){var i=s.lanes;i&=e.pendingLanes,a|=i,s.lanes=a,Cc(e,a)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,s){return Th().memoizedState=[e,s===void 0?null:s],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,s,a){return a=a!=null?a.concat([e]):null,ki(4194308,4,pi.bind(null,s,e),a)},useLayoutEffect:function(e,s){return ki(4194308,4,e,s)},useInsertionEffect:function(e,s){return ki(4,2,e,s)},useMemo:function(e,s){var a=Th();return s=s===void 0?null:s,e=e(),a.memoizedState=[e,s],e},useReducer:function(e,s,a){var i=Th();return s=a!==void 0?a(s):s,i.memoizedState=i.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},i.queue=e,e=e.dispatch=xi.bind(null,M,e),[i.memoizedState,e]},useRef:function(e){var s=Th();return e={current:e},s.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),s=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,a){var i=M,o=Th();if(I){if(a===void 0)throw Error(p(407));a=a()}else{if(a=s(),Q===null)throw Error(p(349));Hh&30||di(i,s,a)}o.memoizedState=a;var c={value:a,getSnapshot:s};return o.queue=c,mi(ai.bind(null,i,c,e),[e]),i.flags|=2048,bi(9,ci.bind(null,i,c,a,s),void 0,null),a},useId:function(){var e=Th(),s=Q.identifierPrefix;if(I){var a=sg,i=rg;a=(i&~(1<<32-oc(i)-1)).toString(32)+a,s=":"+s+"R"+a,a=Kh++,0<a&&(s+="H"+a.toString(32)),s+=":"}else a=Lh++,s=":"+s+"r"+a.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var s=Uh();return ui(s,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],s=Uh().memoizedState;return[e,s]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var s=Uh();return N===null?s.memoizedState=e:ui(s,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],s=Uh().memoizedState;return[e,s]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,s){if(e&&e.defaultProps){s=A({},s),e=e.defaultProps;for(var a in e)s[a]===void 0&&(s[a]=e[a]);return s}return s}function Di(e,s,a,i){s=e.memoizedState,a=a(i,s),a=a==null?s:A({},s,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,s,a){e=e._reactInternals;var i=R(),o=yi(e),c=mh(i,o);c.payload=s,a!=null&&(c.callback=a),s=nh(e,c,o),s!==null&&(gi(s,e,o,i),oh(s,e,o))},enqueueReplaceState:function(e,s,a){e=e._reactInternals;var i=R(),o=yi(e),c=mh(i,o);c.tag=1,c.payload=s,a!=null&&(c.callback=a),s=nh(e,c,o),s!==null&&(gi(s,e,o,i),oh(s,e,o))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var a=R(),i=yi(e),o=mh(a,i);o.tag=2,s!=null&&(o.callback=s),s=nh(e,o,i),s!==null&&(gi(s,e,i,a),oh(s,e,i))}};function Fi(e,s,a,i,o,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,c,d):s.prototype&&s.prototype.isPureReactComponent?!Ie(a,i)||!Ie(o,c):!0}function Gi(e,s,a){var i=!1,o=Vf,c=s.contextType;return typeof c=="object"&&c!==null?c=eh(c):(o=Zf(s)?Xf:H.current,i=s.contextTypes,c=(i=i!=null)?Yf(e,o):Vf),s=new s(a,c),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Ei,e.stateNode=s,s._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=c),s}function Hi(e,s,a,i){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,i),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,i),s.state!==e&&Ei.enqueueReplaceState(s,s.state,null)}function Ii(e,s,a,i){var o=e.stateNode;o.props=a,o.state=e.memoizedState,o.refs={},kh(e);var c=s.contextType;typeof c=="object"&&c!==null?o.context=eh(c):(c=Zf(s)?Xf:H.current,o.context=Yf(e,c)),o.state=e.memoizedState,c=s.getDerivedStateFromProps,typeof c=="function"&&(Di(e,s,c,a),o.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(s=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),s!==o.state&&Ei.enqueueReplaceState(o,o.state,null),qh(e,a,o,i),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,s){try{var a="",i=s;do a+=Pa(i),i=i.return;while(i);var o=a}catch(c){o=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:s,stack:o,digest:null}}function Ki(e,s,a){return{value:e,source:null,stack:a??null,digest:s??null}}function Li(e,s){try{console.error(s.value)}catch(a){setTimeout(function(){throw a})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,s,a){a=mh(-1,a),a.tag=3,a.payload={element:null};var i=s.value;return a.callback=function(){Oi||(Oi=!0,Pi=i),Li(e,s)},a}function Qi(e,s,a){a=mh(-1,a),a.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var o=s.value;a.payload=function(){return i(o)},a.callback=function(){Li(e,s)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(a.callback=function(){Li(e,s),typeof i!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var d=s.stack;this.componentDidCatch(s.value,{componentStack:d!==null?d:""})}),a}function Si(e,s,a){var i=e.pingCache;if(i===null){i=e.pingCache=new Mi;var o=new Set;i.set(s,o)}else o=i.get(s),o===void 0&&(o=new Set,i.set(s,o));o.has(a)||(o.add(a),e=Ti.bind(null,e,s,a),s.then(e,e))}function Ui(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function Vi(e,s,a,i,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===s?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(s=mh(-1,1),s.tag=2,nh(a,s,1))),a.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,s,a,i){s.child=e===null?Vg(s,null,a,i):Ug(s,e.child,a,i)}function Yi(e,s,a,i,o){a=a.render;var c=s.ref;return ch(s,o),i=Nh(e,s,a,i,c,o),a=Sh(),e!==null&&!dh?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~o,Zi(e,s,o)):(I&&a&&vg(s),s.flags|=1,Xi(e,s,i,o),s.child)}function $i(e,s,a,i,o){if(e===null){var c=a.type;return typeof c=="function"&&!aj(c)&&c.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(s.tag=15,s.type=c,bj(e,s,c,i,o)):(e=Rg(a.type,null,i,s,s.mode,o),e.ref=s.ref,e.return=s,s.child=e)}if(c=e.child,!(e.lanes&o)){var d=c.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a(d,i)&&e.ref===s.ref)return Zi(e,s,o)}return s.flags|=1,e=Pg(c,i),e.ref=s.ref,e.return=s,s.child=e}function bj(e,s,a,i,o){if(e!==null){var c=e.memoizedProps;if(Ie(c,i)&&e.ref===s.ref)if(dh=!1,s.pendingProps=i=c,(e.lanes&o)!==0)e.flags&131072&&(dh=!0);else return s.lanes=e.lanes,Zi(e,s,o)}return cj(e,s,a,i,o)}function dj(e,s,a){var i=s.pendingProps,o=i.children,c=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=a;else{if(!(a&1073741824))return e=c!==null?c.baseLanes|a:a,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,G(ej,fj),fj|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=c!==null?c.baseLanes:a,G(ej,fj),fj|=i}else c!==null?(i=c.baseLanes|a,s.memoizedState=null):i=a,G(ej,fj),fj|=i;return Xi(e,s,o,a),s.child}function gj(e,s){var a=s.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(s.flags|=512,s.flags|=2097152)}function cj(e,s,a,i,o){var c=Zf(a)?Xf:H.current;return c=Yf(s,c),ch(s,o),a=Nh(e,s,a,i,c,o),i=Sh(),e!==null&&!dh?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~o,Zi(e,s,o)):(I&&i&&vg(s),s.flags|=1,Xi(e,s,a,o),s.child)}function hj(e,s,a,i,o){if(Zf(a)){var c=!0;cg(s)}else c=!1;if(ch(s,o),s.stateNode===null)ij(e,s),Gi(s,a,i),Ii(s,a,i,o),i=!0;else if(e===null){var d=s.stateNode,h=s.memoizedProps;d.props=h;var g=d.context,_=a.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(a)?Xf:H.current,_=Yf(s,_));var b=a.getDerivedStateFromProps,j=typeof b=="function"||typeof d.getSnapshotBeforeUpdate=="function";j||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==i||g!==_)&&Hi(s,d,i,_),jh=!1;var _e=s.memoizedState;d.state=_e,qh(s,i,d,o),g=s.memoizedState,h!==i||_e!==g||Wf.current||jh?(typeof b=="function"&&(Di(s,a,b,i),g=s.memoizedState),(h=jh||Fi(s,a,h,i,_e,g,_))?(j||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(s.flags|=4194308)):(typeof d.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=i,s.memoizedState=g),d.props=i,d.state=g,d.context=_,i=h):(typeof d.componentDidMount=="function"&&(s.flags|=4194308),i=!1)}else{d=s.stateNode,lh(e,s),h=s.memoizedProps,_=s.type===s.elementType?h:Ci(s.type,h),d.props=_,j=s.pendingProps,_e=d.context,g=a.contextType,typeof g=="object"&&g!==null?g=eh(g):(g=Zf(a)?Xf:H.current,g=Yf(s,g));var tt=a.getDerivedStateFromProps;(b=typeof tt=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==j||_e!==g)&&Hi(s,d,i,g),jh=!1,_e=s.memoizedState,d.state=_e,qh(s,i,d,o);var rt=s.memoizedState;h!==j||_e!==rt||Wf.current||jh?(typeof tt=="function"&&(Di(s,a,tt,i),rt=s.memoizedState),(_=jh||Fi(s,a,_,i,_e,rt,g)||!1)?(b||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(i,rt,g),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(i,rt,g)),typeof d.componentDidUpdate=="function"&&(s.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof d.componentDidUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(s.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(s.flags|=1024),s.memoizedProps=i,s.memoizedState=rt),d.props=i,d.state=rt,d.context=g,i=_):(typeof d.componentDidUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(s.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(s.flags|=1024),i=!1)}return jj(e,s,a,i,c,o)}function jj(e,s,a,i,o,c){gj(e,s);var d=(s.flags&128)!==0;if(!i&&!d)return o&&dg(s,a,!1),Zi(e,s,c);i=s.stateNode,Wi.current=s;var h=d&&typeof a.getDerivedStateFromError!="function"?null:i.render();return s.flags|=1,e!==null&&d?(s.child=Ug(s,e.child,null,c),s.child=Ug(s,null,h,c)):Xi(e,s,h,c),s.memoizedState=i.state,o&&dg(s,a,!0),s.child}function kj(e){var s=e.stateNode;s.pendingContext?ag(e,s.pendingContext,s.pendingContext!==s.context):s.context&&ag(e,s.context,!1),yh(e,s.containerInfo)}function lj(e,s,a,i,o){return Ig(),Jg(o),s.flags|=256,Xi(e,s,a,i),s.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,s,a){var i=s.pendingProps,o=L.current,c=!1,d=(s.flags&128)!==0,h;if((h=d)||(h=e!==null&&e.memoizedState===null?!1:(o&2)!==0),h?(c=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),G(L,o&1),e===null)return Eg(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(d=i.children,e=i.fallback,c?(i=s.mode,c=s.child,d={mode:"hidden",children:d},!(i&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=pj(d,i,0,null),e=Tg(e,i,a,null),c.return=s,e.return=s,c.sibling=e,s.child=c,s.child.memoizedState=nj(a),s.memoizedState=mj,e):qj(s,d));if(o=e.memoizedState,o!==null&&(h=o.dehydrated,h!==null))return rj(e,s,d,i,h,o,a);if(c){c=i.fallback,d=s.mode,o=e.child,h=o.sibling;var g={mode:"hidden",children:i.children};return!(d&1)&&s.child!==o?(i=s.child,i.childLanes=0,i.pendingProps=g,s.deletions=null):(i=Pg(o,g),i.subtreeFlags=o.subtreeFlags&14680064),h!==null?c=Pg(h,c):(c=Tg(c,d,a,null),c.flags|=2),c.return=s,i.return=s,i.sibling=c,s.child=i,i=c,c=s.child,d=e.child.memoizedState,d=d===null?nj(a):{baseLanes:d.baseLanes|a,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=e.childLanes&~a,s.memoizedState=mj,i}return c=e.child,e=c.sibling,i=Pg(c,{mode:"visible",children:i.children}),!(s.mode&1)&&(i.lanes=a),i.return=s,i.sibling=null,e!==null&&(a=s.deletions,a===null?(s.deletions=[e],s.flags|=16):a.push(e)),s.child=i,s.memoizedState=null,i}function qj(e,s){return s=pj({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function sj(e,s,a,i){return i!==null&&Jg(i),Ug(s,e.child,null,a),e=qj(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function rj(e,s,a,i,o,c,d){if(a)return s.flags&256?(s.flags&=-257,i=Ki(Error(p(422))),sj(e,s,d,i)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(c=i.fallback,o=s.mode,i=pj({mode:"visible",children:i.children},o,0,null),c=Tg(c,o,d,null),c.flags|=2,i.return=s,c.return=s,i.sibling=c,s.child=i,s.mode&1&&Ug(s,e.child,null,d),s.child.memoizedState=nj(d),s.memoizedState=mj,c);if(!(s.mode&1))return sj(e,s,d,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var h=i.dgst;return i=h,c=Error(p(419)),i=Ki(c,i,void 0),sj(e,s,d,i)}if(h=(d&e.childLanes)!==0,dh||h){if(i=Q,i!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(i.suspendedLanes|d)?0:o,o!==0&&o!==c.retryLane&&(c.retryLane=o,ih(e,o),gi(i,e,o,-1))}return tj(),i=Ki(Error(p(421))),sj(e,s,d,i)}return o.data==="$?"?(s.flags|=128,s.child=e.child,s=uj.bind(null,e),o._reactRetry=s,null):(e=c.treeContext,yg=Lf(o.nextSibling),xg=s,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=s),s=qj(s,i.children),s.flags|=4096,s)}function vj(e,s,a){e.lanes|=s;var i=e.alternate;i!==null&&(i.lanes|=s),bh(e.return,s,a)}function wj(e,s,a,i,o){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:i,tail:a,tailMode:o}:(c.isBackwards=s,c.rendering=null,c.renderingStartTime=0,c.last=i,c.tail=a,c.tailMode=o)}function xj(e,s,a){var i=s.pendingProps,o=i.revealOrder,c=i.tail;if(Xi(e,s,i.children,a),i=L.current,i&2)i=i&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,a,s);else if(e.tag===19)vj(e,a,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(G(L,i),!(s.mode&1))s.memoizedState=null;else switch(o){case"forwards":for(a=s.child,o=null;a!==null;)e=a.alternate,e!==null&&Ch(e)===null&&(o=a),a=a.sibling;a=o,a===null?(o=s.child,s.child=null):(o=a.sibling,a.sibling=null),wj(s,!1,o,a,c);break;case"backwards":for(a=null,o=s.child,s.child=null;o!==null;){if(e=o.alternate,e!==null&&Ch(e)===null){s.child=o;break}e=o.sibling,o.sibling=a,a=o,o=e}wj(s,!0,a,null,c);break;case"together":wj(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ij(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function Zi(e,s,a){if(e!==null&&(s.dependencies=e.dependencies),rh|=s.lanes,!(a&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(p(153));if(s.child!==null){for(e=s.child,a=Pg(e,e.pendingProps),s.child=a,a.return=s;e.sibling!==null;)e=e.sibling,a=a.sibling=Pg(e,e.pendingProps),a.return=s;a.sibling=null}return s.child}function yj(e,s,a){switch(s.tag){case 3:kj(s),Ig();break;case 5:Ah(s);break;case 1:Zf(s.type)&&cg(s);break;case 4:yh(s,s.stateNode.containerInfo);break;case 10:var i=s.type._context,o=s.memoizedProps.value;G(Wg,i._currentValue),i._currentValue=o;break;case 13:if(i=s.memoizedState,i!==null)return i.dehydrated!==null?(G(L,L.current&1),s.flags|=128,null):a&s.child.childLanes?oj(e,s,a):(G(L,L.current&1),e=Zi(e,s,a),e!==null?e.sibling:null);G(L,L.current&1);break;case 19:if(i=(a&s.childLanes)!==0,e.flags&128){if(i)return xj(e,s,a);s.flags|=128}if(o=s.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),G(L,L.current),i)break;return null;case 22:case 23:return s.lanes=0,dj(e,s,a)}return Zi(e,s,a)}var zj,Aj,Bj,Cj;zj=function(e,s){for(var a=s.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Aj=function(){};Bj=function(e,s,a,i){var o=e.memoizedProps;if(o!==i){e=s.stateNode,xh(uh.current);var c=null;switch(a){case"input":o=Ya(e,o),i=Ya(e,i),c=[];break;case"select":o=A({},o,{value:void 0}),i=A({},i,{value:void 0}),c=[];break;case"textarea":o=gb(e,o),i=gb(e,i),c=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Bf)}ub(a,i);var d;a=null;for(_ in o)if(!i.hasOwnProperty(_)&&o.hasOwnProperty(_)&&o[_]!=null)if(_==="style"){var h=o[_];for(d in h)h.hasOwnProperty(d)&&(a||(a={}),a[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in i){var g=i[_];if(h=o!=null?o[_]:void 0,i.hasOwnProperty(_)&&g!==h&&(g!=null||h!=null))if(_==="style")if(h){for(d in h)!h.hasOwnProperty(d)||g&&g.hasOwnProperty(d)||(a||(a={}),a[d]="");for(d in g)g.hasOwnProperty(d)&&h[d]!==g[d]&&(a||(a={}),a[d]=g[d])}else a||(c||(c=[]),c.push(_,a)),a=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,h=h?h.__html:void 0,g!=null&&h!==g&&(c=c||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(c=c||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&D("scroll",e),c||h===g||(c=[])):(c=c||[]).push(_,g))}a&&(c=c||[]).push("style",a);var _=c;(s.updateQueue=_)&&(s.flags|=4)}};Cj=function(e,s,a,i){a!==i&&(s.flags|=4)};function Dj(e,s){if(!I)switch(e.tailMode){case"hidden":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function S(e){var s=e.alternate!==null&&e.alternate.child===e.child,a=0,i=0;if(s)for(var o=e.child;o!==null;)a|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)a|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=a,s}function Ej(e,s,a){var i=s.pendingProps;switch(wg(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(s),null;case 1:return Zf(s.type)&&$f(),S(s),null;case 3:return i=s.stateNode,zh(),E(Wf),E(H),Eh(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Gg(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,s),S(s),null;case 5:Bh(s);var o=xh(wh.current);if(a=s.type,e!==null&&s.stateNode!=null)Bj(e,s,a,i,o),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!i){if(s.stateNode===null)throw Error(p(166));return S(s),null}if(e=xh(uh.current),Gg(s)){i=s.stateNode,a=s.type;var c=s.memoizedProps;switch(i[Of]=s,i[Pf]=c,e=(s.mode&1)!==0,a){case"dialog":D("cancel",i),D("close",i);break;case"iframe":case"object":case"embed":D("load",i);break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],i);break;case"source":D("error",i);break;case"img":case"image":case"link":D("error",i),D("load",i);break;case"details":D("toggle",i);break;case"input":Za(i,c),D("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!c.multiple},D("invalid",i);break;case"textarea":hb(i,c),D("invalid",i)}ub(a,c),o=null;for(var d in c)if(c.hasOwnProperty(d)){var h=c[d];d==="children"?typeof h=="string"?i.textContent!==h&&(c.suppressHydrationWarning!==!0&&Af(i.textContent,h,e),o=["children",h]):typeof h=="number"&&i.textContent!==""+h&&(c.suppressHydrationWarning!==!0&&Af(i.textContent,h,e),o=["children",""+h]):ea.hasOwnProperty(d)&&h!=null&&d==="onScroll"&&D("scroll",i)}switch(a){case"input":Va(i),db(i,c,!0);break;case"textarea":Va(i),jb(i);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(i.onclick=Bf)}i=o,s.updateQueue=i,i!==null&&(s.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=d.createElement(a,{is:i.is}):(e=d.createElement(a),a==="select"&&(d=e,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):e=d.createElementNS(e,a),e[Of]=s,e[Pf]=i,zj(e,s,!1,!1),s.stateNode=e;e:{switch(d=vb(a,i),a){case"dialog":D("cancel",e),D("close",e),o=i;break;case"iframe":case"object":case"embed":D("load",e),o=i;break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],e);o=i;break;case"source":D("error",e),o=i;break;case"img":case"image":case"link":D("error",e),D("load",e),o=i;break;case"details":D("toggle",e),o=i;break;case"input":Za(e,i),o=Ya(e,i),D("invalid",e);break;case"option":o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=A({},i,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,i),o=gb(e,i),D("invalid",e);break;default:o=i}ub(a,o),h=o;for(c in h)if(h.hasOwnProperty(c)){var g=h[c];c==="style"?sb(e,g):c==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&nb(e,g)):c==="children"?typeof g=="string"?(a!=="textarea"||g!=="")&&ob(e,g):typeof g=="number"&&ob(e,""+g):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?g!=null&&c==="onScroll"&&D("scroll",e):g!=null&&ta(e,c,g,d))}switch(a){case"input":Va(e),db(e,i,!1);break;case"textarea":Va(e),jb(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Sa(i.value));break;case"select":e.multiple=!!i.multiple,c=i.value,c!=null?fb(e,!!i.multiple,c,!1):i.defaultValue!=null&&fb(e,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Bf)}switch(a){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return S(s),null;case 6:if(e&&s.stateNode!=null)Cj(e,s,e.memoizedProps,i);else{if(typeof i!="string"&&s.stateNode===null)throw Error(p(166));if(a=xh(wh.current),xh(uh.current),Gg(s)){if(i=s.stateNode,a=s.memoizedProps,i[Of]=s,(c=i.nodeValue!==a)&&(e=xg,e!==null))switch(e.tag){case 3:Af(i.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(i.nodeValue,a,(e.mode&1)!==0)}c&&(s.flags|=4)}else i=(a.nodeType===9?a:a.ownerDocument).createTextNode(i),i[Of]=s,s.stateNode=i}return S(s),null;case 13:if(E(L),i=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&s.mode&1&&!(s.flags&128))Hg(),Ig(),s.flags|=98560,c=!1;else if(c=Gg(s),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(p(318));if(c=s.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p(317));c[Of]=s}else Ig(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;S(s),c=!1}else zg!==null&&(Fj(zg),zg=null),c=!0;if(!c)return s.flags&65536?s:null}return s.flags&128?(s.lanes=a,s):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(s.child.flags|=8192,s.mode&1&&(e===null||L.current&1?T===0&&(T=3):tj())),s.updateQueue!==null&&(s.flags|=4),S(s),null);case 4:return zh(),Aj(e,s),e===null&&sf(s.stateNode.containerInfo),S(s),null;case 10:return ah(s.type._context),S(s),null;case 17:return Zf(s.type)&&$f(),S(s),null;case 19:if(E(L),c=s.memoizedState,c===null)return S(s),null;if(i=(s.flags&128)!==0,d=c.rendering,d===null)if(i)Dj(c,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(d=Ch(e),d!==null){for(s.flags|=128,Dj(c,!1),i=d.updateQueue,i!==null&&(s.updateQueue=i,s.flags|=4),s.subtreeFlags=0,i=a,a=s.child;a!==null;)c=a,e=i,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,e=d.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return G(L,L.current&1|2),s.child}e=e.sibling}c.tail!==null&&B()>Gj&&(s.flags|=128,i=!0,Dj(c,!1),s.lanes=4194304)}else{if(!i)if(e=Ch(d),e!==null){if(s.flags|=128,i=!0,a=e.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),Dj(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!I)return S(s),null}else 2*B()-c.renderingStartTime>Gj&&a!==1073741824&&(s.flags|=128,i=!0,Dj(c,!1),s.lanes=4194304);c.isBackwards?(d.sibling=s.child,s.child=d):(a=c.last,a!==null?a.sibling=d:s.child=d,c.last=d)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=B(),s.sibling=null,a=L.current,G(L,i?a&1|2:a&1),s):(S(s),null);case 22:case 23:return Hj(),i=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(s.flags|=8192),i&&s.mode&1?fj&1073741824&&(S(s),s.subtreeFlags&6&&(s.flags|=8192)):S(s),null;case 24:return null;case 25:return null}throw Error(p(156,s.tag))}function Ij(e,s){switch(wg(s),s.tag){case 1:return Zf(s.type)&&$f(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return zh(),E(Wf),E(H),Eh(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return Bh(s),null;case 13:if(E(L),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(p(340));Ig()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(s.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,s){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(i){W(e,s,i)}else a.current=null}function Mj(e,s,a){try{a()}catch(i){W(e,s,i)}}var Nj=!1;function Oj(e,s){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var i=a.getSelection&&a.getSelection();if(i&&i.rangeCount!==0){a=i.anchorNode;var o=i.anchorOffset,c=i.focusNode;i=i.focusOffset;try{a.nodeType,c.nodeType}catch{a=null;break e}var d=0,h=-1,g=-1,_=0,b=0,j=e,_e=null;t:for(;;){for(var tt;j!==a||o!==0&&j.nodeType!==3||(h=d+o),j!==c||i!==0&&j.nodeType!==3||(g=d+i),j.nodeType===3&&(d+=j.nodeValue.length),(tt=j.firstChild)!==null;)_e=j,j=tt;for(;;){if(j===e)break t;if(_e===a&&++_===o&&(h=d),_e===c&&++b===i&&(g=d),(tt=j.nextSibling)!==null)break;j=_e,_e=j.parentNode}j=tt}a=h===-1||g===-1?null:{start:h,end:g}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df={focusedElem:e,selectionRange:a},dd=!1,V=s;V!==null;)if(s=V,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,V=e;else for(;V!==null;){s=V;try{var rt=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(rt!==null){var et=rt.memoizedProps,st=rt.memoizedState,at=s.stateNode,it=at.getSnapshotBeforeUpdate(s.elementType===s.type?et:Ci(s.type,et),st);at.__reactInternalSnapshotBeforeUpdate=it}break;case 3:var nt=s.stateNode.containerInfo;nt.nodeType===1?nt.textContent="":nt.nodeType===9&&nt.documentElement&&nt.removeChild(nt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(ot){W(s,s.return,ot)}if(e=s.sibling,e!==null){e.return=s.return,V=e;break}V=s.return}return rt=Nj,Nj=!1,rt}function Pj(e,s,a){var i=s.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var c=o.destroy;o.destroy=void 0,c!==void 0&&Mj(s,a,c)}o=o.next}while(o!==i)}}function Qj(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var i=a.create;a.destroy=i()}a=a.next}while(a!==s)}}function Rj(e){var s=e.ref;if(s!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof s=="function"?s(e):s.current=e}}function Sj(e){var s=e.alternate;s!==null&&(e.alternate=null,Sj(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[Of],delete s[Pf],delete s[of],delete s[Qf],delete s[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,s,a){var i=e.tag;if(i===5||i===6)e=e.stateNode,s?a.nodeType===8?a.parentNode.insertBefore(e,s):a.insertBefore(e,s):(a.nodeType===8?(s=a.parentNode,s.insertBefore(e,a)):(s=a,s.appendChild(e)),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Bf));else if(i!==4&&(e=e.child,e!==null))for(Vj(e,s,a),e=e.sibling;e!==null;)Vj(e,s,a),e=e.sibling}function Wj(e,s,a){var i=e.tag;if(i===5||i===6)e=e.stateNode,s?a.insertBefore(e,s):a.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(Wj(e,s,a),e=e.sibling;e!==null;)Wj(e,s,a),e=e.sibling}var X$1=null,Xj=!1;function Yj(e,s,a){for(a=a.child;a!==null;)Zj(e,s,a),a=a.sibling}function Zj(e,s,a){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,a)}catch{}switch(a.tag){case 5:U||Lj(a,s);case 6:var i=X$1,o=Xj;X$1=null,Yj(e,s,a),X$1=i,Xj=o,X$1!==null&&(Xj?(e=X$1,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):X$1.removeChild(a.stateNode));break;case 18:X$1!==null&&(Xj?(e=X$1,a=a.stateNode,e.nodeType===8?Kf(e.parentNode,a):e.nodeType===1&&Kf(e,a),bd(e)):Kf(X$1,a.stateNode));break;case 4:i=X$1,o=Xj,X$1=a.stateNode.containerInfo,Xj=!0,Yj(e,s,a),X$1=i,Xj=o;break;case 0:case 11:case 14:case 15:if(!U&&(i=a.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var c=o,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Mj(a,s,d),o=o.next}while(o!==i)}Yj(e,s,a);break;case 1:if(!U&&(Lj(a,s),i=a.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=a.memoizedProps,i.state=a.memoizedState,i.componentWillUnmount()}catch(h){W(a,s,h)}Yj(e,s,a);break;case 21:Yj(e,s,a);break;case 22:a.mode&1?(U=(i=U)||a.memoizedState!==null,Yj(e,s,a),U=i):Yj(e,s,a);break;default:Yj(e,s,a)}}function ak(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new Kj),s.forEach(function(i){var o=bk.bind(null,e,i);a.has(i)||(a.add(i),i.then(o,o))})}}function ck(e,s){var a=s.deletions;if(a!==null)for(var i=0;i<a.length;i++){var o=a[i];try{var c=e,d=s,h=d;e:for(;h!==null;){switch(h.tag){case 5:X$1=h.stateNode,Xj=!1;break e;case 3:X$1=h.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=h.stateNode.containerInfo,Xj=!0;break e}h=h.return}if(X$1===null)throw Error(p(160));Zj(c,d,o),X$1=null,Xj=!1;var g=o.alternate;g!==null&&(g.return=null),o.return=null}catch(_){W(o,s,_)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)dk(s,e),s=s.sibling}function dk(e,s){var a=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(s,e),ek(e),i&4){try{Pj(3,e,e.return),Qj(3,e)}catch(et){W(e,e.return,et)}try{Pj(5,e,e.return)}catch(et){W(e,e.return,et)}}break;case 1:ck(s,e),ek(e),i&512&&a!==null&&Lj(a,a.return);break;case 5:if(ck(s,e),ek(e),i&512&&a!==null&&Lj(a,a.return),e.flags&32){var o=e.stateNode;try{ob(o,"")}catch(et){W(e,e.return,et)}}if(i&4&&(o=e.stateNode,o!=null)){var c=e.memoizedProps,d=a!==null?a.memoizedProps:c,h=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{h==="input"&&c.type==="radio"&&c.name!=null&&ab(o,c),vb(h,d);var _=vb(h,c);for(d=0;d<g.length;d+=2){var b=g[d],j=g[d+1];b==="style"?sb(o,j):b==="dangerouslySetInnerHTML"?nb(o,j):b==="children"?ob(o,j):ta(o,b,j,_)}switch(h){case"input":bb(o,c);break;case"textarea":ib(o,c);break;case"select":var _e=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!c.multiple;var tt=c.value;tt!=null?fb(o,!!c.multiple,tt,!1):_e!==!!c.multiple&&(c.defaultValue!=null?fb(o,!!c.multiple,c.defaultValue,!0):fb(o,!!c.multiple,c.multiple?[]:"",!1))}o[Pf]=c}catch(et){W(e,e.return,et)}}break;case 6:if(ck(s,e),ek(e),i&4){if(e.stateNode===null)throw Error(p(162));o=e.stateNode,c=e.memoizedProps;try{o.nodeValue=c}catch(et){W(e,e.return,et)}}break;case 3:if(ck(s,e),ek(e),i&4&&a!==null&&a.memoizedState.isDehydrated)try{bd(s.containerInfo)}catch(et){W(e,e.return,et)}break;case 4:ck(s,e),ek(e);break;case 13:ck(s,e),ek(e),o=e.child,o.flags&8192&&(c=o.memoizedState!==null,o.stateNode.isHidden=c,!c||o.alternate!==null&&o.alternate.memoizedState!==null||(fk=B())),i&4&&ak(e);break;case 22:if(b=a!==null&&a.memoizedState!==null,e.mode&1?(U=(_=U)||b,ck(s,e),U=_):ck(s,e),ek(e),i&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!b&&e.mode&1)for(V=e,b=e.child;b!==null;){for(j=V=b;V!==null;){switch(_e=V,tt=_e.child,_e.tag){case 0:case 11:case 14:case 15:Pj(4,_e,_e.return);break;case 1:Lj(_e,_e.return);var rt=_e.stateNode;if(typeof rt.componentWillUnmount=="function"){i=_e,a=_e.return;try{s=i,rt.props=s.memoizedProps,rt.state=s.memoizedState,rt.componentWillUnmount()}catch(et){W(i,a,et)}}break;case 5:Lj(_e,_e.return);break;case 22:if(_e.memoizedState!==null){gk(j);continue}}tt!==null?(tt.return=_e,V=tt):gk(j)}b=b.sibling}e:for(b=null,j=e;;){if(j.tag===5){if(b===null){b=j;try{o=j.stateNode,_?(c=o.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(h=j.stateNode,g=j.memoizedProps.style,d=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=rb("display",d))}catch(et){W(e,e.return,et)}}}else if(j.tag===6){if(b===null)try{j.stateNode.nodeValue=_?"":j.memoizedProps}catch(et){W(e,e.return,et)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===e)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===e)break e;for(;j.sibling===null;){if(j.return===null||j.return===e)break e;b===j&&(b=null),j=j.return}b===j&&(b=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:ck(s,e),ek(e),i&4&&ak(e);break;case 21:break;default:ck(s,e),ek(e)}}function ek(e){var s=e.flags;if(s&2){try{e:{for(var a=e.return;a!==null;){if(Tj(a)){var i=a;break e}a=a.return}throw Error(p(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(ob(o,""),i.flags&=-33);var c=Uj(e);Wj(e,c,o);break;case 3:case 4:var d=i.stateNode.containerInfo,h=Uj(e);Vj(e,h,d);break;default:throw Error(p(161))}}catch(g){W(e,e.return,g)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function hk(e,s,a){V=e,ik(e)}function ik(e,s,a){for(var i=(e.mode&1)!==0;V!==null;){var o=V,c=o.child;if(o.tag===22&&i){var d=o.memoizedState!==null||Jj;if(!d){var h=o.alternate,g=h!==null&&h.memoizedState!==null||U;h=Jj;var _=U;if(Jj=d,(U=g)&&!_)for(V=o;V!==null;)d=V,g=d.child,d.tag===22&&d.memoizedState!==null?jk(o):g!==null?(g.return=d,V=g):jk(o);for(;c!==null;)V=c,ik(c),c=c.sibling;V=o,Jj=h,U=_}kk(e)}else o.subtreeFlags&8772&&c!==null?(c.return=o,V=c):kk(e)}}function kk(e){for(;V!==null;){var s=V;if(s.flags&8772){var a=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:U||Qj(5,s);break;case 1:var i=s.stateNode;if(s.flags&4&&!U)if(a===null)i.componentDidMount();else{var o=s.elementType===s.type?a.memoizedProps:Ci(s.type,a.memoizedProps);i.componentDidUpdate(o,a.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var c=s.updateQueue;c!==null&&sh(s,c,i);break;case 3:var d=s.updateQueue;if(d!==null){if(a=null,s.child!==null)switch(s.child.tag){case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}sh(s,d,a)}break;case 5:var h=s.stateNode;if(a===null&&s.flags&4){a=h;var g=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&a.focus();break;case"img":g.src&&(a.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var _=s.alternate;if(_!==null){var b=_.memoizedState;if(b!==null){var j=b.dehydrated;j!==null&&bd(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||s.flags&512&&Rj(s)}catch(_e){W(s,s.return,_e)}}if(s===e){V=null;break}if(a=s.sibling,a!==null){a.return=s.return,V=a;break}V=s.return}}function gk(e){for(;V!==null;){var s=V;if(s===e){V=null;break}var a=s.sibling;if(a!==null){a.return=s.return,V=a;break}V=s.return}}function jk(e){for(;V!==null;){var s=V;try{switch(s.tag){case 0:case 11:case 15:var a=s.return;try{Qj(4,s)}catch(g){W(s,a,g)}break;case 1:var i=s.stateNode;if(typeof i.componentDidMount=="function"){var o=s.return;try{i.componentDidMount()}catch(g){W(s,o,g)}}var c=s.return;try{Rj(s)}catch(g){W(s,c,g)}break;case 5:var d=s.return;try{Rj(s)}catch(g){W(s,d,g)}}}catch(g){W(s,s.return,g)}if(s===e){V=null;break}var h=s.sibling;if(h!==null){h.return=s.return,V=h;break}V=s.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,s,a,i){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,a,i),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=a),T===4&&Ck(e,Z)),Dk(e,i),a===1&&K===0&&!(s.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,s){var a=e.callbackNode;wc(e,s);var i=uc(e,e===Q?Z:0);if(i===0)a!==null&&bc(a),e.callbackNode=null,e.callbackPriority=0;else if(s=i&-i,e.callbackPriority!==s){if(a!=null&&bc(a),s===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),a=null;else{switch(Dc(i)){case 1:a=fc;break;case 4:a=gc;break;case 16:a=hc;break;case 536870912:a=jc;break;default:a=hc}a=Fk(a,Gk.bind(null,e))}e.callbackPriority=s,e.callbackNode=a}}function Gk(e,s){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var a=e.callbackNode;if(Hk()&&e.callbackNode!==a)return null;var i=uc(e,e===Q?Z:0);if(i===0)return null;if(i&30||i&e.expiredLanes||s)s=Ik(e,i);else{s=i;var o=K;K|=2;var c=Jk();(Q!==e||Z!==s)&&(uk=null,Gj=B()+500,Kk(e,s));do try{Lk();break}catch(h){Mk(e,h)}while(!0);$g(),mk.current=c,K=o,Y!==null?s=0:(Q=null,Z=0,s=T)}if(s!==0){if(s===2&&(o=xc(e),o!==0&&(i=o,s=Nk(e,o))),s===1)throw a=pk,Kk(e,0),Ck(e,i),Dk(e,B()),a;if(s===6)Ck(e,i);else{if(o=e.current.alternate,!(i&30)&&!Ok(o)&&(s=Ik(e,i),s===2&&(c=xc(e),c!==0&&(i=c,s=Nk(e,c))),s===1))throw a=pk,Kk(e,0),Ck(e,i),Dk(e,B()),a;switch(e.finishedWork=o,e.finishedLanes=i,s){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,i),(i&130023424)===i&&(s=fk+500-B(),10<s)){if(uc(e,0)!==0)break;if(o=e.suspendedLanes,(o&i)!==i){R(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),s);break}Pk(e,tk,uk);break;case 4:if(Ck(e,i),(i&4194240)===i)break;for(s=e.eventTimes,o=-1;0<i;){var d=31-oc(i);c=1<<d,d=s[d],d>o&&(o=d),i&=~c}if(i=o,i=B()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*lk(i/1960))-i,10<i){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===a?Gk.bind(null,e):null}function Nk(e,s){var a=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,s).flags|=256),e=Ik(e,s),e!==2&&(s=tk,tk=a,s!==null&&Fj(s)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var s=e;;){if(s.flags&16384){var a=s.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var i=0;i<a.length;i++){var o=a[i],c=o.getSnapshot;o=o.value;try{if(!He(c(),o))return!1}catch{return!1}}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ck(e,s){for(s&=~rk,s&=~qk,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var a=31-oc(s),i=1<<a;e[a]=-1,s&=~i}}function Ek(e){if(K&6)throw Error(p(327));Hk();var s=uc(e,0);if(!(s&1))return Dk(e,B()),null;var a=Ik(e,s);if(e.tag!==0&&a===2){var i=xc(e);i!==0&&(s=i,a=Nk(e,i))}if(a===1)throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;if(a===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,s){var a=K;K|=1;try{return e(s)}finally{K=a,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var s=K;K|=1;var a=ok.transition,i=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=i,ok.transition=a,K=s,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,s){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Gf(a)),Y!==null)for(a=Y.return;a!==null;){var i=a;switch(wg(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(i);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(i.type._context);break;case 22:case 23:Hj()}a=a.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=s,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(s=0;s<fh.length;s++)if(a=fh[s],i=a.interleaved,i!==null){a.interleaved=null;var o=i.next,c=a.pending;if(c!==null){var d=c.next;c.next=o,i.next=d}a.pending=i}fh=null}return e}function Mk(e,s){do{var a=Y;try{if($g(),Fh.current=Rh,Ih){for(var i=M.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,a===null||a.return===null){T=1,pk=s,Y=null;break}e:{var c=e,d=a.return,h=a,g=s;if(s=Z,h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,b=h,j=b.tag;if(!(b.mode&1)&&(j===0||j===11||j===15)){var _e=b.alternate;_e?(b.updateQueue=_e.updateQueue,b.memoizedState=_e.memoizedState,b.lanes=_e.lanes):(b.updateQueue=null,b.memoizedState=null)}var tt=Ui(d);if(tt!==null){tt.flags&=-257,Vi(tt,d,h,c,s),tt.mode&1&&Si(c,_,s),s=tt,g=_;var rt=s.updateQueue;if(rt===null){var et=new Set;et.add(g),s.updateQueue=et}else rt.add(g);break e}else{if(!(s&1)){Si(c,_,s),tj();break e}g=Error(p(426))}}else if(I&&h.mode&1){var st=Ui(d);if(st!==null){!(st.flags&65536)&&(st.flags|=256),Vi(st,d,h,c,s),Jg(Ji(g,h));break e}}c=g=Ji(g,h),T!==4&&(T=2),sk===null?sk=[c]:sk.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,s&=-s,c.lanes|=s;var at=Ni(c,g,s);ph(c,at);break e;case 1:h=g;var it=c.type,nt=c.stateNode;if(!(c.flags&128)&&(typeof it.getDerivedStateFromError=="function"||nt!==null&&typeof nt.componentDidCatch=="function"&&(Ri===null||!Ri.has(nt)))){c.flags|=65536,s&=-s,c.lanes|=s;var ot=Qi(c,h,s);ph(c,ot);break e}}c=c.return}while(c!==null)}Sk(a)}catch(dt){s=dt,Y===a&&a!==null&&(Y=a=a.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,s){var a=K;K|=2;var i=Jk();(Q!==e||Z!==s)&&(uk=null,Kk(e,s));do try{Tk();break}catch(o){Mk(e,o)}while(!0);if($g(),K=a,mk.current=i,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(e){var s=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,s===null?Sk(e):Y=s,nk.current=null}function Sk(e){var s=e;do{var a=s.alternate;if(e=s.return,s.flags&32768){if(a=Ij(a,s),a!==null){a.flags&=32767,Y=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(a=Ej(a,s,fj),a!==null){Y=a;return}if(s=s.sibling,s!==null){Y=s;return}Y=s=e}while(s!==null);T===0&&(T=5)}function Pk(e,s,a){var i=C,o=ok.transition;try{ok.transition=null,C=1,Wk(e,s,a,i)}finally{ok.transition=o,C=i}return null}function Wk(e,s,a,i){do Hk();while(wk!==null);if(K&6)throw Error(p(327));a=e.finishedWork;var o=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var c=a.lanes|a.childLanes;if(Bc(e,c),e===Q&&(Y=Q=null,Z=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),c=(a.flags&15990)!==0,a.subtreeFlags&15990||c){c=ok.transition,ok.transition=null;var d=C;C=1;var h=K;K|=4,nk.current=null,Oj(e,a),dk(a,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=a,hk(a),dc(),K=h,C=d,ok.transition=c}else e.current=a;if(vk&&(vk=!1,wk=e,xk=o),c=e.pendingLanes,c===0&&(Ri=null),mc(a.stateNode),Dk(e,B()),s!==null)for(i=e.onRecoverableError,a=0;a<s.length;a++)o=s[a],i(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),c=e.pendingLanes,c&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),s=ok.transition,a=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var i=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var o=K;for(K|=4,V=e.current;V!==null;){var c=V,d=c.child;if(V.flags&16){var h=c.deletions;if(h!==null){for(var g=0;g<h.length;g++){var _=h[g];for(V=_;V!==null;){var b=V;switch(b.tag){case 0:case 11:case 15:Pj(8,b,c)}var j=b.child;if(j!==null)j.return=b,V=j;else for(;V!==null;){b=V;var _e=b.sibling,tt=b.return;if(Sj(b),b===_){V=null;break}if(_e!==null){_e.return=tt,V=_e;break}V=tt}}}var rt=c.alternate;if(rt!==null){var et=rt.child;if(et!==null){rt.child=null;do{var st=et.sibling;et.sibling=null,et=st}while(et!==null)}}V=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,V=d;else e:for(;V!==null;){if(c=V,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Pj(9,c,c.return)}var at=c.sibling;if(at!==null){at.return=c.return,V=at;break e}V=c.return}}var it=e.current;for(V=it;V!==null;){d=V;var nt=d.child;if(d.subtreeFlags&2064&&nt!==null)nt.return=d,V=nt;else e:for(d=it;V!==null;){if(h=V,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(dt){W(h,h.return,dt)}if(h===d){V=null;break e}var ot=h.sibling;if(ot!==null){ot.return=h.return,V=ot;break e}V=h.return}}if(K=o,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}i=!0}return i}finally{C=a,ok.transition=s}}return!1}function Xk(e,s,a){s=Ji(a,s),s=Ni(e,s,1),e=nh(e,s,1),s=R(),e!==null&&(Ac(e,1,s),Dk(e,s))}function W(e,s,a){if(e.tag===3)Xk(e,e,a);else for(;s!==null;){if(s.tag===3){Xk(s,e,a);break}else if(s.tag===1){var i=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ri===null||!Ri.has(i))){e=Ji(a,e),e=Qi(s,e,1),s=nh(s,e,1),e=R(),s!==null&&(Ac(s,1,e),Dk(s,e));break}}s=s.return}}function Ti(e,s,a){var i=e.pingCache;i!==null&&i.delete(s),s=R(),e.pingedLanes|=e.suspendedLanes&a,Q===e&&(Z&a)===a&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=a),Dk(e,s)}function Yk(e,s){s===0&&(e.mode&1?(s=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):s=1);var a=R();e=ih(e,s),e!==null&&(Ac(e,s,a),Dk(e,a))}function uj(e){var s=e.memoizedState,a=0;s!==null&&(a=s.retryLane),Yk(e,a)}function bk(e,s){var a=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(a=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(p(314))}i!==null&&i.delete(s),Yk(e,a)}var Vk;Vk=function(e,s,a){if(e!==null)if(e.memoizedProps!==s.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&a)&&!(s.flags&128))return dh=!1,yj(e,s,a);dh=!!(e.flags&131072)}else dh=!1,I&&s.flags&1048576&&ug(s,ng,s.index);switch(s.lanes=0,s.tag){case 2:var i=s.type;ij(e,s),e=s.pendingProps;var o=Yf(s,H.current);ch(s,a),o=Nh(null,s,i,e,o,a);var c=Sh();return s.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Zf(i)?(c=!0,cg(s)):c=!1,s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,kh(s),o.updater=Ei,s.stateNode=o,o._reactInternals=s,Ii(s,i,e,a),s=jj(null,s,i,!0,c,a)):(s.tag=0,I&&c&&vg(s),Xi(null,s,o,a),s=s.child),s;case 16:i=s.elementType;e:{switch(ij(e,s),e=s.pendingProps,o=i._init,i=o(i._payload),s.type=i,o=s.tag=Zk(i),e=Ci(i,e),o){case 0:s=cj(null,s,i,e,a);break e;case 1:s=hj(null,s,i,e,a);break e;case 11:s=Yi(null,s,i,e,a);break e;case 14:s=$i(null,s,i,Ci(i.type,e),a);break e}throw Error(p(306,i,""))}return s;case 0:return i=s.type,o=s.pendingProps,o=s.elementType===i?o:Ci(i,o),cj(e,s,i,o,a);case 1:return i=s.type,o=s.pendingProps,o=s.elementType===i?o:Ci(i,o),hj(e,s,i,o,a);case 3:e:{if(kj(s),e===null)throw Error(p(387));i=s.pendingProps,c=s.memoizedState,o=c.element,lh(e,s),qh(s,i,null,a);var d=s.memoizedState;if(i=d.element,c.isDehydrated)if(c={element:i,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},s.updateQueue.baseState=c,s.memoizedState=c,s.flags&256){o=Ji(Error(p(423)),s),s=lj(e,s,i,a,o);break e}else if(i!==o){o=Ji(Error(p(424)),s),s=lj(e,s,i,a,o);break e}else for(yg=Lf(s.stateNode.containerInfo.firstChild),xg=s,I=!0,zg=null,a=Vg(s,null,i,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),i===o){s=Zi(e,s,a);break e}Xi(e,s,i,a)}s=s.child}return s;case 5:return Ah(s),e===null&&Eg(s),i=s.type,o=s.pendingProps,c=e!==null?e.memoizedProps:null,d=o.children,Ef(i,o)?d=null:c!==null&&Ef(i,c)&&(s.flags|=32),gj(e,s),Xi(e,s,d,a),s.child;case 6:return e===null&&Eg(s),null;case 13:return oj(e,s,a);case 4:return yh(s,s.stateNode.containerInfo),i=s.pendingProps,e===null?s.child=Ug(s,null,i,a):Xi(e,s,i,a),s.child;case 11:return i=s.type,o=s.pendingProps,o=s.elementType===i?o:Ci(i,o),Yi(e,s,i,o,a);case 7:return Xi(e,s,s.pendingProps,a),s.child;case 8:return Xi(e,s,s.pendingProps.children,a),s.child;case 12:return Xi(e,s,s.pendingProps.children,a),s.child;case 10:e:{if(i=s.type._context,o=s.pendingProps,c=s.memoizedProps,d=o.value,G(Wg,i._currentValue),i._currentValue=d,c!==null)if(He(c.value,d)){if(c.children===o.children&&!Wf.current){s=Zi(e,s,a);break e}}else for(c=s.child,c!==null&&(c.return=s);c!==null;){var h=c.dependencies;if(h!==null){d=c.child;for(var g=h.firstContext;g!==null;){if(g.context===i){if(c.tag===1){g=mh(-1,a&-a),g.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var b=_.pending;b===null?g.next=g:(g.next=b.next,b.next=g),_.pending=g}}c.lanes|=a,g=c.alternate,g!==null&&(g.lanes|=a),bh(c.return,a,s),h.lanes|=a;break}g=g.next}}else if(c.tag===10)d=c.type===s.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(p(341));d.lanes|=a,h=d.alternate,h!==null&&(h.lanes|=a),bh(d,a,s),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===s){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Xi(e,s,o.children,a),s=s.child}return s;case 9:return o=s.type,i=s.pendingProps.children,ch(s,a),o=eh(o),i=i(o),s.flags|=1,Xi(e,s,i,a),s.child;case 14:return i=s.type,o=Ci(i,s.pendingProps),o=Ci(i.type,o),$i(e,s,i,o,a);case 15:return bj(e,s,s.type,s.pendingProps,a);case 17:return i=s.type,o=s.pendingProps,o=s.elementType===i?o:Ci(i,o),ij(e,s),s.tag=1,Zf(i)?(e=!0,cg(s)):e=!1,ch(s,a),Gi(s,i,o),Ii(s,i,o,a),jj(null,s,i,!0,e,a);case 19:return xj(e,s,a);case 22:return dj(e,s,a)}throw Error(p(156,s.tag))};function Fk(e,s){return ac(e,s)}function $k(e,s,a,i){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,s,a,i){return new $k(e,s,a,i)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,s){var a=e.alternate;return a===null?(a=Bg(e.tag,s,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=s,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,s=e.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Rg(e,s,a,i,o,c){var d=2;if(i=e,typeof e=="function")aj(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case ya:return Tg(a.children,o,c,s);case za:d=8,o|=8;break;case Aa:return e=Bg(12,a,s,o|2),e.elementType=Aa,e.lanes=c,e;case Ea:return e=Bg(13,a,s,o),e.elementType=Ea,e.lanes=c,e;case Fa:return e=Bg(19,a,s,o),e.elementType=Fa,e.lanes=c,e;case Ia:return pj(a,o,c,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:d=10;break e;case Ca:d=9;break e;case Da:d=11;break e;case Ga:d=14;break e;case Ha:d=16,i=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return s=Bg(d,a,s,o),s.elementType=e,s.type=i,s.lanes=c,s}function Tg(e,s,a,i){return e=Bg(7,e,i,s),e.lanes=a,e}function pj(e,s,a,i){return e=Bg(22,e,i,s),e.elementType=Ia,e.lanes=a,e.stateNode={isHidden:!1},e}function Qg(e,s,a){return e=Bg(6,e,null,s),e.lanes=a,e}function Sg(e,s,a){return s=Bg(4,e.children!==null?e.children:[],e.key,s),s.lanes=a,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function al(e,s,a,i,o){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function bl(e,s,a,i,o,c,d,h,g){return e=new al(e,s,a,h,g),s===1?(s=1,c===!0&&(s|=8)):s=0,c=Bg(3,null,null,s),e.current=c,c.stateNode=e,c.memoizedState={element:i,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(c),e}function cl(e,s,a){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:i==null?null:""+i,children:e,containerInfo:s,implementation:a}}function dl(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Zf(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(p(171))}if(e.tag===1){var a=e.type;if(Zf(a))return bg(e,a,s)}return s}function el(e,s,a,i,o,c,d,h,g){return e=bl(a,i,!0,e,o,c,d,h,g),e.context=dl(null),a=e.current,i=R(),o=yi(a),c=mh(i,o),c.callback=s??null,nh(a,c,o),e.current.lanes=o,Ac(e,o,i),Dk(e,i),e}function fl(e,s,a,i){var o=s.current,c=R(),d=yi(o);return a=dl(a),s.context===null?s.context=a:s.pendingContext=a,s=mh(c,d),s.payload={element:e},i=i===void 0?null:i,i!==null&&(s.callback=i),e=nh(o,s,d),e!==null&&(gi(e,o,d,c),oh(e,o,d)),d}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<s?a:s}}function il(e,s){hl(e,s),(e=e.alternate)&&hl(e,s)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(p(409));fl(e,s,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;Rk(function(){fl(null,e,null,null)}),s[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var s=Hc();e={blockedOn:null,target:e,priority:s};for(var a=0;a<Qc.length&&s!==0&&s<Qc[a].priority;a++);Qc.splice(a,0,e),a===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,s,a,i,o){if(o){if(typeof i=="function"){var c=i;i=function(){var _=gl(d);c.call(_)}}var d=el(s,i,e,0,null,!1,!1,"",pl);return e._reactRootContainer=d,e[uf]=d.current,sf(e.nodeType===8?e.parentNode:e),Rk(),d}for(;o=e.lastChild;)e.removeChild(o);if(typeof i=="function"){var h=i;i=function(){var _=gl(g);h.call(_)}}var g=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=g,e[uf]=g.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(s,g,a,i)}),g}function rl(e,s,a,i,o){var c=a._reactRootContainer;if(c){var d=c;if(typeof o=="function"){var h=o;o=function(){var g=gl(d);h.call(g)}}fl(s,d,e,o)}else d=ql(a,s,e,o,i);return gl(d)}Ec=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var a=tc(s.pendingLanes);a!==0&&(Cc(s,a|1),Dk(s,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var i=ih(e,1);if(i!==null){var o=R();gi(i,e,1,o)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var s=ih(e,134217728);if(s!==null){var a=R();gi(s,e,134217728,a)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var s=yi(e),a=ih(e,s);if(a!==null){var i=R();gi(a,e,s,i)}il(e,s)}};Hc=function(){return C};Ic=function(e,s){var a=C;try{return C=e,s()}finally{C=a}};yb=function(e,s,a){switch(s){case"input":if(bb(e,a),s=a.name,a.type==="radio"&&s!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<a.length;s++){var i=a[s];if(i!==e&&i.form===e.form){var o=Db(i);if(!o)throw Error(p(90));Wa(i),bb(i,o)}}}break;case"textarea":ib(e,a);break;case"select":s=a.value,s!=null&&fb(e,!!a.multiple,s,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,s){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(s))throw Error(p(200));return cl(e,s,null,a)};reactDom_production_min.createRoot=function(e,s){if(!nl(e))throw Error(p(299));var a=!1,i="",o=kl;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(i=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),s=bl(e,1,!1,null,null,a,!1,i,o),e[uf]=s.current,sf(e.nodeType===8?e.parentNode:e),new ll(s)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(s),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,s,a){if(!ol(s))throw Error(p(200));return rl(null,e,s,!0,a)};reactDom_production_min.hydrateRoot=function(e,s,a){if(!nl(e))throw Error(p(405));var i=a!=null&&a.hydratedSources||null,o=!1,c="",d=kl;if(a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onRecoverableError!==void 0&&(d=a.onRecoverableError)),s=el(s,null,e,1,a??null,o,!1,c,d),e[uf]=s.current,sf(e),i)for(e=0;e<i.length;e++)a=i[e],o=a._getVersion,o=o(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,o]:s.mutableSourceEagerHydrationData.push(a,o);return new ml(s)};reactDom_production_min.render=function(e,s,a){if(!ol(s))throw Error(p(200));return rl(null,e,s,!1,a)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,s,a,i){if(!ol(a))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl(e,s,a,!1,i)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},_extends$2.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function s(i,o){let{pathname:c,search:d,hash:h}=i.location;return createLocation("",{pathname:c,search:d,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(i,o){return typeof o=="string"?o:createPath(o)}return getUrlBasedHistory(s,a,null,e)}function invariant(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function warning(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,s){return{usr:e.state,key:e.key,idx:s}}function createLocation(e,s,a,i){return a===void 0&&(a=null),_extends$2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof s=="string"?parsePath(s):s,{state:a,key:s&&s.key||i||createKey()})}function createPath(e){let{pathname:s="/",search:a="",hash:i=""}=e;return a&&a!=="?"&&(s+=a.charAt(0)==="?"?a:"?"+a),i&&i!=="#"&&(s+=i.charAt(0)==="#"?i:"#"+i),s}function parsePath(e){let s={};if(e){let a=e.indexOf("#");a>=0&&(s.hash=e.substr(a),e=e.substr(0,a));let i=e.indexOf("?");i>=0&&(s.search=e.substr(i),e=e.substr(0,i)),e&&(s.pathname=e)}return s}function getUrlBasedHistory(e,s,a,i){i===void 0&&(i={});let{window:o=document.defaultView,v5Compat:c=!1}=i,d=o.history,h=Action.Pop,g=null,_=b();_==null&&(_=0,d.replaceState(_extends$2({},d.state,{idx:_}),""));function b(){return(d.state||{idx:null}).idx}function j(){h=Action.Pop;let st=b(),at=st==null?null:st-_;_=st,g&&g({action:h,location:et.location,delta:at})}function _e(st,at){h=Action.Push;let it=createLocation(et.location,st,at);_=b()+1;let nt=getHistoryState(it,_),ot=et.createHref(it);try{d.pushState(nt,"",ot)}catch(dt){if(dt instanceof DOMException&&dt.name==="DataCloneError")throw dt;o.location.assign(ot)}c&&g&&g({action:h,location:et.location,delta:1})}function tt(st,at){h=Action.Replace;let it=createLocation(et.location,st,at);_=b();let nt=getHistoryState(it,_),ot=et.createHref(it);d.replaceState(nt,"",ot),c&&g&&g({action:h,location:et.location,delta:0})}function rt(st){let at=o.location.origin!=="null"?o.location.origin:o.location.href,it=typeof st=="string"?st:createPath(st);return it=it.replace(/ $/,"%20"),invariant(at,"No window.location.(origin|href) available to create URL for href: "+it),new URL(it,at)}let et={get action(){return h},get location(){return e(o,d)},listen(st){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(PopStateEventType,j),g=st,()=>{o.removeEventListener(PopStateEventType,j),g=null}},createHref(st){return s(o,st)},createURL:rt,encodeLocation(st){let at=rt(st);return{pathname:at.pathname,search:at.search,hash:at.hash}},push:_e,replace:tt,go(st){return d.go(st)}};return et}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function matchRoutes(e,s,a){return a===void 0&&(a="/"),matchRoutesImpl(e,s,a,!1)}function matchRoutesImpl(e,s,a,i){let o=typeof s=="string"?parsePath(s):s,c=stripBasename(o.pathname||"/",a);if(c==null)return null;let d=flattenRoutes(e);rankRouteBranches(d);let h=null;for(let g=0;h==null&&g<d.length;++g){let _=decodePath(c);h=matchRouteBranch(d[g],_,i)}return h}function flattenRoutes(e,s,a,i){s===void 0&&(s=[]),a===void 0&&(a=[]),i===void 0&&(i="");let o=(c,d,h)=>{let g={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};g.relativePath.startsWith("/")&&(invariant(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let _=joinPaths([i,g.relativePath]),b=a.concat(g);c.children&&c.children.length>0&&(invariant(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),flattenRoutes(c.children,s,b,_)),!(c.path==null&&!c.index)&&s.push({path:_,score:computeScore(_,c.index),routesMeta:b})};return e.forEach((c,d)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))o(c,d);else for(let g of explodeOptionalSegments(c.path))o(c,d,g)}),s}function explodeOptionalSegments(e){let s=e.split("/");if(s.length===0)return[];let[a,...i]=s,o=a.endsWith("?"),c=a.replace(/\?$/,"");if(i.length===0)return o?[c,""]:[c];let d=explodeOptionalSegments(i.join("/")),h=[];return h.push(...d.map(g=>g===""?c:[c,g].join("/"))),o&&h.push(...d),h.map(g=>e.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(e){e.sort((s,a)=>s.score!==a.score?a.score-s.score:compareIndexes(s.routesMeta.map(i=>i.childrenIndex),a.routesMeta.map(i=>i.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,s){let a=e.split("/"),i=a.length;return a.some(isSplat)&&(i+=splatPenalty),s&&(i+=indexRouteValue),a.filter(o=>!isSplat(o)).reduce((o,c)=>o+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),i)}function compareIndexes(e,s){return e.length===s.length&&e.slice(0,-1).every((i,o)=>i===s[o])?e[e.length-1]-s[s.length-1]:0}function matchRouteBranch(e,s,a){let{routesMeta:i}=e,o={},c="/",d=[];for(let h=0;h<i.length;++h){let g=i[h],_=h===i.length-1,b=c==="/"?s:s.slice(c.length)||"/",j=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:_},b),_e=g.route;if(!j&&_&&a&&!i[i.length-1].route.index&&(j=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!j)return null;Object.assign(o,j.params),d.push({params:o,pathname:joinPaths([c,j.pathname]),pathnameBase:normalizePathname(joinPaths([c,j.pathnameBase])),route:_e}),j.pathnameBase!=="/"&&(c=joinPaths([c,j.pathnameBase]))}return d}function matchPath(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,i]=compilePath(e.path,e.caseSensitive,e.end),o=s.match(a);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:i.reduce((_,b,j)=>{let{paramName:_e,isOptional:tt}=b;if(_e==="*"){let et=h[j]||"";d=c.slice(0,c.length-et.length).replace(/(.)\/+$/,"$1")}const rt=h[j];return tt&&!rt?_[_e]=void 0:_[_e]=(rt||"").replace(/%2F/g,"/"),_},{}),pathname:c,pathnameBase:d,pattern:e}}function compilePath(e,s,a){s===void 0&&(s=!1),a===void 0&&(a=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,h,g)=>(i.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,s?void 0:"i"),i]}function decodePath(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),e}}function stripBasename(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,i=e.charAt(a);return i&&i!=="/"?null:e.slice(a)||"/"}function resolvePath(e,s){s===void 0&&(s="/");let{pathname:a,search:i="",hash:o=""}=typeof e=="string"?parsePath(e):e;return{pathname:a?a.startsWith("/")?a:resolvePathname(a,s):s,search:normalizeSearch(i),hash:normalizeHash(o)}}function resolvePathname(e,s){let a=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function getInvalidPathError(e,s,a,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function getResolveToMatches(e,s){let a=getPathContributingMatches(e);return s?a.map((i,o)=>o===a.length-1?i.pathname:i.pathnameBase):a.map(i=>i.pathnameBase)}function resolveTo(e,s,a,i){i===void 0&&(i=!1);let o;typeof e=="string"?o=parsePath(e):(o=_extends$2({},e),invariant(!o.pathname||!o.pathname.includes("?"),getInvalidPathError("?","pathname","search",o)),invariant(!o.pathname||!o.pathname.includes("#"),getInvalidPathError("#","pathname","hash",o)),invariant(!o.search||!o.search.includes("#"),getInvalidPathError("#","search","hash",o)));let c=e===""||o.pathname==="",d=c?"/":o.pathname,h;if(d==null)h=a;else{let j=s.length-1;if(!i&&d.startsWith("..")){let _e=d.split("/");for(;_e[0]==="..";)_e.shift(),j-=1;o.pathname=_e.join("/")}h=j>=0?s[j]:"/"}let g=resolvePath(o,h),_=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&a.endsWith("/");return!g.pathname.endsWith("/")&&(_||b)&&(g.pathname+="/"),g}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(e,s){let{relative:a}=s===void 0?{}:s;useInRouterContext()||invariant(!1);let{basename:i,navigator:o}=reactExports.useContext(NavigationContext),{hash:c,pathname:d,search:h}=useResolvedPath(e,{relative:a}),g=d;return i!=="/"&&(g=d==="/"?i:joinPaths([i,d])),o.createHref({pathname:g,search:h,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let e=reactExports.useContext(DataRouterContext),{basename:s,future:a,navigator:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(o,a.v7_relativeSplatPath)),h=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{h.current=!0}),reactExports.useCallback(function(_,b){if(b===void 0&&(b={}),!h.current)return;if(typeof _=="number"){i.go(_);return}let j=resolveTo(_,JSON.parse(d),c,b.relative==="path");e==null&&s!=="/"&&(j.pathname=j.pathname==="/"?s:joinPaths([s,j.pathname])),(b.replace?i.replace:i.push)(j,b.state,b)},[s,i,d,c,e])}function useResolvedPath(e,s){let{relative:a}=s===void 0?{}:s,{future:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(o,i.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(d),c,a==="path"),[e,d,c,a])}function useRoutes(e,s){return useRoutesImpl(e,s)}function useRoutesImpl(e,s,a,i){useInRouterContext()||invariant(!1);let{navigator:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),d=c[c.length-1],h=d?d.params:{};d&&d.pathname;let g=d?d.pathnameBase:"/";d&&d.route;let _=useLocation(),b;if(s){var j;let st=typeof s=="string"?parsePath(s):s;g==="/"||(j=st.pathname)!=null&&j.startsWith(g)||invariant(!1),b=st}else b=_;let _e=b.pathname||"/",tt=_e;if(g!=="/"){let st=g.replace(/^\//,"").split("/");tt="/"+_e.replace(/^\//,"").split("/").slice(st.length).join("/")}let rt=matchRoutes(e,{pathname:tt}),et=_renderMatches(rt&&rt.map(st=>Object.assign({},st,{params:Object.assign({},h,st.params),pathname:joinPaths([g,o.encodeLocation?o.encodeLocation(st.pathname).pathname:st.pathname]),pathnameBase:st.pathnameBase==="/"?g:joinPaths([g,o.encodeLocation?o.encodeLocation(st.pathnameBase).pathname:st.pathnameBase])})),c,a,i);return s&&et?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Action.Pop}},et):et}function DefaultErrorComponent(){let e=useRouteError(),s=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},s),a?reactExports.createElement("pre",{style:o},a):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,a){return a.location!==s.location||a.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:a.error,location:a.location,revalidation:s.revalidation||a.revalidation}}componentDidCatch(s,a){console.error("React Router caught the following error during render",s,a)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:s,match:a,children:i}=e,o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=a.route.id),reactExports.createElement(RouteContext.Provider,{value:s},i)}function _renderMatches(e,s,a,i){var o;if(s===void 0&&(s=[]),a===void 0&&(a=null),i===void 0&&(i=null),e==null){var c;if(!a)return null;if(a.errors)e=a.matches;else if((c=i)!=null&&c.v7_partialHydration&&s.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let d=e,h=(o=a)==null?void 0:o.errors;if(h!=null){let b=d.findIndex(j=>j.route.id&&(h==null?void 0:h[j.route.id])!==void 0);b>=0||invariant(!1),d=d.slice(0,Math.min(d.length,b+1))}let g=!1,_=-1;if(a&&i&&i.v7_partialHydration)for(let b=0;b<d.length;b++){let j=d[b];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(_=b),j.route.id){let{loaderData:_e,errors:tt}=a,rt=j.route.loader&&_e[j.route.id]===void 0&&(!tt||tt[j.route.id]===void 0);if(j.route.lazy||rt){g=!0,_>=0?d=d.slice(0,_+1):d=[d[0]];break}}}return d.reduceRight((b,j,_e)=>{let tt,rt=!1,et=null,st=null;a&&(tt=h&&j.route.id?h[j.route.id]:void 0,et=j.route.errorElement||defaultErrorElement,g&&(_<0&&_e===0?(rt=!0,st=null):_===_e&&(rt=!0,st=j.route.hydrateFallbackElement||null)));let at=s.concat(d.slice(0,_e+1)),it=()=>{let nt;return tt?nt=et:rt?nt=st:j.route.Component?nt=reactExports.createElement(j.route.Component,null):j.route.element?nt=j.route.element:nt=b,reactExports.createElement(RenderedRoute,{match:j,routeContext:{outlet:b,matches:at,isDataRoute:a!=null},children:nt})};return a&&(j.route.ErrorBoundary||j.route.errorElement||_e===0)?reactExports.createElement(RenderErrorBoundary,{location:a.location,revalidation:a.revalidation,component:et,error:tt,children:it(),routeContext:{outlet:null,matches:at,isDataRoute:!0}}):it()},null)}var DataRouterHook$1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DataRouterHook$1||{}),DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterContext$1(e){let s=reactExports.useContext(DataRouterContext);return s||invariant(!1),s}function useDataRouterState(e){let s=reactExports.useContext(DataRouterStateContext);return s||invariant(!1),s}function useRouteContext(e){let s=reactExports.useContext(RouteContext);return s||invariant(!1),s}function useCurrentRouteId(e){let s=useRouteContext(),a=s.matches[s.matches.length-1];return a.route.id||invariant(!1),a.route.id}function useRouteError(){var e;let s=reactExports.useContext(RouteErrorContext),a=useDataRouterState(DataRouterStateHook$1.UseRouteError),i=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return s!==void 0?s:(e=a.errors)==null?void 0:e[i]}function useNavigateStable(){let{router:e}=useDataRouterContext$1(DataRouterHook$1.UseNavigateStable),s=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),a=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{a.current=!0}),reactExports.useCallback(function(o,c){c===void 0&&(c={}),a.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,_extends$1({fromRouteId:s},c)))},[e,s])}function logV6DeprecationWarnings(e,s){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Route(e){invariant(!1)}function Router(e){let{basename:s="/",children:a=null,location:i,navigationType:o=Action.Pop,navigator:c,static:d=!1,future:h}=e;useInRouterContext()&&invariant(!1);let g=s.replace(/^\/*/,"/"),_=reactExports.useMemo(()=>({basename:g,navigator:c,static:d,future:_extends$1({v7_relativeSplatPath:!1},h)}),[g,h,c,d]);typeof i=="string"&&(i=parsePath(i));let{pathname:b="/",search:j="",hash:_e="",state:tt=null,key:rt="default"}=i,et=reactExports.useMemo(()=>{let st=stripBasename(b,g);return st==null?null:{location:{pathname:st,search:j,hash:_e,state:tt,key:rt},navigationType:o}},[g,b,j,_e,tt,rt,o]);return et==null?null:reactExports.createElement(NavigationContext.Provider,{value:_},reactExports.createElement(LocationContext.Provider,{children:a,value:et}))}function Routes(e){let{children:s,location:a}=e;return useRoutes(createRoutesFromChildren(s),a)}new Promise(()=>{});function createRoutesFromChildren(e,s){s===void 0&&(s=[]);let a=[];return reactExports.Children.forEach(e,(i,o)=>{if(!reactExports.isValidElement(i))return;let c=[...s,o];if(i.type===reactExports.Fragment){a.push.apply(a,createRoutesFromChildren(i.props.children,c));return}i.type!==Route&&invariant(!1),!i.props.index||!i.props.children||invariant(!1);let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=createRoutesFromChildren(i.props.children,c)),a.push(d)}),a}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(e,s){if(e==null)return{};var a={},i=Object.keys(e),o,c;for(c=0;c<i.length;c++)o=i[c],!(s.indexOf(o)>=0)&&(a[o]=e[o]);return a}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,s){return e.button===0&&(!s||s==="_self")&&!isModifiedEvent(e)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_excluded2=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(e){let{basename:s,children:a,future:i,window:o}=e,c=reactExports.useRef();c.current==null&&(c.current=createBrowserHistory({window:o,v5Compat:!0}));let d=c.current,[h,g]=reactExports.useState({action:d.action,location:d.location}),{v7_startTransition:_}=i||{},b=reactExports.useCallback(j=>{_&&startTransitionImpl?startTransitionImpl(()=>g(j)):g(j)},[g,_]);return reactExports.useLayoutEffect(()=>d.listen(b),[d,b]),reactExports.useEffect(()=>logV6DeprecationWarnings(i),[i]),reactExports.createElement(Router,{basename:s,children:a,location:h.location,navigationType:h.action,navigator:d,future:i})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(s,a){let{onClick:i,relative:o,reloadDocument:c,replace:d,state:h,target:g,to:_,preventScrollReset:b,viewTransition:j}=s,_e=_objectWithoutPropertiesLoose(s,_excluded),{basename:tt}=reactExports.useContext(NavigationContext),rt,et=!1;if(typeof _=="string"&&ABSOLUTE_URL_REGEX.test(_)&&(rt=_,isBrowser$1))try{let nt=new URL(window.location.href),ot=_.startsWith("//")?new URL(nt.protocol+_):new URL(_),dt=stripBasename(ot.pathname,tt);ot.origin===nt.origin&&dt!=null?_=dt+ot.search+ot.hash:et=!0}catch{}let st=useHref(_,{relative:o}),at=useLinkClickHandler(_,{replace:d,state:h,target:g,preventScrollReset:b,relative:o,viewTransition:j});function it(nt){i&&i(nt),nt.defaultPrevented||at(nt)}return reactExports.createElement("a",_extends({},_e,{href:rt||st,onClick:et||c?i:it,ref:a,target:g}))}),NavLink=reactExports.forwardRef(function(s,a){let{"aria-current":i="page",caseSensitive:o=!1,className:c="",end:d=!1,style:h,to:g,viewTransition:_,children:b}=s,j=_objectWithoutPropertiesLoose(s,_excluded2),_e=useResolvedPath(g,{relative:j.relative}),tt=useLocation(),rt=reactExports.useContext(DataRouterStateContext),{navigator:et,basename:st}=reactExports.useContext(NavigationContext),at=rt!=null&&useViewTransitionState(_e)&&_===!0,it=et.encodeLocation?et.encodeLocation(_e).pathname:_e.pathname,nt=tt.pathname,ot=rt&&rt.navigation&&rt.navigation.location?rt.navigation.location.pathname:null;o||(nt=nt.toLowerCase(),ot=ot?ot.toLowerCase():null,it=it.toLowerCase()),ot&&st&&(ot=stripBasename(ot,st)||ot);const dt=it!=="/"&&it.endsWith("/")?it.length-1:it.length;let ht=nt===it||!d&&nt.startsWith(it)&&nt.charAt(dt)==="/",lt=ot!=null&&(ot===it||!d&&ot.startsWith(it)&&ot.charAt(it.length)==="/"),gt={isActive:ht,isPending:lt,isTransitioning:at},yt=ht?i:void 0,Tt;typeof c=="function"?Tt=c(gt):Tt=[c,ht?"active":null,lt?"pending":null,at?"transitioning":null].filter(Boolean).join(" ");let mt=typeof h=="function"?h(gt):h;return reactExports.createElement(Link,_extends({},j,{"aria-current":yt,className:Tt,ref:a,style:mt,to:g,viewTransition:_}),typeof b=="function"?b(gt):b)});var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useDataRouterContext(e){let s=reactExports.useContext(DataRouterContext);return s||invariant(!1),s}function useLinkClickHandler(e,s){let{target:a,replace:i,state:o,preventScrollReset:c,relative:d,viewTransition:h}=s===void 0?{}:s,g=useNavigate(),_=useLocation(),b=useResolvedPath(e,{relative:d});return reactExports.useCallback(j=>{if(shouldProcessLinkClick(j,a)){j.preventDefault();let _e=i!==void 0?i:createPath(_)===createPath(b);g(e,{replace:_e,state:o,preventScrollReset:c,relative:d,viewTransition:h})}},[_,g,b,i,o,a,e,c,d,h])}function useViewTransitionState(e,s){s===void 0&&(s={});let a=reactExports.useContext(ViewTransitionContext);a==null&&invariant(!1);let{basename:i}=useDataRouterContext(DataRouterHook.useViewTransitionState),o=useResolvedPath(e,{relative:s.relative});if(!a.isTransitioning)return!1;let c=stripBasename(a.currentLocation.pathname,i)||a.currentLocation.pathname,d=stripBasename(a.nextLocation.pathname,i)||a.nextLocation.pathname;return matchPath(o.pathname,d)!=null||matchPath(o.pathname,c)!=null}var sha256$1={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(e){return typeof e=="object"&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,s){return function(a){return new Sha256(s,!0).update(a)[e]()}},createMethod=function(e){var s=createOutputMethod("hex",e);NODE_JS&&(s=nodeWrap(s,e)),s.create=function(){return new Sha256(e)},s.update=function(o){return s.create().update(o)};for(var a=0;a<OUTPUT_TYPES.length;++a){var i=OUTPUT_TYPES[a];s[i]=createOutputMethod(i,e)}return s},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if(typeof e=="string")return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(e==null)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,s){return function(a,i){return new HmacSha256(a,s,!0).update(i)[e]()}},createHmacMethod=function(e){var s=createHmacOutputMethod("hex",e);s.create=function(o){return new HmacSha256(o,e)},s.update=function(o,c){return s.create(o).update(c)};for(var a=0;a<OUTPUT_TYPES.length;++a){var i=OUTPUT_TYPES[a];s[i]=createHmacOutputMethod(i,e)}return s};function Sha256(e,s){s?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}Sha256.prototype.update=function(e){if(!this.finalized){var s,a=typeof e;if(a!=="string"){if(a==="object"){if(e===null)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(e)))throw new Error(ERROR)}else throw new Error(ERROR);s=!0}for(var i,o=0,c,d=e.length,h=this.blocks;o<d;){if(this.hashed&&(this.hashed=!1,h[0]=this.block,h[16]=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=h[9]=h[10]=h[11]=h[12]=h[13]=h[14]=h[15]=0),s)for(c=this.start;o<d&&c<64;++o)h[c>>2]|=e[o]<<SHIFT[c++&3];else for(c=this.start;o<d&&c<64;++o)i=e.charCodeAt(o),i<128?h[c>>2]|=i<<SHIFT[c++&3]:i<2048?(h[c>>2]|=(192|i>>6)<<SHIFT[c++&3],h[c>>2]|=(128|i&63)<<SHIFT[c++&3]):i<55296||i>=57344?(h[c>>2]|=(224|i>>12)<<SHIFT[c++&3],h[c>>2]|=(128|i>>6&63)<<SHIFT[c++&3],h[c>>2]|=(128|i&63)<<SHIFT[c++&3]):(i=65536+((i&1023)<<10|e.charCodeAt(++o)&1023),h[c>>2]|=(240|i>>18)<<SHIFT[c++&3],h[c>>2]|=(128|i>>12&63)<<SHIFT[c++&3],h[c>>2]|=(128|i>>6&63)<<SHIFT[c++&3],h[c>>2]|=(128|i&63)<<SHIFT[c++&3]);this.lastByteIndex=c,this.bytes+=c-this.start,c>=64?(this.block=h[16],this.start=c-64,this.hash(),this.hashed=!0):this.start=c}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,s=this.lastByteIndex;e[16]=this.block,e[s>>2]|=EXTRA[s&3],this.block=e[16],s>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e=this.h0,s=this.h1,a=this.h2,i=this.h3,o=this.h4,c=this.h5,d=this.h6,h=this.h7,g=this.blocks,_,b,j,_e,tt,rt,et,st,at,it,nt;for(_=16;_<64;++_)tt=g[_-15],b=(tt>>>7|tt<<25)^(tt>>>18|tt<<14)^tt>>>3,tt=g[_-2],j=(tt>>>17|tt<<15)^(tt>>>19|tt<<13)^tt>>>10,g[_]=g[_-16]+b+g[_-7]+j<<0;for(nt=s&a,_=0;_<64;_+=4)this.first?(this.is224?(st=300032,tt=g[0]-1413257819,h=tt-150054599<<0,i=tt+24177077<<0):(st=704751109,tt=g[0]-210244248,h=tt-1521486534<<0,i=tt+143694565<<0),this.first=!1):(b=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),j=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),st=e&s,_e=st^e&a^nt,et=o&c^~o&d,tt=h+j+et+K[_]+g[_],rt=b+_e,h=i+tt<<0,i=tt+rt<<0),b=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),j=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),at=i&e,_e=at^i&s^st,et=h&o^~h&c,tt=d+j+et+K[_+1]+g[_+1],rt=b+_e,d=a+tt<<0,a=tt+rt<<0,b=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),j=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),it=a&i,_e=it^a&e^at,et=d&h^~d&o,tt=c+j+et+K[_+2]+g[_+2],rt=b+_e,c=s+tt<<0,s=tt+rt<<0,b=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),j=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),nt=s&a,_e=nt^s&i^it,et=c&d^~c&h,tt=o+j+et+K[_+3]+g[_+3],rt=b+_e,o=e+tt<<0,e=tt+rt<<0;this.h0=this.h0+e<<0,this.h1=this.h1+s<<0,this.h2=this.h2+a<<0,this.h3=this.h3+i<<0,this.h4=this.h4+o<<0,this.h5=this.h5+c<<0,this.h6=this.h6+d<<0,this.h7=this.h7+h<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,s=this.h1,a=this.h2,i=this.h3,o=this.h4,c=this.h5,d=this.h6,h=this.h7,g=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[c>>28&15]+HEX_CHARS[c>>24&15]+HEX_CHARS[c>>20&15]+HEX_CHARS[c>>16&15]+HEX_CHARS[c>>12&15]+HEX_CHARS[c>>8&15]+HEX_CHARS[c>>4&15]+HEX_CHARS[c&15]+HEX_CHARS[d>>28&15]+HEX_CHARS[d>>24&15]+HEX_CHARS[d>>20&15]+HEX_CHARS[d>>16&15]+HEX_CHARS[d>>12&15]+HEX_CHARS[d>>8&15]+HEX_CHARS[d>>4&15]+HEX_CHARS[d&15];return this.is224||(g+=HEX_CHARS[h>>28&15]+HEX_CHARS[h>>24&15]+HEX_CHARS[h>>20&15]+HEX_CHARS[h>>16&15]+HEX_CHARS[h>>12&15]+HEX_CHARS[h>>8&15]+HEX_CHARS[h>>4&15]+HEX_CHARS[h&15]),g},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,s=this.h1,a=this.h2,i=this.h3,o=this.h4,c=this.h5,d=this.h6,h=this.h7,g=[e>>24&255,e>>16&255,e>>8&255,e&255,s>>24&255,s>>16&255,s>>8&255,s&255,a>>24&255,a>>16&255,a>>8&255,a&255,i>>24&255,i>>16&255,i>>8&255,i&255,o>>24&255,o>>16&255,o>>8&255,o&255,c>>24&255,c>>16&255,c>>8&255,c&255,d>>24&255,d>>16&255,d>>8&255,d&255];return this.is224||g.push(h>>24&255,h>>16&255,h>>8&255,h&255),g},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),s=new DataView(e);return s.setUint32(0,this.h0),s.setUint32(4,this.h1),s.setUint32(8,this.h2),s.setUint32(12,this.h3),s.setUint32(16,this.h4),s.setUint32(20,this.h5),s.setUint32(24,this.h6),this.is224||s.setUint32(28,this.h7),e};function HmacSha256(e,s,a){var i,o=typeof e;if(o==="string"){var c=[],d=e.length,h=0,g;for(i=0;i<d;++i)g=e.charCodeAt(i),g<128?c[h++]=g:g<2048?(c[h++]=192|g>>6,c[h++]=128|g&63):g<55296||g>=57344?(c[h++]=224|g>>12,c[h++]=128|g>>6&63,c[h++]=128|g&63):(g=65536+((g&1023)<<10|e.charCodeAt(++i)&1023),c[h++]=240|g>>18,c[h++]=128|g>>12&63,c[h++]=128|g>>6&63,c[h++]=128|g&63);e=c}else if(o==="object"){if(e===null)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(e)))throw new Error(ERROR)}else throw new Error(ERROR);e.length>64&&(e=new Sha256(s,!0).update(e).array());var _=[],b=[];for(i=0;i<64;++i){var j=e[i]||0;_[i]=92^j,b[i]=54^j}Sha256.call(this,s,a),this.update(b),this.oKeyPad=_,this.inner=!0,this.sharedMemory=a}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256$1);var sha256Exports=sha256$1.exports;const getDeviceLocation=async()=>{var e;try{const s="https://ipwho.is/",a=new AbortController,i=setTimeout(()=>a.abort(),5e3),o=await fetch(s,{signal:a.signal,headers:{Accept:"application/json"}});if(clearTimeout(i),o.ok){const c=await o.json();return[{country:c.country||"Unknown",region:c.region||"Unknown",city:c.city||"Unknown",ip:c.ip||"Unknown",timezone:((e=c.timezone)==null?void 0:e.id)||Intl.DateTimeFormat().resolvedOptions().timeZone},!1]}throw new Error(`Failed to fetch location data: ${o.statusText}`)}catch(s){return console.warn("Location service failed:",s),[{country:"Unknown",region:"Unknown",city:"Unknown",ip:"Unknown",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},!0]}},formatLocation=e=>{if(!e)return"Unknown Location";const s=[e.city,e.region,e.country].filter(a=>a&&a!=="Unknown");return s.length>0?s.join(", "):"Unknown Location"},SecurityPopup=({show:e,message:s,type:a,onClose:i})=>{if(!e)return null;const o={success:"bg-green-500",error:"bg-red-500",warning:"bg-yellow-500"}[a];return jsxRuntimeExports.jsxs("div",{className:`fixed bottom-4 right-4 ${o} text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-3`,children:[jsxRuntimeExports.jsx("span",{children:s}),jsxRuntimeExports.jsx("button",{onClick:i,className:"text-white hover:text-gray-200",children:""})]})},scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function e(s,a,i){let o=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=Promise.allSettled(a.map(g=>{if(g=assetsURL(g),g in seen)return;seen[g]=!0;const _=g.endsWith(".css"),b=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${b}`))return;const j=document.createElement("link");if(j.rel=_?"stylesheet":scriptRel,_||(j.as="script"),j.crossOrigin="",j.href=g,h&&j.setAttribute("nonce",h),document.head.appendChild(j),_)return new Promise((_e,tt)=>{j.addEventListener("load",_e),j.addEventListener("error",()=>tt(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return o.then(d=>{for(const h of d||[])h.status==="rejected"&&c(h.reason);return s().catch(c)})},resolveFetch$3=e=>{let s;return e?s=e:typeof fetch>"u"?s=(...a)=>__vitePreload(async()=>{const{default:i}=await Promise.resolve().then(()=>browser);return{default:i}},void 0).then(({default:i})=>i(...a)):s=fetch,(...a)=>s(...a)};class FunctionsError extends Error{constructor(s,a="FunctionsError",i){super(s),this.name=a,this.context=i}}class FunctionsFetchError extends FunctionsError{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class FunctionsRelayError extends FunctionsError{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class FunctionsHttpError extends FunctionsError{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var FunctionRegion;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$7=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};class FunctionsClient{constructor(s,{headers:a={},customFetch:i,region:o=FunctionRegion.Any}={}){this.url=s,this.headers=a,this.region=o,this.fetch=resolveFetch$3(i)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s,a={}){var i;return __awaiter$7(this,void 0,void 0,function*(){try{const{headers:o,method:c,body:d}=a;let h={},{region:g}=a;g||(g=this.region),g&&g!=="any"&&(h["x-region"]=g);let _;d&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(h["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(h["Content-Type"]="application/json",_=JSON.stringify(d)));const b=yield this.fetch(`${this.url}/${s}`,{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:_}).catch(rt=>{throw new FunctionsFetchError(rt)}),j=b.headers.get("x-relay-error");if(j&&j==="true")throw new FunctionsRelayError(b);if(!b.ok)throw new FunctionsHttpError(b);let _e=((i=b.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),tt;return _e==="application/json"?tt=yield b.json():_e==="application/octet-stream"?tt=yield b.blob():_e==="text/event-stream"?tt=b:_e==="multipart/form-data"?tt=yield b.formData():tt=yield b.text(),{data:tt,error:null}}catch(o){return{data:null,error:o}}})}}var cjs={},PostgrestClient$2={},PostgrestQueryBuilder$2={},PostgrestFilterBuilder$2={},PostgrestTransformBuilder$2={},PostgrestBuilder$2={},getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$1=globalObject.Headers,Request=globalObject.Request,Response$1=globalObject.Response,browser=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$1,Request,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(browser);var PostgrestError$2={};Object.defineProperty(PostgrestError$2,"__esModule",{value:!0});let PostgrestError$1=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}};PostgrestError$2.default=PostgrestError$1;var __importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PostgrestBuilder$2,"__esModule",{value:!0});const node_fetch_1=__importDefault$5(require$$0),PostgrestError_1$1=__importDefault$5(PostgrestError$2);let PostgrestBuilder$1=class{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=node_fetch_1.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=Object.assign({},this.headers),this.headers[s]=a,this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let o=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,g;let _=null,b=null,j=null,_e=c.status,tt=c.statusText;if(c.ok){if(this.method!=="HEAD"){const at=await c.text();at===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?b=at:b=JSON.parse(at))}const et=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),st=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");et&&st&&st.length>1&&(j=parseInt(st[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(_={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,j=null,_e=406,tt="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const et=await c.text();try{_=JSON.parse(et),Array.isArray(_)&&c.status===404&&(b=[],_=null,_e=200,tt="OK")}catch{c.status===404&&et===""?(_e=204,tt="No Content"):_={message:et}}if(_&&this.isMaybeSingle&&(!((g=_==null?void 0:_.details)===null||g===void 0)&&g.includes("0 rows"))&&(_=null,_e=200,tt="OK"),_&&this.shouldThrowOnError)throw new PostgrestError_1$1.default(_)}return{error:_,data:b,count:j,status:_e,statusText:tt}});return this.shouldThrowOnError||(o=o.catch(c=>{var d,h,g;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(g=c==null?void 0:c.code)!==null&&g!==void 0?g:""}`},data:null,count:null,status:0,statusText:""}})),o.then(s,a)}returns(){return this}overrideTypes(){return this}};PostgrestBuilder$2.default=PostgrestBuilder$1;var __importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PostgrestTransformBuilder$2,"__esModule",{value:!0});const PostgrestBuilder_1$1=__importDefault$4(PostgrestBuilder$2);let PostgrestTransformBuilder$1=class extends PostgrestBuilder_1$1.default{select(s){let a=!1;const i=(s??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:c=o}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${s}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${s}`),this}range(s,a,{foreignTable:i,referencedTable:o=i}={}){const c=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:c=!1,format:d="text"}={}){var h;const g=[s?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,c?"wal":null].filter(Boolean).join("|"),_=(h=this.headers.Accept)!==null&&h!==void 0?h:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${_}"; options=${g};`,d==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};PostgrestTransformBuilder$2.default=PostgrestTransformBuilder$1;var __importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PostgrestFilterBuilder$2,"__esModule",{value:!0});const PostgrestTransformBuilder_1$1=__importDefault$3(PostgrestTransformBuilder$2);let PostgrestFilterBuilder$1=class extends PostgrestTransformBuilder_1$1.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(s,`in.(${i})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:i,type:o}={}){let c="";o==="plain"?c="pl":o==="phrase"?c="ph":o==="websearch"&&(c="w");const d=i===void 0?"":`(${i})`;return this.url.searchParams.append(s,`${c}fts${d}.${a}`),this}match(s){return Object.entries(s).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(s,a,i){return this.url.searchParams.append(s,`not.${a}.${i}`),this}or(s,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${s})`),this}filter(s,a,i){return this.url.searchParams.append(s,`${a}.${i}`),this}};PostgrestFilterBuilder$2.default=PostgrestFilterBuilder$1;var __importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PostgrestQueryBuilder$2,"__esModule",{value:!0});const PostgrestFilterBuilder_1$2=__importDefault$2(PostgrestFilterBuilder$2);let PostgrestQueryBuilder$1=class{constructor(s,{headers:a={},schema:i,fetch:o}){this.url=s,this.headers=a,this.schema=i,this.fetch=o}select(s,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let c=!1;const d=(s??"*").split("").map(h=>/\s/.test(h)&&!c?"":(h==='"'&&(c=!c),h)).join("");return this.url.searchParams.set("select",d),i&&(this.headers.Prefer=`count=${i}`),new PostgrestFilterBuilder_1$2.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:a,defaultToNull:i=!0}={}){const o="POST",c=[];if(this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),i||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(s)){const d=s.reduce((h,g)=>h.concat(Object.keys(g)),[]);if(d.length>0){const h=[...new Set(d)].map(g=>`"${g}"`);this.url.searchParams.set("columns",h.join(","))}}return new PostgrestFilterBuilder_1$2.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:c=!0}={}){const d="POST",h=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&h.push(this.headers.Prefer),o&&h.push(`count=${o}`),c||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(s)){const g=s.reduce((_,b)=>_.concat(Object.keys(b)),[]);if(g.length>0){const _=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",_.join(","))}}return new PostgrestFilterBuilder_1$2.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new PostgrestFilterBuilder_1$2.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const a="DELETE",i=[];return s&&i.push(`count=${s}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new PostgrestFilterBuilder_1$2.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};PostgrestQueryBuilder$2.default=PostgrestQueryBuilder$1;var constants={},version$4={};Object.defineProperty(version$4,"__esModule",{value:!0});version$4.version=void 0;version$4.version="0.0.0-automated";Object.defineProperty(constants,"__esModule",{value:!0});constants.DEFAULT_HEADERS=void 0;const version_1=version$4;constants.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${version_1.version}`};var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PostgrestClient$2,"__esModule",{value:!0});const PostgrestQueryBuilder_1$1=__importDefault$1(PostgrestQueryBuilder$2),PostgrestFilterBuilder_1$1=__importDefault$1(PostgrestFilterBuilder$2),constants_1=constants;let PostgrestClient$1=class Or{constructor(s,{headers:a={},schema:i,fetch:o}={}){this.url=s,this.headers=Object.assign(Object.assign({},constants_1.DEFAULT_HEADERS),a),this.schemaName=i,this.fetch=o}from(s){const a=new URL(`${this.url}/${s}`);return new PostgrestQueryBuilder_1$1.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new Or(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:i=!1,get:o=!1,count:c}={}){let d;const h=new URL(`${this.url}/rpc/${s}`);let g;i||o?(d=i?"HEAD":"GET",Object.entries(a).filter(([b,j])=>j!==void 0).map(([b,j])=>[b,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([b,j])=>{h.searchParams.append(b,j)})):(d="POST",g=a);const _=Object.assign({},this.headers);return c&&(_.Prefer=`count=${c}`),new PostgrestFilterBuilder_1$1.default({method:d,url:h,headers:_,schema:this.schemaName,body:g,fetch:this.fetch,allowEmpty:!1})}};PostgrestClient$2.default=PostgrestClient$1;var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(cjs,"__esModule",{value:!0});cjs.PostgrestError=cjs.PostgrestBuilder=cjs.PostgrestTransformBuilder=cjs.PostgrestFilterBuilder=cjs.PostgrestQueryBuilder=cjs.PostgrestClient=void 0;const PostgrestClient_1=__importDefault(PostgrestClient$2);cjs.PostgrestClient=PostgrestClient_1.default;const PostgrestQueryBuilder_1=__importDefault(PostgrestQueryBuilder$2);cjs.PostgrestQueryBuilder=PostgrestQueryBuilder_1.default;const PostgrestFilterBuilder_1=__importDefault(PostgrestFilterBuilder$2);cjs.PostgrestFilterBuilder=PostgrestFilterBuilder_1.default;const PostgrestTransformBuilder_1=__importDefault(PostgrestTransformBuilder$2);cjs.PostgrestTransformBuilder=PostgrestTransformBuilder_1.default;const PostgrestBuilder_1=__importDefault(PostgrestBuilder$2);cjs.PostgrestBuilder=PostgrestBuilder_1.default;const PostgrestError_1=__importDefault(PostgrestError$2);cjs.PostgrestError=PostgrestError_1.default;var _default=cjs.default={PostgrestClient:PostgrestClient_1.default,PostgrestQueryBuilder:PostgrestQueryBuilder_1.default,PostgrestFilterBuilder:PostgrestFilterBuilder_1.default,PostgrestTransformBuilder:PostgrestTransformBuilder_1.default,PostgrestBuilder:PostgrestBuilder_1.default,PostgrestError:PostgrestError_1.default};const{PostgrestClient,PostgrestQueryBuilder,PostgrestFilterBuilder,PostgrestTransformBuilder,PostgrestBuilder,PostgrestError}=_default;function getNativeWebSocket(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const WebSocket$1=getNativeWebSocket(),version$3="2.11.15",DEFAULT_VERSION=`realtime-js/${version$3}`,VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3;var SOCKET_STATES;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(e){e.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Serializer{constructor(){this.HEADER_LENGTH=1}decode(s,a){return s.constructor===ArrayBuffer?a(this._binaryDecode(s)):a(typeof s=="string"?JSON.parse(s):{})}_binaryDecode(s){const a=new DataView(s),i=new TextDecoder;return this._decodeBroadcast(s,a,i)}_decodeBroadcast(s,a,i){const o=a.getUint8(1),c=a.getUint8(2);let d=this.HEADER_LENGTH+2;const h=i.decode(s.slice(d,d+o));d=d+o;const g=i.decode(s.slice(d,d+c));d=d+c;const _=JSON.parse(i.decode(s.slice(d,s.byteLength)));return{ref:null,topic:h,event:g,payload:_}}}class Timer{constructor(s,a){this.callback=s,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var PostgresTypes;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(e,s,a={})=>{var i;const o=(i=a.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(s).reduce((c,d)=>(c[d]=convertColumn(d,e,s,o),c),{})},convertColumn=(e,s,a,i)=>{const o=s.find(h=>h.name===e),c=o==null?void 0:o.type,d=a[e];return c&&!i.includes(c)?convertCell(c,d):noop$1(d)},convertCell=(e,s)=>{if(e.charAt(0)==="_"){const a=e.slice(1,e.length);return toArray(s,a)}switch(e){case PostgresTypes.bool:return toBoolean(s);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(s);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(s);case PostgresTypes.timestamp:return toTimestampString(s);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$1(s);default:return noop$1(s)}},noop$1=e=>e,toBoolean=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},toNumber=e=>{if(typeof e=="string"){const s=parseFloat(e);if(!Number.isNaN(s))return s}return e},toJson=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(s){return console.log(`JSON parse error: ${s}`),e}return e},toArray=(e,s)=>{if(typeof e!="string")return e;const a=e.length-1,i=e[a];if(e[0]==="{"&&i==="}"){let c;const d=e.slice(1,a);try{c=JSON.parse("["+d+"]")}catch{c=d?d.split(","):[]}return c.map(h=>convertCell(s,h))}return e},toTimestampString=e=>typeof e=="string"?e.replace(" ","T"):e,httpEndpointURL=e=>{let s=e;return s=s.replace(/^ws/i,"http"),s=s.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),s.replace(/\/+$/,"")};class Push{constructor(s,a,i={},o=DEFAULT_TIMEOUT){this.channel=s,this.event=a,this.payload=i,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,a){var i;return this._hasReceived(s)&&a((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:s,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:a}){this.recHooks.filter(i=>i.status===s).forEach(i=>i.callback(a))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(s,a){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(a==null?void 0:a.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},o=>{const{onJoin:c,onLeave:d,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,o,c,d),this.pendingDiffs.forEach(g=>{this.state=RealtimePresence.syncDiff(this.state,g,c,d)}),this.pendingDiffs=[],h()}),this.channel._on(i.diff,{},o=>{const{onJoin:c,onLeave:d,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=RealtimePresence.syncDiff(this.state,o,c,d),h())}),this.onJoin((o,c,d)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:c,newPresences:d})}),this.onLeave((o,c,d)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:c,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,a,i,o){const c=this.cloneDeep(s),d=this.transformState(a),h={},g={};return this.map(c,(_,b)=>{d[_]||(g[_]=b)}),this.map(d,(_,b)=>{const j=c[_];if(j){const _e=b.map(st=>st.presence_ref),tt=j.map(st=>st.presence_ref),rt=b.filter(st=>tt.indexOf(st.presence_ref)<0),et=j.filter(st=>_e.indexOf(st.presence_ref)<0);rt.length>0&&(h[_]=rt),et.length>0&&(g[_]=et)}else h[_]=b}),this.syncDiff(c,{joins:h,leaves:g},i,o)}static syncDiff(s,a,i,o){const{joins:c,leaves:d}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return i||(i=()=>{}),o||(o=()=>{}),this.map(c,(h,g)=>{var _;const b=(_=s[h])!==null&&_!==void 0?_:[];if(s[h]=this.cloneDeep(g),b.length>0){const j=s[h].map(tt=>tt.presence_ref),_e=b.filter(tt=>j.indexOf(tt.presence_ref)<0);s[h].unshift(..._e)}i(h,b,g)}),this.map(d,(h,g)=>{let _=s[h];if(!_)return;const b=g.map(j=>j.presence_ref);_=_.filter(j=>b.indexOf(j.presence_ref)<0),s[h]=_,o(h,_,g),_.length===0&&delete s[h]}),s}static map(s,a){return Object.getOwnPropertyNames(s).map(i=>a(i,s[i]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((a,i)=>{const o=s[i];return"metas"in o?a[i]=o.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):a[i]=o,a},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(s,a={config:{}},i){this.topic=s,this.params=a,this.socket=i,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(s,a=this.timeout){var i,o;if(this.socket.isConnected()||this.socket.connect(),this.state==CHANNEL_STATES.closed){const{config:{broadcast:c,presence:d,private:h}}=this.params;this._onError(b=>s==null?void 0:s(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,b)),this._onClose(()=>s==null?void 0:s(REALTIME_SUBSCRIBE_STATES.CLOSED));const g={},_={broadcast:c,presence:d,postgres_changes:(o=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(b=>b.filter))!==null&&o!==void 0?o:[],private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:_},g)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:b})=>{var j;if(this.socket.setAuth(),b===void 0){s==null||s(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}else{const _e=this.bindings.postgres_changes,tt=(j=_e==null?void 0:_e.length)!==null&&j!==void 0?j:0,rt=[];for(let et=0;et<tt;et++){const st=_e[et],{filter:{event:at,schema:it,table:nt,filter:ot}}=st,dt=b&&b[et];if(dt&&dt.event===at&&dt.schema===it&&dt.table===nt&&dt.filter===ot)rt.push(Object.assign(Object.assign({},st),{id:dt.id}));else{this.unsubscribe(),this.state=CHANNEL_STATES.errored,s==null||s(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=rt,s&&s(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}}).receive("error",b=>{this.state=CHANNEL_STATES.errored,s==null||s(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{s==null||s(REALTIME_SUBSCRIBE_STATES.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,a={}){return await this.send({type:"presence",event:"track",payload:s},a.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,a,i){return this._on(s,a,i)}async send(s,a={}){var i,o;if(!this._canPush()&&s.type==="broadcast"){const{event:c,payload:d}=s,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:d,private:this.private}]})};try{const _=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=a.timeout)!==null&&i!==void 0?i:this.timeout);return await((o=_.body)===null||o===void 0?void 0:o.cancel()),_.ok?"ok":"error"}catch(_){return _.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var d,h,g;const _=this._push(s.type,s,a.timeout||this.timeout);s.type==="broadcast"&&!(!((g=(h=(d=this.params)===null||d===void 0?void 0:d.config)===null||h===void 0?void 0:h.broadcast)===null||g===void 0)&&g.ack)&&c("ok"),_.receive("ok",()=>c("ok")),_.receive("error",()=>c("error")),_.receive("timeout",()=>c("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=CHANNEL_STATES.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(o=>{i=new Push(this,CHANNEL_EVENTS.leave,{},s),i.receive("ok",()=>{a(),o("ok")}).receive("timeout",()=>{a(),o("timed out")}).receive("error",()=>{o("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(s,a,i){const o=new AbortController,c=setTimeout(()=>o.abort(),i),d=await this.socket.fetch(s,Object.assign(Object.assign({},a),{signal:o.signal}));return clearTimeout(c),d}_push(s,a,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Push(this,s,a,i);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(s,a,i){return a}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,a,i){var o,c;const d=s.toLocaleLowerCase(),{close:h,error:g,leave:_,join:b}=CHANNEL_EVENTS;if(i&&[h,g,_,b].indexOf(d)>=0&&i!==this._joinRef())return;let _e=this._onMessage(d,a,i);if(a&&!_e)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(tt=>{var rt,et,st;return((rt=tt.filter)===null||rt===void 0?void 0:rt.event)==="*"||((st=(et=tt.filter)===null||et===void 0?void 0:et.event)===null||st===void 0?void 0:st.toLocaleLowerCase())===d}).map(tt=>tt.callback(_e,i)):(c=this.bindings[d])===null||c===void 0||c.filter(tt=>{var rt,et,st,at,it,nt;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in tt){const ot=tt.id,dt=(rt=tt.filter)===null||rt===void 0?void 0:rt.event;return ot&&((et=a.ids)===null||et===void 0?void 0:et.includes(ot))&&(dt==="*"||(dt==null?void 0:dt.toLocaleLowerCase())===((st=a.data)===null||st===void 0?void 0:st.type.toLocaleLowerCase()))}else{const ot=(it=(at=tt==null?void 0:tt.filter)===null||at===void 0?void 0:at.event)===null||it===void 0?void 0:it.toLocaleLowerCase();return ot==="*"||ot===((nt=a==null?void 0:a.event)===null||nt===void 0?void 0:nt.toLocaleLowerCase())}else return tt.type.toLocaleLowerCase()===d}).map(tt=>{if(typeof _e=="object"&&"ids"in _e){const rt=_e.data,{schema:et,table:st,commit_timestamp:at,type:it,errors:nt}=rt;_e=Object.assign(Object.assign({},{schema:et,table:st,commit_timestamp:at,eventType:it,new:{},old:{},errors:nt}),this._getPayloadRecords(rt))}tt.callback(_e,i)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,a,i){const o=s.toLocaleLowerCase(),c={type:o,filter:a,callback:i};return this.bindings[o]?this.bindings[o].push(c):this.bindings[o]=[c],this}_off(s,a){const i=s.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(o=>{var c;return!(((c=o.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===i&&RealtimeChannel.isEqual(o.filter,a))}),this}static isEqual(s,a){if(Object.keys(s).length!==Object.keys(a).length)return!1;for(const i in s)if(s[i]!==a[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(CHANNEL_EVENTS.close,{},s)}_onError(s){this._on(CHANNEL_EVENTS.error,{},a=>s(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const a={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(a.new=convertChangeData(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(a.old=convertChangeData(s.columns,s.old_record)),a}}const noop=()=>{},WORKER_SCRIPT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RealtimeClient{constructor(s,a){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=DEFAULT_TIMEOUT,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=noop,this.ref=0,this.logger=noop,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=c=>{let d;return c?d=c:typeof fetch>"u"?d=(...h)=>__vitePreload(async()=>{const{default:g}=await Promise.resolve().then(()=>browser);return{default:g}},void 0).then(({default:g})=>g(...h)):d=fetch,(...h)=>d(...h)},this.endPoint=`${s}/${TRANSPORTS.websocket}`,this.httpEndpoint=httpEndpointURL(s),a!=null&&a.transport?this.transport=a.transport:this.transport=null,a!=null&&a.params&&(this.params=a.params),a!=null&&a.timeout&&(this.timeout=a.timeout),a!=null&&a.logger&&(this.logger=a.logger),(a!=null&&a.logLevel||a!=null&&a.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),a!=null&&a.heartbeatIntervalMs&&(this.heartbeatIntervalMs=a.heartbeatIntervalMs);const o=(i=a==null?void 0:a.params)===null||i===void 0?void 0:i.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=a!=null&&a.reconnectAfterMs?a.reconnectAfterMs:c=>[1e3,2e3,5e3,1e4][c-1]||1e4,this.encode=a!=null&&a.encode?a.encode:(c,d)=>d(JSON.stringify(c)),this.decode=a!=null&&a.decode?a.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(a==null?void 0:a.fetch),a!=null&&a.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(a==null?void 0:a.worker)||!1,this.workerUrl=a==null?void 0:a.workerUrl}this.accessToken=(a==null?void 0:a.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=WebSocket$1),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}disconnect(s,a){this.conn&&(this.conn.onclose=function(){},s?this.conn.close(s,a??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(i=>i.teardown()))}getChannels(){return this.channels}async removeChannel(s){const a=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const s=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,a,i){this.logger(s,a,i)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}channel(s,a={config:{}}){const i=`realtime:${s}`,o=this.getChannels().find(c=>c.topic===i);if(o)return o;{const c=new RealtimeChannel(`realtime:${s}`,a,this);return this.channels.push(c),c}}push(s){const{topic:a,event:i,payload:o,ref:c}=s,d=()=>{this.encode(s,h=>{var g;(g=this.conn)===null||g===void 0||g.send(h)})};this.log("push",`${a} ${i} (${c})`,o),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(s=null){let a=s||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(i=>{const o={access_token:a,version:DEFAULT_VERSION};a&&i.updateJoinPayload(o),i.joinedOnce&&i._isJoined()&&i._push(CHANNEL_EVENTS.access_token,{access_token:a})}))}async sendHeartbeat(){var s;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(s=this.conn)===null||s===void 0||s.close(WS_CLOSE_NORMAL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let a=this.channels.find(i=>i.topic===s&&(i._isJoined()||i._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${s}"`),a.unsubscribe())}_remove(s){this.channels=this.channels.filter(a=>a.topic!==s.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s))}_onConnMessage(s){this.decode(s.data,a=>{let{topic:i,event:o,payload:c,ref:d}=a;i==="phoenix"&&o==="phx_reply"&&this.heartbeatCallback(a.payload.status=="ok"?"ok":"error"),d&&d===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${c.status||""} ${i} ${o} ${d&&"("+d+")"||""}`,c),Array.from(this.channels).filter(h=>h._isMember(i)).forEach(h=>h._trigger(o,c,d)),this.stateChangeCallbacks.message.forEach(h=>h(a))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(s=>s())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(s){this.log("transport","close",s),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(a=>a(s))}_onConnError(s){this.log("transport",`${s}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(a=>a(s))}_triggerChanError(){this.channels.forEach(s=>s._trigger(CHANNEL_EVENTS.error))}_appendParams(s,a){if(Object.keys(a).length===0)return s;const i=s.match(/\?/)?"&":"?",o=new URLSearchParams(a);return`${s}${i}${o}`}_workerObjectUrl(s){let a;if(s)a=s;else{const i=new Blob([WORKER_SCRIPT],{type:"application/javascript"});a=URL.createObjectURL(i)}return a}}class StorageError extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class StorageApiError extends StorageError{constructor(s,a){super(s),this.name="StorageApiError",this.status=a}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(s,a){super(s),this.name="StorageUnknownError",this.originalError=a}}var __awaiter$6=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};const resolveFetch$2=e=>{let s;return e?s=e:typeof fetch>"u"?s=(...a)=>__vitePreload(async()=>{const{default:i}=await Promise.resolve().then(()=>browser);return{default:i}},void 0).then(({default:i})=>i(...a)):s=fetch,(...a)=>s(...a)},resolveResponse=()=>__awaiter$6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser),void 0)).Response:Response}),recursiveToCamel=e=>{if(Array.isArray(e))return e.map(a=>recursiveToCamel(a));if(typeof e=="function"||e!==Object(e))return e;const s={};return Object.entries(e).forEach(([a,i])=>{const o=a.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));s[o]=recursiveToCamel(i)}),s};var __awaiter$5=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};const _getErrorMessage$1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),handleError$1=(e,s,a)=>__awaiter$5(void 0,void 0,void 0,function*(){const i=yield resolveResponse();e instanceof i&&!(a!=null&&a.noResolveJson)?e.json().then(o=>{s(new StorageApiError(_getErrorMessage$1(o),e.status||500))}).catch(o=>{s(new StorageUnknownError(_getErrorMessage$1(o),o))}):s(new StorageUnknownError(_getErrorMessage$1(e),e))}),_getRequestParams$1=(e,s,a,i)=>{const o={method:e,headers:(s==null?void 0:s.headers)||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},s==null?void 0:s.headers),i&&(o.body=JSON.stringify(i)),Object.assign(Object.assign({},o),a))};function _handleRequest$1(e,s,a,i,o,c){return __awaiter$5(this,void 0,void 0,function*(){return new Promise((d,h)=>{e(a,_getRequestParams$1(s,i,o,c)).then(g=>{if(!g.ok)throw g;return i!=null&&i.noResolveJson?g:g.json()}).then(g=>d(g)).catch(g=>handleError$1(g,h,i))})})}function get(e,s,a,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"GET",s,a,i)})}function post(e,s,a,i,o){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"POST",s,i,o,a)})}function put(e,s,a,i,o){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"PUT",s,i,o,a)})}function head(e,s,a,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"HEAD",s,Object.assign(Object.assign({},a),{noResolveJson:!0}),i)})}function remove(e,s,a,i,o){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"DELETE",s,i,o,a)})}var __awaiter$4=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(s,a={},i,o){this.url=s,this.headers=a,this.bucketId=i,this.fetch=resolveFetch$2(o)}uploadOrUpdate(s,a,i,o){return __awaiter$4(this,void 0,void 0,function*(){try{let c;const d=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),o);let h=Object.assign(Object.assign({},this.headers),s==="POST"&&{"x-upsert":String(d.upsert)});const g=d.metadata;typeof Blob<"u"&&i instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),g&&c.append("metadata",this.encodeMetadata(g)),c.append("",i)):typeof FormData<"u"&&i instanceof FormData?(c=i,c.append("cacheControl",d.cacheControl),g&&c.append("metadata",this.encodeMetadata(g))):(c=i,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType,g&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),o!=null&&o.headers&&(h=Object.assign(Object.assign({},h),o.headers));const _=this._removeEmptyFolders(a),b=this._getFinalPath(_),j=yield this.fetch(`${this.url}/object/${b}`,Object.assign({method:s,body:c,headers:h},d!=null&&d.duplex?{duplex:d.duplex}:{})),_e=yield j.json();return j.ok?{data:{path:_,id:_e.Id,fullPath:_e.Key},error:null}:{data:null,error:_e}}catch(c){if(isStorageError(c))return{data:null,error:c};throw c}})}upload(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",s,a,i)})}uploadToSignedUrl(s,a,i,o){return __awaiter$4(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(s),d=this._getFinalPath(c),h=new URL(this.url+`/object/upload/sign/${d}`);h.searchParams.set("token",a);try{let g;const _=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},o),b=Object.assign(Object.assign({},this.headers),{"x-upsert":String(_.upsert)});typeof Blob<"u"&&i instanceof Blob?(g=new FormData,g.append("cacheControl",_.cacheControl),g.append("",i)):typeof FormData<"u"&&i instanceof FormData?(g=i,g.append("cacheControl",_.cacheControl)):(g=i,b["cache-control"]=`max-age=${_.cacheControl}`,b["content-type"]=_.contentType);const j=yield this.fetch(h.toString(),{method:"PUT",body:g,headers:b}),_e=yield j.json();return j.ok?{data:{path:c,fullPath:_e.Key},error:null}:{data:null,error:_e}}catch(g){if(isStorageError(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(s,a){return __awaiter$4(this,void 0,void 0,function*(){try{let i=this._getFinalPath(s);const o=Object.assign({},this.headers);a!=null&&a.upsert&&(o["x-upsert"]="true");const c=yield post(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:o}),d=new URL(this.url+c.url),h=d.searchParams.get("token");if(!h)throw new StorageError("No token returned by API");return{data:{signedUrl:d.toString(),path:s,token:h},error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}update(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",s,a,i)})}move(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:a,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}copy(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:a,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}createSignedUrl(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){try{let o=this._getFinalPath(s),c=yield post(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:a},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const d=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${d}`)},{data:c,error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}createSignedUrls(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){try{const o=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:a,paths:s},{headers:this.headers}),c=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:o.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${c}`):null})),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}download(s,a){return __awaiter$4(this,void 0,void 0,function*(){const o=typeof(a==null?void 0:a.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((a==null?void 0:a.transform)||{}),d=c?`?${c}`:"";try{const h=this._getFinalPath(s);return{data:yield(yield get(this.fetch,`${this.url}/${o}/${h}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}})}info(s){return __awaiter$4(this,void 0,void 0,function*(){const a=this._getFinalPath(s);try{const i=yield get(this.fetch,`${this.url}/object/info/${a}`,{headers:this.headers});return{data:recursiveToCamel(i),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}exists(s){return __awaiter$4(this,void 0,void 0,function*(){const a=this._getFinalPath(s);try{return yield head(this.fetch,`${this.url}/object/${a}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(isStorageError(i)&&i instanceof StorageUnknownError){const o=i.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:i}}throw i}})}getPublicUrl(s,a){const i=this._getFinalPath(s),o=[],c=a!=null&&a.download?`download=${a.download===!0?"":a.download}`:"";c!==""&&o.push(c);const h=typeof(a==null?void 0:a.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((a==null?void 0:a.transform)||{});g!==""&&o.push(g);let _=o.join("&");return _!==""&&(_=`?${_}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${i}${_}`)}}}remove(s){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}list(s,a,i){return __awaiter$4(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),a),{prefix:s||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},i),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const a=[];return s.width&&a.push(`width=${s.width}`),s.height&&a.push(`height=${s.height}`),s.resize&&a.push(`resize=${s.resize}`),s.format&&a.push(`format=${s.format}`),s.quality&&a.push(`quality=${s.quality}`),a.join("&")}}const version$2="2.7.1",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$2}`};var __awaiter$3=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};class StorageBucketApi{constructor(s,a={},i){this.url=s,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),a),this.fetch=resolveFetch$2(i)}listBuckets(){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(s){if(isStorageError(s))return{data:null,error:s};throw s}})}getBucket(s){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}createBucket(s,a={public:!1}){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:s,name:s,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}updateBucket(s,a){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}emptyBucket(s){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}deleteBucket(s){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}}class StorageClient extends StorageBucketApi{constructor(s,a={},i){super(s,a,i)}from(s){return new StorageFileApi(this.url,this.headers,s,this.fetch)}}const version$1="2.50.2";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$1}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$2=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};const resolveFetch$1=e=>{let s;return e?s=e:typeof fetch>"u"?s=nodeFetch:s=fetch,(...a)=>s(...a)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$1:Headers,fetchWithAuth=(e,s,a)=>{const i=resolveFetch$1(a),o=resolveHeadersConstructor();return(c,d)=>__awaiter$2(void 0,void 0,void 0,function*(){var h;const g=(h=yield s())!==null&&h!==void 0?h:e;let _=new o(d==null?void 0:d.headers);return _.has("apikey")||_.set("apikey",e),_.has("Authorization")||_.set("Authorization",`Bearer ${g}`),i(c,Object.assign(Object.assign({},d),{headers:_}))})};var __awaiter$1=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};function ensureTrailingSlash(e){return e.endsWith("/")?e:e+"/"}function applySettingDefaults(e,s){var a,i;const{db:o,auth:c,realtime:d,global:h}=e,{db:g,auth:_,realtime:b,global:j}=s,_e={db:Object.assign(Object.assign({},g),o),auth:Object.assign(Object.assign({},_),c),realtime:Object.assign(Object.assign({},b),d),global:Object.assign(Object.assign(Object.assign({},j),h),{headers:Object.assign(Object.assign({},(a=j==null?void 0:j.headers)!==null&&a!==void 0?a:{}),(i=h==null?void 0:h.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>__awaiter$1(this,void 0,void 0,function*(){return""})};return e.accessToken?_e.accessToken=e.accessToken:delete _e.accessToken,_e}const version="2.70.0",AUTO_REFRESH_TICK_DURATION_MS=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3,EXPIRY_MARGIN_MS=AUTO_REFRESH_TICK_THRESHOLD*AUTO_REFRESH_TICK_DURATION_MS,GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version}`},API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},BASE64URL_REGEX=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JWKS_TTL=6e5;class AuthError extends Error{constructor(s,a,i){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=i}}function isAuthError(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class AuthApiError extends AuthError{constructor(s,a,i){super(s,a,i),this.name="AuthApiError",this.status=a,this.code=i}}function isAuthApiError(e){return isAuthError(e)&&e.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(s,a){super(s),this.name="AuthUnknownError",this.originalError=a}}class CustomAuthError extends AuthError{constructor(s,a,i,o){super(s,i,o),this.name=a,this.status=i}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function isAuthSessionMissingError(e){return isAuthError(e)&&e.name==="AuthSessionMissingError"}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(s,a=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function isAuthImplicitGrantRedirectError(e){return isAuthError(e)&&e.name==="AuthImplicitGrantRedirectError"}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(s,a=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(s,a){super(s,"AuthRetryableFetchError",a,void 0)}}function isAuthRetryableFetchError(e){return isAuthError(e)&&e.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(s,a,i){super(s,"AuthWeakPasswordError",a,"weak_password"),this.reasons=i}}class AuthInvalidJwtError extends CustomAuthError{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const TO_BASE64URL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),IGNORE_BASE64URL=` 	
\r=`.split(""),FROM_BASE64URL=(()=>{const e=new Array(128);for(let s=0;s<e.length;s+=1)e[s]=-1;for(let s=0;s<IGNORE_BASE64URL.length;s+=1)e[IGNORE_BASE64URL[s].charCodeAt(0)]=-2;for(let s=0;s<TO_BASE64URL.length;s+=1)e[TO_BASE64URL[s].charCodeAt(0)]=s;return e})();function byteToBase64URL(e,s,a){if(e!==null)for(s.queue=s.queue<<8|e,s.queuedBits+=8;s.queuedBits>=6;){const i=s.queue>>s.queuedBits-6&63;a(TO_BASE64URL[i]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const i=s.queue>>s.queuedBits-6&63;a(TO_BASE64URL[i]),s.queuedBits-=6}}function byteFromBase64URL(e,s,a){const i=FROM_BASE64URL[e];if(i>-1)for(s.queue=s.queue<<6|i,s.queuedBits+=6;s.queuedBits>=8;)a(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function stringFromBase64URL(e){const s=[],a=d=>{s.push(String.fromCodePoint(d))},i={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},c=d=>{stringFromUTF8(d,i,a)};for(let d=0;d<e.length;d+=1)byteFromBase64URL(e.charCodeAt(d),o,c);return s.join("")}function codepointToUTF8(e,s){if(e<=127){s(e);return}else if(e<=2047){s(192|e>>6),s(128|e&63);return}else if(e<=65535){s(224|e>>12),s(128|e>>6&63),s(128|e&63);return}else if(e<=1114111){s(240|e>>18),s(128|e>>12&63),s(128|e>>6&63),s(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function stringToUTF8(e,s){for(let a=0;a<e.length;a+=1){let i=e.charCodeAt(a);if(i>55295&&i<=56319){const o=(i-55296)*1024&65535;i=(e.charCodeAt(a+1)-56320&65535|o)+65536,a+=1}codepointToUTF8(i,s)}}function stringFromUTF8(e,s,a){if(s.utf8seq===0){if(e<=127){a(e);return}for(let i=1;i<6;i+=1)if(!(e>>7-i&1)){s.utf8seq=i;break}if(s.utf8seq===2)s.codepoint=e&31;else if(s.utf8seq===3)s.codepoint=e&15;else if(s.utf8seq===4)s.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|e&63,s.utf8seq-=1,s.utf8seq===0&&a(s.codepoint)}}function base64UrlToUint8Array(e){const s=[],a={queue:0,queuedBits:0},i=o=>{s.push(o)};for(let o=0;o<e.length;o+=1)byteFromBase64URL(e.charCodeAt(o),a,i);return new Uint8Array(s)}function stringToUint8Array(e){const s=[];return stringToUTF8(e,a=>s.push(a)),new Uint8Array(s)}function bytesToBase64URL(e){const s=[],a={queue:0,queuedBits:0},i=o=>{s.push(o)};return e.forEach(o=>byteToBase64URL(o,a,i)),byteToBase64URL(null,a,i),s.join("")}function expiresAt(e){return Math.round(Date.now()/1e3)+e}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const s=Math.random()*16|0;return(e=="x"?s:s&3|8).toString(16)})}const isBrowser=()=>typeof window<"u"&&typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(e){const s={},a=new URL(e);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((o,c)=>{s[c]=o})}catch{}return a.searchParams.forEach((i,o)=>{s[o]=i}),s}const resolveFetch=e=>{let s;return e?s=e:typeof fetch>"u"?s=(...a)=>__vitePreload(async()=>{const{default:i}=await Promise.resolve().then(()=>browser);return{default:i}},void 0).then(({default:i})=>i(...a)):s=fetch,(...a)=>s(...a)},looksLikeFetchResponse=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",setItemAsync=async(e,s,a)=>{await e.setItem(s,JSON.stringify(a))},getItemAsync=async(e,s)=>{const a=await e.getItem(s);if(!a)return null;try{return JSON.parse(a)}catch{return a}},removeItemAsync=async(e,s)=>{await e.removeItem(s)};class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((s,a)=>{this.resolve=s,this.reject=a})}}Deferred.promiseConstructor=Promise;function decodeJWT(e){const s=e.split(".");if(s.length!==3)throw new AuthInvalidJwtError("Invalid JWT structure");for(let i=0;i<s.length;i++)if(!BASE64URL_REGEX.test(s[i]))throw new AuthInvalidJwtError("JWT not in base64url format");return{header:JSON.parse(stringFromBase64URL(s[0])),payload:JSON.parse(stringFromBase64URL(s[1])),signature:base64UrlToUint8Array(s[2]),raw:{header:s[0],payload:s[1]}}}async function sleep(e){return await new Promise(s=>{setTimeout(()=>s(null),e)})}function retryable(e,s){return new Promise((i,o)=>{(async()=>{for(let c=0;c<1/0;c++)try{const d=await e(c);if(!s(c,null,d)){i(d);return}}catch(d){if(!s(c,d)){o(d);return}}})()})}function dec2hex(e){return("0"+e.toString(16)).substr(-2)}function generatePKCEVerifier(){const s=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=a.length;let o="";for(let c=0;c<56;c++)o+=a.charAt(Math.floor(Math.random()*i));return o}return crypto.getRandomValues(s),Array.from(s,dec2hex).join("")}async function sha256(e){const a=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",a),o=new Uint8Array(i);return Array.from(o).map(c=>String.fromCharCode(c)).join("")}async function generatePKCEChallenge(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const a=await sha256(e);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function getCodeChallengeAndMethod(e,s,a=!1){const i=generatePKCEVerifier();let o=i;a&&(o+="/PASSWORD_RECOVERY"),await setItemAsync(e,`${s}-code-verifier`,o);const c=await generatePKCEChallenge(i);return[c,i===c?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(e){const s=e.headers.get(API_VERSION_HEADER_NAME);if(!s||!s.match(API_VERSION_REGEX))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function validateExp(e){if(!e)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(e<=s)throw new Error("JWT has expired")}function getAlgorithm(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const UUID_REGEX=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function validateUUID(e){if(!UUID_REGEX.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var __rest$1=function(e,s){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&s.indexOf(i)<0&&(a[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)s.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(a[i[o]]=e[i[o]]);return a};const _getErrorMessage=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),NETWORK_ERROR_CODES=[502,503,504];async function handleError(e){var s;if(!looksLikeFetchResponse(e))throw new AuthRetryableFetchError(_getErrorMessage(e),0);if(NETWORK_ERROR_CODES.includes(e.status))throw new AuthRetryableFetchError(_getErrorMessage(e),e.status);let a;try{a=await e.json()}catch(c){throw new AuthUnknownError(_getErrorMessage(c),c)}let i;const o=parseResponseAPIVersion(e);if(o&&o.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?i=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(i=a.error_code),i){if(i==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(a),e.status,((s=a.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(i==="session_not_found")throw new AuthSessionMissingError}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((c,d)=>c&&typeof d=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(a),e.status,a.weak_password.reasons);throw new AuthApiError(_getErrorMessage(a),e.status||500,i)}const _getRequestParams=(e,s,a,i)=>{const o={method:e,headers:(s==null?void 0:s.headers)||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),o.body=JSON.stringify(i),Object.assign(Object.assign({},o),a))};async function _request(e,s,a,i){var o;const c=Object.assign({},i==null?void 0:i.headers);c[API_VERSION_HEADER_NAME]||(c[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),i!=null&&i.jwt&&(c.Authorization=`Bearer ${i.jwt}`);const d=(o=i==null?void 0:i.query)!==null&&o!==void 0?o:{};i!=null&&i.redirectTo&&(d.redirect_to=i.redirectTo);const h=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",g=await _handleRequest(e,s,a+h,{headers:c,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function _handleRequest(e,s,a,i,o,c){const d=_getRequestParams(s,i,o,c);let h;try{h=await e(a,Object.assign({},d))}catch(g){throw console.error(g),new AuthRetryableFetchError(_getErrorMessage(g),0)}if(h.ok||await handleError(h),i!=null&&i.noResolveJson)return h;try{return await h.json()}catch(g){await handleError(g)}}function _sessionResponse(e){var s;let a=null;hasSession(e)&&(a=Object.assign({},e),e.expires_at||(a.expires_at=expiresAt(e.expires_in)));const i=(s=e.user)!==null&&s!==void 0?s:e;return{data:{session:a,user:i},error:null}}function _sessionResponsePassword(e){const s=_sessionResponse(e);return!s.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0)&&(s.data.weak_password=e.weak_password),s}function _userResponse(e){var s;return{data:{user:(s=e.user)!==null&&s!==void 0?s:e},error:null}}function _ssoResponse(e){return{data:e,error:null}}function _generateLinkResponse(e){const{action_link:s,email_otp:a,hashed_token:i,redirect_to:o,verification_type:c}=e,d=__rest$1(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:s,email_otp:a,hashed_token:i,redirect_to:o,verification_type:c},g=Object.assign({},d);return{data:{properties:h,user:g},error:null}}function _noResolveJsonResponse(e){return e}function hasSession(e){return e.access_token&&e.refresh_token&&e.expires_in}const SIGN_OUT_SCOPES=["global","local","others"];var __rest=function(e,s){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&s.indexOf(i)<0&&(a[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)s.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(a[i[o]]=e[i[o]]);return a};class GoTrueAdminApi{constructor({url:s="",headers:a={},fetch:i}){this.url=s,this.headers=a,this.fetch=resolveFetch(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(s,a=SIGN_OUT_SCOPES[0]){if(SIGN_OUT_SCOPES.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${SIGN_OUT_SCOPES.join(", ")}`);try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}async inviteUserByEmail(s,a={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:_userResponse})}catch(i){if(isAuthError(i))return{data:{user:null},error:i};throw i}}async generateLink(s){try{const{options:a}=s,i=__rest(s,["options"]),o=Object.assign(Object.assign({},i),a);return"newEmail"in i&&(o.new_email=i==null?void 0:i.newEmail,delete o.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:_generateLinkResponse,redirectTo:a==null?void 0:a.redirectTo})}catch(a){if(isAuthError(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(s){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:_userResponse})}catch(a){if(isAuthError(a))return{data:{user:null},error:a};throw a}}async listUsers(s){var a,i,o,c,d,h,g;try{const _={nextPage:null,lastPage:0,total:0},b=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(a=s==null?void 0:s.page)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:"",per_page:(c=(o=s==null?void 0:s.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:_noResolveJsonResponse});if(b.error)throw b.error;const j=await b.json(),_e=(d=b.headers.get("x-total-count"))!==null&&d!==void 0?d:0,tt=(g=(h=b.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&g!==void 0?g:[];return tt.length>0&&(tt.forEach(rt=>{const et=parseInt(rt.split(";")[0].split("=")[1].substring(0,1)),st=JSON.parse(rt.split(";")[1].split("=")[1]);_[`${st}Page`]=et}),_.total=parseInt(_e)),{data:Object.assign(Object.assign({},j),_),error:null}}catch(_){if(isAuthError(_))return{data:{users:[]},error:_};throw _}}async getUserById(s){validateUUID(s);try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:_userResponse})}catch(a){if(isAuthError(a))return{data:{user:null},error:a};throw a}}async updateUserById(s,a){validateUUID(s);try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:a,headers:this.headers,xform:_userResponse})}catch(i){if(isAuthError(i))return{data:{user:null},error:i};throw i}}async deleteUser(s,a=!1){validateUUID(s);try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:a},xform:_userResponse})}catch(i){if(isAuthError(i))return{data:{user:null},error:i};throw i}}async _listFactors(s){validateUUID(s.userId);try{const{data:a,error:i}=await _request(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:a,error:i}}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _deleteFactor(s){validateUUID(s.userId),validateUUID(s.id);try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}}const localStorageAdapter={getItem:e=>supportsLocalStorage()?globalThis.localStorage.getItem(e):null,setItem:(e,s)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(e,s)},removeItem:e=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(e)}};function memoryLocalStorageAdapter(e={}){return{getItem:s=>e[s]||null,setItem:(s,a)=>{e[s]=a},removeItem:s=>{delete e[s]}}}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(e,s,a){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,s);const i=new globalThis.AbortController;return s>0&&setTimeout(()=>{i.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async o=>{if(o){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await a()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(s===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(internals.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lockNoOp(e,s,a){return await a()}class GoTrueClient{constructor(s){var a,i;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},DEFAULT_OPTIONS),s);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new GoTrueAdminApi({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=resolveFetch(o.fetch),this.lock=o.lock||lockNoOp,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:isBrowser()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:supportsLocalStorage()?this.storage=localStorageAdapter:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}_debug(...s){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version}) ${new Date().toISOString()}`,...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{const a=parseParametersFromURL(window.location.href);let i="none";if(this._isImplicitGrantCallback(a)?i="implicit":await this._isPKCECallback(a)&&(i="pkce"),isBrowser()&&this.detectSessionInUrl&&i!=="none"){const{data:o,error:c}=await this._getSessionFromURL(a,i);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),isAuthImplicitGrantRedirectError(c)){const g=(s=c.details)===null||s===void 0?void 0:s.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:d,redirectType:h}=o;return this._debug("#_initialize()","detected session in URL",d,"redirect type",h),await this._saveSession(d),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return isAuthError(a)?{error:a}:{error:new AuthUnknownError("Unexpected error during initialization",a)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var a,i,o;try{const c=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(a=s==null?void 0:s.options)===null||a===void 0?void 0:a.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(o=s==null?void 0:s.options)===null||o===void 0?void 0:o.captchaToken}},xform:_sessionResponse}),{data:d,error:h}=c;if(h||!d)return{data:{user:null,session:null},error:h};const g=d.session,_=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:_,session:g},error:null}}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(s){var a,i,o;try{let c;if("email"in s){const{email:b,password:j,options:_e}=s;let tt=null,rt=null;this.flowType==="pkce"&&([tt,rt]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),c=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_e==null?void 0:_e.emailRedirectTo,body:{email:b,password:j,data:(a=_e==null?void 0:_e.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:_e==null?void 0:_e.captchaToken},code_challenge:tt,code_challenge_method:rt},xform:_sessionResponse})}else if("phone"in s){const{phone:b,password:j,options:_e}=s;c=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:j,data:(i=_e==null?void 0:_e.data)!==null&&i!==void 0?i:{},channel:(o=_e==null?void 0:_e.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:_e==null?void 0:_e.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:d,error:h}=c;if(h||!d)return{data:{user:null,session:null},error:h};const g=d.session,_=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:_,session:g},error:null}}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(s){try{let a;if("email"in s){const{email:c,password:d,options:h}=s;a=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in s){const{phone:c,password:d,options:h}=s;a=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:i,error:o}=a;return o?{data:{user:null,session:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:o})}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(s){var a,i,o,c;return await this._handleProviderSignIn(s.provider,{redirectTo:(a=s.options)===null||a===void 0?void 0:a.redirectTo,scopes:(i=s.options)===null||i===void 0?void 0:i.scopes,queryParams:(o=s.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(c=s.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:a}=s;if(a==="solana")return await this.signInWithSolana(s);throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}async signInWithSolana(s){var a,i,o,c,d,h,g,_,b,j,_e,tt;let rt,et;if("message"in s)rt=s.message,et=s.signature;else{const{chain:st,wallet:at,statement:it,options:nt}=s;let ot;if(isBrowser())if(typeof at=="object")ot=at;else{const ht=window;if("solana"in ht&&typeof ht.solana=="object"&&("signIn"in ht.solana&&typeof ht.solana.signIn=="function"||"signMessage"in ht.solana&&typeof ht.solana.signMessage=="function"))ot=ht.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof at!="object"||!(nt!=null&&nt.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");ot=at}const dt=new URL((a=nt==null?void 0:nt.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in ot&&ot.signIn){const ht=await ot.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},nt==null?void 0:nt.signInWithSolana),{version:"1",domain:dt.host,uri:dt.href}),it?{statement:it}:null));let lt;if(Array.isArray(ht)&&ht[0]&&typeof ht[0]=="object")lt=ht[0];else if(ht&&typeof ht=="object"&&"signedMessage"in ht&&"signature"in ht)lt=ht;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in lt&&"signature"in lt&&(typeof lt.signedMessage=="string"||lt.signedMessage instanceof Uint8Array)&&lt.signature instanceof Uint8Array)rt=typeof lt.signedMessage=="string"?lt.signedMessage:new TextDecoder().decode(lt.signedMessage),et=lt.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in ot)||typeof ot.signMessage!="function"||!("publicKey"in ot)||typeof ot!="object"||!ot.publicKey||!("toBase58"in ot.publicKey)||typeof ot.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");rt=[`${dt.host} wants you to sign in with your Solana account:`,ot.publicKey.toBase58(),...it?["",it,""]:[""],"Version: 1",`URI: ${dt.href}`,`Issued At: ${(o=(i=nt==null?void 0:nt.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((c=nt==null?void 0:nt.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${nt.signInWithSolana.notBefore}`]:[],...!((d=nt==null?void 0:nt.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${nt.signInWithSolana.expirationTime}`]:[],...!((h=nt==null?void 0:nt.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${nt.signInWithSolana.chainId}`]:[],...!((g=nt==null?void 0:nt.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${nt.signInWithSolana.nonce}`]:[],...!((_=nt==null?void 0:nt.signInWithSolana)===null||_===void 0)&&_.requestId?[`Request ID: ${nt.signInWithSolana.requestId}`]:[],...!((j=(b=nt==null?void 0:nt.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||j===void 0)&&j.length?["Resources",...nt.signInWithSolana.resources.map(lt=>`- ${lt}`)]:[]].join(`
`);const ht=await ot.signMessage(new TextEncoder().encode(rt),"utf8");if(!ht||!(ht instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");et=ht}}try{const{data:st,error:at}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:rt,signature:bytesToBase64URL(et)},!((_e=s.options)===null||_e===void 0)&&_e.captchaToken?{gotrue_meta_security:{captcha_token:(tt=s.options)===null||tt===void 0?void 0:tt.captchaToken}}:null),xform:_sessionResponse});if(at)throw at;return!st||!st.session||!st.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(st.session&&(await this._saveSession(st.session),await this._notifyAllSubscribers("SIGNED_IN",st.session)),{data:Object.assign({},st),error:at})}catch(st){if(isAuthError(st))return{data:{user:null,session:null},error:st};throw st}}async _exchangeCodeForSession(s){const a=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[i,o]=(a??"").split("/");try{const{data:c,error:d}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:i},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:o??null}),error:d})}catch(c){if(isAuthError(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(s){try{const{options:a,provider:i,token:o,access_token:c,nonce:d}=s,h=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:o,access_token:c,nonce:d,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_sessionResponse}),{data:g,error:_}=h;return _?{data:{user:null,session:null},error:_}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:_})}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(s){var a,i,o,c,d;try{if("email"in s){const{email:h,options:g}=s;let _=null,b=null;this.flowType==="pkce"&&([_,b]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:j}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:_,code_challenge_method:b},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:j}}if("phone"in s){const{phone:h,options:g}=s,{data:_,error:b}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(o=g==null?void 0:g.data)!==null&&o!==void 0?o:{},create_user:(c=g==null?void 0:g.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(d=g==null?void 0:g.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:_==null?void 0:_.message_id},error:b}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(h){if(isAuthError(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(s){var a,i;try{let o,c;"options"in s&&(o=(a=s.options)===null||a===void 0?void 0:a.redirectTo,c=(i=s.options)===null||i===void 0?void 0:i.captchaToken);const{data:d,error:h}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:c}}),redirectTo:o,xform:_sessionResponse});if(h)throw h;if(!d)throw new Error("An error occurred on token verification.");const g=d.session,_=d.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:_,session:g},error:null}}catch(o){if(isAuthError(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(s){var a,i,o;try{let c=null,d=null;return this.flowType==="pkce"&&([c,d]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(i=(a=s.options)===null||a===void 0?void 0:a.redirectTo)!==null&&i!==void 0?i:void 0}),!((o=s==null?void 0:s.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:_ssoResponse})}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:a},error:i}=s;if(i)throw i;if(!a)throw new AuthSessionMissingError;const{error:o}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return{data:{user:null,session:null},error:o}})}catch(s){if(isAuthError(s))return{data:{user:null,session:null},error:s};throw s}}async resend(s){try{const a=`${this.url}/resend`;if("email"in s){const{email:i,type:o,options:c}=s,{error:d}=await _request(this.fetch,"POST",a,{headers:this.headers,body:{email:i,type:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in s){const{phone:i,type:o,options:c}=s,{data:d,error:h}=await _request(this.fetch,"POST",a,{headers:this.headers,body:{phone:i,type:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(s,a){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await i,await a()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=a();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await s(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const a=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?s=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const i=s.expires_at?s.expires_at*1e3-Date.now()<EXPIRY_MARGIN_MS:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",s.expires_at),!i){if(this.storage.isServer){let d=this.suppressGetSessionWarning;s=new Proxy(s,{get:(g,_,b)=>(!d&&_==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,_,b))})}return{data:{session:s},error:null}}const{session:o,error:c}=await this._callRefreshToken(s.refresh_token);return c?{data:{session:null},error:c}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(s){return s?await this._getUser(s):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(s){try{return s?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:_userResponse}):await this._useSession(async a=>{var i,o,c;const{data:d,error:h}=a;if(h)throw h;return!(!((i=d.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(o=d.session)===null||o===void 0?void 0:o.access_token)!==null&&c!==void 0?c:void 0,xform:_userResponse})})}catch(a){if(isAuthError(a))return isAuthSessionMissingError(a)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:a};throw a}}async updateUser(s,a={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,a))}async _updateUser(s,a={}){try{return await this._useSession(async i=>{const{data:o,error:c}=i;if(c)throw c;if(!o.session)throw new AuthSessionMissingError;const d=o.session;let h=null,g=null;this.flowType==="pkce"&&s.email!=null&&([h,g]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:_,error:b}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a==null?void 0:a.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:h,code_challenge_method:g}),jwt:d.access_token,xform:_userResponse});if(b)throw b;return d.user=_.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(i){if(isAuthError(i))return{data:{user:null},error:i};throw i}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new AuthSessionMissingError;const a=Date.now()/1e3;let i=a,o=!0,c=null;const{payload:d}=decodeJWT(s.access_token);if(d.exp&&(i=d.exp,o=i<=a),o){const{session:h,error:g}=await this._callRefreshToken(s.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!h)return{data:{user:null,session:null},error:null};c=h}else{const{data:h,error:g}=await this._getUser(s.access_token);if(g)throw g;c={access_token:s.access_token,refresh_token:s.refresh_token,user:h.user,token_type:"bearer",expires_in:i-a,expires_at:i},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(a){if(isAuthError(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async a=>{var i;if(!s){const{data:d,error:h}=a;if(h)throw h;s=(i=d.session)!==null&&i!==void 0?i:void 0}if(!(s!=null&&s.refresh_token))throw new AuthSessionMissingError;const{session:o,error:c}=await this._callRefreshToken(s.refresh_token);return c?{data:{user:null,session:null},error:c}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(s,a){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(s.error||s.error_description||s.error_code)throw new AuthImplicitGrantRedirectError(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:it,error:nt}=await this._exchangeCodeForSession(s.code);if(nt)throw nt;const ot=new URL(window.location.href);return ot.searchParams.delete("code"),window.history.replaceState(window.history.state,"",ot.toString()),{data:{session:it.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:o,access_token:c,refresh_token:d,expires_in:h,expires_at:g,token_type:_}=s;if(!c||!h||!d||!_)throw new AuthImplicitGrantRedirectError("No session defined in URL");const b=Math.round(Date.now()/1e3),j=parseInt(h);let _e=b+j;g&&(_e=parseInt(g));const tt=_e-b;tt*1e3<=AUTO_REFRESH_TICK_DURATION_MS&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${tt}s, should have been closer to ${j}s`);const rt=_e-j;b-rt>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",rt,_e,b):b-rt<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",rt,_e,b);const{data:et,error:st}=await this._getUser(c);if(st)throw st;const at={provider_token:i,provider_refresh_token:o,access_token:c,expires_in:j,expires_at:_e,refresh_token:d,token_type:_,user:et.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:at,redirectType:s.type},error:null}}catch(i){if(isAuthError(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(s){return!!(s.access_token||s.error_description)}async _isPKCECallback(s){const a=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&a)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async a=>{var i;const{data:o,error:c}=a;if(c)return{error:c};const d=(i=o.session)===null||i===void 0?void 0:i.access_token;if(d){const{error:h}=await this.admin.signOut(d,s);if(h&&!(isAuthApiError(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return s!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(s){const a=uuid(),i={id:a,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:i}}}async _emitInitialSession(s){return await this._useSession(async a=>{var i,o;try{const{data:{session:c},error:d}=a;if(d)throw d;await((i=this.stateChangeEmitters.get(s))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",s,"session",c)}catch(c){await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",c),console.error(c)}})}async resetPasswordForEmail(s,a={}){let i=null,o=null;this.flowType==="pkce"&&([i,o]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:i,code_challenge_method:o,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async getUserIdentities(){var s;try{const{data:a,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(s=a.user.identities)!==null&&s!==void 0?s:[]},error:null}}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async linkIdentity(s){var a;try{const{data:i,error:o}=await this._useSession(async c=>{var d,h,g,_,b;const{data:j,error:_e}=c;if(_e)throw _e;const tt=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(d=s.options)===null||d===void 0?void 0:d.redirectTo,scopes:(h=s.options)===null||h===void 0?void 0:h.scopes,queryParams:(g=s.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",tt,{headers:this.headers,jwt:(b=(_=j.session)===null||_===void 0?void 0:_.access_token)!==null&&b!==void 0?b:void 0})});if(o)throw o;return isBrowser()&&!(!((a=s.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:s.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(isAuthError(i))return{data:{provider:s.provider,url:null},error:i};throw i}}async unlinkIdentity(s){try{return await this._useSession(async a=>{var i,o;const{data:c,error:d}=a;if(d)throw d;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(o=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _refreshAccessToken(s){const a=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(a,"begin");try{const i=Date.now();return await retryable(async o=>(o>0&&await sleep(200*Math.pow(2,o-1)),this._debug(a,"refreshing attempt",o),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:_sessionResponse})),(o,c)=>{const d=200*Math.pow(2,o);return c&&isAuthRetryableFetchError(c)&&Date.now()+d-i<AUTO_REFRESH_TICK_DURATION_MS})}catch(i){if(this._debug(a,"error",i),isAuthError(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(a,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,a){const i=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",a,"url",i),isBrowser()&&!a.skipBrowserRedirect&&window.location.assign(i),{data:{provider:s,url:i},error:null}}async _recoverAndRefresh(){var s;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const i=await getItemAsync(this.storage,this.storageKey);if(this._debug(a,"session from storage",i),!this._isValidSession(i)){this._debug(a,"session is not valid"),i!==null&&await this._removeSession();return}const o=((s=i.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<EXPIRY_MARGIN_MS;if(this._debug(a,`session has${o?"":" not"} expired with margin of ${EXPIRY_MARGIN_MS}s`),o){if(this.autoRefreshToken&&i.refresh_token){const{error:c}=await this._callRefreshToken(i.refresh_token);c&&(console.error(c),isAuthRetryableFetchError(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(a,"error",i),console.error(i);return}finally{this._debug(a,"end")}}async _callRefreshToken(s){var a,i;if(!s)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Deferred;const{data:c,error:d}=await this._refreshAccessToken(s);if(d)throw d;if(!c.session)throw new AuthSessionMissingError;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const h={session:c.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(c){if(this._debug(o,"error",c),isAuthError(c)){const d={session:null,error:c};return isAuthRetryableFetchError(c)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(d),d}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(c),c}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(s,a,i=!0){const o=`#_notifyAllSubscribers(${s})`;this._debug(o,"begin",a,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:s,session:a});const c=[],d=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(s,a)}catch(g){c.push(g)}});if(await Promise.all(d),c.length>0){for(let h=0;h<c.length;h+=1)console.error(c[h]);throw c[0]}}finally{this._debug(o,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0,await setItemAsync(this.storage,this.storageKey,s)}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&isBrowser()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION_MS);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async a=>{const{data:{session:i}}=a;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((i.expires_at*1e3-s)/AUTO_REFRESH_TICK_DURATION_MS);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),o<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(i.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const a=`#_onVisibilityChanged(${s})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,a,i){const o=[`provider=${encodeURIComponent(a)}`];if(i!=null&&i.redirectTo&&o.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&o.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[c,d]=await getCodeChallengeAndMethod(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(d)}`});o.push(h.toString())}if(i!=null&&i.queryParams){const c=new URLSearchParams(i.queryParams);o.push(c.toString())}return i!=null&&i.skipBrowserRedirect&&o.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${s}?${o.join("&")}`}async _unenroll(s){try{return await this._useSession(async a=>{var i;const{data:o,error:c}=a;return c?{data:null,error:c}:await _request(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _enroll(s){try{return await this._useSession(async a=>{var i,o;const{data:c,error:d}=a;if(d)return{data:null,error:d};const h=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:{issuer:s.issuer}),{data:g,error:_}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(i=c==null?void 0:c.session)===null||i===void 0?void 0:i.access_token});return _?{data:null,error:_}:(s.factorType==="totp"&&(!((o=g==null?void 0:g.totp)===null||o===void 0)&&o.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var i;const{data:o,error:c}=a;if(c)return{data:null,error:c};const{data:d,error:h}=await _request(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:{code:s.code,challenge_id:s.challengeId},headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:h})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var i;const{data:o,error:c}=a;return c?{data:null,error:c}:await _request(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:{channel:s.channel},headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(s){const{data:a,error:i}=await this._challenge({factorId:s.factorId});return i?{data:null,error:i}:await this._verify({factorId:s.factorId,challengeId:a.id,code:s.code})}async _listFactors(){const{data:{user:s},error:a}=await this.getUser();if(a)return{data:null,error:a};const i=(s==null?void 0:s.factors)||[],o=i.filter(d=>d.factor_type==="totp"&&d.status==="verified"),c=i.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:i,totp:o,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async s=>{var a,i;const{data:{session:o},error:c}=s;if(c)return{data:null,error:c};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=decodeJWT(o.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((i=(a=o.user.factors)===null||a===void 0?void 0:a.filter(j=>j.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(g="aal2");const b=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:b},error:null}}))}async fetchJwk(s,a={keys:[]}){let i=a.keys.find(d=>d.kid===s);if(i||(i=this.jwks.keys.find(d=>d.kid===s),i&&this.jwks_cached_at+JWKS_TTL>Date.now()))return i;const{data:o,error:c}=await _request(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;if(!o.keys||o.keys.length===0)throw new AuthInvalidJwtError("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),i=o.keys.find(d=>d.kid===s),!i)throw new AuthInvalidJwtError("No matching signing key found in JWKS");return i}async getClaims(s,a={keys:[]}){try{let i=s;if(!i){const{data:tt,error:rt}=await this.getSession();if(rt||!tt.session)return{data:null,error:rt};i=tt.session.access_token}const{header:o,payload:c,signature:d,raw:{header:h,payload:g}}=decodeJWT(i);if(validateExp(c.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:tt}=await this.getUser(i);if(tt)throw tt;return{data:{claims:c,header:o,signature:d},error:null}}const _=getAlgorithm(o.alg),b=await this.fetchJwk(o.kid,a),j=await crypto.subtle.importKey("jwk",b,_,!0,["verify"]);if(!await crypto.subtle.verify(_,j,d,stringToUint8Array(`${h}.${g}`)))throw new AuthInvalidJwtError("Invalid JWT signature");return{data:{claims:c,header:o,signature:d},error:null}}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(s){super(s)}}var __awaiter=function(e,s,a,i){function o(c){return c instanceof a?c:new a(function(d){d(c)})}return new(a||(a=Promise))(function(c,d){function h(b){try{_(i.next(b))}catch(j){d(j)}}function g(b){try{_(i.throw(b))}catch(j){d(j)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((i=i.apply(e,s||[])).next())})};class SupabaseClient{constructor(s,a,i){var o,c,d;if(this.supabaseUrl=s,this.supabaseKey=a,!s)throw new Error("supabaseUrl is required.");if(!a)throw new Error("supabaseKey is required.");const h=ensureTrailingSlash(s),g=new URL(h);this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const _=`sb-${g.hostname.split(".")[0]}-auth-token`,b={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:_}),global:DEFAULT_GLOBAL_OPTIONS},j=applySettingDefaults(i??{},b);this.storageKey=(o=j.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(c=j.global.headers)!==null&&c!==void 0?c:{},j.accessToken?(this.accessToken=j.accessToken,this.auth=new Proxy({},{get:(_e,tt)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(tt)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=j.auth)!==null&&d!==void 0?d:{},this.headers,j.global.fetch),this.fetch=fetchWithAuth(a,this._getAccessToken.bind(this),j.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},j.realtime)),this.rest=new PostgrestClient(new URL("rest/v1",g).href,{headers:this.headers,schema:j.db.schema,fetch:this.fetch}),j.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl.href,this.headers,this.fetch)}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,a={},i={}){return this.rest.rpc(s,a,i)}channel(s,a={config:{}}){return this.realtime.channel(s,a)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var s,a;return __awaiter(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:null})}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:a,detectSessionInUrl:i,storage:o,storageKey:c,flowType:d,lock:h,debug:g},_,b){const j={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},j),_),storageKey:c,autoRefreshToken:s,persistSession:a,detectSessionInUrl:i,storage:o,flowType:d,lock:h,debug:g,fetch:b,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(s){return new RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},s),{params:Object.assign({apikey:this.supabaseKey},s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,i)=>{this._handleTokenChanged(a,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(s,a,i){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:s==="SIGNED_OUT"&&(this.realtime.setAuth(),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(e,s,a)=>new SupabaseClient(e,s,a),supabaseUrl="YOUR_SUPABASE_URL",supabaseKey="YOUR_SUPABASE_ANON_KEY";console.log("Connecting to Supabase...");const supabase=createClient(supabaseUrl,supabaseKey,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"}});(async()=>{try{console.log("Testing Supabase connection...");const{data:e,error:s}=await supabase.from("gmail_accounts").select("id").limit(1);if(s)throw console.error("Supabase connection error:",{code:s.code,message:s.message,details:s.details,hint:s.hint}),s.code==="PGRST116"?console.error("Table 'gmail_accounts' does not exist!"):s.code==="invalid_api_key"?console.error("Invalid Supabase API key!"):s.code==="invalid_url"&&console.error("Invalid Supabase URL!"),s;console.log(" Supabase connected successfully!")}catch(e){throw console.error("Supabase initialization failed:",e),e}})();const gmailAccountsTable={getUnusedEmails:async(e,s=10)=>{try{const{data:a,error:i}=await supabase.from("gmail_accounts").select("id, email, status, created_at").eq("status","unused").eq("user_id",e).order("created_at",{ascending:!0}).limit(s);if(i)throw console.error("Error fetching unused emails:",i),i;return a||[]}catch(a){throw console.error("Failed to fetch unused emails:",a),a}},getRecentlyUsedEmails:async(e,s=10)=>{try{const{data:a,error:i}=await supabase.from("gmail_accounts").select("id, email, status, created_at").eq("status","used").eq("user_id",e).order("created_at",{ascending:!1}).limit(s);if(i)throw console.error("Error fetching used emails:",i),i;return a||[]}catch(a){throw console.error("Failed to fetch used emails:",a),a}},updateEmailStatus:async(e,s)=>{try{const{error:a}=await supabase.from("gmail_accounts").update({status:s}).eq("id",e);if(a)throw console.error(`Error updating email status to ${s}:`,a),a;return!0}catch(a){throw console.error(`Failed to update email status to ${s}:`,a),a}},uploadEmails:async(e,s)=>{try{console.log("Uploading emails for user:",s);const a=e.filter(c=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.trim()));if(a.length===0)throw new Error("No valid emails found in the input");const i=100,o=[];for(let c=0;c<a.length;c+=i){const h=a.slice(c,c+i).map(b=>({email:b.trim(),status:"unused",user_id:s})),{data:g,error:_}=await supabase.from("gmail_accounts").insert(h).select();if(_&&(console.error(`Error uploading batch ${c/i+1}:`,_),!_.message.includes("duplicate key")))throw _;g&&o.push(...g)}return o}catch(a){throw console.error("Failed to upload emails:",a),a}},getStatistics:async e=>{try{const s=await Promise.all([supabase.from("gmail_accounts").select("id",{count:"exact",head:!0}).eq("status","unused").eq("user_id",e),supabase.from("gmail_accounts").select("id",{count:"exact",head:!0}).eq("status","used").eq("user_id",e),supabase.from("gmail_accounts").select("id",{count:"exact",head:!0}).eq("status","blacklisted").eq("user_id",e)]),[a,i,o]=s;if(a.error||i.error||o.error){const c=a.error||i.error||o.error;throw console.error("Error fetching statistics:",c),c}return{unused:a.count||0,used:i.count||0,blacklisted:o.count||0,total:(a.count||0)+(i.count||0)+(o.count||0)}}catch(s){throw console.error("Failed to fetch statistics:",s),s}},deleteEmailsByStatus:async(e,s)=>{try{let a=supabase.from("gmail_accounts").delete().eq("user_id",e);s!=="all"&&(a=a.eq("status",s));const{error:i}=await a;if(i)throw console.error("Error deleting emails:",i),i;return!0}catch(a){throw console.error("Failed to delete emails:",a),a}}},apiKeysTable={getAll:async()=>{try{const{data:e,error:s}=await supabase.from("api_keys").select("*").order("created_at",{ascending:!1});if(s)throw console.error("Error fetching API keys:",s),s;return e||[]}catch(e){throw console.error("Failed to fetch API keys:",e),e}},add:async e=>{try{console.log("Adding key to Supabase:",e);const s={...e,expires_at:e.expires_at===null?null:e.expires_at},{data:a,error:i}=await supabase.from("api_keys").insert([s]).select();if(i)throw console.error("Error adding API key:",i),i;return a&&a[0]}catch(s){throw console.error("Failed to add API key:",s),s}},remove:async e=>{try{const{error:s}=await supabase.from("api_keys").delete().eq("id",e);if(s)throw console.error("Error removing API key:",s),s;return!0}catch(s){throw console.error("Failed to remove API key:",s),s}},update:async(e,s)=>{try{const{data:a,error:i}=await supabase.from("api_keys").update(s).eq("id",e).select();if(i)throw console.error("Error updating API key:",i),i;return a&&a[0]}catch(a){throw console.error("Failed to update API key:",a),a}}},ThemeContext=reactExports.createContext(void 0),useTheme=()=>{const e=reactExports.useContext(ThemeContext);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},ThemeProvider=({children:e})=>{const[s,a]=reactExports.useState(()=>{const o=localStorage.getItem("theme"),c=window.matchMedia("(prefers-color-scheme: dark)").matches;return o==="dark"||!o&&c});reactExports.useEffect(()=>{s?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",s?"dark":"light")},[s]);const i=()=>{a(!s)};return jsxRuntimeExports.jsx(ThemeContext.Provider,{value:{isDarkMode:s,toggleDarkMode:i},children:e})},SecurityContext=reactExports.createContext(void 0),useSecurity=()=>{const e=reactExports.useContext(SecurityContext);if(!e)throw new Error("useSecurity must be used within a SecurityProvider");return e};function mapApiKeyFromDb(e){return{id:e.id,key:e.key,name:e.name,deviceId:e.device_id,deviceLocation:e.device_location,createdAt:e.created_at,expiresAt:e.expires_at,isActive:e.is_active,lastUsed:e.last_used}}const SecurityProvider=({children:e})=>{const[s,a]=reactExports.useState(!1),[i,o]=reactExports.useState(null),[c,d]=reactExports.useState([]),[h,g]=reactExports.useState(!0),[_,b]=reactExports.useState(""),[j,_e]=reactExports.useState("warning"),[tt,rt]=reactExports.useState(!1),et=(lt,gt)=>{b(lt),_e(gt),rt(!0)},st=()=>{const lt=document.createElement("canvas"),gt=lt.getContext("2d");gt&&(gt.textBaseline="top",gt.font="14px Arial",gt.fillText("Device fingerprint",2,2));const yt=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),lt.toDataURL(),navigator.hardwareConcurrency||0,navigator.deviceMemory||0].join("|");return sha256Exports.sha256(yt)},at=lt=>lt?new Date>new Date(lt):!1,it=lt=>{if(!lt)return 1/0;const gt=new Date,Tt=new Date(lt).getTime()-gt.getTime(),mt=Math.ceil(Tt/(1e3*60*60*24));return Math.max(0,mt)};reactExports.useEffect(()=>{(async()=>{try{g(!0);const gt=sessionStorage.getItem("isAuthenticated"),yt=sessionStorage.getItem("currentProfile");if(gt==="true"&&yt)try{const Tt=JSON.parse(yt);if(at(Tt.expiresAt))console.warn("Stored key expired"),ot();else{const mt=(await apiKeysTable.getAll()).map(mapApiKeyFromDb);d(mt),mt.find(Ft=>Ft.id===Tt.id&&Ft.isActive)?(a(!0),o({...Tt,isExpired:!1,daysUntilExpiry:it(Tt.expiresAt)})):(console.warn("Stored key no longer valid"),ot())}}catch(Tt){console.error("Failed to parse saved profile",Tt),ot()}else{const Tt=(await apiKeysTable.getAll()).map(mapApiKeyFromDb);d(Tt)}}catch(gt){console.error("Failed to initialize security context",gt),d([]),ot()}finally{g(!1)}})()},[]);const nt=async lt=>{g(!0);try{const gt=st(),[yt,Tt]=await getDeviceLocation();Tt&&console.warn("Location service unavailable during login");let mt=c;if(!mt.length)try{mt=(await apiKeysTable.getAll()).map(mapApiKeyFromDb),d(mt)}catch(Ft){return console.error("Failed to fetch API keys from Supabase",Ft),!1}const Et=mt.find(Ft=>Ft.key===lt&&Ft.isActive);if(Et){if(at(Et.expiresAt))return alert("This access key has expired!"),!1;if(Et.deviceId===""||Et.deviceId===gt){Et.deviceId===""?await apiKeysTable.update(Et.id,{device_id:gt,last_used:new Date().toISOString()}):await apiKeysTable.update(Et.id,{last_used:new Date().toISOString()});const Ft={id:Et.id,name:Et.name,deviceId:gt,deviceLocation:yt,createdAt:Et.createdAt,expiresAt:Et.expiresAt,lastUsed:new Date().toISOString(),isExpired:!1,daysUntilExpiry:it(Et.expiresAt)};return o(Ft),a(!0),sessionStorage.setItem("isAuthenticated","true"),sessionStorage.setItem("currentProfile",JSON.stringify(Ft)),!0}else alert("This key is bound to a different device!")}return!1}finally{g(!1)}},ot=()=>{a(!1),o(null),sessionStorage.removeItem("isAuthenticated"),sessionStorage.removeItem("currentProfile")},dt=async(lt,gt,yt)=>{const[Tt,mt]=await getDeviceLocation();mt&&console.warn("Location service unavailable when adding key");const Et={key:lt,name:gt,device_id:"",device_location:Tt,created_at:new Date().toISOString(),expires_at:yt,is_active:!0};try{await apiKeysTable.add(Et);const Ft=(await apiKeysTable.getAll()).map(mapApiKeyFromDb);d(Ft)}catch(Ft){throw console.error("Error adding API key:",Ft),Ft}},ht=async lt=>{await apiKeysTable.remove(lt);const gt=(await apiKeysTable.getAll()).map(mapApiKeyFromDb);d(gt)};return jsxRuntimeExports.jsxs(SecurityContext.Provider,{value:{isAuthenticated:s,currentProfile:i,isLoading:h,login:nt,logout:ot,apiKeys:c,addApiKey:dt,removeApiKey:ht,getDeviceFingerprint:st,triggerSecurityPopup:et},children:[e,tt&&jsxRuntimeExports.jsx(SecurityPopup,{show:tt,message:_,type:j,onClose:()=>rt(!1)})]})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,s)=>{const a=reactExports.forwardRef(({color:i="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:h="",children:g,..._},b)=>reactExports.createElement("svg",{ref:b,...defaultAttributes,width:o,height:o,stroke:i,strokeWidth:d?Number(c)*24/Number(o):c,className:["lucide",`lucide-${toKebabCase(e)}`,h].join(" "),..._},[...s.map(([j,_e])=>reactExports.createElement(j,_e)),...Array.isArray(g)?g:[g]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertCircle=createLucideIcon("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertTriangle=createLucideIcon("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowUpDown=createLucideIcon("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AtSign=createLucideIcon("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BarChart3=createLucideIcon("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Copy=createLucideIcon("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Database=createLucideIcon("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EyeOff=createLucideIcon("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=createLucideIcon("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const File$1=createLucideIcon("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Globe=createLucideIcon("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Home=createLucideIcon("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Key=createLucideIcon("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lock=createLucideIcon("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LogOut=createLucideIcon("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mail=createLucideIcon("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MapPin=createLucideIcon("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Monitor=createLucideIcon("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Moon=createLucideIcon("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pen=createLucideIcon("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Phone=createLucideIcon("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RefreshCw=createLucideIcon("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RotateCcw=createLucideIcon("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Save=createLucideIcon("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Shield=createLucideIcon("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Shuffle=createLucideIcon("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SkipForward=createLucideIcon("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Smartphone=createLucideIcon("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sun=createLucideIcon("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ToggleLeft=createLucideIcon("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ToggleRight=createLucideIcon("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash2=createLucideIcon("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Type=createLucideIcon("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const User=createLucideIcon("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Users=createLucideIcon("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ProLogo=({size:e="md",variant:s="light"})=>{const a={sm:"h-6",md:"h-8",lg:"h-12",xl:"h-16"},i={light:{primary:"text-white",secondary:"text-pro-purple-200"},dark:{primary:"text-gray-800",secondary:"text-pro-purple-600"}};return jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("svg",{className:`${a[e]} ${i[s].primary}`,viewBox:"0 0 50 50",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M25 5C15.6 5 8 12.6 8 22C8 29.3 13.4 35.5 20.5 37.3L25 45L29.5 37.3C36.6 35.5 42 29.3 42 22C42 12.6 34.4 5 25 5ZM25 10C31.6 10 37 15.4 37 22C37 28.6 31.6 34 25 34C18.4 34 13 28.6 13 22C13 15.4 18.4 10 25 10Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M25 15C21.1 15 18 18.1 18 22C18 25.9 21.1 29 25 29C28.9 29 32 25.9 32 22C32 18.1 28.9 15 25 15Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M32 18L38 12",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 transform translate-x-1/4 -translate-y-1/4",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:jsxRuntimeExports.jsx("svg",{className:`${e==="sm"?"h-3":e==="md"?"h-4":e==="lg"?"h-6":"h-8"} ${i[s].primary}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M7 11L12 6L17 11M12 18V7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),jsxRuntimeExports.jsxs("div",{className:`ml-2 font-bold ${e==="sm"?"text-lg":e==="md"?"text-xl":e==="lg"?"text-2xl":"text-3xl"}`,style:{textShadow:s==="light"?"0 2px 4px rgba(0,0,0,0.2)":"none"},children:[jsxRuntimeExports.jsx("span",{className:i[s].primary,children:"B"}),jsxRuntimeExports.jsx("span",{className:i[s].secondary,children:"Tools"})]})]})},LoadingSpinner=({size:e="md",className:s=""})=>{const a={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return jsxRuntimeExports.jsx("div",{className:`inline-block ${s}`,children:jsxRuntimeExports.jsx("div",{className:`${a[e]} animate-spin`,children:jsxRuntimeExports.jsx("div",{className:"h-full w-full border-4 border-gray-200 rounded-full border-t-blue-600 dark:border-gray-700 dark:border-t-blue-500"})})})},LoginPage=()=>{const[e,s]=reactExports.useState(""),[a,i]=reactExports.useState(!1),[o,c]=reactExports.useState("success"),[d,h]=reactExports.useState(""),{login:g,isLoading:_}=useSecurity(),{isDarkMode:b}=useTheme();if(_)return jsxRuntimeExports.jsx("div",{className:`min-h-screen flex items-center justify-center p-4 ${b?"bg-gradient-to-br from-gray-900 to-gray-800":"bg-pro-gradient"}`,children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(LoadingSpinner,{size:"lg",className:"mb-4"}),jsxRuntimeExports.jsx("p",{className:`text-lg ${b?"text-white":"text-gray-800"}`,children:"Initializing B Tools..."})]})});const j=async rt=>{if(rt.preventDefault(),!e.trim()){_e("Please enter an access key!","warning");return}await g(e)?(_e("Login Successful! Welcome to B Tools!","success"),setTimeout(()=>{i(!1)},2e3)):(_e("Invalid Access Key! Please try again.","error"),s(""))},_e=(rt,et)=>{h(rt),c(et),i(!0)},tt=()=>{_e("Redirecting to Telegram for access key...","success"),setTimeout(()=>{window.open("https://t.me/muthassimbilla","_blank"),i(!1)},1500)};return jsxRuntimeExports.jsxs("div",{className:`min-h-screen flex items-center justify-center p-4 ${b?"bg-gradient-to-br from-gray-900 to-gray-800":"bg-pro-gradient"}`,children:[jsxRuntimeExports.jsxs("div",{className:"max-w-md w-full",children:[jsxRuntimeExports.jsxs("div",{className:`${b?"bg-slate-800/80 border-slate-700/20":"bg-white/80 border-white/20"} backdrop-blur-lg rounded-xl sm:rounded-2xl shadow-2xl p-6 sm:p-8 border`,children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-4",children:jsxRuntimeExports.jsx(ProLogo,{size:"lg",variant:b?"light":"dark"})}),jsxRuntimeExports.jsx("p",{className:`${b?"text-slate-300":"text-gray-600"} mt-2 text-sm sm:text-base`,children:"Professional Development Utilities"}),jsxRuntimeExports.jsx("p",{className:`text-xs sm:text-sm ${b?"text-slate-400":"text-gray-500"} mt-1`,children:"Enter your access key to continue"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:j,className:"space-y-4 sm:space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:jsxRuntimeExports.jsx(Key,{className:`h-4 w-4 sm:h-5 sm:w-5 ${b?"text-slate-400":"text-gray-400"}`})}),jsxRuntimeExports.jsx("input",{type:"password",value:e,onChange:rt=>s(rt.target.value),className:`block w-full pl-8 sm:pl-10 pr-3 py-2 sm:py-3 ${b?"border-slate-600 bg-slate-700/50 text-white focus:ring-pro-purple-400":"border-gray-300 bg-white/50 text-gray-900 focus:ring-pro-purple-500"} rounded-lg sm:rounded-xl focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200 backdrop-blur-sm text-sm sm:text-base`,placeholder:"Enter your access key",autoComplete:"off"})]}),jsxRuntimeExports.jsxs("button",{type:"submit",disabled:_,className:`w-full flex items-center justify-center px-4 py-2 sm:py-3 bg-gradient-to-r from-pro-purple-500 to-pro-purple-700 text-white font-semibold rounded-lg sm:rounded-xl hover:from-pro-purple-600 hover:to-pro-purple-800 focus:outline-none focus:ring-2 focus:ring-pro-purple-500 focus:ring-offset-2 transform hover:scale-105 transition-all duration-200 shadow-lg text-sm sm:text-base ${_?"opacity-75 cursor-not-allowed":""}`,children:[_?jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm",className:"mr-2"}):jsxRuntimeExports.jsx(Lock,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2"}),_?"Accessing...":"Access B Tools"]})]}),jsxRuntimeExports.jsx("div",{className:"mt-4 sm:mt-6 text-center",children:jsxRuntimeExports.jsxs("button",{onClick:tt,className:"text-pro-purple-400 hover:text-pro-purple-300 font-medium transition-colors duration-200 flex items-center justify-center mx-auto text-sm sm:text-base",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Need an access key?"]})})]}),jsxRuntimeExports.jsxs("div",{className:`mt-4 sm:mt-6 ${b?"bg-slate-800/60 border-slate-700/20":"bg-white/60 border-white/20"} backdrop-blur-lg rounded-lg sm:rounded-xl p-4 sm:p-6 border`,children:[jsxRuntimeExports.jsx("h3",{className:`text-base sm:text-lg font-semibold ${b?"text-white":"text-gray-800"} mb-3 sm:mb-4 text-center`,children:"Available Tools"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 text-xs sm:text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-pro-purple-500 rounded-full flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:`${b?"text-slate-300":"text-gray-700"}`,children:"Email Extractor"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-pro-purple-600 rounded-full flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:`${b?"text-slate-300":"text-gray-700"}`,children:"Duplicate Remover"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-pro-purple-400 rounded-full flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:`${b?"text-slate-300":"text-gray-700"}`,children:"User Agent Mixer"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-pro-purple-700 rounded-full flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:`${b?"text-slate-300":"text-gray-700"}`,children:"UA Generator"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-pro-purple-300 rounded-full flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:`${b?"text-slate-300":"text-gray-700"}`,children:"Text Formatter"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-pro-purple-800 rounded-full flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:`${b?"text-slate-300":"text-gray-700"}`,children:"Password Generator"})]})]})]}),jsxRuntimeExports.jsx("div",{className:`mt-4 sm:mt-6 ${b?"bg-slate-800 border-slate-700":"bg-pro-purple-50 border-pro-purple-200"} rounded-lg sm:rounded-xl p-3 sm:p-4 border`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:`w-4 h-4 sm:w-5 sm:h-5 ${b?"text-pro-purple-400":"text-pro-purple-600"} mt-0.5 mr-2 flex-shrink-0`}),jsxRuntimeExports.jsxs("div",{className:`text-xs sm:text-sm ${b?"text-slate-300":"text-pro-purple-800"}`,children:[jsxRuntimeExports.jsx("p",{className:"font-semibold mb-1",children:"Security Notice:"}),jsxRuntimeExports.jsx("p",{children:"This application is protected by advanced security measures. Unauthorized access attempts are monitored."})]})]})})]}),a&&jsxRuntimeExports.jsx(SecurityPopup,{show:a,message:d,type:o,onClose:()=>i(!1)})]})},HomePage=()=>{const{isDarkMode:e}=useTheme(),s=[{id:"email-extractor",title:"Email Extractor",description:"Extract and validate email addresses from any text with advanced filtering options.",icon:Mail,color:"from-blue-500 to-blue-600",hoverColor:"hover:from-blue-600 hover:to-blue-700",path:"/email-extractor",features:["Bulk extraction","Domain filtering","Export to Excel/TXT"]},{id:"duplicate-remover",title:"Duplicate Remover",description:"Remove duplicate lines and organize your data with intelligent sorting algorithms.",icon:Copy,color:"from-purple-500 to-purple-600",hoverColor:"hover:from-purple-600 hover:to-purple-700",path:"/duplicate-remover",features:["Smart deduplication","Alphabetical sorting","Statistics tracking"]},{id:"user-agent-mixer",title:"User Agent Mixer",description:"Mix and randomize user agents from different devices for testing purposes.",icon:Shuffle,color:"from-green-500 to-green-600",hoverColor:"hover:from-green-600 hover:to-green-700",path:"/user-agent-mixer",features:["Device categorization","Random mixing","Bulk import/export"]},{id:"user-agent-generator",title:"User Agent Generator",description:"Generate realistic user agents for iPhone and Samsung devices with authentic patterns.",icon:Smartphone,color:"from-indigo-500 to-indigo-600",hoverColor:"hover:from-indigo-600 hover:to-indigo-700",path:"/user-agent-generator",features:["iPhone & Samsung support","Realistic patterns","Bulk generation"]},{id:"text-formatter",title:"Text Formatter",description:"Format, clean, and transform text with multiple formatting options.",icon:Type,color:"from-orange-500 to-orange-600",hoverColor:"hover:from-orange-600 hover:to-orange-700",path:"/text-formatter",features:["Case conversion","Text cleaning","Format validation"]},{id:"password-generator",title:"Password Generator",description:"Generate secure passwords with customizable length and character sets.",icon:Key,color:"from-red-500 to-red-600",hoverColor:"hover:from-red-600 hover:to-red-700",path:"/password-generator",features:["Customizable length","Character options","Strength meter"]},{id:"email-alias-manager",title:"Email Alias Manager",description:"Create and manage email aliases with Firebase integration for secure storage.",icon:Database,color:"from-cyan-500 to-cyan-600",hoverColor:"hover:from-cyan-600 hover:to-cyan-700",path:"/email-alias-manager",features:["Firebase integration","Google Auth","Secure storage"]},{id:"us-address-generator",title:"US Address Generator",description:"Generate real US addresses by ZIP code using official Census Bureau data.",icon:MapPin,color:"from-emerald-500 to-emerald-600",hoverColor:"hover:from-emerald-600 hover:to-emerald-700",path:"/us-address-generator",features:["Real Census data","ZIP code lookup","Copy components"]},{id:"gmail-manager",title:"Gmail Manager",description:"Upload, generate and track Gmail accounts with automatic status management.",icon:AtSign,color:"from-pink-500 to-pink-600",hoverColor:"hover:from-pink-600 hover:to-pink-700",path:"/gmail-manager",features:["Supabase integration","Status tracking","One-click generation"]}];return jsxRuntimeExports.jsx("div",{className:"min-h-screen",children:jsxRuntimeExports.jsx("section",{className:"py-6 sm:py-12 md:py-20 px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-6 sm:mb-12",children:[jsxRuntimeExports.jsx("h2",{className:`text-2xl sm:text-3xl md:text-4xl font-bold ${e?"text-white":"text-gray-900"} mb-2 sm:mb-4`,children:"Powerful Tools at Your Fingertips"}),jsxRuntimeExports.jsx("p",{className:`text-sm sm:text-base md:text-xl ${e?"text-gray-300":"text-gray-600"} max-w-3xl mx-auto px-4`,children:"Choose from our collection of professional-grade tools designed to streamline your workflow."})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 md:gap-6 lg:gap-8",children:s.map(a=>jsxRuntimeExports.jsxs(Link,{to:a.path,className:`group relative ${e?"bg-gray-800 border-gray-700":"bg-white/80 border-white/20"} backdrop-blur-lg rounded-lg sm:rounded-xl md:rounded-2xl p-3 sm:p-4 md:p-6 lg:p-8 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[jsxRuntimeExports.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${a.color} opacity-0 group-hover:opacity-10 rounded-lg sm:rounded-xl md:rounded-2xl transition-opacity duration-300`}),jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsx("div",{className:`inline-flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-gradient-to-r ${a.color} text-white shadow-lg mb-3 sm:mb-4`,children:jsxRuntimeExports.jsx(a.icon,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),jsxRuntimeExports.jsx("h3",{className:`text-base sm:text-lg md:text-xl font-semibold mb-2 ${e?"text-white":"text-gray-900"}`,children:a.title}),jsxRuntimeExports.jsx("p",{className:`text-xs sm:text-sm md:text-base mb-3 sm:mb-4 ${e?"text-gray-300":"text-gray-600"}`,children:a.description}),jsxRuntimeExports.jsx("div",{className:"space-y-1 sm:space-y-2",children:a.features.map((i,o)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:`w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full bg-gradient-to-r ${a.color}`}),jsxRuntimeExports.jsx("span",{className:`text-xs sm:text-sm ${e?"text-gray-400":"text-gray-500"}`,children:i})]},o))})]})]},a.id))})]})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var s=[],a=0,i=e.length;a<i;++a)s[a]=e.charCodeAt(a);return s}function utf16leread(e){for(var s=[],a=0;a<e.length>>1;++a)s[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return s.join("")}function utf16beread(e){for(var s=[],a=0;a<e.length>>1;++a)s[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return s.join("")}var debom=function(e){var s=e.charCodeAt(0),a=e.charCodeAt(1);return s==255&&a==254?utf16leread(e.slice(2)):s==254&&a==255?utf16beread(e.slice(2)):s==65279?e.slice(1):e},_getchar=function e(s){return String.fromCharCode(s)},_getansi=function e(s){return String.fromCharCode(s)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var s="",a=0,i=0,o=0,c=0,d=0,h=0,g=0,_=0;_<e.length;)a=e.charCodeAt(_++),c=a>>2,i=e.charCodeAt(_++),d=(a&3)<<4|i>>4,o=e.charCodeAt(_++),h=(i&15)<<2|o>>6,g=o&63,isNaN(i)?h=g=64:isNaN(o)&&(g=64),s+=Base64_map.charAt(c)+Base64_map.charAt(d)+Base64_map.charAt(h)+Base64_map.charAt(g);return s}function Base64_decode(e){var s="",a=0,i=0,o=0,c=0,d=0,h=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var _=0;_<e.length;)c=Base64_map.indexOf(e.charAt(_++)),d=Base64_map.indexOf(e.charAt(_++)),a=c<<2|d>>4,s+=String.fromCharCode(a),h=Base64_map.indexOf(e.charAt(_++)),i=(d&15)<<4|h>>2,h!==64&&(s+=String.fromCharCode(i)),g=Base64_map.indexOf(e.charAt(_++)),o=(h&3)<<6|g,g!==64&&(s+=String.fromCharCode(o));return s}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(s,a){return a?new Buffer(s,a):new Buffer(s)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function e(s){return has_buf?Buffer_from(s,"binary"):s.split("").map(function(a){return a.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var s=new ArrayBuffer(e.length),a=new Uint8Array(s),i=0;i!=e.length;++i)a[i]=e.charCodeAt(i)&255;return s}function a2s(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var s=[],a=0;a<e.length;++a)s[a]=String.fromCharCode(e[a]);return s.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var s=new Array(e.length),a=0;a<e.length;++a)s[a]=e[a];return s}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(s){return Buffer.isBuffer(s)?s:Buffer_from(s)}))}:function(e){if(typeof Uint8Array<"u"){var s=0,a=0;for(s=0;s<e.length;++s)a+=e[s].length;var i=new Uint8Array(a),o=0;for(s=0,a=0;s<e.length;a+=o,++s)if(o=e[s].length,e[s]instanceof Uint8Array)i.set(e[s],a);else{if(typeof e[s]=="string")throw"wtf";i.set(new Uint8Array(e[s]),a)}return i}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function utf8decode(e){for(var s=[],a=0,i=e.length+250,o=new_raw_buf(e.length+255),c=0;c<e.length;++c){var d=e.charCodeAt(c);if(d<128)o[a++]=d;else if(d<2048)o[a++]=192|d>>6&31,o[a++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var h=e.charCodeAt(++c)&1023;o[a++]=240|d>>8&7,o[a++]=128|d>>2&63,o[a++]=128|h>>6&15|(d&3)<<4,o[a++]=128|h&63}else o[a++]=224|d>>12&15,o[a++]=128|d>>6&63,o[a++]=128|d&63;a>i&&(s.push(o.slice(0,a)),a=0,o=new_raw_buf(65535),i=65530)}return s.push(o.slice(0,a)),bconcat(s)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var s="",a=e.length-1;a>=0;)s+=e.charAt(a--);return s}function pad0(e,s){var a=""+e;return a.length>=s?a:fill("0",s-a.length)+a}function pad_(e,s){var a=""+e;return a.length>=s?a:fill(" ",s-a.length)+a}function rpad_(e,s){var a=""+e;return a.length>=s?a:a+fill(" ",s-a.length)}function pad0r1(e,s){var a=""+Math.round(e);return a.length>=s?a:fill("0",s-a.length)+a}function pad0r2(e,s){var a=""+e;return a.length>=s?a:fill("0",s-a.length)+a}var p2_32=Math.pow(2,32);function pad0r(e,s){if(e>p2_32||e<-p2_32)return pad0r1(e,s);var a=Math.round(e);return pad0r2(a,s)}function SSF_isgeneral(e,s){return s=s||0,e.length>=7+s&&(e.charCodeAt(s)|32)===103&&(e.charCodeAt(s+1)|32)===101&&(e.charCodeAt(s+2)|32)===110&&(e.charCodeAt(s+3)|32)===101&&(e.charCodeAt(s+4)|32)===114&&(e.charCodeAt(s+5)|32)===97&&(e.charCodeAt(s+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,s,a){for(var i=e<0?-1:1,o=e*i,c=0,d=1,h=0,g=1,_=0,b=0,j=Math.floor(o);_<s&&(j=Math.floor(o),h=j*d+c,b=j*_+g,!(o-j<5e-8));)o=1/(o-j),c=d,d=h,g=_,_=b;if(b>s&&(_>s?(b=g,h=c):(b=_,h=d)),!a)return[0,i*h,b];var _e=Math.floor(i*h/b);return[_e,i*h-_e*b,b]}function SSF_parse_date_code(e,s,a){if(e>2958465||e<0)return null;var i=e|0,o=Math.floor(86400*(e-i)),c=0,d=[],h={D:i,T:o,u:86400*(e-i)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),s&&s.date1904&&(i+=1462),h.u>.9999&&(h.u=0,++o==86400&&(h.T=o=0,++i,++h.D)),i===60)d=a?[1317,10,29]:[1900,2,29],c=3;else if(i===0)d=a?[1317,8,29]:[1900,1,0],c=6;else{i>60&&--i;var g=new Date(1900,0,1);g.setDate(g.getDate()+i-1),d=[g.getFullYear(),g.getMonth()+1,g.getDate()],c=g.getDay(),i<60&&(c=(c+6)%7),a&&(c=SSF_fix_hijri(g,d))}return h.y=d[0],h.m=d[1],h.d=d[2],h.S=o%60,o=Math.floor(o/60),h.M=o%60,o=Math.floor(o/60),h.H=o,h.q=c,h}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,s){var a=e.getTime();return s?a-=1461*24*60*60*1e3:e>=SSFbase1904&&(a+=24*60*60*1e3),(a-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var s=e<0?12:11,a=SSF_strip_decimal(e.toFixed(12));return a.length<=s||(a=e.toPrecision(10),a.length<=s)?a:e.toExponential(5)}function SSF_large_exp(e){var s=SSF_strip_decimal(e.toFixed(11));return s.length>(e<0?12:11)||s==="0"||s==="-0"?e.toPrecision(6):s}function SSF_general_num(e){var s=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return s>=-4&&s<=-1?a=e.toPrecision(10+s):Math.abs(s)<=9?a=SSF_small_exp(e):s===10?a=e.toFixed(10).substr(0,12):a=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(a.toUpperCase()))}function SSF_general(e,s){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,s){s[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function SSF_write_date(e,s,a,i){var o="",c=0,d=0,h=a.y,g,_=0;switch(e){case 98:h=a.y+543;case 121:switch(s.length){case 1:case 2:g=h%100,_=2;break;default:g=h%1e4,_=4;break}break;case 109:switch(s.length){case 1:case 2:g=a.m,_=s.length;break;case 3:return months[a.m-1][1];case 5:return months[a.m-1][0];default:return months[a.m-1][2]}break;case 100:switch(s.length){case 1:case 2:g=a.d,_=s.length;break;case 3:return days[a.q][0];default:return days[a.q][1]}break;case 104:switch(s.length){case 1:case 2:g=1+(a.H+11)%12,_=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:g=a.H,_=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:g=a.M,_=s.length;break;default:throw"bad minute format: "+s}break;case 115:if(s!="s"&&s!="ss"&&s!=".0"&&s!=".00"&&s!=".000")throw"bad second format: "+s;return a.u===0&&(s=="s"||s=="ss")?pad0(a.S,s.length):(i>=2?d=i===3?1e3:100:d=i===1?10:1,c=Math.round(d*(a.S+a.u)),c>=60*d&&(c=0),s==="s"?c===0?"0":""+c/d:(o=pad0(c,2+i),s==="ss"?o.substr(0,2):"."+o.substr(2,s.length-1)));case 90:switch(s){case"[h]":case"[hh]":g=a.D*24+a.H;break;case"[m]":case"[mm]":g=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":g=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+s}_=s.length===3?1:2;break;case 101:g=h,_=1;break}var b=_>0?pad0(g,_):"";return b}function commaify(e){var s=3;if(e.length<=s)return e;for(var a=e.length%s,i=e.substr(0,a);a!=e.length;a+=s)i+=(i.length>0?",":"")+e.substr(a,s);return i}var pct1=/%/g;function write_num_pct(e,s,a){var i=s.replace(pct1,""),o=s.length-i.length;return write_num(e,i,a*Math.pow(10,2*o))+fill("%",o)}function write_num_cm(e,s,a){for(var i=s.length-1;s.charCodeAt(i-1)===44;)--i;return write_num(e,s.substr(0,i),a/Math.pow(10,3*(s.length-i)))}function write_num_exp(e,s){var a,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+write_num_exp(e,-s);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(s)*Math.LOG10E)%o;if(c<0&&(c+=o),a=(s/Math.pow(10,c)).toPrecision(i+1+(o+c)%o),a.indexOf("e")===-1){var d=Math.floor(Math.log(s)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(d-a.length+c):a+="E+"+(d-c);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,o)+"."+a.substr(2+o),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,_,b){return g+_+b.substr(0,(o+c)%o)+"."+b.substr(c)+"E"})}else a=s.toExponential(i);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,s,a){var i=parseInt(e[4],10),o=Math.round(s*i),c=Math.floor(o/i),d=o-c*i,h=i;return a+(c===0?"":""+c)+" "+(d===0?fill(" ",e[1].length+1+e[4].length):pad_(d,e[1].length)+e[2]+"/"+e[3]+pad0(h,e[4].length))}function write_num_f2(e,s,a){return a+(s===0?"":""+s)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var s="",a,i=0;i!=e.length;++i)switch(a=e.charCodeAt(i)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(a)}return s}function rnd(e,s){var a=Math.pow(10,s);return""+Math.round(e*a)/a}function dec(e,s){var a=e-Math.floor(e),i=Math.pow(10,s);return s<(""+Math.round(a*i)).length?0:Math.round(a*i)}function carry(e,s){return s<(""+Math.round((e-Math.floor(e))*Math.pow(10,s))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,s,a){if(e.charCodeAt(0)===40&&!s.match(closeparen)){var i=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?write_num_flt("n",i,a):"("+write_num_flt("n",i,-a)+")"}if(s.charCodeAt(s.length-1)===44)return write_num_cm(e,s,a);if(s.indexOf("%")!==-1)return write_num_pct(e,s,a);if(s.indexOf("E")!==-1)return write_num_exp(s,a);if(s.charCodeAt(0)===36)return"$"+write_num_flt(e,s.substr(s.charAt(1)==" "?2:1),a);var o,c,d,h,g=Math.abs(a),_=a<0?"-":"";if(s.match(/^00+$/))return _+pad0r(g,s.length);if(s.match(/^[#?]+$/))return o=pad0r(a,0),o==="0"&&(o=""),o.length>s.length?o:hashq(s.substr(0,s.length-o.length))+o;if(c=s.match(frac1))return write_num_f1(c,g,_);if(s.match(/^#+0+$/))return _+pad0r(g,s.length-s.indexOf("0"));if(c=s.match(dec1))return o=rnd(a,c[1].length).replace(/^([^\.]+)$/,"$1."+hashq(c[1])).replace(/\.$/,"."+hashq(c[1])).replace(/\.(\d*)$/,function(rt,et){return"."+et+fill("0",hashq(c[1]).length-et.length)}),s.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),c=s.match(/^(0*)\.(#*)$/))return _+rnd(g,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=s.match(/^#{1,3},##0(\.?)$/))return _+commaify(pad0r(g,0));if(c=s.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+write_num_flt(e,s,-a):commaify(""+(Math.floor(a)+carry(a,c[1].length)))+"."+pad0(dec(a,c[1].length),c[1].length);if(c=s.match(/^#,#*,#0/))return write_num_flt(e,s.replace(/^#,#*,/,""),a);if(c=s.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_flt(e,s.replace(/[\\-]/g,""),a)),d=0,_strrev(_strrev(s.replace(/\\/g,"")).replace(/[0#]/g,function(rt){return d<o.length?o.charAt(d++):rt==="0"?"0":""}));if(s.match(phone))return o=write_num_flt(e,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var b="";if(c=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(c[4].length,7),h=SSF_frac(g,Math.pow(10,d)-1,!1),o=""+_,b=write_num("n",c[1],h[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),o+=b+c[2]+"/"+c[3],b=rpad_(h[2],d),b.length<c[4].length&&(b=hashq(c[4].substr(c[4].length-b.length))+b),o+=b,o;if(c=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(c[1].length,c[4].length),7),h=SSF_frac(g,Math.pow(10,d)-1,!0),_+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pad_(h[1],d)+c[2]+"/"+c[3]+rpad_(h[2],d):fill(" ",2*d+1+c[2].length+c[3].length));if(c=s.match(/^[#0?]+$/))return o=pad0r(a,0),s.length<=o.length?o:hashq(s.substr(0,s.length-o.length))+o;if(c=s.match(/^([#0?]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var j=s.indexOf(".")-d,_e=s.length-o.length-j;return hashq(s.substr(0,j)+o+s.substr(s.length-_e))}if(c=s.match(/^00,000\.([#0]*0)$/))return d=dec(a,c[1].length),a<0?"-"+write_num_flt(e,s,-a):commaify(flr(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(rt){return"00,"+(rt.length<3?pad0(0,3-rt.length):"")+rt})+"."+pad0(d,c[1].length);switch(s){case"###,##0.00":return write_num_flt(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var tt=commaify(pad0r(g,0));return tt!=="0"?_+tt:"";case"###,###.00":return write_num_flt(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+s+"|")}function write_num_cm2(e,s,a){for(var i=s.length-1;s.charCodeAt(i-1)===44;)--i;return write_num(e,s.substr(0,i),a/Math.pow(10,3*(s.length-i)))}function write_num_pct2(e,s,a){var i=s.replace(pct1,""),o=s.length-i.length;return write_num(e,i,a*Math.pow(10,2*o))+fill("%",o)}function write_num_exp2(e,s){var a,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+write_num_exp2(e,-s);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(s)*Math.LOG10E)%o;if(c<0&&(c+=o),a=(s/Math.pow(10,c)).toPrecision(i+1+(o+c)%o),!a.match(/[Ee]/)){var d=Math.floor(Math.log(s)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(d-a.length+c):a+="E+"+(d-c),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,_,b){return g+_+b.substr(0,(o+c)%o)+"."+b.substr(c)+"E"})}else a=s.toExponential(i);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function write_num_int(e,s,a){if(e.charCodeAt(0)===40&&!s.match(closeparen)){var i=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?write_num_int("n",i,a):"("+write_num_int("n",i,-a)+")"}if(s.charCodeAt(s.length-1)===44)return write_num_cm2(e,s,a);if(s.indexOf("%")!==-1)return write_num_pct2(e,s,a);if(s.indexOf("E")!==-1)return write_num_exp2(s,a);if(s.charCodeAt(0)===36)return"$"+write_num_int(e,s.substr(s.charAt(1)==" "?2:1),a);var o,c,d,h,g=Math.abs(a),_=a<0?"-":"";if(s.match(/^00+$/))return _+pad0(g,s.length);if(s.match(/^[#?]+$/))return o=""+a,a===0&&(o=""),o.length>s.length?o:hashq(s.substr(0,s.length-o.length))+o;if(c=s.match(frac1))return write_num_f2(c,g,_);if(s.match(/^#+0+$/))return _+pad0(g,s.length-s.indexOf("0"));if(c=s.match(dec1))return o=(""+a).replace(/^([^\.]+)$/,"$1."+hashq(c[1])).replace(/\.$/,"."+hashq(c[1])),o=o.replace(/\.(\d*)$/,function(rt,et){return"."+et+fill("0",hashq(c[1]).length-et.length)}),s.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),c=s.match(/^(0*)\.(#*)$/))return _+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=s.match(/^#{1,3},##0(\.?)$/))return _+commaify(""+g);if(c=s.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+write_num_int(e,s,-a):commaify(""+a)+"."+fill("0",c[1].length);if(c=s.match(/^#,#*,#0/))return write_num_int(e,s.replace(/^#,#*,/,""),a);if(c=s.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_int(e,s.replace(/[\\-]/g,""),a)),d=0,_strrev(_strrev(s.replace(/\\/g,"")).replace(/[0#]/g,function(rt){return d<o.length?o.charAt(d++):rt==="0"?"0":""}));if(s.match(phone))return o=write_num_int(e,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var b="";if(c=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(c[4].length,7),h=SSF_frac(g,Math.pow(10,d)-1,!1),o=""+_,b=write_num("n",c[1],h[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),o+=b+c[2]+"/"+c[3],b=rpad_(h[2],d),b.length<c[4].length&&(b=hashq(c[4].substr(c[4].length-b.length))+b),o+=b,o;if(c=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(c[1].length,c[4].length),7),h=SSF_frac(g,Math.pow(10,d)-1,!0),_+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pad_(h[1],d)+c[2]+"/"+c[3]+rpad_(h[2],d):fill(" ",2*d+1+c[2].length+c[3].length));if(c=s.match(/^[#0?]+$/))return o=""+a,s.length<=o.length?o:hashq(s.substr(0,s.length-o.length))+o;if(c=s.match(/^([#0]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var j=s.indexOf(".")-d,_e=s.length-o.length-j;return hashq(s.substr(0,j)+o+s.substr(s.length-_e))}if(c=s.match(/^00,000\.([#0]*0)$/))return a<0?"-"+write_num_int(e,s,-a):commaify(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(rt){return"00,"+(rt.length<3?pad0(0,3-rt.length):"")+rt})+"."+pad0(0,c[1].length);switch(s){case"###,###":case"##,###":case"#,###":var tt=commaify(""+g);return tt!=="0"?_+tt:"";default:if(s.match(/\.[0#?]*$/))return write_num_int(e,s.slice(0,s.lastIndexOf(".")),a)+hashq(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}function write_num(e,s,a){return(a|0)===a?write_num_int(e,s,a):write_num_flt(e,s,a)}function SSF_split_fmt(e){for(var s=[],a=!1,i=0,o=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:a=!a;break;case 95:case 42:case 92:++i;break;case 59:s[s.length]=e.substr(o,i-o),o=i+1}if(s[s.length]=e.substr(o),a===!0)throw new Error("Format |"+e+"| unterminated string ");return s}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var s=0,a="",i="";s<e.length;)switch(a=e.charAt(s)){case"G":SSF_isgeneral(e,s)&&(s+=6),s++;break;case'"':for(;e.charCodeAt(++s)!==34&&s<e.length;);++s;break;case"\\":s+=2;break;case"_":s+=2;break;case"@":++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(s,3).toUpperCase()==="A/P"||e.substr(s,5).toUpperCase()==="AM/PM"||e.substr(s,5).toUpperCase()==="/")return!0;++s;break;case"[":for(i=a;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;s<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++s))>-1||a=="\\"&&e.charAt(s+1)=="-"&&"0#".indexOf(e.charAt(s+2))>-1););break;case"?":for(;e.charAt(++s)===a;);break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;);break;case" ":++s;break;default:++s;break}return!1}function eval_fmt(e,s,a,i){for(var o=[],c="",d=0,h="",g="t",_,b,j,_e="H";d<e.length;)switch(h=e.charAt(d)){case"G":if(!SSF_isgeneral(e,d))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"G",v:"General"},d+=7;break;case'"':for(c="";(j=e.charCodeAt(++d))!==34&&d<e.length;)c+=String.fromCharCode(j);o[o.length]={t:"t",v:c},++d;break;case"\\":var tt=e.charAt(++d),rt=tt==="("||tt===")"?tt:"t";o[o.length]={t:rt,v:tt},++d;break;case"_":o[o.length]={t:"t",v:" "},d+=2;break;case"@":o[o.length]={t:"T",v:s},++d;break;case"B":case"b":if(e.charAt(d+1)==="1"||e.charAt(d+1)==="2"){if(_==null&&(_=SSF_parse_date_code(s,a,e.charAt(d+1)==="2"),_==null))return"";o[o.length]={t:"X",v:e.substr(d,2)},g=h,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0||_==null&&(_=SSF_parse_date_code(s,a),_==null))return"";for(c=h;++d<e.length&&e.charAt(d).toLowerCase()===h;)c+=h;h==="m"&&g.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=_e),o[o.length]={t:h,v:c},g=h;break;case"A":case"a":case"":var et={t:h,v:h};if(_==null&&(_=SSF_parse_date_code(s,a)),e.substr(d,3).toUpperCase()==="A/P"?(_!=null&&(et.v=_.H>=12?"P":"A"),et.t="T",_e="h",d+=3):e.substr(d,5).toUpperCase()==="AM/PM"?(_!=null&&(et.v=_.H>=12?"PM":"AM"),et.t="T",d+=5,_e="h"):e.substr(d,5).toUpperCase()==="/"?(_!=null&&(et.v=_.H>=12?"":""),et.t="T",d+=5,_e="h"):(et.t="t",++d),_==null&&et.t==="T")return"";o[o.length]=et,g=h;break;case"[":for(c=h;e.charAt(d++)!=="]"&&d<e.length;)c+=e.charAt(d);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(SSF_abstime)){if(_==null&&(_=SSF_parse_date_code(s,a),_==null))return"";o[o.length]={t:"Z",v:c.toLowerCase()},g=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(o[o.length]={t:"t",v:c}));break;case".":if(_!=null){for(c=h;++d<e.length&&(h=e.charAt(d))==="0";)c+=h;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=h;++d<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(d))>-1;)c+=h;o[o.length]={t:"n",v:c};break;case"?":for(c=h;e.charAt(++d)===h;)c+=h;o[o.length]={t:h,v:c},g=h;break;case"*":++d,(e.charAt(d)==" "||e.charAt(d)=="*")&&++d;break;case"(":case")":o[o.length]={t:i===1?"t":h,v:h},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=h;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)c+=e.charAt(d);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:h,v:h},++d;break;case"$":o[o.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"t",v:h},++d;break}var st=0,at=0,it;for(d=o.length-1,g="t";d>=0;--d)switch(o[d].t){case"h":case"H":o[d].t=_e,g="h",st<1&&(st=1);break;case"s":(it=o[d].v.match(/\.0+$/))&&(at=Math.max(at,it[0].length-1)),st<3&&(st=3);case"d":case"y":case"M":case"e":g=o[d].t;break;case"m":g==="s"&&(o[d].t="M",st<2&&(st=2));break;case"X":break;case"Z":st<1&&o[d].v.match(/[Hh]/)&&(st=1),st<2&&o[d].v.match(/[Mm]/)&&(st=2),st<3&&o[d].v.match(/[Ss]/)&&(st=3)}switch(st){case 0:break;case 1:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M),_.M>=60&&(_.M=0,++_.H);break;case 2:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M);break}var nt="",ot;for(d=0;d<o.length;++d)switch(o[d].t){case"t":case"T":case" ":case"D":break;case"X":o[d].v="",o[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[d].v=SSF_write_date(o[d].t.charCodeAt(0),o[d].v,_,at),o[d].t="t";break;case"n":case"?":for(ot=d+1;o[ot]!=null&&((h=o[ot].t)==="?"||h==="D"||(h===" "||h==="t")&&o[ot+1]!=null&&(o[ot+1].t==="?"||o[ot+1].t==="t"&&o[ot+1].v==="/")||o[d].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(o[ot].v==="/"||o[ot].v===" "&&o[ot+1]!=null&&o[ot+1].t=="?"));)o[d].v+=o[ot].v,o[ot]={v:"",t:";"},++ot;nt+=o[d].v,d=ot-1;break;case"G":o[d].t="t",o[d].v=SSF_general(s,a);break}var dt="",ht,lt;if(nt.length>0){nt.charCodeAt(0)==40?(ht=s<0&&nt.charCodeAt(0)===45?-s:s,lt=write_num("n",nt,ht)):(ht=s<0&&i>1?-s:s,lt=write_num("n",nt,ht),ht<0&&o[0]&&o[0].t=="t"&&(lt=lt.substr(1),o[0].v="-"+o[0].v)),ot=lt.length-1;var gt=o.length;for(d=0;d<o.length;++d)if(o[d]!=null&&o[d].t!="t"&&o[d].v.indexOf(".")>-1){gt=d;break}var yt=o.length;if(gt===o.length&&lt.indexOf("E")===-1){for(d=o.length-1;d>=0;--d)o[d]==null||"n?".indexOf(o[d].t)===-1||(ot>=o[d].v.length-1?(ot-=o[d].v.length,o[d].v=lt.substr(ot+1,o[d].v.length)):ot<0?o[d].v="":(o[d].v=lt.substr(0,ot+1),ot=-1),o[d].t="t",yt=d);ot>=0&&yt<o.length&&(o[yt].v=lt.substr(0,ot+1)+o[yt].v)}else if(gt!==o.length&&lt.indexOf("E")===-1){for(ot=lt.indexOf(".")-1,d=gt;d>=0;--d)if(!(o[d]==null||"n?".indexOf(o[d].t)===-1)){for(b=o[d].v.indexOf(".")>-1&&d===gt?o[d].v.indexOf(".")-1:o[d].v.length-1,dt=o[d].v.substr(b+1);b>=0;--b)ot>=0&&(o[d].v.charAt(b)==="0"||o[d].v.charAt(b)==="#")&&(dt=lt.charAt(ot--)+dt);o[d].v=dt,o[d].t="t",yt=d}for(ot>=0&&yt<o.length&&(o[yt].v=lt.substr(0,ot+1)+o[yt].v),ot=lt.indexOf(".")+1,d=gt;d<o.length;++d)if(!(o[d]==null||"n?(".indexOf(o[d].t)===-1&&d!==gt)){for(b=o[d].v.indexOf(".")>-1&&d===gt?o[d].v.indexOf(".")+1:0,dt=o[d].v.substr(0,b);b<o[d].v.length;++b)ot<lt.length&&(dt+=lt.charAt(ot++));o[d].v=dt,o[d].t="t",yt=d}}}for(d=0;d<o.length;++d)o[d]!=null&&"n?".indexOf(o[d].t)>-1&&(ht=i>1&&s<0&&d>0&&o[d-1].v==="-"?-s:s,o[d].v=write_num(o[d].t,o[d].v,ht),o[d].t="t");var Tt="";for(d=0;d!==o.length;++d)o[d]!=null&&(Tt+=o[d].v);return Tt}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,s){if(s==null)return!1;var a=parseFloat(s[2]);switch(s[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function choose_fmt(e,s){var a=SSF_split_fmt(e),i=a.length,o=a[i-1].indexOf("@");if(i<4&&o>-1&&--i,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof s!="number")return[4,a.length===4||o>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=o>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=o>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=o>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var c=s>0?a[0]:s<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[i,c];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var d=a[0].match(cfregex2),h=a[1].match(cfregex2);return chkcond(s,d)?[i,a[0]]:chkcond(s,h)?[i,a[1]]:[i,a[d!=null&&h!=null?2:1]]}return[i,c]}function SSF_format(e,s,a){a==null&&(a={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?i=a.dateNF:i=e;break;case"number":e==14&&a.dateNF?i=a.dateNF:i=(a.table!=null?a.table:table_fmt)[e],i==null&&(i=a.table&&a.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),i==null&&(i=SSF_default_str[e]||"General");break}if(SSF_isgeneral(i,0))return SSF_general(s,a);s instanceof Date&&(s=datenum_local(s,a.date1904));var o=choose_fmt(i,s);if(SSF_isgeneral(o[1]))return SSF_general(s,a);if(s===!0)s="TRUE";else if(s===!1)s="FALSE";else if(s===""||s==null)return"";return eval_fmt(o[1],s,a,o[0])}function SSF_load(e,s){if(typeof s!="number"){s=+s||-1;for(var a=0;a<392;++a){if(table_fmt[a]==null){s<0&&(s=a);continue}if(table_fmt[a]==e){s=a;break}}s<0&&(s=391)}return table_fmt[s]=e,s}function SSF_load_table(e){for(var s=0;s!=392;++s)e[s]!==void 0&&SSF_load(e[s],s)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var s=typeof e=="number"?table_fmt[e]:e;return s=s.replace(dateNFregex,"(\\d+)"),new RegExp("^"+s+"$")}function dateNF_fix(e,s,a){var i=-1,o=-1,c=-1,d=-1,h=-1,g=-1;(s.match(dateNFregex)||[]).forEach(function(j,_e){var tt=parseInt(a[_e+1],10);switch(j.toLowerCase().charAt(0)){case"y":i=tt;break;case"d":c=tt;break;case"h":d=tt;break;case"s":g=tt;break;case"m":d>=0?h=tt:o=tt;break}}),g>=0&&h==-1&&o>=0&&(h=o,o=-1);var _=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);_.length==7&&(_="0"+_),_.length==8&&(_="20"+_);var b=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return d==-1&&h==-1&&g==-1?_:i==-1&&o==-1&&c==-1?b:_+"T"+b}var CRC32=function(){var e={};e.version="1.2.0";function s(){for(var lt=0,gt=new Array(256),yt=0;yt!=256;++yt)lt=yt,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,gt[yt]=lt;return typeof Int32Array<"u"?new Int32Array(gt):gt}var a=s();function i(lt){var gt=0,yt=0,Tt=0,mt=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Tt=0;Tt!=256;++Tt)mt[Tt]=lt[Tt];for(Tt=0;Tt!=256;++Tt)for(yt=lt[Tt],gt=256+Tt;gt<4096;gt+=256)yt=mt[gt]=yt>>>8^lt[yt&255];var Et=[];for(Tt=1;Tt!=16;++Tt)Et[Tt-1]=typeof Int32Array<"u"?mt.subarray(Tt*256,Tt*256+256):mt.slice(Tt*256,Tt*256+256);return Et}var o=i(a),c=o[0],d=o[1],h=o[2],g=o[3],_=o[4],b=o[5],j=o[6],_e=o[7],tt=o[8],rt=o[9],et=o[10],st=o[11],at=o[12],it=o[13],nt=o[14];function ot(lt,gt){for(var yt=gt^-1,Tt=0,mt=lt.length;Tt<mt;)yt=yt>>>8^a[(yt^lt.charCodeAt(Tt++))&255];return~yt}function dt(lt,gt){for(var yt=gt^-1,Tt=lt.length-15,mt=0;mt<Tt;)yt=nt[lt[mt++]^yt&255]^it[lt[mt++]^yt>>8&255]^at[lt[mt++]^yt>>16&255]^st[lt[mt++]^yt>>>24]^et[lt[mt++]]^rt[lt[mt++]]^tt[lt[mt++]]^_e[lt[mt++]]^j[lt[mt++]]^b[lt[mt++]]^_[lt[mt++]]^g[lt[mt++]]^h[lt[mt++]]^d[lt[mt++]]^c[lt[mt++]]^a[lt[mt++]];for(Tt+=15;mt<Tt;)yt=yt>>>8^a[(yt^lt[mt++])&255];return~yt}function ht(lt,gt){for(var yt=gt^-1,Tt=0,mt=lt.length,Et=0,Ft=0;Tt<mt;)Et=lt.charCodeAt(Tt++),Et<128?yt=yt>>>8^a[(yt^Et)&255]:Et<2048?(yt=yt>>>8^a[(yt^(192|Et>>6&31))&255],yt=yt>>>8^a[(yt^(128|Et&63))&255]):Et>=55296&&Et<57344?(Et=(Et&1023)+64,Ft=lt.charCodeAt(Tt++)&1023,yt=yt>>>8^a[(yt^(240|Et>>8&7))&255],yt=yt>>>8^a[(yt^(128|Et>>2&63))&255],yt=yt>>>8^a[(yt^(128|Ft>>6&15|(Et&3)<<4))&255],yt=yt>>>8^a[(yt^(128|Ft&63))&255]):(yt=yt>>>8^a[(yt^(224|Et>>12&15))&255],yt=yt>>>8^a[(yt^(128|Et>>6&63))&255],yt=yt>>>8^a[(yt^(128|Et&63))&255]);return~yt}return e.table=a,e.bstr=ot,e.buf=dt,e.str=ht,e}(),CFB=function e(){var s={};s.version="1.2.1";function a(ct,_t){for(var pt=ct.split("/"),xt=_t.split("/"),vt=0,wt=0,Ot=Math.min(pt.length,xt.length);vt<Ot;++vt){if(wt=pt[vt].length-xt[vt].length)return wt;if(pt[vt]!=xt[vt])return pt[vt]<xt[vt]?-1:1}return pt.length-xt.length}function i(ct){if(ct.charAt(ct.length-1)=="/")return ct.slice(0,-1).indexOf("/")===-1?ct:i(ct.slice(0,-1));var _t=ct.lastIndexOf("/");return _t===-1?ct:ct.slice(0,_t+1)}function o(ct){if(ct.charAt(ct.length-1)=="/")return o(ct.slice(0,-1));var _t=ct.lastIndexOf("/");return _t===-1?ct:ct.slice(_t+1)}function c(ct,_t){typeof _t=="string"&&(_t=new Date(_t));var pt=_t.getHours();pt=pt<<6|_t.getMinutes(),pt=pt<<5|_t.getSeconds()>>>1,ct.write_shift(2,pt);var xt=_t.getFullYear()-1980;xt=xt<<4|_t.getMonth()+1,xt=xt<<5|_t.getDate(),ct.write_shift(2,xt)}function d(ct){var _t=ct.read_shift(2)&65535,pt=ct.read_shift(2)&65535,xt=new Date,vt=pt&31;pt>>>=5;var wt=pt&15;pt>>>=4,xt.setMilliseconds(0),xt.setFullYear(pt+1980),xt.setMonth(wt-1),xt.setDate(vt);var Ot=_t&31;_t>>>=5;var Ht=_t&63;return _t>>>=6,xt.setHours(_t),xt.setMinutes(Ht),xt.setSeconds(Ot<<1),xt}function h(ct){prep_blob(ct,0);for(var _t={},pt=0;ct.l<=ct.length-4;){var xt=ct.read_shift(2),vt=ct.read_shift(2),wt=ct.l+vt,Ot={};switch(xt){case 21589:pt=ct.read_shift(1),pt&1&&(Ot.mtime=ct.read_shift(4)),vt>5&&(pt&2&&(Ot.atime=ct.read_shift(4)),pt&4&&(Ot.ctime=ct.read_shift(4))),Ot.mtime&&(Ot.mt=new Date(Ot.mtime*1e3));break}ct.l=wt,_t[xt]=Ot}return _t}var g;function _(){return g||(g={})}function b(ct,_t){if(ct[0]==80&&ct[1]==75)return Ir(ct,_t);if((ct[0]|32)==109&&(ct[1]|32)==105)return Xr(ct,_t);if(ct.length<512)throw new Error("CFB file size "+ct.length+" < 512");var pt=3,xt=512,vt=0,wt=0,Ot=0,Ht=0,It=0,Dt=[],Bt=ct.slice(0,512);prep_blob(Bt,0);var Kt=j(Bt);switch(pt=Kt[0],pt){case 3:xt=512;break;case 4:xt=4096;break;case 0:if(Kt[1]==0)return Ir(ct,_t);default:throw new Error("Major Version: Expected 3 or 4 saw "+pt)}xt!==512&&(Bt=ct.slice(0,xt),prep_blob(Bt,28));var Yt=ct.slice(0,xt);_e(Bt,pt);var Qt=Bt.read_shift(4,"i");if(pt===3&&Qt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Qt);Bt.l+=4,Ot=Bt.read_shift(4,"i"),Bt.l+=4,Bt.chk("00100000","Mini Stream Cutoff Size: "),Ht=Bt.read_shift(4,"i"),vt=Bt.read_shift(4,"i"),It=Bt.read_shift(4,"i"),wt=Bt.read_shift(4,"i");for(var qt=-1,Jt=0;Jt<109&&(qt=Bt.read_shift(4,"i"),!(qt<0));++Jt)Dt[Jt]=qt;var tr=tt(ct,xt);st(It,wt,tr,xt,Dt);var or=it(tr,Ot,Dt,xt);or[Ot].name="!Directory",vt>0&&Ht!==Ft&&(or[Ht].name="!MiniFAT"),or[Dt[0]].name="!FAT",or.fat_addrs=Dt,or.ssz=xt;var lr={},hr=[],Tr=[],Rr=[];nt(Ot,or,tr,hr,vt,lr,Tr,Ht),rt(Tr,Rr,hr),hr.shift();var Cr={FileIndex:Tr,FullPaths:Rr};return _t&&_t.raw&&(Cr.raw={header:Yt,sectors:tr}),Cr}function j(ct){if(ct[ct.l]==80&&ct[ct.l+1]==75)return[0,0];ct.chk(Vt,"Header Signature: "),ct.l+=16;var _t=ct.read_shift(2,"u");return[ct.read_shift(2,"u"),_t]}function _e(ct,_t){var pt=9;switch(ct.l+=2,pt=ct.read_shift(2)){case 9:if(_t!=3)throw new Error("Sector Shift: Expected 9 saw "+pt);break;case 12:if(_t!=4)throw new Error("Sector Shift: Expected 12 saw "+pt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+pt)}ct.chk("0600","Mini Sector Shift: "),ct.chk("000000000000","Reserved: ")}function tt(ct,_t){for(var pt=Math.ceil(ct.length/_t)-1,xt=[],vt=1;vt<pt;++vt)xt[vt-1]=ct.slice(vt*_t,(vt+1)*_t);return xt[pt-1]=ct.slice(pt*_t),xt}function rt(ct,_t,pt){for(var xt=0,vt=0,wt=0,Ot=0,Ht=0,It=pt.length,Dt=[],Bt=[];xt<It;++xt)Dt[xt]=Bt[xt]=xt,_t[xt]=pt[xt];for(;Ht<Bt.length;++Ht)xt=Bt[Ht],vt=ct[xt].L,wt=ct[xt].R,Ot=ct[xt].C,Dt[xt]===xt&&(vt!==-1&&Dt[vt]!==vt&&(Dt[xt]=Dt[vt]),wt!==-1&&Dt[wt]!==wt&&(Dt[xt]=Dt[wt])),Ot!==-1&&(Dt[Ot]=xt),vt!==-1&&xt!=Dt[xt]&&(Dt[vt]=Dt[xt],Bt.lastIndexOf(vt)<Ht&&Bt.push(vt)),wt!==-1&&xt!=Dt[xt]&&(Dt[wt]=Dt[xt],Bt.lastIndexOf(wt)<Ht&&Bt.push(wt));for(xt=1;xt<It;++xt)Dt[xt]===xt&&(wt!==-1&&Dt[wt]!==wt?Dt[xt]=Dt[wt]:vt!==-1&&Dt[vt]!==vt&&(Dt[xt]=Dt[vt]));for(xt=1;xt<It;++xt)if(ct[xt].type!==0){if(Ht=xt,Ht!=Dt[Ht])do Ht=Dt[Ht],_t[xt]=_t[Ht]+"/"+_t[xt];while(Ht!==0&&Dt[Ht]!==-1&&Ht!=Dt[Ht]);Dt[xt]=-1}for(_t[0]+="/",xt=1;xt<It;++xt)ct[xt].type!==2&&(_t[xt]+="/")}function et(ct,_t,pt){for(var xt=ct.start,vt=ct.size,wt=[],Ot=xt;pt&&vt>0&&Ot>=0;)wt.push(_t.slice(Ot*Et,Ot*Et+Et)),vt-=Et,Ot=__readInt32LE(pt,Ot*4);return wt.length===0?new_buf(0):bconcat(wt).slice(0,ct.size)}function st(ct,_t,pt,xt,vt){var wt=Ft;if(ct===Ft){if(_t!==0)throw new Error("DIFAT chain shorter than expected")}else if(ct!==-1){var Ot=pt[ct],Ht=(xt>>>2)-1;if(!Ot)return;for(var It=0;It<Ht&&(wt=__readInt32LE(Ot,It*4))!==Ft;++It)vt.push(wt);st(__readInt32LE(Ot,xt-4),_t-1,pt,xt,vt)}}function at(ct,_t,pt,xt,vt){var wt=[],Ot=[];vt||(vt=[]);var Ht=xt-1,It=0,Dt=0;for(It=_t;It>=0;){vt[It]=!0,wt[wt.length]=It,Ot.push(ct[It]);var Bt=pt[Math.floor(It*4/xt)];if(Dt=It*4&Ht,xt<4+Dt)throw new Error("FAT boundary crossed: "+It+" 4 "+xt);if(!ct[Bt])break;It=__readInt32LE(ct[Bt],Dt)}return{nodes:wt,data:__toBuffer([Ot])}}function it(ct,_t,pt,xt){var vt=ct.length,wt=[],Ot=[],Ht=[],It=[],Dt=xt-1,Bt=0,Kt=0,Yt=0,Qt=0;for(Bt=0;Bt<vt;++Bt)if(Ht=[],Yt=Bt+_t,Yt>=vt&&(Yt-=vt),!Ot[Yt]){It=[];var qt=[];for(Kt=Yt;Kt>=0;){qt[Kt]=!0,Ot[Kt]=!0,Ht[Ht.length]=Kt,It.push(ct[Kt]);var Jt=pt[Math.floor(Kt*4/xt)];if(Qt=Kt*4&Dt,xt<4+Qt)throw new Error("FAT boundary crossed: "+Kt+" 4 "+xt);if(!ct[Jt]||(Kt=__readInt32LE(ct[Jt],Qt),qt[Kt]))break}wt[Yt]={nodes:Ht,data:__toBuffer([It])}}return wt}function nt(ct,_t,pt,xt,vt,wt,Ot,Ht){for(var It=0,Dt=xt.length?2:0,Bt=_t[ct].data,Kt=0,Yt=0,Qt;Kt<Bt.length;Kt+=128){var qt=Bt.slice(Kt,Kt+128);prep_blob(qt,64),Yt=qt.read_shift(2),Qt=__utf16le(qt,0,Yt-Dt),xt.push(Qt);var Jt={name:Qt,type:qt.read_shift(1),color:qt.read_shift(1),L:qt.read_shift(4,"i"),R:qt.read_shift(4,"i"),C:qt.read_shift(4,"i"),clsid:qt.read_shift(16),state:qt.read_shift(4,"i"),start:0,size:0},tr=qt.read_shift(2)+qt.read_shift(2)+qt.read_shift(2)+qt.read_shift(2);tr!==0&&(Jt.ct=ot(qt,qt.l-8));var or=qt.read_shift(2)+qt.read_shift(2)+qt.read_shift(2)+qt.read_shift(2);or!==0&&(Jt.mt=ot(qt,qt.l-8)),Jt.start=qt.read_shift(4,"i"),Jt.size=qt.read_shift(4,"i"),Jt.size<0&&Jt.start<0&&(Jt.size=Jt.type=0,Jt.start=Ft,Jt.name=""),Jt.type===5?(It=Jt.start,vt>0&&It!==Ft&&(_t[It].name="!StreamData")):Jt.size>=4096?(Jt.storage="fat",_t[Jt.start]===void 0&&(_t[Jt.start]=at(pt,Jt.start,_t.fat_addrs,_t.ssz)),_t[Jt.start].name=Jt.name,Jt.content=_t[Jt.start].data.slice(0,Jt.size)):(Jt.storage="minifat",Jt.size<0?Jt.size=0:It!==Ft&&Jt.start!==Ft&&_t[It]&&(Jt.content=et(Jt,_t[It].data,(_t[Ht]||{}).data))),Jt.content&&prep_blob(Jt.content,0),wt[Qt]=Jt,Ot.push(Jt)}}function ot(ct,_t){return new Date((__readUInt32LE(ct,_t+4)/1e7*Math.pow(2,32)+__readUInt32LE(ct,_t)/1e7-11644473600)*1e3)}function dt(ct,_t){return _(),b(g.readFileSync(ct),_t)}function ht(ct,_t){var pt=_t&&_t.type;switch(pt||has_buf&&Buffer.isBuffer(ct)&&(pt="buffer"),pt||"base64"){case"file":return dt(ct,_t);case"base64":return b(s2a(Base64_decode(ct)),_t);case"binary":return b(s2a(ct),_t)}return b(ct,_t)}function lt(ct,_t){var pt=_t||{},xt=pt.root||"Root Entry";if(ct.FullPaths||(ct.FullPaths=[]),ct.FileIndex||(ct.FileIndex=[]),ct.FullPaths.length!==ct.FileIndex.length)throw new Error("inconsistent CFB structure");ct.FullPaths.length===0&&(ct.FullPaths[0]=xt+"/",ct.FileIndex[0]={name:xt,type:5}),pt.CLSID&&(ct.FileIndex[0].clsid=pt.CLSID),gt(ct)}function gt(ct){var _t="Sh33tJ5";if(!CFB.find(ct,"/"+_t)){var pt=new_buf(4);pt[0]=55,pt[1]=pt[3]=50,pt[2]=54,ct.FileIndex.push({name:_t,type:2,content:pt,size:4,L:69,R:69,C:69}),ct.FullPaths.push(ct.FullPaths[0]+_t),yt(ct)}}function yt(ct,_t){lt(ct);for(var pt=!1,xt=!1,vt=ct.FullPaths.length-1;vt>=0;--vt){var wt=ct.FileIndex[vt];switch(wt.type){case 0:xt?pt=!0:(ct.FileIndex.pop(),ct.FullPaths.pop());break;case 1:case 2:case 5:xt=!0,isNaN(wt.R*wt.L*wt.C)&&(pt=!0),wt.R>-1&&wt.L>-1&&wt.R==wt.L&&(pt=!0);break;default:pt=!0;break}}if(!(!pt&&!_t)){var Ot=new Date(1987,1,19),Ht=0,It=Object.create?Object.create(null):{},Dt=[];for(vt=0;vt<ct.FullPaths.length;++vt)It[ct.FullPaths[vt]]=!0,ct.FileIndex[vt].type!==0&&Dt.push([ct.FullPaths[vt],ct.FileIndex[vt]]);for(vt=0;vt<Dt.length;++vt){var Bt=i(Dt[vt][0]);xt=It[Bt],xt||(Dt.push([Bt,{name:o(Bt).replace("/",""),type:1,clsid:Ct,ct:Ot,mt:Ot,content:null}]),It[Bt]=!0)}for(Dt.sort(function(Qt,qt){return a(Qt[0],qt[0])}),ct.FullPaths=[],ct.FileIndex=[],vt=0;vt<Dt.length;++vt)ct.FullPaths[vt]=Dt[vt][0],ct.FileIndex[vt]=Dt[vt][1];for(vt=0;vt<Dt.length;++vt){var Kt=ct.FileIndex[vt],Yt=ct.FullPaths[vt];if(Kt.name=o(Yt).replace("/",""),Kt.L=Kt.R=Kt.C=-(Kt.color=1),Kt.size=Kt.content?Kt.content.length:0,Kt.start=0,Kt.clsid=Kt.clsid||Ct,vt===0)Kt.C=Dt.length>1?1:-1,Kt.size=0,Kt.type=5;else if(Yt.slice(-1)=="/"){for(Ht=vt+1;Ht<Dt.length&&i(ct.FullPaths[Ht])!=Yt;++Ht);for(Kt.C=Ht>=Dt.length?-1:Ht,Ht=vt+1;Ht<Dt.length&&i(ct.FullPaths[Ht])!=i(Yt);++Ht);Kt.R=Ht>=Dt.length?-1:Ht,Kt.type=1}else i(ct.FullPaths[vt+1]||"")==i(Yt)&&(Kt.R=vt+1),Kt.type=2}}}function Tt(ct,_t){var pt=_t||{};if(pt.fileType=="mad")return Gr(ct,pt);switch(yt(ct),pt.fileType){case"zip":return Ur(ct,pt)}var xt=function(Qt){for(var qt=0,Jt=0,tr=0;tr<Qt.FileIndex.length;++tr){var or=Qt.FileIndex[tr];if(or.content){var lr=or.content.length;lr>0&&(lr<4096?qt+=lr+63>>6:Jt+=lr+511>>9)}}for(var hr=Qt.FullPaths.length+3>>2,Tr=qt+7>>3,Rr=qt+127>>7,Cr=Tr+Jt+hr+Rr,kr=Cr+127>>7,Fr=kr<=109?0:Math.ceil((kr-109)/127);Cr+kr+Fr+127>>7>kr;)Fr=++kr<=109?0:Math.ceil((kr-109)/127);var wr=[1,Fr,kr,Rr,hr,Jt,qt,0];return Qt.FileIndex[0].size=qt<<6,wr[7]=(Qt.FileIndex[0].start=wr[0]+wr[1]+wr[2]+wr[3]+wr[4]+wr[5])+(wr[6]+7>>3),wr}(ct),vt=new_buf(xt[7]<<9),wt=0,Ot=0;{for(wt=0;wt<8;++wt)vt.write_shift(1,Mt[wt]);for(wt=0;wt<8;++wt)vt.write_shift(2,0);for(vt.write_shift(2,62),vt.write_shift(2,3),vt.write_shift(2,65534),vt.write_shift(2,9),vt.write_shift(2,6),wt=0;wt<3;++wt)vt.write_shift(2,0);for(vt.write_shift(4,0),vt.write_shift(4,xt[2]),vt.write_shift(4,xt[0]+xt[1]+xt[2]+xt[3]-1),vt.write_shift(4,0),vt.write_shift(4,4096),vt.write_shift(4,xt[3]?xt[0]+xt[1]+xt[2]-1:Ft),vt.write_shift(4,xt[3]),vt.write_shift(-4,xt[1]?xt[0]-1:Ft),vt.write_shift(4,xt[1]),wt=0;wt<109;++wt)vt.write_shift(-4,wt<xt[2]?xt[1]+wt:-1)}if(xt[1])for(Ot=0;Ot<xt[1];++Ot){for(;wt<236+Ot*127;++wt)vt.write_shift(-4,wt<xt[2]?xt[1]+wt:-1);vt.write_shift(-4,Ot===xt[1]-1?Ft:Ot+1)}var Ht=function(Qt){for(Ot+=Qt;wt<Ot-1;++wt)vt.write_shift(-4,wt+1);Qt&&(++wt,vt.write_shift(-4,Ft))};for(Ot=wt=0,Ot+=xt[1];wt<Ot;++wt)vt.write_shift(-4,kt.DIFSECT);for(Ot+=xt[2];wt<Ot;++wt)vt.write_shift(-4,kt.FATSECT);Ht(xt[3]),Ht(xt[4]);for(var It=0,Dt=0,Bt=ct.FileIndex[0];It<ct.FileIndex.length;++It)Bt=ct.FileIndex[It],Bt.content&&(Dt=Bt.content.length,!(Dt<4096)&&(Bt.start=Ot,Ht(Dt+511>>9)));for(Ht(xt[6]+7>>3);vt.l&511;)vt.write_shift(-4,kt.ENDOFCHAIN);for(Ot=wt=0,It=0;It<ct.FileIndex.length;++It)Bt=ct.FileIndex[It],Bt.content&&(Dt=Bt.content.length,!(!Dt||Dt>=4096)&&(Bt.start=Ot,Ht(Dt+63>>6)));for(;vt.l&511;)vt.write_shift(-4,kt.ENDOFCHAIN);for(wt=0;wt<xt[4]<<2;++wt){var Kt=ct.FullPaths[wt];if(!Kt||Kt.length===0){for(It=0;It<17;++It)vt.write_shift(4,0);for(It=0;It<3;++It)vt.write_shift(4,-1);for(It=0;It<12;++It)vt.write_shift(4,0);continue}Bt=ct.FileIndex[wt],wt===0&&(Bt.start=Bt.size?Bt.start-1:Ft);var Yt=wt===0&&pt.root||Bt.name;if(Dt=2*(Yt.length+1),vt.write_shift(64,Yt,"utf16le"),vt.write_shift(2,Dt),vt.write_shift(1,Bt.type),vt.write_shift(1,Bt.color),vt.write_shift(-4,Bt.L),vt.write_shift(-4,Bt.R),vt.write_shift(-4,Bt.C),Bt.clsid)vt.write_shift(16,Bt.clsid,"hex");else for(It=0;It<4;++It)vt.write_shift(4,0);vt.write_shift(4,Bt.state||0),vt.write_shift(4,0),vt.write_shift(4,0),vt.write_shift(4,0),vt.write_shift(4,0),vt.write_shift(4,Bt.start),vt.write_shift(4,Bt.size),vt.write_shift(4,0)}for(wt=1;wt<ct.FileIndex.length;++wt)if(Bt=ct.FileIndex[wt],Bt.size>=4096)if(vt.l=Bt.start+1<<9,has_buf&&Buffer.isBuffer(Bt.content))Bt.content.copy(vt,vt.l,0,Bt.size),vt.l+=Bt.size+511&-512;else{for(It=0;It<Bt.size;++It)vt.write_shift(1,Bt.content[It]);for(;It&511;++It)vt.write_shift(1,0)}for(wt=1;wt<ct.FileIndex.length;++wt)if(Bt=ct.FileIndex[wt],Bt.size>0&&Bt.size<4096)if(has_buf&&Buffer.isBuffer(Bt.content))Bt.content.copy(vt,vt.l,0,Bt.size),vt.l+=Bt.size+63&-64;else{for(It=0;It<Bt.size;++It)vt.write_shift(1,Bt.content[It]);for(;It&63;++It)vt.write_shift(1,0)}if(has_buf)vt.l=vt.length;else for(;vt.l<vt.length;)vt.write_shift(1,0);return vt}function mt(ct,_t){var pt=ct.FullPaths.map(function(It){return It.toUpperCase()}),xt=pt.map(function(It){var Dt=It.split("/");return Dt[Dt.length-(It.slice(-1)=="/"?2:1)]}),vt=!1;_t.charCodeAt(0)===47?(vt=!0,_t=pt[0].slice(0,-1)+_t):vt=_t.indexOf("/")!==-1;var wt=_t.toUpperCase(),Ot=vt===!0?pt.indexOf(wt):xt.indexOf(wt);if(Ot!==-1)return ct.FileIndex[Ot];var Ht=!wt.match(chr1);for(wt=wt.replace(chr0,""),Ht&&(wt=wt.replace(chr1,"!")),Ot=0;Ot<pt.length;++Ot)if((Ht?pt[Ot].replace(chr1,"!"):pt[Ot]).replace(chr0,"")==wt||(Ht?xt[Ot].replace(chr1,"!"):xt[Ot]).replace(chr0,"")==wt)return ct.FileIndex[Ot];return null}var Et=64,Ft=-2,Vt="d0cf11e0a1b11ae1",Mt=[208,207,17,224,161,177,26,225],Ct="00000000000000000000000000000000",kt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ft,FREESECT:-1,HEADER_SIGNATURE:Vt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ct,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function jt(ct,_t,pt){_();var xt=Tt(ct,pt);g.writeFileSync(_t,xt)}function ut(ct){for(var _t=new Array(ct.length),pt=0;pt<ct.length;++pt)_t[pt]=String.fromCharCode(ct[pt]);return _t.join("")}function Lt(ct,_t){var pt=Tt(ct,_t);switch(_t&&_t.type||"buffer"){case"file":return _(),g.writeFileSync(_t.filename,pt),pt;case"binary":return typeof pt=="string"?pt:ut(pt);case"base64":return Base64_encode(typeof pt=="string"?pt:ut(pt));case"buffer":if(has_buf)return Buffer.isBuffer(pt)?pt:Buffer_from(pt);case"array":return typeof pt=="string"?s2a(pt):pt}return pt}var Pt;function ft(ct){try{var _t=ct.InflateRaw,pt=new _t;if(pt._processChunk(new Uint8Array([3,0]),pt._finishFlushFlag),pt.bytesRead)Pt=ct;else throw new Error("zlib does not expose bytesRead")}catch(xt){console.error("cannot use native zlib: "+(xt.message||xt))}}function Rt(ct,_t){if(!Pt)return Pr(ct,_t);var pt=Pt.InflateRaw,xt=new pt,vt=xt._processChunk(ct.slice(ct.l),xt._finishFlushFlag);return ct.l+=xt.bytesRead,vt}function bt(ct){return Pt?Pt.deflateRawSync(ct):rr(ct)}var At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ut=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Xt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Gt(ct){var _t=(ct<<1|ct<<11)&139536|(ct<<5|ct<<15)&558144;return(_t>>16|_t>>8|_t)&255}for(var zt=typeof Uint8Array<"u",Wt=zt?new Uint8Array(256):[],er=0;er<256;++er)Wt[er]=Gt(er);function St(ct,_t){var pt=Wt[ct&255];return _t<=8?pt>>>8-_t:(pt=pt<<8|Wt[ct>>8&255],_t<=16?pt>>>16-_t:(pt=pt<<8|Wt[ct>>16&255],pt>>>24-_t))}function ir(ct,_t){var pt=_t&7,xt=_t>>>3;return(ct[xt]|(pt<=6?0:ct[xt+1]<<8))>>>pt&3}function nr(ct,_t){var pt=_t&7,xt=_t>>>3;return(ct[xt]|(pt<=5?0:ct[xt+1]<<8))>>>pt&7}function ar(ct,_t){var pt=_t&7,xt=_t>>>3;return(ct[xt]|(pt<=4?0:ct[xt+1]<<8))>>>pt&15}function $t(ct,_t){var pt=_t&7,xt=_t>>>3;return(ct[xt]|(pt<=3?0:ct[xt+1]<<8))>>>pt&31}function Nt(ct,_t){var pt=_t&7,xt=_t>>>3;return(ct[xt]|(pt<=1?0:ct[xt+1]<<8))>>>pt&127}function Zt(ct,_t,pt){var xt=_t&7,vt=_t>>>3,wt=(1<<pt)-1,Ot=ct[vt]>>>xt;return pt<8-xt||(Ot|=ct[vt+1]<<8-xt,pt<16-xt)||(Ot|=ct[vt+2]<<16-xt,pt<24-xt)||(Ot|=ct[vt+3]<<24-xt),Ot&wt}function sr(ct,_t,pt){var xt=_t&7,vt=_t>>>3;return xt<=5?ct[vt]|=(pt&7)<<xt:(ct[vt]|=pt<<xt&255,ct[vt+1]=(pt&7)>>8-xt),_t+3}function cr(ct,_t,pt){var xt=_t&7,vt=_t>>>3;return pt=(pt&1)<<xt,ct[vt]|=pt,_t+1}function dr(ct,_t,pt){var xt=_t&7,vt=_t>>>3;return pt<<=xt,ct[vt]|=pt&255,pt>>>=8,ct[vt+1]=pt,_t+8}function Er(ct,_t,pt){var xt=_t&7,vt=_t>>>3;return pt<<=xt,ct[vt]|=pt&255,pt>>>=8,ct[vt+1]=pt&255,ct[vt+2]=pt>>>8,_t+16}function gr(ct,_t){var pt=ct.length,xt=2*pt>_t?2*pt:_t+5,vt=0;if(pt>=_t)return ct;if(has_buf){var wt=new_unsafe_buf(xt);if(ct.copy)ct.copy(wt);else for(;vt<ct.length;++vt)wt[vt]=ct[vt];return wt}else if(zt){var Ot=new Uint8Array(xt);if(Ot.set)Ot.set(ct);else for(;vt<pt;++vt)Ot[vt]=ct[vt];return Ot}return ct.length=xt,ct}function xr(ct){for(var _t=new Array(ct),pt=0;pt<ct;++pt)_t[pt]=0;return _t}function vr(ct,_t,pt){var xt=1,vt=0,wt=0,Ot=0,Ht=0,It=ct.length,Dt=zt?new Uint16Array(32):xr(32);for(wt=0;wt<32;++wt)Dt[wt]=0;for(wt=It;wt<pt;++wt)ct[wt]=0;It=ct.length;var Bt=zt?new Uint16Array(It):xr(It);for(wt=0;wt<It;++wt)Dt[vt=ct[wt]]++,xt<vt&&(xt=vt),Bt[wt]=0;for(Dt[0]=0,wt=1;wt<=xt;++wt)Dt[wt+16]=Ht=Ht+Dt[wt-1]<<1;for(wt=0;wt<It;++wt)Ht=ct[wt],Ht!=0&&(Bt[wt]=Dt[Ht+16]++);var Kt=0;for(wt=0;wt<It;++wt)if(Kt=ct[wt],Kt!=0)for(Ht=St(Bt[wt],xt)>>xt-Kt,Ot=(1<<xt+4-Kt)-1;Ot>=0;--Ot)_t[Ht|Ot<<Kt]=Kt&15|wt<<4;return xt}var yr=zt?new Uint16Array(512):xr(512),br=zt?new Uint16Array(32):xr(32);if(!zt){for(var pr=0;pr<512;++pr)yr[pr]=0;for(pr=0;pr<32;++pr)br[pr]=0}(function(){for(var ct=[],_t=0;_t<32;_t++)ct.push(5);vr(ct,br,32);var pt=[];for(_t=0;_t<=143;_t++)pt.push(8);for(;_t<=255;_t++)pt.push(9);for(;_t<=279;_t++)pt.push(7);for(;_t<=287;_t++)pt.push(8);vr(pt,yr,288)})();var _r=function(){for(var _t=zt?new Uint8Array(32768):[],pt=0,xt=0;pt<Xt.length-1;++pt)for(;xt<Xt[pt+1];++xt)_t[xt]=pt;for(;xt<32768;++xt)_t[xt]=29;var vt=zt?new Uint8Array(259):[];for(pt=0,xt=0;pt<Ut.length-1;++pt)for(;xt<Ut[pt+1];++xt)vt[xt]=pt;function wt(Ht,It){for(var Dt=0;Dt<Ht.length;){var Bt=Math.min(65535,Ht.length-Dt),Kt=Dt+Bt==Ht.length;for(It.write_shift(1,+Kt),It.write_shift(2,Bt),It.write_shift(2,~Bt&65535);Bt-- >0;)It[It.l++]=Ht[Dt++]}return It.l}function Ot(Ht,It){for(var Dt=0,Bt=0,Kt=zt?new Uint16Array(32768):[];Bt<Ht.length;){var Yt=Math.min(65535,Ht.length-Bt);if(Yt<10){for(Dt=sr(It,Dt,+(Bt+Yt==Ht.length)),Dt&7&&(Dt+=8-(Dt&7)),It.l=Dt/8|0,It.write_shift(2,Yt),It.write_shift(2,~Yt&65535);Yt-- >0;)It[It.l++]=Ht[Bt++];Dt=It.l*8;continue}Dt=sr(It,Dt,+(Bt+Yt==Ht.length)+2);for(var Qt=0;Yt-- >0;){var qt=Ht[Bt];Qt=(Qt<<5^qt)&32767;var Jt=-1,tr=0;if((Jt=Kt[Qt])&&(Jt|=Bt&-32768,Jt>Bt&&(Jt-=32768),Jt<Bt))for(;Ht[Jt+tr]==Ht[Bt+tr]&&tr<250;)++tr;if(tr>2){qt=vt[tr],qt<=22?Dt=dr(It,Dt,Wt[qt+1]>>1)-1:(dr(It,Dt,3),Dt+=5,dr(It,Dt,Wt[qt-23]>>5),Dt+=3);var or=qt<8?0:qt-4>>2;or>0&&(Er(It,Dt,tr-Ut[qt]),Dt+=or),qt=_t[Bt-Jt],Dt=dr(It,Dt,Wt[qt]>>3),Dt-=3;var lr=qt<4?0:qt-2>>1;lr>0&&(Er(It,Dt,Bt-Jt-Xt[qt]),Dt+=lr);for(var hr=0;hr<tr;++hr)Kt[Qt]=Bt&32767,Qt=(Qt<<5^Ht[Bt])&32767,++Bt;Yt-=tr-1}else qt<=143?qt=qt+48:Dt=cr(It,Dt,1),Dt=dr(It,Dt,Wt[qt]),Kt[Qt]=Bt&32767,++Bt}Dt=dr(It,Dt,0)-1}return It.l=(Dt+7)/8|0,It.l}return function(It,Dt){return It.length<8?wt(It,Dt):Ot(It,Dt)}}();function rr(ct){var _t=new_buf(50+Math.floor(ct.length*1.1)),pt=_r(ct,_t);return _t.slice(0,pt)}var ur=zt?new Uint16Array(32768):xr(32768),mr=zt?new Uint16Array(32768):xr(32768),fr=zt?new Uint16Array(128):xr(128),Sr=1,Nr=1;function Dr(ct,_t){var pt=$t(ct,_t)+257;_t+=5;var xt=$t(ct,_t)+1;_t+=5;var vt=ar(ct,_t)+4;_t+=4;for(var wt=0,Ot=zt?new Uint8Array(19):xr(19),Ht=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],It=1,Dt=zt?new Uint8Array(8):xr(8),Bt=zt?new Uint8Array(8):xr(8),Kt=Ot.length,Yt=0;Yt<vt;++Yt)Ot[At[Yt]]=wt=nr(ct,_t),It<wt&&(It=wt),Dt[wt]++,_t+=3;var Qt=0;for(Dt[0]=0,Yt=1;Yt<=It;++Yt)Bt[Yt]=Qt=Qt+Dt[Yt-1]<<1;for(Yt=0;Yt<Kt;++Yt)(Qt=Ot[Yt])!=0&&(Ht[Yt]=Bt[Qt]++);var qt=0;for(Yt=0;Yt<Kt;++Yt)if(qt=Ot[Yt],qt!=0){Qt=Wt[Ht[Yt]]>>8-qt;for(var Jt=(1<<7-qt)-1;Jt>=0;--Jt)fr[Qt|Jt<<qt]=qt&7|Yt<<3}var tr=[];for(It=1;tr.length<pt+xt;)switch(Qt=fr[Nt(ct,_t)],_t+=Qt&7,Qt>>>=3){case 16:for(wt=3+ir(ct,_t),_t+=2,Qt=tr[tr.length-1];wt-- >0;)tr.push(Qt);break;case 17:for(wt=3+nr(ct,_t),_t+=3;wt-- >0;)tr.push(0);break;case 18:for(wt=11+Nt(ct,_t),_t+=7;wt-- >0;)tr.push(0);break;default:tr.push(Qt),It<Qt&&(It=Qt);break}var or=tr.slice(0,pt),lr=tr.slice(pt);for(Yt=pt;Yt<286;++Yt)or[Yt]=0;for(Yt=xt;Yt<30;++Yt)lr[Yt]=0;return Sr=vr(or,ur,286),Nr=vr(lr,mr,30),_t}function Br(ct,_t){if(ct[0]==3&&!(ct[1]&3))return[new_raw_buf(_t),2];for(var pt=0,xt=0,vt=new_unsafe_buf(_t||1<<18),wt=0,Ot=vt.length>>>0,Ht=0,It=0;!(xt&1);){if(xt=nr(ct,pt),pt+=3,xt>>>1)xt>>1==1?(Ht=9,It=5):(pt=Dr(ct,pt),Ht=Sr,It=Nr);else{pt&7&&(pt+=8-(pt&7));var Dt=ct[pt>>>3]|ct[(pt>>>3)+1]<<8;if(pt+=32,Dt>0)for(!_t&&Ot<wt+Dt&&(vt=gr(vt,wt+Dt),Ot=vt.length);Dt-- >0;)vt[wt++]=ct[pt>>>3],pt+=8;continue}for(;;){!_t&&Ot<wt+32767&&(vt=gr(vt,wt+32767),Ot=vt.length);var Bt=Zt(ct,pt,Ht),Kt=xt>>>1==1?yr[Bt]:ur[Bt];if(pt+=Kt&15,Kt>>>=4,!(Kt>>>8&255))vt[wt++]=Kt;else{if(Kt==256)break;Kt-=257;var Yt=Kt<8?0:Kt-4>>2;Yt>5&&(Yt=0);var Qt=wt+Ut[Kt];Yt>0&&(Qt+=Zt(ct,pt,Yt),pt+=Yt),Bt=Zt(ct,pt,It),Kt=xt>>>1==1?br[Bt]:mr[Bt],pt+=Kt&15,Kt>>>=4;var qt=Kt<4?0:Kt-2>>1,Jt=Xt[Kt];for(qt>0&&(Jt+=Zt(ct,pt,qt),pt+=qt),!_t&&Ot<Qt&&(vt=gr(vt,Qt+100),Ot=vt.length);wt<Qt;)vt[wt]=vt[wt-Jt],++wt}}}return _t?[vt,pt+7>>>3]:[vt.slice(0,wt),pt+7>>>3]}function Pr(ct,_t){var pt=ct.slice(ct.l||0),xt=Br(pt,_t);return ct.l+=xt[1],xt[0]}function Lr(ct,_t){if(ct)typeof console<"u"&&console.error(_t);else throw new Error(_t)}function Ir(ct,_t){var pt=ct;prep_blob(pt,0);var xt=[],vt=[],wt={FileIndex:xt,FullPaths:vt};lt(wt,{root:_t.root});for(var Ot=pt.length-4;(pt[Ot]!=80||pt[Ot+1]!=75||pt[Ot+2]!=5||pt[Ot+3]!=6)&&Ot>=0;)--Ot;pt.l=Ot+4,pt.l+=4;var Ht=pt.read_shift(2);pt.l+=6;var It=pt.read_shift(4);for(pt.l=It,Ot=0;Ot<Ht;++Ot){pt.l+=20;var Dt=pt.read_shift(4),Bt=pt.read_shift(4),Kt=pt.read_shift(2),Yt=pt.read_shift(2),Qt=pt.read_shift(2);pt.l+=8;var qt=pt.read_shift(4),Jt=h(pt.slice(pt.l+Kt,pt.l+Kt+Yt));pt.l+=Kt+Yt+Qt;var tr=pt.l;pt.l=qt+4,Mr(pt,Dt,Bt,wt,Jt),pt.l=tr}return wt}function Mr(ct,_t,pt,xt,vt){ct.l+=2;var wt=ct.read_shift(2),Ot=ct.read_shift(2),Ht=d(ct);if(wt&8257)throw new Error("Unsupported ZIP encryption");for(var It=ct.read_shift(4),Dt=ct.read_shift(4),Bt=ct.read_shift(4),Kt=ct.read_shift(2),Yt=ct.read_shift(2),Qt="",qt=0;qt<Kt;++qt)Qt+=String.fromCharCode(ct[ct.l++]);if(Yt){var Jt=h(ct.slice(ct.l,ct.l+Yt));(Jt[21589]||{}).mt&&(Ht=Jt[21589].mt),((vt||{})[21589]||{}).mt&&(Ht=vt[21589].mt)}ct.l+=Yt;var tr=ct.slice(ct.l,ct.l+Dt);switch(Ot){case 8:tr=Rt(ct,Bt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ot)}var or=!1;wt&8&&(It=ct.read_shift(4),It==134695760&&(It=ct.read_shift(4),or=!0),Dt=ct.read_shift(4),Bt=ct.read_shift(4)),Dt!=_t&&Lr(or,"Bad compressed size: "+_t+" != "+Dt),Bt!=pt&&Lr(or,"Bad uncompressed size: "+pt+" != "+Bt),jr(xt,Qt,tr,{unsafe:!0,mt:Ht})}function Ur(ct,_t){var pt=_t||{},xt=[],vt=[],wt=new_buf(1),Ot=pt.compression?8:0,Ht=0,It=0,Dt=0,Bt=0,Kt=0,Yt=ct.FullPaths[0],Qt=Yt,qt=ct.FileIndex[0],Jt=[],tr=0;for(It=1;It<ct.FullPaths.length;++It)if(Qt=ct.FullPaths[It].slice(Yt.length),qt=ct.FileIndex[It],!(!qt.size||!qt.content||Qt=="Sh33tJ5")){var or=Bt,lr=new_buf(Qt.length);for(Dt=0;Dt<Qt.length;++Dt)lr.write_shift(1,Qt.charCodeAt(Dt)&127);lr=lr.slice(0,lr.l),Jt[Kt]=CRC32.buf(qt.content,0);var hr=qt.content;Ot==8&&(hr=bt(hr)),wt=new_buf(30),wt.write_shift(4,67324752),wt.write_shift(2,20),wt.write_shift(2,Ht),wt.write_shift(2,Ot),qt.mt?c(wt,qt.mt):wt.write_shift(4,0),wt.write_shift(-4,Jt[Kt]),wt.write_shift(4,hr.length),wt.write_shift(4,qt.content.length),wt.write_shift(2,lr.length),wt.write_shift(2,0),Bt+=wt.length,xt.push(wt),Bt+=lr.length,xt.push(lr),Bt+=hr.length,xt.push(hr),wt=new_buf(46),wt.write_shift(4,33639248),wt.write_shift(2,0),wt.write_shift(2,20),wt.write_shift(2,Ht),wt.write_shift(2,Ot),wt.write_shift(4,0),wt.write_shift(-4,Jt[Kt]),wt.write_shift(4,hr.length),wt.write_shift(4,qt.content.length),wt.write_shift(2,lr.length),wt.write_shift(2,0),wt.write_shift(2,0),wt.write_shift(2,0),wt.write_shift(2,0),wt.write_shift(4,0),wt.write_shift(4,or),tr+=wt.l,vt.push(wt),tr+=lr.length,vt.push(lr),++Kt}return wt=new_buf(22),wt.write_shift(4,101010256),wt.write_shift(2,0),wt.write_shift(2,0),wt.write_shift(2,Kt),wt.write_shift(2,Kt),wt.write_shift(4,tr),wt.write_shift(4,Bt),wt.write_shift(2,0),bconcat([bconcat(xt),bconcat(vt),wt])}var Ar={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $r(ct,_t){if(ct.ctype)return ct.ctype;var pt=ct.name||"",xt=pt.match(/\.([^\.]+)$/);return xt&&Ar[xt[1]]||_t&&(xt=(pt=_t).match(/[\.\\]([^\.\\])+$/),xt&&Ar[xt[1]])?Ar[xt[1]]:"application/octet-stream"}function Hr(ct){for(var _t=Base64_encode(ct),pt=[],xt=0;xt<_t.length;xt+=76)pt.push(_t.slice(xt,xt+76));return pt.join(`\r
`)+`\r
`}function Vr(ct){var _t=ct.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Dt){var Bt=Dt.charCodeAt(0).toString(16).toUpperCase();return"="+(Bt.length==1?"0"+Bt:Bt)});_t=_t.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),_t.charAt(0)==`
`&&(_t="=0D"+_t.slice(1)),_t=_t.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var pt=[],xt=_t.split(`\r
`),vt=0;vt<xt.length;++vt){var wt=xt[vt];if(wt.length==0){pt.push("");continue}for(var Ot=0;Ot<wt.length;){var Ht=76,It=wt.slice(Ot,Ot+Ht);It.charAt(Ht-1)=="="?Ht--:It.charAt(Ht-2)=="="?Ht-=2:It.charAt(Ht-3)=="="&&(Ht-=3),It=wt.slice(Ot,Ot+Ht),Ot+=Ht,Ot<wt.length&&(It+="="),pt.push(It)}}return pt.join(`\r
`)}function zr(ct){for(var _t=[],pt=0;pt<ct.length;++pt){for(var xt=ct[pt];pt<=ct.length&&xt.charAt(xt.length-1)=="=";)xt=xt.slice(0,xt.length-1)+ct[++pt];_t.push(xt)}for(var vt=0;vt<_t.length;++vt)_t[vt]=_t[vt].replace(/[=][0-9A-Fa-f]{2}/g,function(wt){return String.fromCharCode(parseInt(wt.slice(1),16))});return s2a(_t.join(`\r
`))}function Wr(ct,_t,pt){for(var xt="",vt="",wt="",Ot,Ht=0;Ht<10;++Ht){var It=_t[Ht];if(!It||It.match(/^\s*$/))break;var Dt=It.match(/^(.*?):\s*([^\s].*)$/);if(Dt)switch(Dt[1].toLowerCase()){case"content-location":xt=Dt[2].trim();break;case"content-type":wt=Dt[2].trim();break;case"content-transfer-encoding":vt=Dt[2].trim();break}}switch(++Ht,vt.toLowerCase()){case"base64":Ot=s2a(Base64_decode(_t.slice(Ht).join("")));break;case"quoted-printable":Ot=zr(_t.slice(Ht));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+vt)}var Bt=jr(ct,xt.slice(pt.length),Ot,{unsafe:!0});wt&&(Bt.ctype=wt)}function Xr(ct,_t){if(ut(ct.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var pt=_t&&_t.root||"",xt=(has_buf&&Buffer.isBuffer(ct)?ct.toString("binary"):ut(ct)).split(`\r
`),vt=0,wt="";for(vt=0;vt<xt.length;++vt)if(wt=xt[vt],!!/^Content-Location:/i.test(wt)&&(wt=wt.slice(wt.indexOf("file")),pt||(pt=wt.slice(0,wt.lastIndexOf("/")+1)),wt.slice(0,pt.length)!=pt))for(;pt.length>0&&(pt=pt.slice(0,pt.length-1),pt=pt.slice(0,pt.lastIndexOf("/")+1),wt.slice(0,pt.length)!=pt););var Ot=(xt[1]||"").match(/boundary="(.*?)"/);if(!Ot)throw new Error("MAD cannot find boundary");var Ht="--"+(Ot[1]||""),It=[],Dt=[],Bt={FileIndex:It,FullPaths:Dt};lt(Bt);var Kt,Yt=0;for(vt=0;vt<xt.length;++vt){var Qt=xt[vt];Qt!==Ht&&Qt!==Ht+"--"||(Yt++&&Wr(Bt,xt.slice(Kt,vt),pt),Kt=vt)}return Bt}function Gr(ct,_t){var pt=_t||{},xt=pt.boundary||"SheetJS";xt="------="+xt;for(var vt=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xt.slice(2)+'"',"","",""],wt=ct.FullPaths[0],Ot=wt,Ht=ct.FileIndex[0],It=1;It<ct.FullPaths.length;++It)if(Ot=ct.FullPaths[It].slice(wt.length),Ht=ct.FileIndex[It],!(!Ht.size||!Ht.content||Ot=="Sh33tJ5")){Ot=Ot.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tr){return"_x"+tr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tr){return"_u"+tr.charCodeAt(0).toString(16)+"_"});for(var Dt=Ht.content,Bt=has_buf&&Buffer.isBuffer(Dt)?Dt.toString("binary"):ut(Dt),Kt=0,Yt=Math.min(1024,Bt.length),Qt=0,qt=0;qt<=Yt;++qt)(Qt=Bt.charCodeAt(qt))>=32&&Qt<128&&++Kt;var Jt=Kt>=Yt*4/5;vt.push(xt),vt.push("Content-Location: "+(pt.root||"file:///C:/SheetJS/")+Ot),vt.push("Content-Transfer-Encoding: "+(Jt?"quoted-printable":"base64")),vt.push("Content-Type: "+$r(Ht,Ot)),vt.push(""),vt.push(Jt?Vr(Bt):Hr(Bt))}return vt.push(xt+`--\r
`),vt.join(`\r
`)}function Kr(ct){var _t={};return lt(_t,ct),_t}function jr(ct,_t,pt,xt){var vt=xt&&xt.unsafe;vt||lt(ct);var wt=!vt&&CFB.find(ct,_t);if(!wt){var Ot=ct.FullPaths[0];_t.slice(0,Ot.length)==Ot?Ot=_t:(Ot.slice(-1)!="/"&&(Ot+="/"),Ot=(Ot+_t).replace("//","/")),wt={name:o(_t),type:2},ct.FileIndex.push(wt),ct.FullPaths.push(Ot),vt||CFB.utils.cfb_gc(ct)}return wt.content=pt,wt.size=pt?pt.length:0,xt&&(xt.CLSID&&(wt.clsid=xt.CLSID),xt.mt&&(wt.mt=xt.mt),xt.ct&&(wt.ct=xt.ct)),wt}function qr(ct,_t){lt(ct);var pt=CFB.find(ct,_t);if(pt){for(var xt=0;xt<ct.FileIndex.length;++xt)if(ct.FileIndex[xt]==pt)return ct.FileIndex.splice(xt,1),ct.FullPaths.splice(xt,1),!0}return!1}function Yr(ct,_t,pt){lt(ct);var xt=CFB.find(ct,_t);if(xt){for(var vt=0;vt<ct.FileIndex.length;++vt)if(ct.FileIndex[vt]==xt)return ct.FileIndex[vt].name=o(pt),ct.FullPaths[vt]=pt,!0}return!1}function Jr(ct){yt(ct,!0)}return s.find=mt,s.read=ht,s.parse=b,s.write=Lt,s.writeFile=jt,s.utils={cfb_new:Kr,cfb_add:jr,cfb_del:qr,cfb_mov:Yr,cfb_gc:Jr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:ft,_deflateRaw:rr,_inflateRaw:Pr,consts:kt},s}();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,s,a){if(typeof Deno<"u"){if(a&&typeof s=="string")switch(a){case"utf8":s=new TextEncoder(a).encode(s);break;case"binary":s=s2ab(s);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,s)}var i=a=="utf8"?utf8write(s):s;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,e);if(typeof Blob<"u"){var o=new Blob([blobify(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var d=document.createElement("a");if(d.download!=null)return d.download=e,d.href=c,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(e);return h.open("w"),h.encoding="binary",Array.isArray(s)&&(s=a2s(s)),h.write(s),h.close(),s}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(e);s.open("r"),s.encoding="binary";var a=s.read();return s.close(),a}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}function keys(e){for(var s=Object.keys(e),a=[],i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e,s[i])&&a.push(s[i]);return a}function evert_key(e,s){for(var a=[],i=keys(e),o=0;o!==i.length;++o)a[e[i[o]][s]]==null&&(a[e[i[o]][s]]=i[o]);return a}function evert(e){for(var s=[],a=keys(e),i=0;i!==a.length;++i)s[e[a[i]]]=a[i];return s}function evert_num(e){for(var s=[],a=keys(e),i=0;i!==a.length;++i)s[e[a[i]]]=parseInt(a[i],10);return s}function evert_arr(e){for(var s=[],a=keys(e),i=0;i!==a.length;++i)s[e[a[i]]]==null&&(s[e[a[i]]]=[]),s[e[a[i]]].push(a[i]);return s}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,s){var a=e.getTime(),i=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(a-i)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var s=new Date;return s.setTime(e*24*60*60*1e3+dnthresh),s.getTimezoneOffset()!==refoffset&&s.setTime(s.getTime()+(s.getTimezoneOffset()-refoffset)*6e4),s}function parse_isodur(e){var s=0,a=0,i=!1,o=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!o)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=o.length;++c)if(o[c]){switch(a=1,c>3&&(i=!0),o[c].slice(o[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+o[c].slice(o[c].length-1));case"D":a*=24;case"H":a*=60;case"M":if(i)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}s+=a*parseInt(o[c],10)}return s}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,s){var a=new Date(e);if(good_pd)return s>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):s<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(a.getFullYear())){var i=a.getFullYear();return e.indexOf(""+i)>-1||a.setFullYear(a.getFullYear()+100),a}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function cc2str(e,s){if(has_buf&&Buffer.isBuffer(e)){if(s){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(s){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return a[c]||c})}catch{}for(var i=[],o=0;o!=e.length;++o)i.push(String.fromCharCode(e[o]));return i.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=dup(e[a]));return s}function fill(e,s){for(var a="";a.length<s;)a+=e;return a}function fuzzynum(e){var s=Number(e);if(!isNaN(s))return isFinite(s)?s:NaN;if(!/\d/.test(e))return s;var a=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(s=Number(i))||(i=i.replace(/[(](.*)[)]/,function(o,c){return a=-a,c}),!isNaN(s=Number(i)))?s/a:s}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var s=new Date(e),a=new Date(NaN),i=s.getYear(),o=s.getMonth(),c=s.getDate();if(isNaN(c))return a;var d=e.toLowerCase();if(d.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(d=d.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),d.length>3&&lower_months.indexOf(d)==-1)return a}else if(d.match(/[a-z]/))return a;return i<0||i>8099?a:(o>0||c>1)&&i!=101?s:e.match(/[^-0-9:,\/\\]/)?a:s}var split_regex=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,i,o){if(e||typeof i=="string")return a.split(i);for(var c=a.split(i),d=[c[0]],h=1;h<c.length;++h)d.push(o),d.push(c[h]);return d}}();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var s=e._data.getContent();return typeof s=="string"?char_codes(s):Array.prototype.slice.call(s)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,s){for(var a=e.FullPaths||keys(e.files),i=s.toLowerCase().replace(/[\/]/g,"\\"),o=i.replace(/\\/g,"/"),c=0;c<a.length;++c){var d=a[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==d||o==d)return e.files?e.files[a[c]]:e.FileIndex[c]}return null}function getzipfile(e,s){var a=safegetzipfile(e,s);if(a==null)throw new Error("Cannot find file "+s+" in zip");return a}function getzipdata(e,s,a){if(!a)return getdata(getzipfile(e,s));if(!s)return null;try{return getzipdata(e,s)}catch{return null}}function getzipstr(e,s,a){if(!a)return getdatastr(getzipfile(e,s));if(!s)return null;try{return getzipstr(e,s)}catch{return null}}function getzipbin(e,s,a){return getdatabin(getzipfile(e,s))}function zipentries(e){for(var s=e.FullPaths||keys(e.files),a=[],i=0;i<s.length;++i)s[i].slice(-1)!="/"&&a.push(s[i].replace(/^Root Entry[\/]/,""));return a.sort()}function zip_add_file(e,s,a){if(e.FullPaths){if(typeof a=="string"){var i;return has_buf?i=Buffer_from(a):i=utf8decode(a),CFB.utils.cfb_add(e,s,i)}CFB.utils.cfb_add(e,s,a)}else e.file(s,a)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(e,s){switch(s.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+s.type)}function resolve_path(e,s){if(e.charAt(0)=="/")return e.slice(1);var a=s.split("/");s.slice(-1)!="/"&&a.pop();for(var i=e.split("/");i.length!==0;){var o=i.shift();o===".."?a.pop():o!=="."&&a.push(o)}return a.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,s,a){for(var i={},o=0,c=0;o!==e.length&&!((c=e.charCodeAt(o))===32||c===10||c===13);++o);if(s||(i[0]=e.slice(0,o)),o===e.length)return i;var d=e.match(attregexg),h=0,g="",_=0,b="",j="",_e=1;if(d)for(_=0;_!=d.length;++_){for(j=d[_],c=0;c!=j.length&&j.charCodeAt(c)!==61;++c);for(b=j.slice(0,c).trim();j.charCodeAt(c+1)==32;)++c;for(_e=(o=j.charCodeAt(c+1))==34||o==39?1:0,g=j.slice(c+1+_e,j.length-_e),h=0;h!=b.length&&b.charCodeAt(h)!==58;++h);if(h===b.length)b.indexOf("_")>0&&(b=b.slice(0,b.indexOf("_"))),i[b]=g,i[b.toLowerCase()]=g;else{var tt=(h===5&&b.slice(0,5)==="xmlns"?"xmlns":"")+b.slice(h+1);if(i[tt]&&b.slice(h-3,h)=="ext")continue;i[tt]=g,i[tt.toLowerCase()]=g}}return i}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,s=/_x([\da-fA-F]{4})_/ig;return function a(i){var o=i+"",c=o.indexOf("<![CDATA[");if(c==-1)return o.replace(e,function(h,g){return encodings[h]||String.fromCharCode(parseInt(g,h.indexOf("x")>-1?16:10))||h}).replace(s,function(h,g){return String.fromCharCode(parseInt(g,16))});var d=o.indexOf("]]>");return a(o.slice(0,c))+o.slice(c+9,d)+a(o.slice(d+3))}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var s=e+"";return s.replace(decregex,function(a){return rencoding[a]}).replace(charegex,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var s=e+"";return s.replace(decregex,function(a){return rencoding[a]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var s=e+"";return s.replace(decregex,function(a){return rencoding[a]}).replace(htmlcharegex,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var e=/&#(\d+);/g;function s(a,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(e,s)}}();function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var s="",a=0,i=0,o=0,c=0,d=0,h=0;a<e.length;){if(i=e.charCodeAt(a++),i<128){s+=String.fromCharCode(i);continue}if(o=e.charCodeAt(a++),i>191&&i<224){d=(i&31)<<6,d|=o&63,s+=String.fromCharCode(d);continue}if(c=e.charCodeAt(a++),i<240){s+=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63);continue}d=e.charCodeAt(a++),h=((i&7)<<18|(o&63)<<12|(c&63)<<6|d&63)-65536,s+=String.fromCharCode(55296+(h>>>10&1023)),s+=String.fromCharCode(56320+(h&1023))}return s}function utf8readb(e){var s=new_raw_buf(2*e.length),a,i,o=1,c=0,d=0,h;for(i=0;i<e.length;i+=o)o=1,(h=e.charCodeAt(i))<128?a=h:h<224?(a=(h&31)*64+(e.charCodeAt(i+1)&63),o=2):h<240?(a=(h&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),o=3):(o=4,a=(h&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),a-=65536,d=55296+(a>>>10&1023),a=56320+(a&1023)),d!==0&&(s[c++]=d&255,s[c++]=d>>>8,d=0),s[c++]=a%256,s[c++]=a>>>8;return s.slice(0,c).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var s=[],a=0,i=0,o=0;a<e.length;)switch(i=e.charCodeAt(a++),!0){case i<128:s.push(String.fromCharCode(i));break;case i<2048:s.push(String.fromCharCode(192+(i>>6))),s.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,o=e.charCodeAt(a++)-56320+(i<<10),s.push(String.fromCharCode(240+(o>>18&7))),s.push(String.fromCharCode(144+(o>>12&63))),s.push(String.fromCharCode(128+(o>>6&63))),s.push(String.fromCharCode(128+(o&63)));break;default:s.push(String.fromCharCode(224+(i>>12))),s.push(String.fromCharCode(128+(i>>6&63))),s.push(String.fromCharCode(128+(i&63)))}return s.join("")},matchtag=function(){var e={};return function(a,i){var o=a+"|"+(i||"");return e[o]?e[o]:e[o]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",i||"")}}(),htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]});return function(a){for(var i=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<e.length;++o)i=i.replace(e[o][0],e[o][1]);return i}}(),vtregex=function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,s){var a=parsexmltag(e),i=e.match(vtregex(a.baseType))||[],o=[];if(i.length!=a.size){if(s.WTF)throw new Error("unexpected vector length "+i.length+" != "+a.size);return o}return i.forEach(function(c){var d=c.replace(vtvregex,"").match(vtmregex);d&&o.push({v:utf8read(d[2]),t:d[1]})}),o}var wtregex=/(^\s|\s$|\n)/;function writetag(e,s){return"<"+e+(s.match(wtregex)?' xml:space="preserve"':"")+">"+s+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(s){return" "+s+'="'+e[s]+'"'}).join("")}function writextag(e,s,a){return"<"+e+(a!=null?wxt_helper(a):"")+(s!=null?(s.match(wtregex)?' xml:space="preserve"':"")+">"+s+"</"+e:"/")+">"}function write_w3cdtf(e,s){try{return e.toISOString().replace(/\.\d*/,"")}catch(a){if(s)throw a}return""}function write_vt(e,s){switch(typeof e){case"string":var a=writextag("vt:lpwstr",escapexml(e));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,s){for(var a=1-2*(e[s+7]>>>7),i=((e[s+7]&127)<<4)+(e[s+6]>>>4&15),o=e[s+6]&15,c=5;c>=0;--c)o=o*256+e[s+c];return i==2047?o==0?a*(1/0):NaN:(i==0?i=-1022:(i-=1023,o+=Math.pow(2,52)),a*Math.pow(2,i-52)*o)}function write_double_le(e,s,a){var i=(s<0||1/s==-1/0?1:0)<<7,o=0,c=0,d=i?-s:s;isFinite(d)?d==0?o=c=0:(o=Math.floor(Math.log(d)/Math.LN2),c=d*Math.pow(2,52-o),o<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?o=-1022:(c-=Math.pow(2,52),o+=1023)):(o=2047,c=isNaN(s)?26985:0);for(var h=0;h<=5;++h,c/=256)e[a+h]=c&255;e[a+6]=(o&15)<<4|c&15,e[a+7]=o>>4|i}var ___toBuffer=function(e){for(var s=[],a=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var o=0,c=e[0][i].length;o<c;o+=a)s.push.apply(s,e[0][i].slice(o,o+a));return s},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(s){return Buffer.isBuffer(s)?s:Buffer_from(s)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,s,a){for(var i=[],o=s;o<a;o+=2)i.push(String.fromCharCode(__readUInt16LE(e,o)));return i.join("").replace(chr0,"")},__utf16le=has_buf?function(e,s,a){return Buffer.isBuffer(e)?e.toString("utf16le",s,a).replace(chr0,""):___utf16le(e,s,a)}:___utf16le,___hexlify=function(e,s,a){for(var i=[],o=s;o<s+a;++o)i.push(("0"+e[o].toString(16)).slice(-2));return i.join("")},__hexlify=has_buf?function(e,s,a){return Buffer.isBuffer(e)?e.toString("hex",s,s+a):___hexlify(e,s,a)}:___hexlify,___utf8=function(e,s,a){for(var i=[],o=s;o<a;o++)i.push(String.fromCharCode(__readUInt8(e,o)));return i.join("")},__utf8=has_buf?function e(s,a,i){return Buffer.isBuffer(s)?s.toString("utf8",a,i):___utf8(s,a,i)}:___utf8,___lpstr=function(e,s){var a=__readUInt32LE(e,s);return a>0?__utf8(e,s+4,s+4+a-1):""},__lpstr=___lpstr,___cpstr=function(e,s){var a=__readUInt32LE(e,s);return a>0?__utf8(e,s+4,s+4+a-1):""},__cpstr=___cpstr,___lpwstr=function(e,s){var a=2*__readUInt32LE(e,s);return a>0?__utf8(e,s+4,s+4+a-1):""},__lpwstr=___lpwstr,___lpp4=function e(s,a){var i=__readUInt32LE(s,a);return i>0?__utf16le(s,a+4,a+4+i):""},__lpp4=___lpp4,___8lpp4=function(e,s){var a=__readUInt32LE(e,s);return a>0?__utf8(e,s+4,s+4+a):""},__8lpp4=___8lpp4,___double=function(e,s){return read_double_le(e,s)},__double=___double,is_buf=function e(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};has_buf&&(__lpstr=function(s,a){if(!Buffer.isBuffer(s))return ___lpstr(s,a);var i=s.readUInt32LE(a);return i>0?s.toString("utf8",a+4,a+4+i-1):""},__cpstr=function(s,a){if(!Buffer.isBuffer(s))return ___cpstr(s,a);var i=s.readUInt32LE(a);return i>0?s.toString("utf8",a+4,a+4+i-1):""},__lpwstr=function(s,a){if(!Buffer.isBuffer(s))return ___lpwstr(s,a);var i=2*s.readUInt32LE(a);return s.toString("utf16le",a+4,a+4+i-1)},__lpp4=function(s,a){if(!Buffer.isBuffer(s))return ___lpp4(s,a);var i=s.readUInt32LE(a);return s.toString("utf16le",a+4,a+4+i)},__8lpp4=function(s,a){if(!Buffer.isBuffer(s))return ___8lpp4(s,a);var i=s.readUInt32LE(a);return s.toString("utf8",a+4,a+4+i)},__double=function(s,a){return Buffer.isBuffer(s)?s.readDoubleLE(a):___double(s,a)},is_buf=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array});var __readUInt8=function(e,s){return e[s]},__readUInt16LE=function(e,s){return e[s+1]*256+e[s]},__readInt16LE=function(e,s){var a=e[s+1]*256+e[s];return a<32768?a:(65535-a+1)*-1},__readUInt32LE=function(e,s){return e[s+3]*(1<<24)+(e[s+2]<<16)+(e[s+1]<<8)+e[s]},__readInt32LE=function(e,s){return e[s+3]<<24|e[s+2]<<16|e[s+1]<<8|e[s]},__readInt32BE=function(e,s){return e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3]};function ReadShift(e,s){var a="",i,o,c=[],d,h,g,_;switch(s){case"dbcs":if(_=this.l,has_buf&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)a+=String.fromCharCode(__readUInt16LE(this,_)),_+=2;e*=2;break;case"utf8":a=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,a=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":a=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":a=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":a=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),a=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),a=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(d=__readUInt8(this,this.l+e++))!==0;)c.push(_getchar(d));a=c.join("");break;case"_wstr":for(e=0,a="";(d=__readUInt16LE(this,this.l+e))!==0;)c.push(_getchar(d)),e+=2;e+=2,a=c.join("");break;case"dbcs-cont":for(a="",_=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(_)!==-1)return d=__readUInt8(this,_),this.l=_+1,h=ReadShift.call(this,e-g,d?"dbcs-cont":"sbcs-cont"),c.join("")+h;c.push(_getchar(__readUInt16LE(this,_))),_+=2}a=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",_=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(_)!==-1)return d=__readUInt8(this,_),this.l=_+1,h=ReadShift.call(this,e-g,d?"dbcs-cont":"sbcs-cont"),c.join("")+h;c.push(_getchar(__readUInt8(this,_))),_+=1}a=c.join("");break;default:switch(e){case 1:return i=__readUInt8(this,this.l),this.l++,i;case 2:return i=(s==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,i;case 4:case-4:return s==="i"||!(this[this.l+3]&128)?(i=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,i):(o=__readUInt32LE(this,this.l),this.l+=4,o);case 8:case-8:if(s==="f")return e==8?o=__double(this,this.l):o=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:a=__hexlify(this,this.l,e);break}}return this.l+=e,a}var __writeUInt32LE=function(e,s,a){e[a]=s&255,e[a+1]=s>>>8&255,e[a+2]=s>>>16&255,e[a+3]=s>>>24&255},__writeInt32LE=function(e,s,a){e[a]=s&255,e[a+1]=s>>8&255,e[a+2]=s>>16&255,e[a+3]=s>>24&255},__writeUInt16LE=function(e,s,a){e[a]=s&255,e[a+1]=s>>>8&255};function WriteShift(e,s,a){var i=0,o=0;if(a==="dbcs"){for(o=0;o!=s.length;++o)__writeUInt16LE(this,s.charCodeAt(o),this.l+2*o);i=2*s.length}else if(a==="sbcs"){for(s=s.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=s.length;++o)this[this.l+o]=s.charCodeAt(o)&255;i=s.length}else if(a==="hex"){for(;o<e;++o)this[this.l++]=parseInt(s.slice(2*o,2*o+2),16)||0;return this}else if(a==="utf16le"){var c=Math.min(this.l+e,this.length);for(o=0;o<Math.min(s.length,e);++o){var d=s.charCodeAt(o);this[this.l++]=d&255,this[this.l++]=d>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=s&255;break;case 2:i=2,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255;break;case 3:i=3,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255,s>>>=8,this[this.l+2]=s&255;break;case 4:i=4,__writeUInt32LE(this,s,this.l);break;case 8:if(i=8,a==="f"){write_double_le(this,s,this.l);break}case 16:break;case-4:i=4,__writeInt32LE(this,s,this.l);break}return this.l+=i,this}function CheckField(e,s){var a=__hexlify(this,this.l,e.length>>1);if(a!==e)throw new Error(s+"Expected "+e+" saw "+a);this.l+=e.length>>1}function prep_blob(e,s){e.l=s,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,s){e.l+=s}function new_buf(e){var s=new_raw_buf(e);return prep_blob(s,0),s}function recordhopper(e,s,a){if(e){var i,o,c;prep_blob(e,e.l||0);for(var d=e.length,h=0,g=0;e.l<d;){h=e.read_shift(1),h&128&&(h=(h&127)+((e.read_shift(1)&127)<<7));var _=XLSBRecordEnum[h]||XLSBRecordEnum[65535];for(i=e.read_shift(1),c=i&127,o=1;o<4&&i&128;++o)c+=((i=e.read_shift(1))&127)<<7*o;g=e.l+c;var b=_.f&&_.f(e,c,a);if(e.l=g,s(b,_,h))return}}}function buf_array(){var e=[],s=has_buf?256:2048,a=function(_){var b=new_buf(_);return prep_blob(b,0),b},i=a(s),o=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},c=function(_){return i&&_<i.length-i.l?i:(o(),i=a(Math.max(_+1,s)))},d=function(){return o(),bconcat(e)},h=function(_){o(),i=_,i.l==null&&(i.l=i.length),c(s)};return{next:c,push:h,end:d,_bufs:e}}function write_record(e,s,a,i){var o=+s,c;if(!isNaN(o)){i||(i=XLSBRecordEnum[o].p||(a||[]).length||0),c=1+(o>=128?1:0)+1,i>=128&&++c,i>=16384&&++c,i>=2097152&&++c;var d=e.next(c);o<=127?d.write_shift(1,o):(d.write_shift(1,(o&127)+128),d.write_shift(1,o>>7));for(var h=0;h!=4;++h)if(i>=128)d.write_shift(1,(i&127)+128),i>>=7;else{d.write_shift(1,i);break}i>0&&is_buf(a)&&e.push(a)}}function shift_cell_xls(e,s,a){var i=dup(e);if(s.s?(i.cRel&&(i.c+=s.s.c),i.rRel&&(i.r+=s.s.r)):(i.cRel&&(i.c+=s.c),i.rRel&&(i.r+=s.r)),!a||a.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function shift_range_xls(e,s,a){var i=dup(e);return i.s=shift_cell_xls(i.s,s.s,a),i.e=shift_cell_xls(i.e,s.s,a),i}function encode_cell_xls(e,s){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=s>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=s>8?1048576:s>5?65536:16384;var a=encode_cell(e);return!e.cRel&&e.cRel!=null&&(a=fix_col(a)),!e.rRel&&e.rRel!=null&&(a=fix_row(a)),a}function encode_range_xls(e,s){return e.s.r==0&&!e.s.rRel&&e.e.r==(s.biff>=12?1048575:s.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(s.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,s.biff)+":"+encode_cell_xls(e.e,s.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var s=unfix_col(e),a=0,i=0;i!==s.length;++i)a=26*a+s.charCodeAt(i)-64;return a-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var s="";for(++e;e;e=Math.floor((e-1)/26))s=String.fromCharCode((e-1)%26+65)+s;return s}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var s=0,a=0,i=0;i<e.length;++i){var o=e.charCodeAt(i);o>=48&&o<=57?s=10*s+(o-48):o>=65&&o<=90&&(a=26*a+(o-64))}return{c:a-1,r:s-1}}function encode_cell(e){for(var s=e.c+1,a="";s;s=(s-1)/26|0)a=String.fromCharCode((s-1)%26+65)+a;return a+(e.r+1)}function decode_range(e){var s=e.indexOf(":");return s==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,s)),e:decode_cell(e.slice(s+1))}}function encode_range(e,s){return typeof s>"u"||typeof s=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof s!="string"&&(s=encode_cell(s)),e==s?e:e+":"+s)}function safe_decode_range(e){var s={s:{c:0,r:0},e:{c:0,r:0}},a=0,i=0,o=0,c=e.length;for(a=0;i<c&&!((o=e.charCodeAt(i)-64)<1||o>26);++i)a=26*a+o;for(s.s.c=--a,a=0;i<c&&!((o=e.charCodeAt(i)-48)<0||o>9);++i)a=10*a+o;if(s.s.r=--a,i===c||o!=10)return s.e.c=s.s.c,s.e.r=s.s.r,s;for(++i,a=0;i!=c&&!((o=e.charCodeAt(i)-64)<1||o>26);++i)a=26*a+o;for(s.e.c=--a,a=0;i!=c&&!((o=e.charCodeAt(i)-48)<0||o>9);++i)a=10*a+o;return s.e.r=--a,s}function safe_format_cell(e,s){var a=e.t=="d"&&s instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,a?datenum(s):s)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(a?14:0),a?datenum(s):s)}catch{return""+s}}function format_cell(e,s,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?BErr[e.v]||e.v:s==null?safe_format_cell(e,e.v):safe_format_cell(e,s))}function sheet_to_workbook(e,s){var a=s&&s.sheet?s.sheet:"Sheet1",i={};return i[a]=e,{SheetNames:[a],Sheets:i}}function sheet_add_aoa(e,s,a){var i=a||{},o=e?Array.isArray(e):i.dense,c=e||(o?[]:{}),d=0,h=0;if(c&&i.origin!=null){if(typeof i.origin=="number")d=i.origin;else{var g=typeof i.origin=="string"?decode_cell(i.origin):i.origin;d=g.r,h=g.c}c["!ref"]||(c["!ref"]="A1:A1")}var _={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var b=safe_decode_range(c["!ref"]);_.s.c=b.s.c,_.s.r=b.s.r,_.e.c=Math.max(_.e.c,b.e.c),_.e.r=Math.max(_.e.r,b.e.r),d==-1&&(_.e.r=d=b.e.r+1)}for(var j=0;j!=s.length;++j)if(s[j]){if(!Array.isArray(s[j]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _e=0;_e!=s[j].length;++_e)if(!(typeof s[j][_e]>"u")){var tt={v:s[j][_e]},rt=d+j,et=h+_e;if(_.s.r>rt&&(_.s.r=rt),_.s.c>et&&(_.s.c=et),_.e.r<rt&&(_.e.r=rt),_.e.c<et&&(_.e.c=et),s[j][_e]&&typeof s[j][_e]=="object"&&!Array.isArray(s[j][_e])&&!(s[j][_e]instanceof Date))tt=s[j][_e];else if(Array.isArray(tt.v)&&(tt.f=s[j][_e][1],tt.v=tt.v[0]),tt.v===null)if(tt.f)tt.t="n";else if(i.nullError)tt.t="e",tt.v=0;else if(i.sheetStubs)tt.t="z";else continue;else typeof tt.v=="number"?tt.t="n":typeof tt.v=="boolean"?tt.t="b":tt.v instanceof Date?(tt.z=i.dateNF||table_fmt[14],i.cellDates?(tt.t="d",tt.w=SSF_format(tt.z,datenum(tt.v))):(tt.t="n",tt.v=datenum(tt.v),tt.w=SSF_format(tt.z,tt.v))):tt.t="s";if(o)c[rt]||(c[rt]=[]),c[rt][et]&&c[rt][et].z&&(tt.z=c[rt][et].z),c[rt][et]=tt;else{var st=encode_cell({c:et,r:rt});c[st]&&c[st].z&&(tt.z=c[st].z),c[st]=tt}}}return _.s.c<1e7&&(c["!ref"]=encode_range(_)),c}function aoa_to_sheet(e,s){return sheet_add_aoa(null,e,s)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,s){return s||(s=new_buf(4)),s.write_shift(4,e),s}function parse_XLWideString(e){var s=e.read_shift(4);return s===0?"":e.read_shift(s,"dbcs")}function write_XLWideString(e,s){var a=!1;return s==null&&(a=!0,s=new_buf(4+2*e.length)),s.write_shift(4,e.length),e.length>0&&s.write_shift(0,e,"dbcs"),a?s.slice(0,s.l):s}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,s){return s||(s=new_buf(4)),s.write_shift(2,0),s.write_shift(2,0),s}function parse_RichStr(e,s){var a=e.l,i=e.read_shift(1),o=parse_XLWideString(e),c=[],d={t:o,h:o};if(i&1){for(var h=e.read_shift(4),g=0;g!=h;++g)c.push(parse_StrRun(e));d.r=c}else d.r=[{ich:0,ifnt:0}];return e.l=a+s,d}function write_RichStr(e,s){var a=!1;return s==null&&(a=!0,s=new_buf(15+4*e.t.length)),s.write_shift(1,0),write_XLWideString(e.t,s),a?s.slice(0,s.l):s}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,s){var a=!1;return s==null&&(a=!0,s=new_buf(23+4*e.t.length)),s.write_shift(1,1),write_XLWideString(e.t,s),s.write_shift(4,1),write_StrRun({ich:0,ifnt:0},s),a?s.slice(0,s.l):s}function parse_XLSBCell(e){var s=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:s,iStyleRef:a}}function write_XLSBCell(e,s){return s==null&&(s=new_buf(8)),s.write_shift(-4,e.c),s.write_shift(3,e.iStyleRef||e.s),s.write_shift(1,0),s}function parse_XLSBShortCell(e){var s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:s}}function write_XLSBShortCell(e,s){return s==null&&(s=new_buf(4)),s.write_shift(3,e.iStyleRef||e.s),s.write_shift(1,0),s}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var s=e.read_shift(4);return s===0||s===4294967295?"":e.read_shift(s,"dbcs")}function write_XLNullableWideString(e,s){var a=!1;return s==null&&(a=!0,s=new_buf(127)),s.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&s.write_shift(0,e,"dbcs"),a?s.slice(0,s.l):s}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var s=e.slice(e.l,e.l+4),a=s[0]&1,i=s[0]&2;e.l+=4;var o=i===0?__double([0,0,0,0,s[0]&252,s[1],s[2],s[3]],0):__readInt32LE(s,0)>>2;return a?o/100:o}function write_RkNumber(e,s){s==null&&(s=new_buf(4));var a=0,i=0,o=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?i=1:o==(o|0)&&o>=-(1<<29)&&o<1<<29&&(i=1,a=1),i)s.write_shift(-4,((a?o:e)<<2)+(a+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var s={s:{},e:{}};return s.s.r=e.read_shift(4),s.e.r=e.read_shift(4),s.s.c=e.read_shift(4),s.e.c=e.read_shift(4),s}function write_RfX(e,s){return s||(s=new_buf(16)),s.write_shift(4,e.s.r),s.write_shift(4,e.e.r),s.write_shift(4,e.s.c),s.write_shift(4,e.e.c),s}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,s){return(s||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var s={},a=e.read_shift(1),i=a>>>1,o=e.read_shift(1),c=e.read_shift(2,"i"),d=e.read_shift(1),h=e.read_shift(1),g=e.read_shift(1);switch(e.l++,i){case 0:s.auto=1;break;case 1:s.index=o;var _=XLSIcv[o];_&&(s.rgb=rgb2Hex(_));break;case 2:s.rgb=rgb2Hex([d,h,g]);break;case 3:s.theme=o;break}return c!=0&&(s.tint=c>0?c/32767:c/32768),s}function write_BrtColor(e,s){if(s||(s=new_buf(8)),!e||e.auto)return s.write_shift(4,0),s.write_shift(4,0),s;e.index!=null?(s.write_shift(1,2),s.write_shift(1,e.index)):e.theme!=null?(s.write_shift(1,6),s.write_shift(1,e.theme)):(s.write_shift(1,5),s.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),s.write_shift(2,a),!e.rgb||e.theme!=null)s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);else{var i=e.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),s.write_shift(1,parseInt(i.slice(0,2),16)),s.write_shift(1,parseInt(i.slice(2,4),16)),s.write_shift(1,parseInt(i.slice(4,6),16)),s.write_shift(1,255)}return s}function parse_FontFlags(e){var s=e.read_shift(1);e.l++;var a={fBold:s&1,fItalic:s&2,fUnderline:s&4,fStrikeout:s&8,fOutline:s&16,fShadow:s&32,fCondense:s&64,fExtend:s&128};return a}function write_FontFlags(e,s){s||(s=new_buf(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return s.write_shift(1,a),s.write_shift(1,0),s}function parse_ClipboardFormatOrString(e,s){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,s==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(s){return[s>>16&255,s>>8&255,s&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var s=new_ct();if(!e||!e.match)return s;var a={};if((e.match(tagregex)||[]).forEach(function(i){var o=parsexmltag(i);switch(o[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":s.xmlns=o["xmlns"+(o[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[o.Extension]=o.ContentType;break;case"<Override":s[ct2type[o.ContentType]]!==void 0&&s[ct2type[o.ContentType]].push(o.PartName);break}}),s.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+s.xmlns);return s.calcchain=s.calcchains.length>0?s.calcchains[0]:"",s.sst=s.strs.length>0?s.strs[0]:"",s.style=s.styles.length>0?s.styles[0]:"",s.defaults=a,delete s.calcchains,s}function write_ct(e,s){var a=evert_arr(ct2type),i=[],o;i[i.length]=XML_HEADER,i[i.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return writextag("Default",null,{Extension:g[0],ContentType:g[1]})}));var c=function(g){e[g]&&e[g].length>0&&(o=e[g][0],i[i.length]=writextag("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:CT_LIST[g][s.bookType]||CT_LIST[g].xlsx}))},d=function(g){(e[g]||[]).forEach(function(_){i[i.length]=writextag("Override",null,{PartName:(_[0]=="/"?"":"/")+_,ContentType:CT_LIST[g][s.bookType]||CT_LIST[g].xlsx})})},h=function(g){(e[g]||[]).forEach(function(_){i[i.length]=writextag("Override",null,{PartName:(_[0]=="/"?"":"/")+_,ContentType:a[g][0]})})};return c("workbooks"),d("sheets"),d("charts"),h("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),d("metadata"),h("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var s=e.lastIndexOf("/");return e.slice(0,s+1)+"_rels/"+e.slice(s+1)+".rels"}function parse_rels(e,s){var a={"!id":{}};if(!e)return a;s.charAt(0)!=="/"&&(s="/"+s);var i={};return(e.match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);if(c[0]==="<Relationship"){var d={};d.Type=c.Type,d.Target=c.Target,d.Id=c.Id,c.TargetMode&&(d.TargetMode=c.TargetMode);var h=c.TargetMode==="External"?c.Target:resolve_path(c.Target,s);a[h]=d,i[c.Id]=d}}),a["!id"]=i,a}function write_rels(e){var s=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(a){s[s.length]=writextag("Relationship",null,e["!id"][a])}),s.length>2&&(s[s.length]="</Relationships>",s[1]=s[1].replace("/>",">")),s.join("")}function add_rels(e,s,a,i,o,c){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),s<0)for(s=e["!idx"];e["!id"]["rId"+s];++s);if(e["!idx"]=s+1,o.Id="rId"+s,o.Type=i,o.Target=a,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+s);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,s}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,s){for(var a=xlml_normalize(e),i,o;i=xlmlregex.exec(a);)switch(i[3]){case"manifest":break;case"file-entry":if(o=parsexmltag(i[0],!1),o.path=="/"&&o.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(s&&s.WTF)throw i}}function write_manifest(e){var s=[XML_HEADER];s.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),s.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<e.length;++a)s.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+`"/>
`);return s.push("</manifest:manifest>"),s.join("")}function write_rdf_type(e,s,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+s+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,s){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+s+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var s=[XML_HEADER];s.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=e.length;++a)s.push(write_rdf_type(e[a][0],e[a][1])),s.push(write_rdf_has("",e[a][0]));return s.push(write_rdf_type("","Document","pkg")),s.push("</rdf:RDF>"),s.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var e=new Array(CORE_PROPS.length),s=0;s<CORE_PROPS.length;++s){var a=CORE_PROPS[s],i="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[s]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e}();function parse_core_props(e){var s={};e=utf8read(e);for(var a=0;a<CORE_PROPS.length;++a){var i=CORE_PROPS[a],o=e.match(CORE_PROPS_REGEX[a]);o!=null&&o.length>0&&(s[i[1]]=unescapexml(o[1])),i[2]==="date"&&s[i[1]]&&(s[i[1]]=parseDate(s[i[1]]))}return s}function cp_doit(e,s,a,i,o){o[e]!=null||s==null||s===""||(o[e]=s,s=escapexml(s),i[i.length]=a?writextag(e,s,a):writetag(e,s))}function write_core_props(e,s){var a=s||{},i=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],o={};if(!e&&!a.Props)return i.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},i,o),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},i,o));for(var c=0;c!=CORE_PROPS.length;++c){var d=CORE_PROPS[c],h=a.Props&&a.Props[d[1]]!=null?a.Props[d[1]]:e?e[d[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&cp_doit(d[0],h,null,i,o)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(e,s,a,i){var o=[];if(typeof e=="string")o=parseVector(e,i);else for(var c=0;c<e.length;++c)o=o.concat(e[c].map(function(b){return{v:b}}));var d=typeof s=="string"?parseVector(s,i).map(function(b){return b.v}):s,h=0,g=0;if(d.length>0)for(var _=0;_!==o.length;_+=2){switch(g=+o[_+1].v,o[_].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=g,a.SheetNames=d.slice(h,h+g);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=g,a.DefinedNames=d.slice(h,h+g);break;case"Charts":case"Diagramme":a.Chartsheets=g,a.ChartNames=d.slice(h,h+g);break}h+=g}}function parse_ext_props(e,s,a){var i={};return s||(s={}),e=utf8read(e),EXT_PROPS.forEach(function(o){var c=(e.match(matchtag(o[0]))||[])[1];switch(o[2]){case"string":c&&(s[o[1]]=unescapexml(c));break;case"bool":s[o[1]]=c==="true";break;case"raw":var d=e.match(new RegExp("<"+o[0]+"[^>]*>([\\s\\S]*?)</"+o[0]+">"));d&&d.length>0&&(i[o[1]]=d[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&load_props_pairs(i.HeadingPairs,i.TitlesOfParts,s,a),s}function write_ext_props(e){var s=[],a=writextag;return e||(e={}),e.Application="SheetJS",s[s.length]=XML_HEADER,s[s.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(i){if(e[i[1]]!==void 0){var o;switch(i[2]){case"string":o=escapexml(String(e[i[1]]));break;case"bool":o=e[i[1]]?"true":"false";break}o!==void 0&&(s[s.length]=a(i[0],o))}}),s[s.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),s[s.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(i){return"<vt:lpstr>"+escapexml(i)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,s){var a={},i="",o=e.match(custregex);if(o)for(var c=0;c!=o.length;++c){var d=o[c],h=parsexmltag(d);switch(h[0]){case"<?xml":break;case"<Properties":break;case"<property":i=unescapexml(h.name);break;case"</property>":i=null;break;default:if(d.indexOf("<vt:")===0){var g=d.split(">"),_=g[0].slice(4),b=g[1];switch(_){case"lpstr":case"bstr":case"lpwstr":a[i]=unescapexml(b);break;case"bool":a[i]=parsexmlbool(b);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[i]=parseInt(b,10);break;case"r4":case"r8":case"decimal":a[i]=parseFloat(b);break;case"filetime":case"date":a[i]=parseDate(b);break;case"cy":case"error":a[i]=unescapexml(b);break;default:if(_.slice(-1)=="/")break;s.WTF&&typeof console<"u"&&console.warn("Unexpected",d,_,g)}}else if(d.slice(0,2)!=="</"){if(s.WTF)throw new Error(d)}}}return a}function write_cust_props(e){var s=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return s.join("");var a=1;return keys(e).forEach(function(o){++a,s[s.length]=writextag("property",write_vt(e[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:escapexml(o)})}),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,s,a){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),s=evert_XLMLDPM[s]||s,e[s]=a}function xlml_write_docprops(e,s){var a=[];return keys(XLMLDocPropsMap).map(function(i){for(var o=0;o<CORE_PROPS.length;++o)if(CORE_PROPS[o][1]==i)return CORE_PROPS[o];for(o=0;o<EXT_PROPS.length;++o)if(EXT_PROPS[o][1]==i)return EXT_PROPS[o];throw i}).forEach(function(i){if(e[i[1]]!=null){var o=s&&s.Props&&s.Props[i[1]]!=null?s.Props[i[1]]:e[i[1]];switch(i[2]){case"date":o=new Date(o).toISOString().replace(/\.\d*Z/,"Z");break}typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),a.push(writetag(XLMLDocPropsMap[i[1]]||i[1],o))}}),writextag("DocumentProperties",a.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,s){var a=["Worksheets","SheetNames"],i="CustomDocumentProperties",o=[];return e&&keys(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var d=0;d<CORE_PROPS.length;++d)if(c==CORE_PROPS[d][1])return;for(d=0;d<EXT_PROPS.length;++d)if(c==EXT_PROPS[d][1])return;for(d=0;d<a.length;++d)if(c==a[d])return;var h=e[c],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h=String(h),o.push(writextag(escapexmltag(c),h,{"dt:dt":g}))}}),s&&keys(s).forEach(function(c){if(Object.prototype.hasOwnProperty.call(s,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var d=s[c],h="string";typeof d=="number"?(h="float",d=String(d)):d===!0||d===!1?(h="boolean",d=d?"1":"0"):d instanceof Date?(h="dateTime.tz",d=d.toISOString()):d=String(d),o.push(writextag(escapexmltag(c),d,{"dt:dt":h}))}}),"<"+i+' xmlns="'+XLMLNS.o+'">'+o.join("")+"</"+i+">"}function parse_FILETIME(e){var s=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+s/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(e){var s=typeof e=="string"?new Date(Date.parse(e)):e,a=s.getTime()/1e3+11644473600,i=a%Math.pow(2,32),o=(a-i)/Math.pow(2,32);i*=1e7,o*=1e7;var c=i/Math.pow(2,32)|0;c>0&&(i=i%Math.pow(2,32),o+=c);var d=new_buf(8);return d.write_shift(4,i),d.write_shift(4,o),d}function parse_lpstr(e,s,a){var i=e.l,o=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-i&3;)++e.l;return o}function parse_lpwstr(e,s,a){var i=e.read_shift(0,"lpwstr");return i}function parse_VtStringBase(e,s,a){return s===31?parse_lpwstr(e):parse_lpstr(e,s,a)}function parse_VtString(e,s,a){return parse_VtStringBase(e,s,a===!1?0:4)}function parse_VtUnalignedString(e,s){if(!s)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,s,0)}function parse_VtVecLpwstrValue(e){for(var s=e.read_shift(4),a=[],i=0;i!=s;++i){var o=e.l;a[i]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-o&2&&(e.l+=2)}return a}function parse_VtVecUnalignedLpstrValue(e){for(var s=e.read_shift(4),a=[],i=0;i!=s;++i)a[i]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return a}function parse_VtHeadingPair(e){var s=e.l,a=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-s&2&&(e.l+=2);var i=parse_TypedPropertyValue(e,VT_I4);return[a,i]}function parse_VtVecHeadingPairValue(e){for(var s=e.read_shift(4),a=[],i=0;i<s/2;++i)a.push(parse_VtHeadingPair(e));return a}function parse_dictionary(e,s){for(var a=e.read_shift(4),i={},o=0;o!=a;++o){var c=e.read_shift(4),d=e.read_shift(4);i[c]=e.read_shift(d,s===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),s===1200&&d%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),i}function parse_BLOB(e){var s=e.read_shift(4),a=e.slice(e.l,e.l+s);return e.l+=s,(s&3)>0&&(e.l+=4-(s&3)&3),a}function parse_ClipboardData(e){var s={};return s.Size=e.read_shift(4),e.l+=s.Size+3-(s.Size-1)%4,s}function parse_TypedPropertyValue(e,s,a){var i=e.read_shift(2),o,c=a||{};if(e.l+=2,s!==VT_VARIANT&&i!==s&&VT_CUSTOM.indexOf(s)===-1&&!((s&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+s+" saw "+i);switch(s===VT_VARIANT?i:s){case 2:return o=e.read_shift(2,"i"),c.raw||(e.l+=2),o;case 3:return o=e.read_shift(4,"i"),o;case 11:return e.read_shift(4)!==0;case 19:return o=e.read_shift(4),o;case 30:return parse_lpstr(e,i,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,i,!c.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,i).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return i==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+i)}}function write_TypedPropertyValue(e,s){var a=new_buf(4),i=new_buf(4);switch(a.write_shift(4,e==80?31:e),e){case 3:i.write_shift(-4,s);break;case 5:i=new_buf(8),i.write_shift(8,s,"f");break;case 11:i.write_shift(4,s?1:0);break;case 64:i=write_FILETIME(s);break;case 31:case 80:for(i=new_buf(4+2*(s.length+1)+(s.length%2?0:2)),i.write_shift(4,s.length+1),i.write_shift(0,s,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+s)}return bconcat([a,i])}function parse_PropertySet(e,s){var a=e.l,i=e.read_shift(4),o=e.read_shift(4),c=[],d=0,h=0,g=-1,_={};for(d=0;d!=o;++d){var b=e.read_shift(4),j=e.read_shift(4);c[d]=[b,j+a]}c.sort(function(it,nt){return it[1]-nt[1]});var _e={};for(d=0;d!=o;++d){if(e.l!==c[d][1]){var tt=!0;if(d>0&&s)switch(s[c[d-1][0]].t){case 2:e.l+2===c[d][1]&&(e.l+=2,tt=!1);break;case 80:e.l<=c[d][1]&&(e.l=c[d][1],tt=!1);break;case 4108:e.l<=c[d][1]&&(e.l=c[d][1],tt=!1);break}if((!s||d==0)&&e.l<=c[d][1]&&(tt=!1,e.l=c[d][1]),tt)throw new Error("Read Error: Expected address "+c[d][1]+" at "+e.l+" :"+d)}if(s){var rt=s[c[d][0]];if(_e[rt.n]=parse_TypedPropertyValue(e,rt.t,{raw:!0}),rt.p==="version"&&(_e[rt.n]=String(_e[rt.n]>>16)+"."+("0000"+String(_e[rt.n]&65535)).slice(-4)),rt.n=="CodePage")switch(_e[rt.n]){case 0:_e[rt.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(h=_e[rt.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_e[rt.n])}}else if(c[d][0]===1){if(h=_e.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(h),g!==-1){var et=e.l;e.l=c[g][1],_=parse_dictionary(e,h),e.l=et}}else if(c[d][0]===0){if(h===0){g=d,e.l=c[d+1][1];continue}_=parse_dictionary(e,h)}else{var st=_[c[d][0]],at;switch(e[e.l]){case 65:e.l+=4,at=parse_BLOB(e);break;case 30:e.l+=4,at=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,at=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,at=e.read_shift(4,"i");break;case 19:e.l+=4,at=e.read_shift(4);break;case 5:e.l+=4,at=e.read_shift(8,"f");break;case 11:e.l+=4,at=parsebool(e,4);break;case 64:e.l+=4,at=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}_e[st]=at}}return e.l=a+i,_e}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,s,a){var i=new_buf(8),o=[],c=[],d=8,h=0,g=new_buf(8),_=new_buf(8);if(g.write_shift(4,2),g.write_shift(4,1200),_.write_shift(4,1),c.push(g),o.push(_),d+=8+g.length,!s){_=new_buf(8),_.write_shift(4,0),o.unshift(_);var b=[new_buf(4)];for(b[0].write_shift(4,e.length),h=0;h<e.length;++h){var j=e[h][0];for(g=new_buf(8+2*(j.length+1)+(j.length%2?0:2)),g.write_shift(4,h+2),g.write_shift(4,j.length+1),g.write_shift(0,j,"dbcs");g.l!=g.length;)g.write_shift(1,0);b.push(g)}g=bconcat(b),c.unshift(g),d+=8+g.length}for(h=0;h<e.length;++h)if(!(s&&!s[e[h][0]])&&!(XLSPSSkip.indexOf(e[h][0])>-1||PseudoPropsPairs.indexOf(e[h][0])>-1)&&e[h][1]!=null){var _e=e[h][1],tt=0;if(s){tt=+s[e[h][0]];var rt=a[tt];if(rt.p=="version"&&typeof _e=="string"){var et=_e.split(".");_e=(+et[0]<<16)+(+et[1]||0)}g=write_TypedPropertyValue(rt.t,_e)}else{var st=guess_property_type(_e);st==-1&&(st=31,_e=String(_e)),g=write_TypedPropertyValue(st,_e)}c.push(g),_=new_buf(8),_.write_shift(4,s?tt:2+h),o.push(_),d+=8+g.length}var at=8*(c.length+1);for(h=0;h<c.length;++h)o[h].write_shift(4,at),at+=c[h].length;return i.write_shift(4,d),i.write_shift(4,c.length),bconcat([i].concat(o).concat(c))}function parse_PropertySetStream(e,s,a){var i=e.content;if(!i)return{};prep_blob(i,0);var o,c,d,h,g=0;i.chk("feff","Byte Order: "),i.read_shift(2);var _=i.read_shift(4),b=i.read_shift(16);if(b!==CFB.utils.consts.HEADER_CLSID&&b!==a)throw new Error("Bad PropertySet CLSID "+b);if(o=i.read_shift(4),o!==1&&o!==2)throw new Error("Unrecognized #Sets: "+o);if(c=i.read_shift(16),h=i.read_shift(4),o===1&&h!==i.l)throw new Error("Length mismatch: "+h+" !== "+i.l);o===2&&(d=i.read_shift(16),g=i.read_shift(4));var j=parse_PropertySet(i,s),_e={SystemIdentifier:_};for(var tt in j)_e[tt]=j[tt];if(_e.FMTID=c,o===1)return _e;if(g-i.l==2&&(i.l+=2),i.l!==g)throw new Error("Length mismatch 2: "+i.l+" !== "+g);var rt;try{rt=parse_PropertySet(i,null)}catch{}for(tt in rt)_e[tt]=rt[tt];return _e.FMTID=[c,d],_e}function write_PropertySetStream(e,s,a,i,o,c){var d=new_buf(o?68:48),h=[d];d.write_shift(2,65534),d.write_shift(2,0),d.write_shift(4,842412599),d.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),d.write_shift(4,o?2:1),d.write_shift(16,s,"hex"),d.write_shift(4,o?68:48);var g=write_PropertySet(e,a,i);if(h.push(g),o){var _=write_PropertySet(o,null,null);d.write_shift(16,c,"hex"),d.write_shift(4,68+g.length),h.push(_)}return bconcat(h)}function parsenoop2(e,s){return e.read_shift(s),null}function writezeroes(e,s){s||(s=new_buf(e));for(var a=0;a<e;++a)s.write_shift(1,0);return s}function parslurp(e,s,a){for(var i=[],o=e.l+s;e.l<o;)i.push(a(e,o-e.l));if(o!==e.l)throw new Error("Slurp error");return i}function parsebool(e,s){return e.read_shift(s)===1}function writebool(e,s){return s||(s=new_buf(2)),s.write_shift(2,+!!e),s}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,s){return s||(s=new_buf(2)),s.write_shift(2,e),s}function parseuint16a(e,s){return parslurp(e,s,parseuint16)}function parse_Bes(e){var s=e.read_shift(1),a=e.read_shift(1);return a===1?s:s===1}function write_Bes(e,s,a){return a||(a=new_buf(2)),a.write_shift(1,s=="e"?+e:+!!e),a.write_shift(1,s=="e"?1:0),a}function parse_ShortXLUnicodeString(e,s,a){var i=e.read_shift(a&&a.biff>=12?2:1),o="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var c=e.read_shift(1);c&&(o="dbcs-cont")}else a.biff==12&&(o="wstr");a.biff>=2&&a.biff<=5&&(o="cpstr");var d=i?e.read_shift(i,o):"";return d}function parse_XLUnicodeRichExtendedString(e){var s=e.read_shift(2),a=e.read_shift(1),i=a&4,o=a&8,c=1+(a&1),d=0,h,g={};o&&(d=e.read_shift(2)),i&&(h=e.read_shift(4));var _=c==2?"dbcs-cont":"sbcs-cont",b=s===0?"":e.read_shift(s,_);return o&&(e.l+=4*d),i&&(e.l+=h),g.t=b,o||(g.raw="<t>"+g.t+"</t>",g.r=g.t),g}function write_XLUnicodeRichExtendedString(e){var s=e.t||"",a=new_buf(3);a.write_shift(2,s.length),a.write_shift(1,1);var i=new_buf(2*s.length);i.write_shift(2*s.length,s,"utf16le");var o=[a,i];return bconcat(o)}function parse_XLUnicodeStringNoCch(e,s,a){var i;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(s,"cpstr");if(a.biff>=12)return e.read_shift(s,"dbcs-cont")}var o=e.read_shift(1);return o===0?i=e.read_shift(s,"sbcs-cont"):i=e.read_shift(s,"dbcs-cont"),i}function parse_XLUnicodeString(e,s,a){var i=e.read_shift(a&&a.biff==2?1:2);return i===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,i,a)}function parse_XLUnicodeString2(e,s,a){if(a.biff>5)return parse_XLUnicodeString(e,s,a);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,s,a){return a||(a=new_buf(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function parse_ControlInfo(e){var s=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[s,a]}function parse_URLMoniker(e){var s=e.read_shift(4),a=e.l,i=!1;s>24&&(e.l+=s-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),e.l=a);var o=e.read_shift((i?s-24:s)>>1,"utf16le").replace(chr0,"");return i&&(e.l+=24),o}function parse_FileMoniker(e){for(var s=e.read_shift(2),a="";s-- >0;)a+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var o=e.read_shift(4);if(o===0)return a+i.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var d=e.read_shift(c>>1,"utf16le").replace(chr0,"");return a+d}function parse_HyperlinkMoniker(e,s){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+a)}}function parse_HyperlinkString(e){var s=e.read_shift(4),a=s>0?e.read_shift(s,"utf16le").replace(chr0,""):"";return a}function write_HyperlinkString(e,s){s||(s=new_buf(6+e.length*2)),s.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)s.write_shift(2,e.charCodeAt(a));return s.write_shift(2,0),s}function parse_Hyperlink(e,s){var a=e.l+s,i=e.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var o=e.read_shift(2);e.l+=2;var c,d,h,g,_="",b,j;o&16&&(c=parse_HyperlinkString(e,a-e.l)),o&128&&(d=parse_HyperlinkString(e,a-e.l)),(o&257)===257&&(h=parse_HyperlinkString(e,a-e.l)),(o&257)===1&&(g=parse_HyperlinkMoniker(e,a-e.l)),o&8&&(_=parse_HyperlinkString(e,a-e.l)),o&32&&(b=e.read_shift(16)),o&64&&(j=parse_FILETIME(e)),e.l=a;var _e=d||h||g||"";_e&&_&&(_e+="#"+_),_e||(_e="#"+_),o&2&&_e.charAt(0)=="/"&&_e.charAt(1)!="/"&&(_e="file://"+_e);var tt={Target:_e};return b&&(tt.guid=b),j&&(tt.time=j),c&&(tt.Tooltip=c),tt}function write_Hyperlink(e){var s=new_buf(512),a=0,i=e.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var o=i.indexOf("#"),c=o>-1?31:23;switch(i.charAt(0)){case"#":c=28;break;case".":c&=-3;break}s.write_shift(4,2),s.write_shift(4,c);var d=[8,6815827,6619237,4849780,83];for(a=0;a<d.length;++a)s.write_shift(4,d[a]);if(c==28)i=i.slice(1),write_HyperlinkString(i,s);else if(c&2){for(d="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<d.length;++a)s.write_shift(1,parseInt(d[a],16));var h=o>-1?i.slice(0,o):i;for(s.write_shift(4,2*(h.length+1)),a=0;a<h.length;++a)s.write_shift(2,h.charCodeAt(a));s.write_shift(2,0),c&8&&write_HyperlinkString(o>-1?i.slice(o+1):"",s)}else{for(d="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<d.length;++a)s.write_shift(1,parseInt(d[a],16));for(var g=0;i.slice(g*3,g*3+3)=="../"||i.slice(g*3,g*3+3)=="..\\";)++g;for(s.write_shift(2,g),s.write_shift(4,i.length-3*g+1),a=0;a<i.length-3*g;++a)s.write_shift(1,i.charCodeAt(a+3*g)&255);for(s.write_shift(1,0),s.write_shift(2,65535),s.write_shift(2,57005),a=0;a<6;++a)s.write_shift(4,0)}return s.slice(0,s.l)}function parse_LongRGBA(e){var s=e.read_shift(1),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);return[s,a,i,o]}function parse_LongRGB(e,s){var a=parse_LongRGBA(e);return a[3]=0,a}function parse_XLSCell(e){var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);return{r:s,c:a,ixfe:i}}function write_XLSCell(e,s,a,i){return i||(i=new_buf(6)),i.write_shift(2,e),i.write_shift(2,s),i.write_shift(2,a||0),i}function parse_frtHeader(e){var s=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:s,flags:a}}function parse_OptXLUnicodeString(e,s,a){return s===0?"":parse_XLUnicodeString2(e,s,a)}function parse_XTI(e,s,a){var i=a.biff>8?4:2,o=e.read_shift(i),c=e.read_shift(i,"i"),d=e.read_shift(i,"i");return[o,c,d]}function parse_RkRec(e){var s=e.read_shift(2),a=parse_RkNumber(e);return[s,a]}function parse_AddinUdf(e,s,a){e.l+=4,s-=4;var i=e.l+s,o=parse_ShortXLUnicodeString(e,s,a),c=e.read_shift(2);if(i-=e.l,c!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+c);return e.l+=c,o}function parse_Ref8U(e){var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);return{s:{c:i,r:s},e:{c:o,r:a}}}function write_Ref8U(e,s){return s||(s=new_buf(8)),s.write_shift(2,e.s.r),s.write_shift(2,e.e.r),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c),s}function parse_RefU(e){var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1);return{s:{c:i,r:s},e:{c:o,r:a}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[a,s,i]}function parse_FtNts(e){var s={};return e.l+=4,e.l+=16,s.fSharedNote=e.read_shift(2),e.l+=4,s}function parse_FtCf(e){var s={};return e.l+=4,e.cf=e.read_shift(2),s}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,s){for(var a=e.l+s,i=[];e.l<a;){var o=e.read_shift(2);e.l-=2;try{i.push(FtTab[o](e,a-e.l))}catch{return e.l=a,i}}return e.l!=a&&(e.l=a),i}function parse_BOF(e,s){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),s-=2,s>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(s>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(s),a}function write_BOF(e,s,a){var i=1536,o=16;switch(a.bookType){case"biff8":break;case"biff5":i=1280,o=8;break;case"biff4":i=4,o=6;break;case"biff3":i=3,o=6;break;case"biff2":i=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=new_buf(o);return c.write_shift(2,i),c.write_shift(2,s),o>4&&c.write_shift(2,29282),o>6&&c.write_shift(2,1997),o>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function parse_InterfaceHdr(e,s){return s===0||e.read_shift(2),1200}function parse_WriteAccess(e,s,a){if(a.enc)return e.l+=s,"";var i=e.l,o=parse_XLUnicodeString2(e,0,a);return e.read_shift(s+i-e.l),o}function write_WriteAccess(e,s){var a=!s||s.biff==8,i=new_buf(a?112:54);for(i.write_shift(s.biff==8?2:1,7),a&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(a?0:536870912));i.l<i.length;)i.write_shift(1,a?0:32);return i}function parse_WsBool(e,s,a){var i=a&&a.biff==8||s==2?e.read_shift(2):(e.l+=s,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function parse_BoundSheet8(e,s,a){var i=e.read_shift(4),o=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var d=parse_ShortXLUnicodeString(e,0,a);return d.length===0&&(d="Sheet1"),{pos:i,hs:o,dt:c,name:d}}function write_BoundSheet8(e,s){var a=!s||s.biff>=8?2:1,i=new_buf(8+a*e.name.length);i.write_shift(4,e.pos),i.write_shift(1,e.hs||0),i.write_shift(1,e.dt),i.write_shift(1,e.name.length),s.biff>=8&&i.write_shift(1,1),i.write_shift(a*e.name.length,e.name,s.biff<8?"sbcs":"utf16le");var o=i.slice(0,i.l);return o.l=i.l,o}function parse_SST(e,s){for(var a=e.l+s,i=e.read_shift(4),o=e.read_shift(4),c=[],d=0;d!=o&&e.l<a;++d)c.push(parse_XLUnicodeRichExtendedString(e));return c.Count=i,c.Unique=o,c}function write_SST(e,s){var a=new_buf(8);a.write_shift(4,e.Count),a.write_shift(4,e.Unique);for(var i=[],o=0;o<e.length;++o)i[o]=write_XLUnicodeRichExtendedString(e[o]);var c=bconcat([a].concat(i));return c.parts=[a.length].concat(i.map(function(d){return d.length})),c}function parse_ExtSST(e,s){var a={};return a.dsst=e.read_shift(2),e.l+=s-2,a}function parse_Row(e){var s={};s.r=e.read_shift(2),s.c=e.read_shift(2),s.cnt=e.read_shift(2)-s.c;var a=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,i&7&&(s.level=i&7),i&32&&(s.hidden=!0),i&64&&(s.hpt=a/20),s}function parse_ForceFullCalculation(e){var s=parse_frtHeader(e);if(s.type!=2211)throw new Error("Invalid Future Record "+s.type);var a=e.read_shift(4);return a!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,s,a){var i=0;a&&a.biff==2||(i=e.read_shift(2));var o=e.read_shift(2);a&&a.biff==2&&(i=1-(o>>15),o&=32767);var c={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[c,o]}function parse_Window1(e){var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2),g=e.read_shift(2),_=e.read_shift(2);return{Pos:[s,a],Dim:[i,o],Flags:c,CurTab:d,FirstTab:h,Selected:g,TabRatio:_}}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function parse_Window2(e,s,a){if(a&&a.biff>=2&&a.biff<5)return{};var i=e.read_shift(2);return{RTL:i&64}}function write_Window2(e){var s=new_buf(18),a=1718;return e&&e.RTL&&(a|=64),s.write_shift(2,a),s.write_shift(4,0),s.write_shift(4,64),s.write_shift(4,0),s.write_shift(4,0),s}function parse_Pane(){}function parse_Font(e,s,a){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return i.name=parse_ShortXLUnicodeString(e,0,a),i}function write_Font(e,s){var a=e.name||"Arial",i=s&&s.biff==5,o=i?15+a.length:16+2*a.length,c=new_buf(o);return c.write_shift(2,(e.sz||12)*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,a.length),i||c.write_shift(1,1),c.write_shift((i?1:2)*a.length,a,i?"sbcs":"utf16le"),c}function parse_LabelSst(e){var s=parse_XLSCell(e);return s.isst=e.read_shift(4),s}function write_LabelSst(e,s,a,i){var o=new_buf(10);return write_XLSCell(e,s,i,o),o.write_shift(4,a),o}function parse_Label(e,s,a){a.biffguess&&a.biff==2&&(a.biff=5);var i=e.l+s,o=parse_XLSCell(e);a.biff==2&&e.l++;var c=parse_XLUnicodeString(e,i-e.l,a);return o.val=c,o}function write_Label(e,s,a,i,o){var c=!o||o.biff==8,d=new_buf(8+ +c+(1+c)*a.length);return write_XLSCell(e,s,i,d),d.write_shift(2,a.length),c&&d.write_shift(1,1),d.write_shift((1+c)*a.length,a,c?"utf16le":"sbcs"),d}function parse_Format(e,s,a){var i=e.read_shift(2),o=parse_XLUnicodeString2(e,0,a);return[i,o]}function write_Format(e,s,a,i){var o=a&&a.biff==5;i||(i=new_buf(o?3+s.length:5+2*s.length)),i.write_shift(2,e),i.write_shift(o?1:2,s.length),o||i.write_shift(1,1),i.write_shift((o?1:2)*s.length,s,o?"sbcs":"utf16le");var c=i.length>i.l?i.slice(0,i.l):i;return c.l==null&&(c.l=c.length),c}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,s,a){var i=e.l+s,o=a.biff==8||!a.biff?4:2,c=e.read_shift(o),d=e.read_shift(o),h=e.read_shift(2),g=e.read_shift(2);return e.l=i,{s:{r:c,c:h},e:{r:d,c:g}}}function write_Dimensions(e,s){var a=s.biff==8||!s.biff?4:2,i=new_buf(2*a+6);return i.write_shift(a,e.s.r),i.write_shift(a,e.e.r+1),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c+1),i.write_shift(2,0),i}function parse_RK(e){var s=e.read_shift(2),a=e.read_shift(2),i=parse_RkRec(e);return{r:s,c:a,ixfe:i[0],rknum:i[1]}}function parse_MulRk(e,s){for(var a=e.l+s-2,i=e.read_shift(2),o=e.read_shift(2),c=[];e.l<a;)c.push(parse_RkRec(e));if(e.l!==a)throw new Error("MulRK read error");var d=e.read_shift(2);if(c.length!=d-o+1)throw new Error("MulRK length mismatch");return{r:i,c:o,C:d,rkrec:c}}function parse_MulBlank(e,s){for(var a=e.l+s-2,i=e.read_shift(2),o=e.read_shift(2),c=[];e.l<a;)c.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var d=e.read_shift(2);if(c.length!=d-o+1)throw new Error("MulBlank length mismatch");return{r:i,c:o,C:d,ixfe:c}}function parse_CellStyleXF(e,s,a,i){var o={},c=e.read_shift(4),d=e.read_shift(4),h=e.read_shift(4),g=e.read_shift(2);return o.patternType=XLSFillPattern[h>>26],i.cellStyles&&(o.alc=c&7,o.fWrap=c>>3&1,o.alcV=c>>4&7,o.fJustLast=c>>7&1,o.trot=c>>8&255,o.cIndent=c>>16&15,o.fShrinkToFit=c>>20&1,o.iReadOrder=c>>22&2,o.fAtrNum=c>>26&1,o.fAtrFnt=c>>27&1,o.fAtrAlc=c>>28&1,o.fAtrBdr=c>>29&1,o.fAtrPat=c>>30&1,o.fAtrProt=c>>31&1,o.dgLeft=d&15,o.dgRight=d>>4&15,o.dgTop=d>>8&15,o.dgBottom=d>>12&15,o.icvLeft=d>>16&127,o.icvRight=d>>23&127,o.grbitDiag=d>>30&3,o.icvTop=h&127,o.icvBottom=h>>7&127,o.icvDiag=h>>14&127,o.dgDiag=h>>21&15,o.icvFore=g&127,o.icvBack=g>>7&127,o.fsxButton=g>>14&1),o}function parse_XF(e,s,a){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,s-=6,i.data=parse_CellStyleXF(e,s,i.fStyle,a),i}function write_XF(e,s,a,i){var o=a&&a.biff==5;i||(i=new_buf(o?16:20)),i.write_shift(2,0),e.style?(i.write_shift(2,e.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,e.numFmtId||0),i.write_shift(2,s<<4));var c=0;return e.numFmtId>0&&o&&(c|=1024),i.write_shift(4,c),i.write_shift(4,0),o||i.write_shift(4,0),i.write_shift(2,0),i}function parse_Guts(e){e.l+=4;var s=[e.read_shift(2),e.read_shift(2)];if(s[0]!==0&&s[0]--,s[1]!==0&&s[1]--,s[0]>7||s[1]>7)throw new Error("Bad Gutters: "+s.join("|"));return s}function write_Guts(e){var s=new_buf(8);return s.write_shift(4,0),s.write_shift(2,0),s.write_shift(2,0),s}function parse_BoolErr(e,s,a){var i=parse_XLSCell(e);(a.biff==2||s==9)&&++e.l;var o=parse_Bes(e);return i.val=o,i.t=o===!0||o===!1?"b":"e",i}function write_BoolErr(e,s,a,i,o,c){var d=new_buf(8);return write_XLSCell(e,s,i,d),write_Bes(a,c,d),d}function parse_Number(e,s,a){a.biffguess&&a.biff==2&&(a.biff=5);var i=parse_XLSCell(e),o=parse_Xnum(e);return i.val=o,i}function write_Number(e,s,a,i){var o=new_buf(14);return write_XLSCell(e,s,i,o),write_Xnum(a,o),o}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,s,a){var i=e.l+s,o=e.read_shift(2),c=e.read_shift(2);if(a.sbcch=c,c==1025||c==14849)return[c,o];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var d=parse_XLUnicodeStringNoCch(e,c),h=[];i>e.l;)h.push(parse_XLUnicodeString(e));return[c,o,d,h]}function parse_ExternName(e,s,a){var i=e.read_shift(2),o,c={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return a.sbcch===14849&&(o=parse_AddinUdf(e,s-2,a)),c.body=o||e.read_shift(s-2),typeof o=="string"&&(c.Name=o),c}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,s,a){var i=e.l+s,o=e.read_shift(2),c=e.read_shift(1),d=e.read_shift(1),h=e.read_shift(a&&a.biff==2?1:2),g=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),g=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var _=parse_XLUnicodeStringNoCch(e,d,a);o&32&&(_=XLSLblBuiltIn[_.charCodeAt(0)]);var b=i-e.l;a&&a.biff==2&&--b;var j=i==e.l||h===0||!(b>0)?[]:parse_NameParsedFormula(e,b,a,h);return{chKey:c,Name:_,itab:g,rgce:j}}function parse_ExternSheet(e,s,a){if(a.biff<8)return parse_BIFF5ExternSheet(e,s,a);for(var i=[],o=e.l+s,c=e.read_shift(a.biff>8?4:2);c--!==0;)i.push(parse_XTI(e,a.biff>8?12:6,a));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return i}function parse_BIFF5ExternSheet(e,s,a){e[e.l+1]==3&&e[e.l]++;var i=parse_ShortXLUnicodeString(e,s,a);return i.charCodeAt(0)==3?i.slice(1):i}function parse_NameCmt(e,s,a){if(a.biff<8){e.l+=s;return}var i=e.read_shift(2),o=e.read_shift(2),c=parse_XLUnicodeStringNoCch(e,i,a),d=parse_XLUnicodeStringNoCch(e,o,a);return[c,d]}function parse_ShrFmla(e,s,a){var i=parse_RefU(e);e.l++;var o=e.read_shift(1);return s-=8,[parse_SharedParsedFormula(e,s,a),o,i]}function parse_Array(e,s,a){var i=parse_Ref(e);switch(a.biff){case 2:e.l++,s-=7;break;case 3:case 4:e.l+=2,s-=8;break;default:e.l+=6,s-=12}return[i,parse_ArrayParsedFormula(e,s,a)]}function parse_MTRSettings(e){var s=e.read_shift(4)!==0,a=e.read_shift(4)!==0,i=e.read_shift(4);return[s,a,i]}function parse_NoteSh(e,s,a){if(!(a.biff<8)){var i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2),h=parse_XLUnicodeString2(e,0,a);return a.biff<8&&e.read_shift(1),[{r:i,c:o},h,d,c]}}function parse_Note(e,s,a){return parse_NoteSh(e,s,a)}function parse_MergeCells(e,s){for(var a=[],i=e.read_shift(2);i--;)a.push(parse_Ref8U(e));return a}function write_MergeCells(e){var s=new_buf(2+e.length*8);s.write_shift(2,e.length);for(var a=0;a<e.length;++a)write_Ref8U(e[a],s);return s}function parse_Obj(e,s,a){if(a&&a.biff<8)return parse_BIFF5Obj(e,s,a);var i=parse_FtCmo(e),o=parse_FtArray(e,s-22,i[1]);return{cmo:i,ft:o}}var parse_BIFF5OT={8:function(e,s){var a=e.l+s;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var o=e.read_shift(1);return e.l+=o,e.l=a,{fmt:i}}};function parse_BIFF5Obj(e,s,a){e.l+=4;var i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,s-=36;var d=[];return d.push((parse_BIFF5OT[i]||parsenoop)(e,s,a)),{cmo:[o,i,c],ft:d}}function parse_TxO(e,s,a){var i=e.l,o="";try{e.l+=4;var c=(a.lastobj||{cmo:[0,0]}).cmo[1],d;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:d=parse_ControlInfo(e,6,a);var h=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var g=e.read_shift(2);e.l+=g;for(var _=1;_<e.lens.length-1;++_){if(e.l-i!=e.lens[_])throw new Error("TxO: bad continue record");var b=e[e.l],j=parse_XLUnicodeStringNoCch(e,e.lens[_+1]-e.lens[_]-1);if(o+=j,o.length>=(b?h:2*h))break}if(o.length!==h&&o.length!==h*2)throw new Error("cchText: "+h+" != "+o.length);return e.l=i+s,{t:o}}catch{return e.l=i+s,{t:o}}}function parse_HLink(e,s){var a=parse_Ref8U(e);e.l+=16;var i=parse_Hyperlink(e,s-24);return[a,i]}function write_HLink(e){var s=new_buf(24),a=decode_cell(e[0]);s.write_shift(2,a.r),s.write_shift(2,a.r),s.write_shift(2,a.c),s.write_shift(2,a.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)s.write_shift(1,parseInt(i[o],16));return bconcat([s,write_Hyperlink(e[1])])}function parse_HLinkTooltip(e,s){e.read_shift(2);var a=parse_Ref8U(e),i=e.read_shift((s-10)/2,"dbcs-cont");return i=i.replace(chr0,""),[a,i]}function write_HLinkTooltip(e){var s=e[1].Tooltip,a=new_buf(10+2*(s.length+1));a.write_shift(2,2048);var i=decode_cell(e[0]);a.write_shift(2,i.r),a.write_shift(2,i.r),a.write_shift(2,i.c),a.write_shift(2,i.c);for(var o=0;o<s.length;++o)a.write_shift(2,s.charCodeAt(o));return a.write_shift(2,0),a}function parse_Country(e){var s=[0,0],a;return a=e.read_shift(2),s[0]=CountryEnum[a]||a,a=e.read_shift(2),s[1]=CountryEnum[a]||a,s}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ClrtClient(e){for(var s=e.read_shift(2),a=[];s-- >0;)a.push(parse_LongRGB(e));return a}function parse_Palette(e){for(var s=e.read_shift(2),a=[];s-- >0;)a.push(parse_LongRGB(e));return a}function parse_XFCRC(e){e.l+=2;var s={cxfs:0,crc:0};return s.cxfs=e.read_shift(2),s.crc=e.read_shift(4),s}function parse_ColInfo(e,s,a){if(!a.cellStyles)return parsenoop(e,s);var i=a&&a.biff>=12?4:2,o=e.read_shift(i),c=e.read_shift(i),d=e.read_shift(i),h=e.read_shift(i),g=e.read_shift(2);i==2&&(e.l+=2);var _={s:o,e:c,w:d,ixfe:h,flags:g};return(a.biff>=5||!a.biff)&&(_.level=g>>8&7),_}function write_ColInfo(e,s){var a=new_buf(12);a.write_shift(2,s),a.write_shift(2,s),a.write_shift(2,e.width*256),a.write_shift(2,0);var i=0;return e.hidden&&(i|=1),a.write_shift(1,i),i=e.level||0,a.write_shift(1,i),a.write_shift(2,0),a}function parse_Setup(e,s){var a={};return s<32||(e.l+=16,a.header=parse_Xnum(e),a.footer=parse_Xnum(e),e.l+=2),a}function parse_ShtProps(e,s,a){var i={area:!1};if(a.biff!=5)return e.l+=s,i;var o=e.read_shift(1);return e.l+=3,o&16&&(i.area=!0),i}function write_RRTabId(e){for(var s=new_buf(2*e),a=0;a<e;++a)s.write_shift(2,a+1);return s}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(4),o={fmt:s,env:a,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,o}function parse_BIFF2STR(e,s,a){a.biffguess&&a.biff==5&&(a.biff=2);var i=parse_XLSCell(e);++e.l;var o=parse_XLUnicodeString2(e,s-7,a);return i.t="str",i.val=o,i}function parse_BIFF2NUM(e){var s=parse_XLSCell(e);++e.l;var a=parse_Xnum(e);return s.t="n",s.val=a,s}function write_BIFF2NUM(e,s,a){var i=new_buf(15);return write_BIFF2Cell(i,e,s),i.write_shift(8,a,"f"),i}function parse_BIFF2INT(e){var s=parse_XLSCell(e);++e.l;var a=e.read_shift(2);return s.t="n",s.val=a,s}function write_BIFF2INT(e,s,a){var i=new_buf(9);return write_BIFF2Cell(i,e,s),i.write_shift(2,a),i}function parse_BIFF2STRING(e){var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,s){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=s-13}function parse_RString(e,s,a){var i=e.l+s,o=parse_XLSCell(e),c=e.read_shift(2),d=parse_XLUnicodeStringNoCch(e,c,a);return e.l=i,o.t="str",o.val=d,o}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},s=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(h,g){var _=[],b=new_raw_buf(1);switch(g.type){case"base64":b=s2a(Base64_decode(h));break;case"binary":b=s2a(h);break;case"buffer":case"array":b=h;break}prep_blob(b,0);var j=b.read_shift(1),_e=!!(j&136),tt=!1,rt=!1;switch(j){case 2:break;case 3:break;case 48:tt=!0,_e=!0;break;case 49:tt=!0,_e=!0;break;case 131:break;case 139:break;case 140:rt=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+j.toString(16))}var et=0,st=521;j==2&&(et=b.read_shift(2)),b.l+=3,j!=2&&(et=b.read_shift(4)),et>1048576&&(et=1e6),j!=2&&(st=b.read_shift(2));var at=b.read_shift(2),it=g.codepage||1252;j!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(it=e[b[b.l]]),b.l+=1,b.l+=2),rt&&(b.l+=36);for(var nt=[],ot={},dt=Math.min(b.length,j==2?521:st-10-(tt?264:0)),ht=rt?32:11;b.l<dt&&b[b.l]!=13;)switch(ot={},ot.name=$cptable.utils.decode(it,b.slice(b.l,b.l+ht)).replace(/[\u0000\r\n].*$/g,""),b.l+=ht,ot.type=String.fromCharCode(b.read_shift(1)),j!=2&&!rt&&(ot.offset=b.read_shift(4)),ot.len=b.read_shift(1),j==2&&(ot.offset=b.read_shift(2)),ot.dec=b.read_shift(1),ot.name.length&&nt.push(ot),j!=2&&(b.l+=rt?13:14),ot.type){case"B":(!tt||ot.len!=8)&&g.WTF&&console.log("Skipping "+ot.name+":"+ot.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+ot.name+":"+ot.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ot.type)}if(b[b.l]!==13&&(b.l=st-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=st;var lt=0,gt=0;for(_[0]=[],gt=0;gt!=nt.length;++gt)_[0][gt]=nt[gt].name;for(;et-- >0;){if(b[b.l]===42){b.l+=at;continue}for(++b.l,_[++lt]=[],gt=0,gt=0;gt!=nt.length;++gt){var yt=b.slice(b.l,b.l+nt[gt].len);b.l+=nt[gt].len,prep_blob(yt,0);var Tt=$cptable.utils.decode(it,yt);switch(nt[gt].type){case"C":Tt.trim().length&&(_[lt][gt]=Tt.replace(/\s+$/,""));break;case"D":Tt.length===8?_[lt][gt]=new Date(+Tt.slice(0,4),+Tt.slice(4,6)-1,+Tt.slice(6,8)):_[lt][gt]=Tt;break;case"F":_[lt][gt]=parseFloat(Tt.trim());break;case"+":case"I":_[lt][gt]=rt?yt.read_shift(-4,"i")^2147483648:yt.read_shift(4,"i");break;case"L":switch(Tt.trim().toUpperCase()){case"Y":case"T":_[lt][gt]=!0;break;case"N":case"F":_[lt][gt]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Tt+"|")}break;case"M":if(!_e)throw new Error("DBF Unexpected MEMO for type "+j.toString(16));_[lt][gt]="##MEMO##"+(rt?parseInt(Tt.trim(),10):yt.read_shift(4));break;case"N":Tt=Tt.replace(/\u0000/g,"").trim(),Tt&&Tt!="."&&(_[lt][gt]=+Tt||0);break;case"@":_[lt][gt]=new Date(yt.read_shift(-8,"f")-621356832e5);break;case"T":_[lt][gt]=new Date((yt.read_shift(4)-2440588)*864e5+yt.read_shift(4));break;case"Y":_[lt][gt]=yt.read_shift(4,"i")/1e4+yt.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":_[lt][gt]=-yt.read_shift(-8,"f");break;case"B":if(tt&&nt[gt].len==8){_[lt][gt]=yt.read_shift(8,"f");break}case"G":case"P":yt.l+=nt[gt].len;break;case"0":if(nt[gt].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+nt[gt].type)}}}if(j!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),g.DBF=nt,_}function i(h,g){var _=g||{};_.dateNF||(_.dateNF="yyyymmdd");var b=aoa_to_sheet(a(h,_),_);return b["!cols"]=_.DBF.map(function(j){return{wch:j.len,DBF:j}}),delete _.DBF,b}function o(h,g){try{return sheet_to_workbook(i(h,g),g)}catch(_){if(g&&g.WTF)throw _}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function d(h,g){var _=g||{};if(+_.codepage>=0&&set_cp(+_.codepage),_.type=="string")throw new Error("Cannot write DBF to JS string");var b=buf_array(),j=sheet_to_json(h,{header:1,raw:!0,cellDates:!0}),_e=j[0],tt=j.slice(1),rt=h["!cols"]||[],et=0,st=0,at=0,it=1;for(et=0;et<_e.length;++et){if(((rt[et]||{}).DBF||{}).name){_e[et]=rt[et].DBF.name,++at;continue}if(_e[et]!=null){if(++at,typeof _e[et]=="number"&&(_e[et]=_e[et].toString(10)),typeof _e[et]!="string")throw new Error("DBF Invalid column name "+_e[et]+" |"+typeof _e[et]+"|");if(_e.indexOf(_e[et])!==et){for(st=0;st<1024;++st)if(_e.indexOf(_e[et]+"_"+st)==-1){_e[et]+="_"+st;break}}}}var nt=safe_decode_range(h["!ref"]),ot=[],dt=[],ht=[];for(et=0;et<=nt.e.c-nt.s.c;++et){var lt="",gt="",yt=0,Tt=[];for(st=0;st<tt.length;++st)tt[st][et]!=null&&Tt.push(tt[st][et]);if(Tt.length==0||_e[et]==null){ot[et]="?";continue}for(st=0;st<Tt.length;++st){switch(typeof Tt[st]){case"number":gt="B";break;case"string":gt="C";break;case"boolean":gt="L";break;case"object":gt=Tt[st]instanceof Date?"D":"C";break;default:gt="C"}yt=Math.max(yt,String(Tt[st]).length),lt=lt&&lt!=gt?"C":gt}yt>250&&(yt=250),gt=((rt[et]||{}).DBF||{}).type,gt=="C"&&rt[et].DBF.len>yt&&(yt=rt[et].DBF.len),lt=="B"&&gt=="N"&&(lt="N",ht[et]=rt[et].DBF.dec,yt=rt[et].DBF.len),dt[et]=lt=="C"||gt=="N"?yt:c[lt]||0,it+=dt[et],ot[et]=lt}var mt=b.next(32);for(mt.write_shift(4,318902576),mt.write_shift(4,tt.length),mt.write_shift(2,296+32*at),mt.write_shift(2,it),et=0;et<4;++et)mt.write_shift(4,0);for(mt.write_shift(4,0|(+s[current_ansi]||3)<<8),et=0,st=0;et<_e.length;++et)if(_e[et]!=null){var Et=b.next(32),Ft=(_e[et].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Et.write_shift(1,Ft,"sbcs"),Et.write_shift(1,ot[et]=="?"?"C":ot[et],"sbcs"),Et.write_shift(4,st),Et.write_shift(1,dt[et]||c[ot[et]]||0),Et.write_shift(1,ht[et]||0),Et.write_shift(1,2),Et.write_shift(4,0),Et.write_shift(1,0),Et.write_shift(4,0),Et.write_shift(4,0),st+=dt[et]||c[ot[et]]||0}var Vt=b.next(264);for(Vt.write_shift(4,13),et=0;et<65;++et)Vt.write_shift(4,0);for(et=0;et<tt.length;++et){var Mt=b.next(it);for(Mt.write_shift(1,0),st=0;st<_e.length;++st)if(_e[st]!=null)switch(ot[st]){case"L":Mt.write_shift(1,tt[et][st]==null?63:tt[et][st]?84:70);break;case"B":Mt.write_shift(8,tt[et][st]||0,"f");break;case"N":var Ct="0";for(typeof tt[et][st]=="number"&&(Ct=tt[et][st].toFixed(ht[st]||0)),at=0;at<dt[st]-Ct.length;++at)Mt.write_shift(1,32);Mt.write_shift(1,Ct,"sbcs");break;case"D":tt[et][st]?(Mt.write_shift(4,("0000"+tt[et][st].getFullYear()).slice(-4),"sbcs"),Mt.write_shift(2,("00"+(tt[et][st].getMonth()+1)).slice(-2),"sbcs"),Mt.write_shift(2,("00"+tt[et][st].getDate()).slice(-2),"sbcs")):Mt.write_shift(8,"00000000","sbcs");break;case"C":var kt=String(tt[et][st]!=null?tt[et][st]:"").slice(0,dt[st]);for(Mt.write_shift(1,kt,"sbcs"),at=0;at<dt[st]-kt.length;++at)Mt.write_shift(1,32);break}}return b.next(1).write_shift(1,26),b.end()}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},s=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(_e,tt){var rt=e[tt];return typeof rt=="number"?_getansi(rt):rt},i=function(_e,tt,rt){var et=tt.charCodeAt(0)-32<<4|rt.charCodeAt(0)-48;return et==59?_e:_getansi(et)};e["|"]=254;function o(_e,tt){switch(tt.type){case"base64":return c(Base64_decode(_e),tt);case"binary":return c(_e,tt);case"buffer":return c(has_buf&&Buffer.isBuffer(_e)?_e.toString("binary"):a2s(_e),tt);case"array":return c(cc2str(_e),tt)}throw new Error("Unrecognized type "+tt.type)}function c(_e,tt){var rt=_e.split(/[\n\r]+/),et=-1,st=-1,at=0,it=0,nt=[],ot=[],dt=null,ht={},lt=[],gt=[],yt=[],Tt=0,mt;for(+tt.codepage>=0&&set_cp(+tt.codepage);at!==rt.length;++at){Tt=0;var Et=rt[at].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(s,a),Ft=Et.replace(/;;/g,"\0").split(";").map(function(At){return At.replace(/\u0000/g,";")}),Vt=Ft[0],Mt;if(Et.length>0)switch(Vt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ft[1].charAt(0)=="P"&&ot.push(Et.slice(3).replace(/;;/g,";"));break;case"C":var Ct=!1,kt=!1,jt=!1,ut=!1,Lt=-1,Pt=-1;for(it=1;it<Ft.length;++it)switch(Ft[it].charAt(0)){case"A":break;case"X":st=parseInt(Ft[it].slice(1))-1,kt=!0;break;case"Y":for(et=parseInt(Ft[it].slice(1))-1,kt||(st=0),mt=nt.length;mt<=et;++mt)nt[mt]=[];break;case"K":Mt=Ft[it].slice(1),Mt.charAt(0)==='"'?Mt=Mt.slice(1,Mt.length-1):Mt==="TRUE"?Mt=!0:Mt==="FALSE"?Mt=!1:isNaN(fuzzynum(Mt))?isNaN(fuzzydate(Mt).getDate())||(Mt=parseDate(Mt)):(Mt=fuzzynum(Mt),dt!==null&&fmt_is_date(dt)&&(Mt=numdate(Mt))),Ct=!0;break;case"E":ut=!0;var ft=rc_to_a1(Ft[it].slice(1),{r:et,c:st});nt[et][st]=[nt[et][st],ft];break;case"S":jt=!0,nt[et][st]=[nt[et][st],"S5S"];break;case"G":break;case"R":Lt=parseInt(Ft[it].slice(1))-1;break;case"C":Pt=parseInt(Ft[it].slice(1))-1;break;default:if(tt&&tt.WTF)throw new Error("SYLK bad record "+Et)}if(Ct&&(nt[et][st]&&nt[et][st].length==2?nt[et][st][0]=Mt:nt[et][st]=Mt,dt=null),jt){if(ut)throw new Error("SYLK shared formula cannot have own formula");var Rt=Lt>-1&&nt[Lt][Pt];if(!Rt||!Rt[1])throw new Error("SYLK shared formula cannot find base");nt[et][st][1]=shift_formula_str(Rt[1],{r:et-Lt,c:st-Pt})}break;case"F":var bt=0;for(it=1;it<Ft.length;++it)switch(Ft[it].charAt(0)){case"X":st=parseInt(Ft[it].slice(1))-1,++bt;break;case"Y":for(et=parseInt(Ft[it].slice(1))-1,mt=nt.length;mt<=et;++mt)nt[mt]=[];break;case"M":Tt=parseInt(Ft[it].slice(1))/20;break;case"F":break;case"G":break;case"P":dt=ot[parseInt(Ft[it].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(yt=Ft[it].slice(1).split(" "),mt=parseInt(yt[0],10);mt<=parseInt(yt[1],10);++mt)Tt=parseInt(yt[2],10),gt[mt-1]=Tt===0?{hidden:!0}:{wch:Tt},process_col(gt[mt-1]);break;case"C":st=parseInt(Ft[it].slice(1))-1,gt[st]||(gt[st]={});break;case"R":et=parseInt(Ft[it].slice(1))-1,lt[et]||(lt[et]={}),Tt>0?(lt[et].hpt=Tt,lt[et].hpx=pt2px(Tt)):Tt===0&&(lt[et].hidden=!0);break;default:if(tt&&tt.WTF)throw new Error("SYLK bad record "+Et)}bt<1&&(dt=null);break;default:if(tt&&tt.WTF)throw new Error("SYLK bad record "+Et)}}return lt.length>0&&(ht["!rows"]=lt),gt.length>0&&(ht["!cols"]=gt),tt&&tt.sheetRows&&(nt=nt.slice(0,tt.sheetRows)),[nt,ht]}function d(_e,tt){var rt=o(_e,tt),et=rt[0],st=rt[1],at=aoa_to_sheet(et,tt);return keys(st).forEach(function(it){at[it]=st[it]}),at}function h(_e,tt){return sheet_to_workbook(d(_e,tt),tt)}function g(_e,tt,rt,et){var st="C;Y"+(rt+1)+";X"+(et+1)+";K";switch(_e.t){case"n":st+=_e.v||0,_e.f&&!_e.F&&(st+=";E"+a1_to_rc(_e.f,{r:rt,c:et}));break;case"b":st+=_e.v?"TRUE":"FALSE";break;case"e":st+=_e.w||_e.v;break;case"d":st+='"'+(_e.w||_e.v)+'"';break;case"s":st+='"'+_e.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return st}function _(_e,tt){tt.forEach(function(rt,et){var st="F;W"+(et+1)+" "+(et+1)+" ";rt.hidden?st+="0":(typeof rt.width=="number"&&!rt.wpx&&(rt.wpx=width2px(rt.width)),typeof rt.wpx=="number"&&!rt.wch&&(rt.wch=px2char(rt.wpx)),typeof rt.wch=="number"&&(st+=Math.round(rt.wch))),st.charAt(st.length-1)!=" "&&_e.push(st)})}function b(_e,tt){tt.forEach(function(rt,et){var st="F;";rt.hidden?st+="M0;":rt.hpt?st+="M"+20*rt.hpt+";":rt.hpx&&(st+="M"+20*px2pt(rt.hpx)+";"),st.length>2&&_e.push(st+"R"+(et+1))})}function j(_e,tt){var rt=["ID;PWXL;N;E"],et=[],st=safe_decode_range(_e["!ref"]),at,it=Array.isArray(_e),nt=`\r
`;rt.push("P;PGeneral"),rt.push("F;P0;DG0G8;M255"),_e["!cols"]&&_(rt,_e["!cols"]),_e["!rows"]&&b(rt,_e["!rows"]),rt.push("B;Y"+(st.e.r-st.s.r+1)+";X"+(st.e.c-st.s.c+1)+";D"+[st.s.c,st.s.r,st.e.c,st.e.r].join(" "));for(var ot=st.s.r;ot<=st.e.r;++ot)for(var dt=st.s.c;dt<=st.e.c;++dt){var ht=encode_cell({r:ot,c:dt});at=it?(_e[ot]||[])[dt]:_e[ht],!(!at||at.v==null&&(!at.f||at.F))&&et.push(g(at,_e,ot,dt))}return rt.join(nt)+nt+et.join(nt)+nt+"E"+nt}return{to_workbook:h,to_sheet:d,from_sheet:j}}(),DIF=function(){function e(c,d){switch(d.type){case"base64":return s(Base64_decode(c),d);case"binary":return s(c,d);case"buffer":return s(has_buf&&Buffer.isBuffer(c)?c.toString("binary"):a2s(c),d);case"array":return s(cc2str(c),d)}throw new Error("Unrecognized type "+d.type)}function s(c,d){for(var h=c.split(`
`),g=-1,_=-1,b=0,j=[];b!==h.length;++b){if(h[b].trim()==="BOT"){j[++g]=[],_=0;continue}if(!(g<0)){var _e=h[b].trim().split(","),tt=_e[0],rt=_e[1];++b;for(var et=h[b]||"";(et.match(/["]/g)||[]).length&1&&b<h.length-1;)et+=`
`+h[++b];switch(et=et.trim(),+tt){case-1:if(et==="BOT"){j[++g]=[],_=0;continue}else if(et!=="EOD")throw new Error("Unrecognized DIF special command "+et);break;case 0:et==="TRUE"?j[g][_]=!0:et==="FALSE"?j[g][_]=!1:isNaN(fuzzynum(rt))?isNaN(fuzzydate(rt).getDate())?j[g][_]=rt:j[g][_]=parseDate(rt):j[g][_]=fuzzynum(rt),++_;break;case 1:et=et.slice(1,et.length-1),et=et.replace(/""/g,'"'),et&&et.match(/^=".*"$/)&&(et=et.slice(2,-1)),j[g][_++]=et!==""?et:null;break}if(et==="EOD")break}}return d&&d.sheetRows&&(j=j.slice(0,d.sheetRows)),j}function a(c,d){return aoa_to_sheet(e(c,d),d)}function i(c,d){return sheet_to_workbook(a(c,d),d)}var o=function(){var c=function(g,_,b,j,_e){g.push(_),g.push(b+","+j),g.push('"'+_e.replace(/"/g,'""')+'"')},d=function(g,_,b,j){g.push(_+","+b),g.push(_==1?'"'+j.replace(/"/g,'""')+'"':j)};return function(g){var _=[],b=safe_decode_range(g["!ref"]),j,_e=Array.isArray(g);c(_,"TABLE",0,1,"sheetjs"),c(_,"VECTORS",0,b.e.r-b.s.r+1,""),c(_,"TUPLES",0,b.e.c-b.s.c+1,""),c(_,"DATA",0,0,"");for(var tt=b.s.r;tt<=b.e.r;++tt){d(_,-1,0,"BOT");for(var rt=b.s.c;rt<=b.e.c;++rt){var et=encode_cell({r:tt,c:rt});if(j=_e?(g[tt]||[])[rt]:g[et],!j){d(_,1,0,"");continue}switch(j.t){case"n":var st=j.w;!st&&j.v!=null&&(st=j.v),st==null?j.f&&!j.F?d(_,1,0,"="+j.f):d(_,1,0,""):d(_,0,st,"V");break;case"b":d(_,0,j.v?1:0,j.v?"TRUE":"FALSE");break;case"s":d(_,1,0,isNaN(j.v)?j.v:'="'+j.v+'"');break;case"d":j.w||(j.w=SSF_format(j.z||table_fmt[14],datenum(parseDate(j.v)))),d(_,0,j.w,"V");break;default:d(_,1,0,"")}}}d(_,-1,0,"EOD");var at=`\r
`,it=_.join(at);return it}}();return{to_workbook:i,to_sheet:a,from_sheet:o}}(),ETH=function(){function e(j){return j.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function s(j){return j.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(j,_e){for(var tt=j.split(`
`),rt=-1,et=-1,st=0,at=[];st!==tt.length;++st){var it=tt[st].trim().split(":");if(it[0]==="cell"){var nt=decode_cell(it[1]);if(at.length<=nt.r)for(rt=at.length;rt<=nt.r;++rt)at[rt]||(at[rt]=[]);switch(rt=nt.r,et=nt.c,it[2]){case"t":at[rt][et]=e(it[3]);break;case"v":at[rt][et]=+it[3];break;case"vtf":var ot=it[it.length-1];case"vtc":switch(it[3]){case"nl":at[rt][et]=!!+it[4];break;default:at[rt][et]=+it[4];break}it[2]=="vtf"&&(at[rt][et]=[at[rt][et],ot])}}}return _e&&_e.sheetRows&&(at=at.slice(0,_e.sheetRows)),at}function i(j,_e){return aoa_to_sheet(a(j,_e),_e)}function o(j,_e){return sheet_to_workbook(i(j,_e),_e)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function _(j){if(!j||!j["!ref"])return"";for(var _e=[],tt=[],rt,et="",st=decode_range(j["!ref"]),at=Array.isArray(j),it=st.s.r;it<=st.e.r;++it)for(var nt=st.s.c;nt<=st.e.c;++nt)if(et=encode_cell({r:it,c:nt}),rt=at?(j[it]||[])[nt]:j[et],!(!rt||rt.v==null||rt.t==="z")){switch(tt=["cell",et,"t"],rt.t){case"s":case"str":tt.push(s(rt.v));break;case"n":rt.f?(tt[2]="vtf",tt[3]="n",tt[4]=rt.v,tt[5]=s(rt.f)):(tt[2]="v",tt[3]=rt.v);break;case"b":tt[2]="vt"+(rt.f?"f":"c"),tt[3]="nl",tt[4]=rt.v?"1":"0",tt[5]=s(rt.f||(rt.v?"TRUE":"FALSE"));break;case"d":var ot=datenum(parseDate(rt.v));tt[2]="vtc",tt[3]="nd",tt[4]=""+ot,tt[5]=rt.w||SSF_format(rt.z||table_fmt[14],ot);break;case"e":continue}_e.push(tt.join(":"))}return _e.push("sheet:c:"+(st.e.c-st.s.c+1)+":r:"+(st.e.r-st.s.r+1)+":tvf:1"),_e.push("valueformat:1:text-wiki"),_e.join(`
`)}function b(j){return[c,d,h,d,_(j),g].join(`
`)}return{to_workbook:o,to_sheet:i,from_sheet:b}}(),PRN=function(){function e(b,j,_e,tt,rt){rt.raw?j[_e][tt]=b:b===""||(b==="TRUE"?j[_e][tt]=!0:b==="FALSE"?j[_e][tt]=!1:isNaN(fuzzynum(b))?isNaN(fuzzydate(b).getDate())?j[_e][tt]=b:j[_e][tt]=parseDate(b):j[_e][tt]=fuzzynum(b))}function s(b,j){var _e=j||{},tt=[];if(!b||b.length===0)return tt;for(var rt=b.split(/[\r\n]/),et=rt.length-1;et>=0&&rt[et].length===0;)--et;for(var st=10,at=0,it=0;it<=et;++it)at=rt[it].indexOf(" "),at==-1?at=rt[it].length:at++,st=Math.max(st,at);for(it=0;it<=et;++it){tt[it]=[];var nt=0;for(e(rt[it].slice(0,st).trim(),tt,it,nt,_e),nt=1;nt<=(rt[it].length-st)/10+1;++nt)e(rt[it].slice(st+(nt-1)*10,st+nt*10).trim(),tt,it,nt,_e)}return _e.sheetRows&&(tt=tt.slice(0,_e.sheetRows)),tt}var a={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function o(b){for(var j={},_e=!1,tt=0,rt=0;tt<b.length;++tt)(rt=b.charCodeAt(tt))==34?_e=!_e:!_e&&rt in a&&(j[rt]=(j[rt]||0)+1);rt=[];for(tt in j)Object.prototype.hasOwnProperty.call(j,tt)&&rt.push([j[tt],tt]);if(!rt.length){j=i;for(tt in j)Object.prototype.hasOwnProperty.call(j,tt)&&rt.push([j[tt],tt])}return rt.sort(function(et,st){return et[0]-st[0]||i[et[1]]-i[st[1]]}),a[rt.pop()[1]]||44}function c(b,j){var _e=j||{},tt="",rt=_e.dense?[]:{},et={s:{c:0,r:0},e:{c:0,r:0}};b.slice(0,4)=="sep="?b.charCodeAt(5)==13&&b.charCodeAt(6)==10?(tt=b.charAt(4),b=b.slice(7)):b.charCodeAt(5)==13||b.charCodeAt(5)==10?(tt=b.charAt(4),b=b.slice(6)):tt=o(b.slice(0,1024)):_e&&_e.FS?tt=_e.FS:tt=o(b.slice(0,1024));var st=0,at=0,it=0,nt=0,ot=0,dt=tt.charCodeAt(0),ht=!1,lt=0,gt=b.charCodeAt(0);b=b.replace(/\r\n/mg,`
`);var yt=_e.dateNF!=null?dateNF_regex(_e.dateNF):null;function Tt(){var mt=b.slice(nt,ot),Et={};if(mt.charAt(0)=='"'&&mt.charAt(mt.length-1)=='"'&&(mt=mt.slice(1,-1).replace(/""/g,'"')),mt.length===0)Et.t="z";else if(_e.raw)Et.t="s",Et.v=mt;else if(mt.trim().length===0)Et.t="s",Et.v=mt;else if(mt.charCodeAt(0)==61)mt.charCodeAt(1)==34&&mt.charCodeAt(mt.length-1)==34?(Et.t="s",Et.v=mt.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(mt)?(Et.t="n",Et.f=mt.slice(1)):(Et.t="s",Et.v=mt);else if(mt=="TRUE")Et.t="b",Et.v=!0;else if(mt=="FALSE")Et.t="b",Et.v=!1;else if(!isNaN(it=fuzzynum(mt)))Et.t="n",_e.cellText!==!1&&(Et.w=mt),Et.v=it;else if(!isNaN(fuzzydate(mt).getDate())||yt&&mt.match(yt)){Et.z=_e.dateNF||table_fmt[14];var Ft=0;yt&&mt.match(yt)&&(mt=dateNF_fix(mt,_e.dateNF,mt.match(yt)||[]),Ft=1),_e.cellDates?(Et.t="d",Et.v=parseDate(mt,Ft)):(Et.t="n",Et.v=datenum(parseDate(mt,Ft))),_e.cellText!==!1&&(Et.w=SSF_format(Et.z,Et.v instanceof Date?datenum(Et.v):Et.v)),_e.cellNF||delete Et.z}else Et.t="s",Et.v=mt;if(Et.t=="z"||(_e.dense?(rt[st]||(rt[st]=[]),rt[st][at]=Et):rt[encode_cell({c:at,r:st})]=Et),nt=ot+1,gt=b.charCodeAt(nt),et.e.c<at&&(et.e.c=at),et.e.r<st&&(et.e.r=st),lt==dt)++at;else if(at=0,++st,_e.sheetRows&&_e.sheetRows<=st)return!0}e:for(;ot<b.length;++ot)switch(lt=b.charCodeAt(ot)){case 34:gt===34&&(ht=!ht);break;case dt:case 10:case 13:if(!ht&&Tt())break e;break}return ot-nt>0&&Tt(),rt["!ref"]=encode_range(et),rt}function d(b,j){return!(j&&j.PRN)||j.FS||b.slice(0,4)=="sep="||b.indexOf("	")>=0||b.indexOf(",")>=0||b.indexOf(";")>=0?c(b,j):aoa_to_sheet(s(b,j),j)}function h(b,j){var _e="",tt=j.type=="string"?[0,0,0,0]:firstbyte(b,j);switch(j.type){case"base64":_e=Base64_decode(b);break;case"binary":_e=b;break;case"buffer":j.codepage==65001?_e=b.toString("utf8"):j.codepage&&typeof $cptable<"u"?_e=$cptable.utils.decode(j.codepage,b):_e=has_buf&&Buffer.isBuffer(b)?b.toString("binary"):a2s(b);break;case"array":_e=cc2str(b);break;case"string":_e=b;break;default:throw new Error("Unrecognized type "+j.type)}return tt[0]==239&&tt[1]==187&&tt[2]==191?_e=utf8read(_e.slice(3)):j.type!="string"&&j.type!="buffer"&&j.codepage==65001?_e=utf8read(_e):j.type=="binary"&&typeof $cptable<"u"&&j.codepage&&(_e=$cptable.utils.decode(j.codepage,$cptable.utils.encode(28591,_e))),_e.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(j.type=="string"?_e:utf8read(_e),j):d(_e,j)}function g(b,j){return sheet_to_workbook(h(b,j),j)}function _(b){for(var j=[],_e=safe_decode_range(b["!ref"]),tt,rt=Array.isArray(b),et=_e.s.r;et<=_e.e.r;++et){for(var st=[],at=_e.s.c;at<=_e.e.c;++at){var it=encode_cell({r:et,c:at});if(tt=rt?(b[et]||[])[at]:b[it],!tt||tt.v==null){st.push("          ");continue}for(var nt=(tt.w||(format_cell(tt),tt.w)||"").slice(0,10);nt.length<10;)nt+=" ";st.push(nt+(at===0?" ":""))}j.push(st.join(""))}return j.join(`
`)}return{to_workbook:g,to_sheet:h,from_sheet:_}}();function read_wb_ID(e,s){var a=s||{},i=!!a.WTF;a.WTF=!0;try{var o=SYLK.to_workbook(e,a);return a.WTF=i,o}catch(c){if(a.WTF=i,!c.message.match(/SYLK bad record ID/)&&i)throw c;return PRN.to_workbook(e,s)}}var WK_=function(){function e(ft,Rt,bt){if(ft){prep_blob(ft,ft.l||0);for(var At=bt.Enum||Lt;ft.l<ft.length;){var Ut=ft.read_shift(2),Xt=At[Ut]||At[65535],Gt=ft.read_shift(2),zt=ft.l+Gt,Wt=Xt.f&&Xt.f(ft,Gt,bt);if(ft.l=zt,Rt(Wt,Xt,Ut))return}}}function s(ft,Rt){switch(Rt.type){case"base64":return a(s2a(Base64_decode(ft)),Rt);case"binary":return a(s2a(ft),Rt);case"buffer":case"array":return a(ft,Rt)}throw"Unsupported type "+Rt.type}function a(ft,Rt){if(!ft)return ft;var bt=Rt||{},At=bt.dense?[]:{},Ut="Sheet1",Xt="",Gt=0,zt={},Wt=[],er=[],St={s:{r:0,c:0},e:{r:0,c:0}},ir=bt.sheetRows||0;if(ft[2]==0&&(ft[3]==8||ft[3]==9)&&ft.length>=16&&ft[14]==5&&ft[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(ft[2]==2)bt.Enum=Lt,e(ft,function(Nt,Zt,sr){switch(sr){case 0:bt.vers=Nt,Nt>=4096&&(bt.qpro=!0);break;case 6:St=Nt;break;case 204:Nt&&(Xt=Nt);break;case 222:Xt=Nt;break;case 15:case 51:bt.qpro||(Nt[1].v=Nt[1].v.slice(1));case 13:case 14:case 16:sr==14&&(Nt[2]&112)==112&&(Nt[2]&15)>1&&(Nt[2]&15)<15&&(Nt[1].z=bt.dateNF||table_fmt[14],bt.cellDates&&(Nt[1].t="d",Nt[1].v=numdate(Nt[1].v))),bt.qpro&&Nt[3]>Gt&&(At["!ref"]=encode_range(St),zt[Ut]=At,Wt.push(Ut),At=bt.dense?[]:{},St={s:{r:0,c:0},e:{r:0,c:0}},Gt=Nt[3],Ut=Xt||"Sheet"+(Gt+1),Xt="");var cr=bt.dense?(At[Nt[0].r]||[])[Nt[0].c]:At[encode_cell(Nt[0])];if(cr){cr.t=Nt[1].t,cr.v=Nt[1].v,Nt[1].z!=null&&(cr.z=Nt[1].z),Nt[1].f!=null&&(cr.f=Nt[1].f);break}bt.dense?(At[Nt[0].r]||(At[Nt[0].r]=[]),At[Nt[0].r][Nt[0].c]=Nt[1]):At[encode_cell(Nt[0])]=Nt[1];break}},bt);else if(ft[2]==26||ft[2]==14)bt.Enum=Pt,ft[2]==14&&(bt.qpro=!0,ft.l=0),e(ft,function(Nt,Zt,sr){switch(sr){case 204:Ut=Nt;break;case 22:Nt[1].v=Nt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Nt[3]>Gt&&(At["!ref"]=encode_range(St),zt[Ut]=At,Wt.push(Ut),At=bt.dense?[]:{},St={s:{r:0,c:0},e:{r:0,c:0}},Gt=Nt[3],Ut="Sheet"+(Gt+1)),ir>0&&Nt[0].r>=ir)break;bt.dense?(At[Nt[0].r]||(At[Nt[0].r]=[]),At[Nt[0].r][Nt[0].c]=Nt[1]):At[encode_cell(Nt[0])]=Nt[1],St.e.c<Nt[0].c&&(St.e.c=Nt[0].c),St.e.r<Nt[0].r&&(St.e.r=Nt[0].r);break;case 27:Nt[14e3]&&(er[Nt[14e3][0]]=Nt[14e3][1]);break;case 1537:er[Nt[0]]=Nt[1],Nt[0]==Gt&&(Ut=Nt[1]);break}},bt);else throw new Error("Unrecognized LOTUS BOF "+ft[2]);if(At["!ref"]=encode_range(St),zt[Xt||Ut]=At,Wt.push(Xt||Ut),!er.length)return{SheetNames:Wt,Sheets:zt};for(var nr={},ar=[],$t=0;$t<er.length;++$t)zt[Wt[$t]]?(ar.push(er[$t]||Wt[$t]),nr[er[$t]]=zt[er[$t]]||zt[Wt[$t]]):(ar.push(er[$t]),nr[er[$t]]={"!ref":"A1"});return{SheetNames:ar,Sheets:nr}}function i(ft,Rt){var bt=Rt||{};if(+bt.codepage>=0&&set_cp(+bt.codepage),bt.type=="string")throw new Error("Cannot write WK1 to JS string");var At=buf_array(),Ut=safe_decode_range(ft["!ref"]),Xt=Array.isArray(ft),Gt=[];write_biff_rec(At,0,c(1030)),write_biff_rec(At,6,g(Ut));for(var zt=Math.min(Ut.e.r,8191),Wt=Ut.s.r;Wt<=zt;++Wt)for(var er=encode_row(Wt),St=Ut.s.c;St<=Ut.e.c;++St){Wt===Ut.s.r&&(Gt[St]=encode_col(St));var ir=Gt[St]+er,nr=Xt?(ft[Wt]||[])[St]:ft[ir];if(!(!nr||nr.t=="z"))if(nr.t=="n")(nr.v|0)==nr.v&&nr.v>=-32768&&nr.v<=32767?write_biff_rec(At,13,tt(Wt,St,nr.v)):write_biff_rec(At,14,et(Wt,St,nr.v));else{var ar=format_cell(nr);write_biff_rec(At,15,j(Wt,St,ar.slice(0,239)))}}return write_biff_rec(At,1),At.end()}function o(ft,Rt){var bt=Rt||{};if(+bt.codepage>=0&&set_cp(+bt.codepage),bt.type=="string")throw new Error("Cannot write WK3 to JS string");var At=buf_array();write_biff_rec(At,0,d(ft));for(var Ut=0,Xt=0;Ut<ft.SheetNames.length;++Ut)(ft.Sheets[ft.SheetNames[Ut]]||{})["!ref"]&&write_biff_rec(At,27,ut(ft.SheetNames[Ut],Xt++));var Gt=0;for(Ut=0;Ut<ft.SheetNames.length;++Ut){var zt=ft.Sheets[ft.SheetNames[Ut]];if(!(!zt||!zt["!ref"])){for(var Wt=safe_decode_range(zt["!ref"]),er=Array.isArray(zt),St=[],ir=Math.min(Wt.e.r,8191),nr=Wt.s.r;nr<=ir;++nr)for(var ar=encode_row(nr),$t=Wt.s.c;$t<=Wt.e.c;++$t){nr===Wt.s.r&&(St[$t]=encode_col($t));var Nt=St[$t]+ar,Zt=er?(zt[nr]||[])[$t]:zt[Nt];if(!(!Zt||Zt.t=="z"))if(Zt.t=="n")write_biff_rec(At,23,Tt(nr,$t,Gt,Zt.v));else{var sr=format_cell(Zt);write_biff_rec(At,22,lt(nr,$t,Gt,sr.slice(0,239)))}}++Gt}}return write_biff_rec(At,1),At.end()}function c(ft){var Rt=new_buf(2);return Rt.write_shift(2,ft),Rt}function d(ft){var Rt=new_buf(26);Rt.write_shift(2,4096),Rt.write_shift(2,4),Rt.write_shift(4,0);for(var bt=0,At=0,Ut=0,Xt=0;Xt<ft.SheetNames.length;++Xt){var Gt=ft.SheetNames[Xt],zt=ft.Sheets[Gt];if(!(!zt||!zt["!ref"])){++Ut;var Wt=decode_range(zt["!ref"]);bt<Wt.e.r&&(bt=Wt.e.r),At<Wt.e.c&&(At=Wt.e.c)}}return bt>8191&&(bt=8191),Rt.write_shift(2,bt),Rt.write_shift(1,Ut),Rt.write_shift(1,At),Rt.write_shift(2,0),Rt.write_shift(2,0),Rt.write_shift(1,1),Rt.write_shift(1,2),Rt.write_shift(4,0),Rt.write_shift(4,0),Rt}function h(ft,Rt,bt){var At={s:{c:0,r:0},e:{c:0,r:0}};return Rt==8&&bt.qpro?(At.s.c=ft.read_shift(1),ft.l++,At.s.r=ft.read_shift(2),At.e.c=ft.read_shift(1),ft.l++,At.e.r=ft.read_shift(2),At):(At.s.c=ft.read_shift(2),At.s.r=ft.read_shift(2),Rt==12&&bt.qpro&&(ft.l+=2),At.e.c=ft.read_shift(2),At.e.r=ft.read_shift(2),Rt==12&&bt.qpro&&(ft.l+=2),At.s.c==65535&&(At.s.c=At.e.c=At.s.r=At.e.r=0),At)}function g(ft){var Rt=new_buf(8);return Rt.write_shift(2,ft.s.c),Rt.write_shift(2,ft.s.r),Rt.write_shift(2,ft.e.c),Rt.write_shift(2,ft.e.r),Rt}function _(ft,Rt,bt){var At=[{c:0,r:0},{t:"n",v:0},0,0];return bt.qpro&&bt.vers!=20768?(At[0].c=ft.read_shift(1),At[3]=ft.read_shift(1),At[0].r=ft.read_shift(2),ft.l+=2):(At[2]=ft.read_shift(1),At[0].c=ft.read_shift(2),At[0].r=ft.read_shift(2)),At}function b(ft,Rt,bt){var At=ft.l+Rt,Ut=_(ft,Rt,bt);if(Ut[1].t="s",bt.vers==20768){ft.l++;var Xt=ft.read_shift(1);return Ut[1].v=ft.read_shift(Xt,"utf8"),Ut}return bt.qpro&&ft.l++,Ut[1].v=ft.read_shift(At-ft.l,"cstr"),Ut}function j(ft,Rt,bt){var At=new_buf(7+bt.length);At.write_shift(1,255),At.write_shift(2,Rt),At.write_shift(2,ft),At.write_shift(1,39);for(var Ut=0;Ut<At.length;++Ut){var Xt=bt.charCodeAt(Ut);At.write_shift(1,Xt>=128?95:Xt)}return At.write_shift(1,0),At}function _e(ft,Rt,bt){var At=_(ft,Rt,bt);return At[1].v=ft.read_shift(2,"i"),At}function tt(ft,Rt,bt){var At=new_buf(7);return At.write_shift(1,255),At.write_shift(2,Rt),At.write_shift(2,ft),At.write_shift(2,bt,"i"),At}function rt(ft,Rt,bt){var At=_(ft,Rt,bt);return At[1].v=ft.read_shift(8,"f"),At}function et(ft,Rt,bt){var At=new_buf(13);return At.write_shift(1,255),At.write_shift(2,Rt),At.write_shift(2,ft),At.write_shift(8,bt,"f"),At}function st(ft,Rt,bt){var At=ft.l+Rt,Ut=_(ft,Rt,bt);if(Ut[1].v=ft.read_shift(8,"f"),bt.qpro)ft.l=At;else{var Xt=ft.read_shift(2);ot(ft.slice(ft.l,ft.l+Xt),Ut),ft.l+=Xt}return Ut}function at(ft,Rt,bt){var At=Rt&32768;return Rt&=-32769,Rt=(At?ft:0)+(Rt>=8192?Rt-16384:Rt),(At?"":"$")+(bt?encode_col(Rt):encode_row(Rt))}var it={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},nt=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ot(ft,Rt){prep_blob(ft,0);for(var bt=[],At=0,Ut="",Xt="",Gt="",zt="";ft.l<ft.length;){var Wt=ft[ft.l++];switch(Wt){case 0:bt.push(ft.read_shift(8,"f"));break;case 1:Xt=at(Rt[0].c,ft.read_shift(2),!0),Ut=at(Rt[0].r,ft.read_shift(2),!1),bt.push(Xt+Ut);break;case 2:{var er=at(Rt[0].c,ft.read_shift(2),!0),St=at(Rt[0].r,ft.read_shift(2),!1);Xt=at(Rt[0].c,ft.read_shift(2),!0),Ut=at(Rt[0].r,ft.read_shift(2),!1),bt.push(er+St+":"+Xt+Ut)}break;case 3:if(ft.l<ft.length){console.error("WK1 premature formula end");return}break;case 4:bt.push("("+bt.pop()+")");break;case 5:bt.push(ft.read_shift(2));break;case 6:{for(var ir="";Wt=ft[ft.l++];)ir+=String.fromCharCode(Wt);bt.push('"'+ir.replace(/"/g,'""')+'"')}break;case 8:bt.push("-"+bt.pop());break;case 23:bt.push("+"+bt.pop());break;case 22:bt.push("NOT("+bt.pop()+")");break;case 20:case 21:zt=bt.pop(),Gt=bt.pop(),bt.push(["AND","OR"][Wt-20]+"("+Gt+","+zt+")");break;default:if(Wt<32&&nt[Wt])zt=bt.pop(),Gt=bt.pop(),bt.push(Gt+nt[Wt]+zt);else if(it[Wt]){if(At=it[Wt][1],At==69&&(At=ft[ft.l++]),At>bt.length){console.error("WK1 bad formula parse 0x"+Wt.toString(16)+":|"+bt.join("|")+"|");return}var nr=bt.slice(-At);bt.length-=At,bt.push(it[Wt][0]+"("+nr.join(",")+")")}else return Wt<=7?console.error("WK1 invalid opcode "+Wt.toString(16)):Wt<=24?console.error("WK1 unsupported op "+Wt.toString(16)):Wt<=30?console.error("WK1 invalid opcode "+Wt.toString(16)):Wt<=115?console.error("WK1 unsupported function opcode "+Wt.toString(16)):console.error("WK1 unrecognized opcode "+Wt.toString(16))}}bt.length==1?Rt[1].f=""+bt[0]:console.error("WK1 bad formula parse |"+bt.join("|")+"|")}function dt(ft){var Rt=[{c:0,r:0},{t:"n",v:0},0];return Rt[0].r=ft.read_shift(2),Rt[3]=ft[ft.l++],Rt[0].c=ft[ft.l++],Rt}function ht(ft,Rt){var bt=dt(ft);return bt[1].t="s",bt[1].v=ft.read_shift(Rt-4,"cstr"),bt}function lt(ft,Rt,bt,At){var Ut=new_buf(6+At.length);Ut.write_shift(2,ft),Ut.write_shift(1,bt),Ut.write_shift(1,Rt),Ut.write_shift(1,39);for(var Xt=0;Xt<At.length;++Xt){var Gt=At.charCodeAt(Xt);Ut.write_shift(1,Gt>=128?95:Gt)}return Ut.write_shift(1,0),Ut}function gt(ft,Rt){var bt=dt(ft);bt[1].v=ft.read_shift(2);var At=bt[1].v>>1;if(bt[1].v&1)switch(At&7){case 0:At=(At>>3)*5e3;break;case 1:At=(At>>3)*500;break;case 2:At=(At>>3)/20;break;case 3:At=(At>>3)/200;break;case 4:At=(At>>3)/2e3;break;case 5:At=(At>>3)/2e4;break;case 6:At=(At>>3)/16;break;case 7:At=(At>>3)/64;break}return bt[1].v=At,bt}function yt(ft,Rt){var bt=dt(ft),At=ft.read_shift(4),Ut=ft.read_shift(4),Xt=ft.read_shift(2);if(Xt==65535)return At===0&&Ut===3221225472?(bt[1].t="e",bt[1].v=15):At===0&&Ut===3489660928?(bt[1].t="e",bt[1].v=42):bt[1].v=0,bt;var Gt=Xt&32768;return Xt=(Xt&32767)-16446,bt[1].v=(1-Gt*2)*(Ut*Math.pow(2,Xt+32)+At*Math.pow(2,Xt)),bt}function Tt(ft,Rt,bt,At){var Ut=new_buf(14);if(Ut.write_shift(2,ft),Ut.write_shift(1,bt),Ut.write_shift(1,Rt),At==0)return Ut.write_shift(4,0),Ut.write_shift(4,0),Ut.write_shift(2,65535),Ut;var Xt=0,Gt=0,zt=0,Wt=0;return At<0&&(Xt=1,At=-At),Gt=Math.log2(At)|0,At/=Math.pow(2,Gt-31),Wt=At>>>0,Wt&2147483648||(At/=2,++Gt,Wt=At>>>0),At-=Wt,Wt|=2147483648,Wt>>>=0,At*=Math.pow(2,32),zt=At>>>0,Ut.write_shift(4,zt),Ut.write_shift(4,Wt),Gt+=16383+(Xt?32768:0),Ut.write_shift(2,Gt),Ut}function mt(ft,Rt){var bt=yt(ft);return ft.l+=Rt-14,bt}function Et(ft,Rt){var bt=dt(ft),At=ft.read_shift(4);return bt[1].v=At>>6,bt}function Ft(ft,Rt){var bt=dt(ft),At=ft.read_shift(8,"f");return bt[1].v=At,bt}function Vt(ft,Rt){var bt=Ft(ft);return ft.l+=Rt-10,bt}function Mt(ft,Rt){return ft[ft.l+Rt-1]==0?ft.read_shift(Rt,"cstr"):""}function Ct(ft,Rt){var bt=ft[ft.l++];bt>Rt-1&&(bt=Rt-1);for(var At="";At.length<bt;)At+=String.fromCharCode(ft[ft.l++]);return At}function kt(ft,Rt,bt){if(!(!bt.qpro||Rt<21)){var At=ft.read_shift(1);ft.l+=17,ft.l+=1,ft.l+=2;var Ut=ft.read_shift(Rt-21,"cstr");return[At,Ut]}}function jt(ft,Rt){for(var bt={},At=ft.l+Rt;ft.l<At;){var Ut=ft.read_shift(2);if(Ut==14e3){for(bt[Ut]=[0,""],bt[Ut][0]=ft.read_shift(2);ft[ft.l];)bt[Ut][1]+=String.fromCharCode(ft[ft.l]),ft.l++;ft.l++}}return bt}function ut(ft,Rt){var bt=new_buf(5+ft.length);bt.write_shift(2,14e3),bt.write_shift(2,Rt);for(var At=0;At<ft.length;++At){var Ut=ft.charCodeAt(At);bt[bt.l++]=Ut>127?95:Ut}return bt[bt.l++]=0,bt}var Lt={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_e},14:{n:"NUMBER",f:rt},15:{n:"LABEL",f:b},16:{n:"FORMULA",f:st},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:b},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Mt},222:{n:"SHEETNAMELP",f:Ct},65535:{n:""}},Pt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ht},23:{n:"NUMBER17",f:yt},24:{n:"NUMBER18",f:gt},25:{n:"FORMULA19",f:mt},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:jt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Et},38:{n:"??"},39:{n:"NUMBER27",f:Ft},40:{n:"FORMULA28",f:Vt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Mt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:kt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:o,to_workbook:s}}();function parse_rpr(e){var s={},a=e.match(tagregex),i=0,o=!1;if(a)for(;i!=a.length;++i){var c=parsexmltag(a[i]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":s.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;s.cp=CS2CP[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":s.outline=1;break;case"</outline>":break;case"<rFont":s.name=c.val;break;case"<sz":s.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":s.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":s.uval="double";break;case"singleAccounting":s.uval="single-accounting";break;case"doubleAccounting":s.uval="double-accounting";break}case"<u>":case"<u/>":s.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":s.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":s.i=1;break;case"</i>":break;case"<color":c.rgb&&(s.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":s.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":s.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(c[0].charCodeAt(1)!==47&&!o)throw new Error("Unrecognized rich format "+c[0])}}return s}var parse_rs=function(){var e=matchtag("t"),s=matchtag("rPr");function a(c){var d=c.match(e);if(!d)return{t:"s",v:""};var h={t:"s",v:unescapexml(d[1])},g=c.match(s);return g&&(h.s=parse_rpr(g[1])),h}var i=/<(?:\w+:)?r>/g,o=/<\/(?:\w+:)?r>/;return function(d){return d.replace(i,"").split(o).map(a).filter(function(h){return h.v})}}(),rs_to_html=function e(){var s=/(\r\n|\n)/g;function a(o,c,d){var h=[];o.u&&h.push("text-decoration: underline;"),o.uval&&h.push("text-underline-style:"+o.uval+";"),o.sz&&h.push("font-size:"+o.sz+"pt;"),o.outline&&h.push("text-effect: outline;"),o.shadow&&h.push("text-shadow: auto;"),c.push('<span style="'+h.join("")+'">'),o.b&&(c.push("<b>"),d.push("</b>")),o.i&&(c.push("<i>"),d.push("</i>")),o.strike&&(c.push("<s>"),d.push("</s>"));var g=o.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(c.push("<"+g+">"),d.push("</"+g+">")),d.push("</span>"),o}function i(o){var c=[[],o.v,[]];return o.v?(o.s&&a(o.s,c[0],c[2]),c[0].join("")+c[1].replace(s,"<br/>")+c[2].join("")):""}return function(c){return c.map(i).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,s){var a=s?s.cellHTML:!0,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=utf8read(e),a&&(i.h=escapehtml(i.t))):e.match(sirregex)&&(i.r=utf8read(e),i.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),a&&(i.h=rs_to_html(parse_rs(i.r)))),i):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,s){var a=[],i="";if(!e)return a;var o=e.match(sstr0);if(o){i=o[2].replace(sstr1,"").split(sstr2);for(var c=0;c!=i.length;++c){var d=parse_si(i[c].trim(),s);d!=null&&(a[a.length]=d)}o=parsexmltag(o[1]),a.Count=o.count,a.Unique=o.uniqueCount}return a}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,s){if(!s.bookSST)return"";var a=[XML_HEADER];a[a.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var i=0;i!=e.length;++i)if(e[i]!=null){var o=e[i],c="<si>";o.r?c+=o.r:(c+="<t",o.t||(o.t=""),o.t.match(straywsregex)&&(c+=' xml:space="preserve"'),c+=">"+escapexml(o.t)+"</t>"),c+="</si>",a[a.length]=c}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,s){var a=[],i=!1;return recordhopper(e,function(c,d,h){switch(h){case 159:a.Count=c[0],a.Unique=c[1];break;case 19:a.push(c);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(d.T,!i||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}),a}function write_BrtBeginSst(e,s){return s||(s=new_buf(8)),s.write_shift(4,e.Count),s.write_shift(4,e.Unique),s}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var s=buf_array();write_record(s,159,write_BrtBeginSst(e));for(var a=0;a<e.length;++a)write_record(s,19,write_BrtSSTItem(e[a]));return write_record(s,160),s.end()}function _JS2ANSI(e){for(var s=[],a=e.split(""),i=0;i<a.length;++i)s[i]=a[i].charCodeAt(0);return s}function parse_CRYPTOVersion(e,s){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),s>=4&&(e.l+=s-4),a}function parse_DataSpaceVersionInfo(e){var s={};return s.id=e.read_shift(0,"lpp4"),s.R=parse_CRYPTOVersion(e,4),s.U=parse_CRYPTOVersion(e,4),s.W=parse_CRYPTOVersion(e,4),s}function parse_DataSpaceMapEntry(e){for(var s=e.read_shift(4),a=e.l+s-4,i={},o=e.read_shift(4),c=[];o-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=c,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return i}function parse_DataSpaceMap(e){var s=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)s.push(parse_DataSpaceMapEntry(e));return s}function parse_DataSpaceDefinition(e){var s=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)s.push(e.read_shift(0,"lpp4"));return s}function parse_TransformInfoHeader(e){var s={};return e.read_shift(4),e.l+=4,s.id=e.read_shift(0,"lpp4"),s.name=e.read_shift(0,"lpp4"),s.R=parse_CRYPTOVersion(e,4),s.U=parse_CRYPTOVersion(e,4),s.W=parse_CRYPTOVersion(e,4),s}function parse_Primary(e){var s=parse_TransformInfoHeader(e);if(s.ename=e.read_shift(0,"8lpp4"),s.blksz=e.read_shift(4),s.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return s}function parse_EncryptionHeader(e,s){var a=e.l+s,i={};i.Flags=e.read_shift(4)&63,e.l+=4,i.AlgID=e.read_shift(4);var o=!1;switch(i.AlgID){case 26126:case 26127:case 26128:o=i.Flags==36;break;case 26625:o=i.Flags==4;break;case 0:o=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!o)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,i}function parse_EncryptionVerifier(e,s){var a={},i=e.l+s;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,i),e.l=i,a}function parse_EncryptionInfo(e){var s=parse_CRYPTOVersion(e);switch(s.Minor){case 2:return[s.Minor,parse_EncInfoStd(e)];case 3:return[s.Minor,parse_EncInfoExt()];case 4:return[s.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+s.Minor)}function parse_EncInfoStd(e){var s=e.read_shift(4);if((s&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),i=parse_EncryptionHeader(e,a),o=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:i,v:o}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var s=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),i={};return a.replace(tagregex,function(c){var d=parsexmltag(c);switch(strip_ns(d[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":s.forEach(function(h){i[h]=d[h]});break;case"<dataIntegrity":i.encryptedHmacKey=d.encryptedHmacKey,i.encryptedHmacValue=d.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=d.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(d);break;default:throw d[0]}}),i}function parse_RC4CryptoHeader(e,s){var a={},i=a.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(s-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);a.Flags=e.read_shift(4),s-=4;var o=e.read_shift(4);return s-=4,a.EncryptionHeader=parse_EncryptionHeader(e,o),s-=o,a.EncryptionVerifier=parse_EncryptionVerifier(e,s),a}function parse_RC4Header(e){var s={},a=s.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return s.Salt=e.read_shift(16),s.EncryptedVerifier=e.read_shift(16),s.EncryptedVerifierHash=e.read_shift(16),s}function crypto_CreatePasswordVerifier_Method1(e){var s=0,a,i=_JS2ANSI(e),o=i.length+1,c,d,h,g,_;for(a=new_raw_buf(o),a[0]=i.length,c=1;c!=o;++c)a[c]=i[c-1];for(c=o-1;c>=0;--c)d=a[c],h=s&16384?1:0,g=s<<1&32767,_=h|g,s=_^d;return s^52811}var crypto_CreateXorArray_Method1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],s=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(d){return(d/2|d*128)&255},o=function(d,h){return i(d^h)},c=function(d){for(var h=s[d.length-1],g=104,_=d.length-1;_>=0;--_)for(var b=d[_],j=0;j!=7;++j)b&64&&(h^=a[g]),b*=2,--g;return h};return function(d){for(var h=_JS2ANSI(d),g=c(h),_=h.length,b=new_raw_buf(16),j=0;j!=16;++j)b[j]=0;var _e,tt,rt;for((_&1)===1&&(_e=g>>8,b[_]=o(e[0],_e),--_,_e=g&255,tt=h[h.length-1],b[_]=o(tt,_e));_>0;)--_,_e=g>>8,b[_]=o(h[_],_e),--_,_e=g&255,b[_]=o(h[_],_e);for(_=15,rt=15-h.length;rt>0;)_e=g>>8,b[_]=o(e[rt],_e),--_,--rt,_e=g&255,b[_]=o(h[_],_e),--_,--rt;return b}}(),crypto_DecryptData_Method1=function(e,s,a,i,o){o||(o=s),i||(i=crypto_CreateXorArray_Method1(e));var c,d;for(c=0;c!=s.length;++c)d=s[c],d^=i[a],d=(d>>5|d<<3)&255,o[c]=d,++a;return[o,a,i]},crypto_MakeXorDecryptor=function(e){var s=0,a=crypto_CreateXorArray_Method1(e);return function(i){var o=crypto_DecryptData_Method1("",i,s,a);return s=o[1],o[0]}};function parse_XORObfuscation(e,s,a,i){var o={key:parseuint16(e),verificationBytes:parseuint16(e)};return a.password&&(o.verifier=crypto_CreatePasswordVerifier_Method1(a.password)),i.valid=o.verificationBytes===o.verifier,i.valid&&(i.insitu=crypto_MakeXorDecryptor(a.password)),o}function parse_FilePassHeader(e,s,a){var i=a||{};return i.Info=e.read_shift(2),e.l-=2,i.Info===1?i.Data=parse_RC4Header(e):i.Data=parse_RC4CryptoHeader(e,s),i}function parse_FilePass(e,s,a){var i={Type:a.biff>=8?e.read_shift(2):0};return i.Type?parse_FilePassHeader(e,s-2,i):parse_XORObfuscation(e,a.biff>=8?s:s-2,a,i),i}var RTF=function(){function e(o,c){switch(c.type){case"base64":return s(Base64_decode(o),c);case"binary":return s(o,c);case"buffer":return s(has_buf&&Buffer.isBuffer(o)?o.toString("binary"):a2s(o),c);case"array":return s(cc2str(o),c)}throw new Error("Unrecognized type "+c.type)}function s(o,c){var d=c||{},h=d.dense?[]:{},g=o.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var _={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(b,j){Array.isArray(h)&&(h[j]=[]);for(var _e=/\\\w+\b/g,tt=0,rt,et=-1;rt=_e.exec(b);){switch(rt[0]){case"\\cell":var st=b.slice(tt,_e.lastIndex-rt[0].length);if(st[0]==" "&&(st=st.slice(1)),++et,st.length){var at={v:st,t:"s"};Array.isArray(h)?h[j][et]=at:h[encode_cell({r:j,c:et})]=at}break}tt=_e.lastIndex}et>_.e.c&&(_.e.c=et)}),h["!ref"]=encode_range(_),h}function a(o,c){return sheet_to_workbook(e(o,c),c)}function i(o){for(var c=["{\\rtf1\\ansi"],d=safe_decode_range(o["!ref"]),h,g=Array.isArray(o),_=d.s.r;_<=d.e.r;++_){c.push("\\trowd\\trautofit1");for(var b=d.s.c;b<=d.e.c;++b)c.push("\\cellx"+(b+1));for(c.push("\\pard\\intbl"),b=d.s.c;b<=d.e.c;++b){var j=encode_cell({r:_,c:b});h=g?(o[_]||[])[b]:o[j],!(!h||h.v==null&&(!h.f||h.F))&&(c.push(" "+(h.w||(format_cell(h),h.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:i}}();function hex2RGB(e){var s=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]}function rgb2Hex(e){for(var s=0,a=1;s!=3;++s)a=a*256+(e[s]>255?255:e[s]<0?0:e[s]);return a.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var s=e[0]/255,a=e[1]/255,i=e[2]/255,o=Math.max(s,a,i),c=Math.min(s,a,i),d=o-c;if(d===0)return[0,0,s];var h=0,g=0,_=o+c;switch(g=d/(_>1?2-_:_),o){case s:h=((a-i)/d+6)%6;break;case a:h=(i-s)/d+2;break;case i:h=(s-a)/d+4;break}return[h/6,g,_/2]}function hsl2RGB(e){var s=e[0],a=e[1],i=e[2],o=a*2*(i<.5?i:1-i),c=i-o/2,d=[c,c,c],h=6*s,g;if(a!==0)switch(h|0){case 0:case 6:g=o*h,d[0]+=o,d[1]+=g;break;case 1:g=o*(2-h),d[0]+=g,d[1]+=o;break;case 2:g=o*(h-2),d[1]+=o,d[2]+=g;break;case 3:g=o*(4-h),d[1]+=g,d[2]+=o;break;case 4:g=o*(h-4),d[2]+=o,d[0]+=g;break;case 5:g=o*(6-h),d[2]+=g,d[0]+=o;break}for(var _=0;_!=3;++_)d[_]=Math.round(d[_]*255);return d}function rgb_tint(e,s){if(s===0)return e;var a=rgb2HSL(hex2RGB(e));return s<0?a[2]=a[2]*(1+s):a[2]=1-(1-a[2])*(1-s),rgb2Hex(hsl2RGB(a))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var s=Math.abs(e-cycle_width(e)),a=MDW;if(s>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=s&&(s=Math.abs(e-cycle_width(e)),a=MDW);MDW=a}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,s,a,i){s.Borders=[];var o={},c=!1;(e[0].match(tagregex)||[]).forEach(function(d){var h=parsexmltag(d);switch(strip_ns(h[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":o={},h.diagonalUp&&(o.diagonalUp=parsexmlbool(h.diagonalUp)),h.diagonalDown&&(o.diagonalDown=parsexmlbool(h.diagonalDown)),s.Borders.push(o);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+h[0]+" in borders")}})}function parse_fills(e,s,a,i){s.Fills=[];var o={},c=!1;(e[0].match(tagregex)||[]).forEach(function(d){var h=parsexmltag(d);switch(strip_ns(h[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":o={},s.Fills.push(o);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":s.Fills.push(o),o={};break;case"<patternFill":case"<patternFill>":h.patternType&&(o.patternType=h.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":o.bgColor||(o.bgColor={}),h.indexed&&(o.bgColor.indexed=parseInt(h.indexed,10)),h.theme&&(o.bgColor.theme=parseInt(h.theme,10)),h.tint&&(o.bgColor.tint=parseFloat(h.tint)),h.rgb&&(o.bgColor.rgb=h.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":o.fgColor||(o.fgColor={}),h.theme&&(o.fgColor.theme=parseInt(h.theme,10)),h.tint&&(o.fgColor.tint=parseFloat(h.tint)),h.rgb!=null&&(o.fgColor.rgb=h.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+h[0]+" in fills")}})}function parse_fonts(e,s,a,i){s.Fonts=[];var o={},c=!1;(e[0].match(tagregex)||[]).forEach(function(d){var h=parsexmltag(d);switch(strip_ns(h[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":s.Fonts.push(o),o={};break;case"<name":h.val&&(o.name=utf8read(h.val));break;case"<name/>":case"</name>":break;case"<b":o.bold=h.val?parsexmlbool(h.val):1;break;case"<b/>":o.bold=1;break;case"<i":o.italic=h.val?parsexmlbool(h.val):1;break;case"<i/>":o.italic=1;break;case"<u":switch(h.val){case"none":o.underline=0;break;case"single":o.underline=1;break;case"double":o.underline=2;break;case"singleAccounting":o.underline=33;break;case"doubleAccounting":o.underline=34;break}break;case"<u/>":o.underline=1;break;case"<strike":o.strike=h.val?parsexmlbool(h.val):1;break;case"<strike/>":o.strike=1;break;case"<outline":o.outline=h.val?parsexmlbool(h.val):1;break;case"<outline/>":o.outline=1;break;case"<shadow":o.shadow=h.val?parsexmlbool(h.val):1;break;case"<shadow/>":o.shadow=1;break;case"<condense":o.condense=h.val?parsexmlbool(h.val):1;break;case"<condense/>":o.condense=1;break;case"<extend":o.extend=h.val?parsexmlbool(h.val):1;break;case"<extend/>":o.extend=1;break;case"<sz":h.val&&(o.sz=+h.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":h.val&&(o.vertAlign=h.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":h.val&&(o.family=parseInt(h.val,10));break;case"<family/>":case"</family>":break;case"<scheme":h.val&&(o.scheme=h.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(h.val=="1")break;h.codepage=CS2CP[parseInt(h.val,10)];break;case"<color":if(o.color||(o.color={}),h.auto&&(o.color.auto=parsexmlbool(h.auto)),h.rgb)o.color.rgb=h.rgb.slice(-6);else if(h.indexed){o.color.index=parseInt(h.indexed,10);var g=XLSIcv[o.color.index];o.color.index==81&&(g=XLSIcv[1]),g||(g=XLSIcv[1]),o.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else h.theme&&(o.color.theme=parseInt(h.theme,10),h.tint&&(o.color.tint=parseFloat(h.tint)),h.theme&&a.themeElements&&a.themeElements.clrScheme&&(o.color.rgb=rgb_tint(a.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+h[0]+" in fonts")}})}function parse_numFmts(e,s,a){s.NumberFmt=[];for(var i=keys(table_fmt),o=0;o<i.length;++o)s.NumberFmt[i[o]]=table_fmt[i[o]];var c=e[0].match(tagregex);if(c)for(o=0;o<c.length;++o){var d=parsexmltag(c[o]);switch(strip_ns(d[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var h=unescapexml(utf8read(d.formatCode)),g=parseInt(d.numFmtId,10);if(s.NumberFmt[g]=h,g>0){if(g>392){for(g=392;g>60&&s.NumberFmt[g]!=null;--g);s.NumberFmt[g]=h}SSF_load(h,g)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+d[0]+" in numFmts")}}}function write_numFmts(e){var s=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)e[i]!=null&&(s[s.length]=writextag("numFmt",null,{numFmtId:i,formatCode:escapexml(e[i])}))}),s.length===1?"":(s[s.length]="</numFmts>",s[0]=writextag("numFmts",null,{count:s.length-2}).replace("/>",">"),s.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,s,a){s.CellXf=[];var i,o=!1;(e[0].match(tagregex)||[]).forEach(function(c){var d=parsexmltag(c),h=0;switch(strip_ns(d[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=d,delete i[0],h=0;h<cellXF_uint.length;++h)i[cellXF_uint[h]]&&(i[cellXF_uint[h]]=parseInt(i[cellXF_uint[h]],10));for(h=0;h<cellXF_bool.length;++h)i[cellXF_bool[h]]&&(i[cellXF_bool[h]]=parsexmlbool(i[cellXF_bool[h]]));if(s.NumberFmt&&i.numFmtId>392){for(h=392;h>60;--h)if(s.NumberFmt[i.numFmtId]==s.NumberFmt[h]){i.numFmtId=h;break}}s.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};d.vertical&&(g.vertical=d.vertical),d.horizontal&&(g.horizontal=d.horizontal),d.textRotation!=null&&(g.textRotation=d.textRotation),d.indent&&(g.indent=d.indent),d.wrapText&&(g.wrapText=parsexmlbool(d.wrapText)),i.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+d[0]+" in cellXfs")}})}function write_cellXfs(e){var s=[];return s[s.length]=writextag("cellXfs",null),e.forEach(function(a){s[s.length]=writextag("xf",null,a)}),s[s.length]="</cellXfs>",s.length===2?"":(s[0]=writextag("cellXfs",null,{count:s.length-2}).replace("/>",">"),s.join(""))}var parse_sty_xml=function e(){var s=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,o=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(h,g,_){var b={};if(!h)return b;h=h.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var j;return(j=h.match(s))&&parse_numFmts(j,b,_),(j=h.match(o))&&parse_fonts(j,b,g,_),(j=h.match(i))&&parse_fills(j,b,g,_),(j=h.match(c))&&parse_borders(j,b,g,_),(j=h.match(a))&&parse_cellXfs(j,b,_),b}}();function write_sty_xml(e,s){var a=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],i;return e.SSF&&(i=write_numFmts(e.SSF))!=null&&(a[a.length]=i),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=write_cellXfs(s.cellXfs))&&(a[a.length]=i),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function parse_BrtFmt(e,s){var a=e.read_shift(2),i=parse_XLWideString(e);return[a,i]}function write_BrtFmt(e,s,a){a||(a=new_buf(6+4*s.length)),a.write_shift(2,e),write_XLWideString(s,a);var i=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),i}function parse_BrtFont(e,s,a){var i={};i.sz=e.read_shift(2)/20;var o=parse_FontFlags(e);o.fItalic&&(i.italic=1),o.fCondense&&(i.condense=1),o.fExtend&&(i.extend=1),o.fShadow&&(i.shadow=1),o.fOutline&&(i.outline=1),o.fStrikeout&&(i.strike=1);var c=e.read_shift(2);switch(c===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var d=e.read_shift(1);d!=0&&(i.underline=d);var h=e.read_shift(1);h>0&&(i.family=h);var g=e.read_shift(1);switch(g>0&&(i.charset=g),e.l++,i.color=parse_BrtColor(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=parse_XLWideString(e),i}function write_BrtFont(e,s){s||(s=new_buf(25+4*32)),s.write_shift(2,e.sz*20),write_FontFlags(e,s),s.write_shift(2,e.bold?700:400);var a=0;e.vertAlign=="superscript"?a=1:e.vertAlign=="subscript"&&(a=2),s.write_shift(2,a),s.write_shift(1,e.underline||0),s.write_shift(1,e.family||0),s.write_shift(1,e.charset||0),s.write_shift(1,0),write_BrtColor(e.color,s);var i=0;return e.scheme=="major"&&(i=1),e.scheme=="minor"&&(i=2),s.write_shift(1,i),write_XLWideString(e.name,s),s.length>s.l?s.slice(0,s.l):s}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,s){s||(s=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var a=rev_XLSBFillPTNames[e.patternType];a==null&&(a=40),s.write_shift(4,a);var i=0;if(a!=40)for(write_BrtColor({auto:1},s),write_BrtColor({auto:1},s);i<12;++i)s.write_shift(4,0);else{for(;i<4;++i)s.write_shift(4,0);for(;i<12;++i)s.write_shift(4,0)}return s.length>s.l?s.slice(0,s.l):s}function parse_BrtXF(e,s){var a=e.l+s,i=e.read_shift(2),o=e.read_shift(2);return e.l=a,{ixfe:i,numFmtId:o}}function write_BrtXF(e,s,a){a||(a=new_buf(16)),a.write_shift(2,s||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var i=0;return a.write_shift(1,i),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function write_Blxf(e,s){return s||(s=new_buf(10)),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(4,0),s}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,s){return s||(s=new_buf(51)),s.write_shift(1,0),write_Blxf(null,s),write_Blxf(null,s),write_Blxf(null,s),write_Blxf(null,s),write_Blxf(null,s),s.length>s.l?s.slice(0,s.l):s}function write_BrtStyle(e,s){return s||(s=new_buf(12+4*10)),s.write_shift(4,e.xfId),s.write_shift(2,1),s.write_shift(1,+e.builtinId),s.write_shift(1,0),write_XLNullableWideString(e.name||"",s),s.length>s.l?s.slice(0,s.l):s}function write_BrtBeginTableStyles(e,s,a){var i=new_buf(2052);return i.write_shift(4,e),write_XLNullableWideString(s,i),write_XLNullableWideString(a,i),i.length>i.l?i.slice(0,i.l):i}function parse_sty_bin(e,s,a){var i={};i.NumberFmt=[];for(var o in table_fmt)i.NumberFmt[o]=table_fmt[o];i.CellXf=[],i.Fonts=[];var c=[],d=!1;return recordhopper(e,function(g,_,b){switch(b){case 44:i.NumberFmt[g[0]]=g[1],SSF_load(g[1],g[0]);break;case 43:i.Fonts.push(g),g.color.theme!=null&&s&&s.themeElements&&s.themeElements.clrScheme&&(g.color.rgb=rgb_tint(s.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&i.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:c.push(b),d=!0;break;case 38:c.pop(),d=!1;break;default:if(_.T>0)c.push(b);else if(_.T<0)c.pop();else if(!d||a.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+b.toString(16))}}),i}function write_FMTS_bin(e,s){if(s){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var o=i[0];o<=i[1];++o)s[o]!=null&&++a}),a!=0&&(write_record(e,615,write_UInt32LE(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var o=i[0];o<=i[1];++o)s[o]!=null&&write_record(e,44,write_BrtFmt(o,s[o]))}),write_record(e,616))}}function write_FONTS_bin(e){var s=1;write_record(e,611,write_UInt32LE(s)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),write_record(e,612)}function write_FILLS_bin(e){var s=2;write_record(e,603,write_UInt32LE(s)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var s=1;write_record(e,613,write_UInt32LE(s)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var s=1;write_record(e,626,write_UInt32LE(s)),write_record(e,47,write_BrtXF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,s){write_record(e,617,write_UInt32LE(s.length)),s.forEach(function(a){write_record(e,47,write_BrtXF(a,0))}),write_record(e,618)}function write_STYLES_bin(e){var s=1;write_record(e,619,write_UInt32LE(s)),write_record(e,48,write_BrtStyle({xfId:0,builtinId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var s=0;write_record(e,505,write_UInt32LE(s)),write_record(e,506)}function write_TABLESTYLES_bin(e){var s=0;write_record(e,508,write_BrtBeginTableStyles(s,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,s){var a=buf_array();return write_record(a,278),write_FMTS_bin(a,e.SSF),write_FONTS_bin(a),write_FILLS_bin(a),write_BORDERS_bin(a),write_CELLSTYLEXFS_bin(a),write_CELLXFS_bin(a,s.cellXfs),write_STYLES_bin(a),write_DXFS_bin(a),write_TABLESTYLES_bin(a),write_record(a,279),a.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,s,a){s.themeElements.clrScheme=[];var i={};(e[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=c.val;break;case"<a:sysClr":i.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(s.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(c[0])]=i,i={}):i.name=c[0].slice(3,c[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,s,a){s.themeElements={};var i;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(o){if(!(i=e.match(o[1])))throw new Error(o[0]+" not found in themeElements");o[2](i,s,a)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,s){(!e||e.length===0)&&(e=write_theme());var a,i={};if(!(a=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(a[0],i,s),i.raw=e,i}function write_theme(e,s){if(s&&s.themeXLSX)return s.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[XML_HEADER];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function parse_Theme(e,s,a){var i=e.l+s,o=e.read_shift(4);if(o!==124226){if(!a.cellStyles){e.l=i;return}var c=e.slice(e.l);e.l=i;var d;try{d=zip_read(c,{type:"array"})}catch{return}var h=getzipstr(d,"theme/theme/theme1.xml",!0);if(h)return parse_theme_xml(h,a)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var s={};switch(s.xclrType=e.read_shift(2),s.nTintShade=e.read_shift(2),s.xclrType){case 0:e.l+=4;break;case 1:s.xclrValue=parse_IcvXF(e,4);break;case 2:s.xclrValue=parse_LongRGBA(e);break;case 3:s.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,s}function parse_IcvXF(e,s){return parsenoop(e,s)}function parse_XFExtGradient(e,s){return parsenoop(e,s)}function parse_ExtProp(e){var s=e.read_shift(2),a=e.read_shift(2)-4,i=[s];switch(s){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=parse_FullColorExt(e);break;case 6:i[1]=parse_XFExtGradient(e,a);break;case 14:case 15:i[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+s+" "+a)}return i}function parse_XFExt(e,s){var a=e.l+s;e.l+=2;var i=e.read_shift(2);e.l+=2;for(var o=e.read_shift(2),c=[];o-- >0;)c.push(parse_ExtProp(e,a-e.l));return{ixfe:i,ext:c}}function update_xfext(e,s){s.forEach(function(a){switch(a[0]){}})}function parse_BrtMdtinfo(e,s){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var s=new_buf(12+2*e.name.length);return s.write_shift(4,e.flags),s.write_shift(4,e.version),write_XLWideString(e.name,s),s.slice(0,s.l)}function parse_BrtMdb(e){for(var s=[],a=e.read_shift(4);a-- >0;)s.push([e.read_shift(4),e.read_shift(4)]);return s}function write_BrtMdb(e){var s=new_buf(4+8*e.length);s.write_shift(4,e.length);for(var a=0;a<e.length;++a)s.write_shift(4,e[a][0]),s.write_shift(4,e[a][1]);return s}function write_BrtBeginEsfmd(e,s){var a=new_buf(8+2*s.length);return a.write_shift(4,e),write_XLWideString(s,a),a.slice(0,a.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,s){var a=new_buf(8);return a.write_shift(4,e),a.write_shift(4,1),a}function parse_xlmeta_bin(e,s,a){var i={Types:[],Cell:[],Value:[]},o=a||{},c=[],d=!1,h=2;return recordhopper(e,function(g,_,b){switch(b){case 335:i.Types.push({name:g.name});break;case 51:g.forEach(function(j){h==1?i.Cell.push({type:i.Types[j[0]-1].name,index:j[1]}):h==0&&i.Value.push({type:i.Types[j[0]-1].name,index:j[1]})});break;case 337:h=g?1:0;break;case 338:h=2;break;case 35:c.push(b),d=!0;break;case 36:c.pop(),d=!1;break;default:if(!_.T){if(!d||o.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+b.toString(16))}}}),i}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function parse_xlmeta_xml(e,s,a){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var o=!1,c=2,d;return e.replace(tagregex,function(h){var g=parsexmltag(h);switch(strip_ns(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var _=0;_<i.Types.length;++_)i.Types[_].name==g.name&&(d=i.Types[_]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?i.Cell.push({type:i.Types[g.t-1].name,index:+g.v}):c==0&&i.Value.push({type:i.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!d)break;d.offsets||(d.offsets=[]),d.offsets.push(+g.i);break;default:if(!o&&a.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return h}),i}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_cc_xml(e){var s=[];if(!e)return s;var a=1;return(e.match(tagregex)||[]).forEach(function(i){var o=parsexmltag(i);switch(o[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete o[0],o.i?a=o.i:o.i=a,s.push(o);break}}),s}function parse_BrtCalcChainItem$(e){var s={};s.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),s.r=encode_cell(a);var i=e.read_shift(1);return i&2&&(s.l="1"),i&8&&(s.a="1"),s}function parse_cc_bin(e,s,a){var i=[];return recordhopper(e,function(c,d,h){switch(h){case 63:i.push(c);break;default:if(!d.T)throw new Error("Unexpected record 0x"+h.toString(16))}}),i}function parse_xlink_xml(){}function parse_xlink_bin(e,s,a,i){if(!e)return e;var o=i||{},c=!1;recordhopper(e,function(h,g,_){switch(_){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!g.T){if(!c||o.WTF)throw new Error("Unexpected record 0x"+_.toString(16))}}},o)}function parse_drawing(e,s){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return s["!id"][a].Target}var _shapeid=1024;function write_comments_vml(e,s){for(var a=[21600,21600],i=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),o=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:i})];_shapeid<e*1e3;)_shapeid+=1e3;return s.forEach(function(c){var d=decode_cell(c[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var g=h.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,_=writextag("v:fill",g,h),b={on:"t",obscured:"t"};++_shapeid,o=o.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",_,writextag("v:shadow",null,b),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[d.c+1,0,d.r+1,0,d.c+3,20,d.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(d.r)),writetag("x:Column",String(d.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function sheet_insert_comments(e,s,a,i){var o=Array.isArray(e),c;s.forEach(function(d){var h=decode_cell(d.ref);if(o?(e[h.r]||(e[h.r]=[]),c=e[h.r][h.c]):c=e[d.ref],!c){c={t:"z"},o?e[h.r][h.c]=c:e[d.ref]=c;var g=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");g.s.r>h.r&&(g.s.r=h.r),g.e.r<h.r&&(g.e.r=h.r),g.s.c>h.c&&(g.s.c=h.c),g.e.c<h.c&&(g.e.c=h.c);var _=encode_range(g);_!==e["!ref"]&&(e["!ref"]=_)}c.c||(c.c=[]);var b={a:d.author,t:d.t,r:d.r,T:a};d.h&&(b.h=d.h);for(var j=c.c.length-1;j>=0;--j){if(!a&&c.c[j].T)return;a&&!c.c[j].T&&c.c.splice(j,1)}if(a&&i){for(j=0;j<i.length;++j)if(b.a==i[j].id){b.a=i[j].name||b.a;break}}c.c.push(b)})}function parse_comments_xml(e,s){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],i=[],o=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);o&&o[1]&&o[1].split(/<\/\w*:?author>/).forEach(function(d){if(!(d===""||d.trim()==="")){var h=d.match(/<(?:\w+:)?author[^>]*>(.*)/);h&&a.push(h[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(d){if(!(d===""||d.trim()==="")){var h=d.match(/<(?:\w+:)?comment[^>]*>/);if(h){var g=parsexmltag(h[0]),_={author:g.authorId&&a[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},b=decode_cell(g.ref);if(!(s.sheetRows&&s.sheetRows<=b.r)){var j=d.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_e=!!j&&!!j[1]&&parse_si(j[1])||{r:"",t:"",h:""};_.r=_e.r,_e.r=="<t></t>"&&(_e.t=_e.h=""),_.t=(_e.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),s.cellHTML&&(_.h=_e.h),i.push(_)}}}}),i}function write_comments_xml(e){var s=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],a=[];return s.push("<authors>"),e.forEach(function(i){i[1].forEach(function(o){var c=escapexml(o.a);a.indexOf(c)==-1&&(a.push(c),s.push("<author>"+c+"</author>")),o.T&&o.ID&&a.indexOf("tc="+o.ID)==-1&&(a.push("tc="+o.ID),s.push("<author>tc="+o.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),s.push("<author>SheetJ5</author>")),s.push("</authors>"),s.push("<commentList>"),e.forEach(function(i){var o=0,c=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?o=a.indexOf("tc="+i[1][0].ID):i[1].forEach(function(g){g.a&&(o=a.indexOf(escapexml(g.a))),c.push(g.t||"")}),s.push('<comment ref="'+i[0]+'" authorId="'+o+'"><text>'),c.length<=1)s.push(writetag("t",escapexml(c[0]||"")));else{for(var d=`Comment:
    `+c[0]+`
`,h=1;h<c.length;++h)d+=`Reply:
    `+c[h]+`
`;s.push(writetag("t",escapexml(d)))}s.push("</text></comment>")}),s.push("</commentList>"),s.length>2&&(s[s.length]="</comments>",s[1]=s[1].replace("/>",">")),s.join("")}function parse_tcmnt_xml(e,s){var a=[],i=!1,o={},c=0;return e.replace(tagregex,function(h,g){var _=parsexmltag(h);switch(strip_ns(_[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":o={author:_.personId,guid:_.id,ref:_.ref,T:1};break;case"</threadedComment>":o.t!=null&&a.push(o);break;case"<text>":case"<text":c=g+h.length;break;case"</text>":o.t=e.slice(c,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&s.WTF)throw new Error("unrecognized "+_[0]+" in threaded comments")}return h}),a}function write_tcmnt_xml(e,s,a){var i=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var c="";(o[1]||[]).forEach(function(d,h){if(!d.T){delete d.ID;return}d.a&&s.indexOf(d.a)==-1&&s.push(d.a);var g={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};h==0?c=g.id:g.parentId=c,d.ID=g.id,d.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+s.indexOf(d.a)).slice(-12)+"}"),i.push(writextag("threadedComment",writetag("text",d.t||""),g))})}),i.push("</ThreadedComments>"),i.join("")}function parse_people_xml(e,s){var a=[],i=!1;return e.replace(tagregex,function(c){var d=parsexmltag(c);switch(strip_ns(d[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:d.displayname,id:d.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&s.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),a}function write_people_xml(e){var s=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(a,i){s.push(writextag("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:a,providerId:"None"}))}),s.push("</personList>"),s.join("")}function parse_BrtBeginComment(e){var s={};s.iauthor=e.read_shift(4);var a=parse_UncheckedRfX(e);return s.rfx=a.s,s.ref=encode_cell(a.s),e.l+=16,s}function write_BrtBeginComment(e,s){return s==null&&(s=new_buf(36)),s.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],s),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function parse_comments_bin(e,s){var a=[],i=[],o={},c=!1;return recordhopper(e,function(h,g,_){switch(_){case 632:i.push(h);break;case 635:o=h;break;case 637:o.t=h.t,o.h=h.h,o.r=h.r;break;case 636:if(o.author=i[o.iauthor],delete o.iauthor,s.sheetRows&&o.rfx&&s.sheetRows<=o.rfx.r)break;o.t||(o.t=""),delete o.rfx,a.push(o);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+_.toString(16))}}}),a}function write_comments_bin(e){var s=buf_array(),a=[];return write_record(s,628),write_record(s,630),e.forEach(function(i){i[1].forEach(function(o){a.indexOf(o.a)>-1||(a.push(o.a.slice(0,54)),write_record(s,632,write_BrtCommentAuthor(o.a)))})}),write_record(s,631),write_record(s,633),e.forEach(function(i){i[1].forEach(function(o){o.iauthor=a.indexOf(o.a);var c={s:decode_cell(i[0]),e:decode_cell(i[0])};write_record(s,635,write_BrtBeginComment([c,o])),o.t&&o.t.length>0&&write_record(s,637,write_BrtCommentText(o)),write_record(s,636),delete o.iauthor})}),write_record(s,634),write_record(s,629),s.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var s=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,i){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var o=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(s,o,e.FileIndex[i].content)}}),CFB.write(s)}function fill_vba_xls(e,s){s.FullPaths.forEach(function(a,i){if(i!=0){var o=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&CFB.utils.cfb_add(e,o,s.FileIndex[i].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,s={r:0,c:0};function a(i,o,c,d){var h=!1,g=!1;c.length==0?g=!0:c.charAt(0)=="["&&(g=!0,c=c.slice(1,-1)),d.length==0?h=!0:d.charAt(0)=="["&&(h=!0,d=d.slice(1,-1));var _=c.length>0?parseInt(c,10)|0:0,b=d.length>0?parseInt(d,10)|0:0;return h?b+=s.c:--b,g?_+=s.r:--_,o+(h?"":"$")+encode_col(b)+(g?"":"$")+encode_row(_)}return function(o,c){return s=c,o.replace(e,a)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(s,a){return s.replace(crefregex,function(i,o,c,d,h,g){var _=decode_col(d)-(c?0:a.c),b=decode_row(g)-(h?0:a.r),j=b==0?"":h?b+1:"["+b+"]",_e=_==0?"":c?_+1:"["+_+"]";return o+"R"+j+"C"+_e})}}();function shift_formula_str(e,s){return e.replace(crefregex,function(a,i,o,c,d,h){return i+(o=="$"?o+c:encode_col(decode_col(c)+s.c))+(d=="$"?d+h:encode_row(decode_row(h)+s.r))})}function shift_formula_xlsx(e,s,a){var i=decode_range(s),o=i.s,c=decode_cell(a),d={r:c.r-o.r,c:c.c-o.c};return shift_formula_str(e,d)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,s){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function parse_RgceArea(e,s,a){var i=2;if(a){if(a.biff>=2&&a.biff<=5)return parse_RgceArea_BIFF2(e);a.biff==12&&(i=4)}var o=e.read_shift(i),c=e.read_shift(i),d=parse_ColRelU(e),h=parse_ColRelU(e);return{s:{r:o,c:d[0],cRel:d[1],rRel:d[2]},e:{r:c,c:h[0],cRel:h[1],rRel:h[2]}}}function parse_RgceArea_BIFF2(e){var s=parse_ColRelU(e),a=parse_ColRelU(e),i=e.read_shift(1),o=e.read_shift(1);return{s:{r:s[0],c:i,cRel:s[1],rRel:s[2]},e:{r:a[0],c:o,cRel:a[1],rRel:a[2]}}}function parse_RgceAreaRel(e,s,a){if(a.biff<8)return parse_RgceArea_BIFF2(e);var i=e.read_shift(a.biff==12?4:2),o=e.read_shift(a.biff==12?4:2),c=parse_ColRelU(e),d=parse_ColRelU(e);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function parse_RgceLoc(e,s,a){if(a&&a.biff>=2&&a.biff<=5)return parse_RgceLoc_BIFF2(e);var i=e.read_shift(a&&a.biff==12?4:2),o=parse_ColRelU(e);return{r:i,c:o[0],cRel:o[1],rRel:o[2]}}function parse_RgceLoc_BIFF2(e){var s=parse_ColRelU(e),a=e.read_shift(1);return{r:s[0],c:a,cRel:s[1],rRel:s[2]}}function parse_RgceElfLoc(e){var s=e.read_shift(2),a=e.read_shift(2);return{r:s,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function parse_RgceLocRel(e,s,a){var i=a&&a.biff?a.biff:8;if(i>=2&&i<=5)return parse_RgceLocRel_BIFF2(e);var o=e.read_shift(i>=12?4:2),c=e.read_shift(2),d=(c&16384)>>14,h=(c&32768)>>15;if(c&=16383,h==1)for(;o>524287;)o-=1048576;if(d==1)for(;c>8191;)c=c-16384;return{r:o,c,cRel:d,rRel:h}}function parse_RgceLocRel_BIFF2(e){var s=e.read_shift(2),a=e.read_shift(1),i=(s&32768)>>15,o=(s&16384)>>14;return s&=16383,i==1&&s>=8192&&(s=s-16384),o==1&&a>=128&&(a=a-256),{r:s,c:a,cRel:o,rRel:i}}function parse_PtgArea(e,s,a){var i=(e[e.l++]&96)>>5,o=parse_RgceArea(e,a.biff>=2&&a.biff<=5?6:8,a);return[i,o]}function parse_PtgArea3d(e,s,a){var i=(e[e.l++]&96)>>5,o=e.read_shift(2,"i"),c=8;if(a)switch(a.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var d=parse_RgceArea(e,c,a);return[i,o,d]}function parse_PtgAreaErr(e,s,a){var i=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[i]}function parse_PtgAreaErr3d(e,s,a){var i=(e[e.l++]&96)>>5,o=e.read_shift(2),c=8;if(a)switch(a.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[i,o]}function parse_PtgAreaN(e,s,a){var i=(e[e.l++]&96)>>5,o=parse_RgceAreaRel(e,s-1,a);return[i,o]}function parse_PtgArray(e,s,a){var i=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[i]}function parse_PtgAttrBaxcel(e){var s=e[e.l+1]&1,a=1;return e.l+=4,[s,a]}function parse_PtgAttrChoose(e,s,a){e.l+=2;for(var i=e.read_shift(a&&a.biff==2?1:2),o=[],c=0;c<=i;++c)o.push(e.read_shift(a&&a.biff==2?1:2));return o}function parse_PtgAttrGoto(e,s,a){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(a&&a.biff==2?1:2)]}function parse_PtgAttrIf(e,s,a){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(a&&a.biff==2?1:2)]}function parse_PtgAttrIfError(e){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(2)]}function parse_PtgAttrSemi(e,s,a){var i=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[i]}function parse_PtgAttrSpaceType(e){var s=e.read_shift(1),a=e.read_shift(1);return[s,a]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,s,a){var i=(e[e.l]&96)>>5;e.l+=1;var o=parse_RgceLoc(e,0,a);return[i,o]}function parse_PtgRefN(e,s,a){var i=(e[e.l]&96)>>5;e.l+=1;var o=parse_RgceLocRel(e,0,a);return[i,o]}function parse_PtgRef3d(e,s,a){var i=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var c=parse_RgceLoc(e,0,a);return[i,o,c]}function parse_PtgFunc(e,s,a){var i=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(a&&a.biff<=3?1:2);return[FtabArgc[o],Ftab[o],i]}function parse_PtgFuncVar(e,s,a){var i=e[e.l++],o=e.read_shift(1),c=a&&a.biff<=3?[i==88?-1:0,e.read_shift(1)]:parsetab(e);return[o,(c[0]===0?Ftab:Cetab)[c[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,s,a){e.l+=a&&a.biff==2?3:4}function parse_PtgExp(e,s,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),o=e.read_shift(a&&a.biff==2?1:2);return[i,o]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,s,a){return e.l++,parse_ShortXLUnicodeString(e,s-1,a)}function parse_SerAr(e,s){var a=[e.read_shift(1)];if(s==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=parsebool(e,1)?"TRUE":"FALSE",s!=12&&(e.l+=7);break;case 37:case 16:a[1]=BErr[e[e.l]],e.l+=s==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=parse_Xnum(e);break;case 2:a[1]=parse_XLUnicodeString2(e,0,{biff:s>0&&s<8?2:s});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function parse_PtgExtraMem(e,s,a){for(var i=e.read_shift(a.biff==12?4:2),o=[],c=0;c!=i;++c)o.push((a.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return o}function parse_PtgExtraArray(e,s,a){var i=0,o=0;a.biff==12?(i=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),i=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--i,--o==0&&(o=256));for(var c=0,d=[];c!=i&&(d[c]=[]);++c)for(var h=0;h!=o;++h)d[c][h]=parse_SerAr(e,a.biff);return d}function parse_PtgName(e,s,a){var i=e.read_shift(1)>>>5&3,o=!a||a.biff>=8?4:2,c=e.read_shift(o);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,c]}function parse_PtgNameX(e,s,a){if(a.biff==5)return parse_PtgNameX_BIFF5(e);var i=e.read_shift(1)>>>5&3,o=e.read_shift(2),c=e.read_shift(4);return[i,o,c]}function parse_PtgNameX_BIFF5(e){var s=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[s,a,i]}function parse_PtgMemArea(e,s,a){var i=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var o=e.read_shift(a&&a.biff==2?1:2);return[i,o]}function parse_PtgMemFunc(e,s,a){var i=e.read_shift(1)>>>5&3,o=e.read_shift(a&&a.biff==2?1:2);return[i,o]}function parse_PtgRefErr(e,s,a){var i=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[i]}function parse_PtgRefErr3d(e,s,a){var i=(e[e.l++]&96)>>5,o=e.read_shift(2),c=4;if(a)switch(a.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[i,o]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,s,a){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(4),o=e.read_shift(2),c=e.read_shift(2),d=PtgListRT[a>>2&31];return{ixti:s,coltype:a&3,rt:d,idx:i,c:o,C:c}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,s,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,s,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var s=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[s,a]}function parse_PtgMemNoMemN(e){var s=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[s,a]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,s,a,i){if(i.biff<8)return parsenoop(e,s);for(var o=e.l+s,c=[],d=0;d!==a.length;++d)switch(a[d][0]){case"PtgArray":a[d][1]=parse_PtgExtraArray(e,0,i),c.push(a[d][1]);break;case"PtgMemArea":a[d][2]=parse_PtgExtraMem(e,a[d][1],i),c.push(a[d][2]);break;case"PtgExp":i&&i.biff==12&&(a[d][1][1]=e.read_shift(4),c.push(a[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[d][0]}return s=o-e.l,s!==0&&c.push(parsenoop(e,s)),c}function parse_Rgce(e,s,a){for(var i=e.l+s,o,c,d=[];i!=e.l;)s=i-e.l,c=e[e.l],o=PtgTypes[c]||PtgTypes[PtgDupes[c]],(c===24||c===25)&&(o=(c===24?Ptg18:Ptg19)[e[e.l+1]]),!o||!o.f?parsenoop(e,s):d.push([o.n,o.f(e,s,a)]);return d}function stringify_array(e){for(var s=[],a=0;a<e.length;++a){for(var i=e[a],o=[],c=0;c<i.length;++c){var d=i[c];if(d)switch(d[0]){case 2:o.push('"'+d[1].replace(/"/g,'""')+'"');break;default:o.push(d[1])}else o.push("")}s.push(o.join(","))}return s.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,s){if(!e&&!(s&&s.biff<=5&&s.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,s,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[s]))return e.SheetNames[s];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[s];if(a.biff<8)return s>1e4&&(s-=65536),s<0&&(s=-s),s==0?"":e.XTI[s-1];if(!i)return"SH33TJSERR1";var o="";if(a.biff>8)switch(e[i[0]][0]){case 357:return o=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?o:o+":"+e.SheetNames[i[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[i[0]][0];case 355:default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return o=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?o:o+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[i[0]][0][3]?(o=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?o:o+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function get_ixti(e,s,a){var i=get_ixti_raw(e,s,a);return i=="#REF"?i:formula_quote_sheet_name(i,a)}function stringify_formula(e,s,a,i,o){var c=o&&o.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},h=[],g,_,b,j=0,_e=0,tt,rt="";if(!e[0]||!e[0][0])return"";for(var et=-1,st="",at=0,it=e[0].length;at<it;++at){var nt=e[0][at];switch(nt[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=h.pop(),_=h.pop(),et>=0){switch(e[0][et][1][0]){case 0:st=fill(" ",e[0][et][1][1]);break;case 1:st=fill("\r",e[0][et][1][1]);break;default:if(st="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][et][1][0])}_=_+st,et=-1}h.push(_+PtgBinOp[nt[0]]+g);break;case"PtgIsect":g=h.pop(),_=h.pop(),h.push(_+" "+g);break;case"PtgUnion":g=h.pop(),_=h.pop(),h.push(_+","+g);break;case"PtgRange":g=h.pop(),_=h.pop(),h.push(_+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":b=shift_cell_xls(nt[1][1],d,o),h.push(encode_cell_xls(b,c));break;case"PtgRefN":b=a?shift_cell_xls(nt[1][1],a,o):nt[1][1],h.push(encode_cell_xls(b,c));break;case"PtgRef3d":j=nt[1][1],b=shift_cell_xls(nt[1][2],d,o),rt=get_ixti(i,j,o),h.push(rt+"!"+encode_cell_xls(b,c));break;case"PtgFunc":case"PtgFuncVar":var ot=nt[1][0],dt=nt[1][1];ot||(ot=0),ot&=127;var ht=ot==0?[]:h.slice(-ot);h.length-=ot,dt==="User"&&(dt=ht.shift()),h.push(dt+"("+ht.join(",")+")");break;case"PtgBool":h.push(nt[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(nt[1]);break;case"PtgNum":h.push(String(nt[1]));break;case"PtgStr":h.push('"'+nt[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(nt[1]);break;case"PtgAreaN":tt=shift_range_xls(nt[1][1],a?{s:a}:d,o),h.push(encode_range_xls(tt,o));break;case"PtgArea":tt=shift_range_xls(nt[1][1],d,o),h.push(encode_range_xls(tt,o));break;case"PtgArea3d":j=nt[1][1],tt=nt[1][2],rt=get_ixti(i,j,o),h.push(rt+"!"+encode_range_xls(tt,o));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_e=nt[1][2];var lt=(i.names||[])[_e-1]||(i[0]||[])[_e],gt=lt?lt.Name:"SH33TJSNAME"+String(_e);gt&&gt.slice(0,6)=="_xlfn."&&!o.xlfn&&(gt=gt.slice(6)),h.push(gt);break;case"PtgNameX":var yt=nt[1][1];_e=nt[1][2];var Tt;if(o.biff<=5)yt<0&&(yt=-yt),i[yt]&&(Tt=i[yt][_e]);else{var mt="";if(((i[yt]||[])[0]||[])[0]==14849||(((i[yt]||[])[0]||[])[0]==1025?i[yt][_e]&&i[yt][_e].itab>0&&(mt=i.SheetNames[i[yt][_e].itab-1]+"!"):mt=i.SheetNames[_e-1]+"!"),i[yt]&&i[yt][_e])mt+=i[yt][_e].Name;else if(i[0]&&i[0][_e])mt+=i[0][_e].Name;else{var Et=(get_ixti_raw(i,yt,o)||"").split(";;");Et[_e-1]?mt=Et[_e-1]:mt+="SH33TJSERRX"}h.push(mt);break}Tt||(Tt={Name:"SH33TJSERRY"}),h.push(Tt.Name);break;case"PtgParen":var Ft="(",Vt=")";if(et>=0){switch(st="",e[0][et][1][0]){case 2:Ft=fill(" ",e[0][et][1][1])+Ft;break;case 3:Ft=fill("\r",e[0][et][1][1])+Ft;break;case 4:Vt=fill(" ",e[0][et][1][1])+Vt;break;case 5:Vt=fill("\r",e[0][et][1][1])+Vt;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][et][1][0])}et=-1}h.push(Ft+h.pop()+Vt);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":b={c:nt[1][1],r:nt[1][0]};var Mt={c:a.c,r:a.r};if(i.sharedf[encode_cell(b)]){var Ct=i.sharedf[encode_cell(b)];h.push(stringify_formula(Ct,d,Mt,i,o))}else{var kt=!1;for(g=0;g!=i.arrayf.length;++g)if(_=i.arrayf[g],!(b.c<_[0].s.c||b.c>_[0].e.c)&&!(b.r<_[0].s.r||b.r>_[0].e.r)){h.push(stringify_formula(_[1],d,Mt,i,o)),kt=!0;break}kt||h.push(nt[1])}break;case"PtgArray":h.push("{"+stringify_array(nt[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":et=at;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+nt[1].idx+"[#"+nt[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(nt));default:throw new Error("Unrecognized Formula Token: "+String(nt))}var jt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&et>=0&&jt.indexOf(e[0][at][0])==-1){nt=e[0][et];var ut=!0;switch(nt[1][0]){case 4:ut=!1;case 0:st=fill(" ",nt[1][1]);break;case 5:ut=!1;case 1:st=fill("\r",nt[1][1]);break;default:if(st="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+nt[1][0])}h.push((ut?st:"")+h.pop()+(ut?"":st)),et=-1}}if(h.length>1&&o.WTF)throw new Error("bad formula stack");return h[0]}function parse_ArrayParsedFormula(e,s,a){var i=e.l+s,o=a.biff==2?1:2,c,d=e.read_shift(o);if(d==65535)return[[],parsenoop(e,s-2)];var h=parse_Rgce(e,d,a);return s!==d+o&&(c=parse_RgbExtra(e,s-d-o,h,a)),e.l=i,[h,c]}function parse_XLSCellParsedFormula(e,s,a){var i=e.l+s,o=a.biff==2?1:2,c,d=e.read_shift(o);if(d==65535)return[[],parsenoop(e,s-2)];var h=parse_Rgce(e,d,a);return s!==d+o&&(c=parse_RgbExtra(e,s-d-o,h,a)),e.l=i,[h,c]}function parse_NameParsedFormula(e,s,a,i){var o=e.l+s,c=parse_Rgce(e,i,a),d;return o!==e.l&&(d=parse_RgbExtra(e,o-e.l,c,a)),[c,d]}function parse_SharedParsedFormula(e,s,a){var i=e.l+s,o,c=e.read_shift(2),d=parse_Rgce(e,c,a);return c==65535?[[],parsenoop(e,s-2)]:(s!==c+2&&(o=parse_RgbExtra(e,i-c-2,d,a)),[d,o])}function parse_FormulaValue(e){var s;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return s=e[e.l+2]===1,e.l+=8,[s,"b"];case 2:return s=e[e.l+2],e.l+=8,[s,"e"];case 3:return e.l+=8,["","s"]}return[]}function write_FormulaValue(e){if(e==null){var s=new_buf(8);return s.write_shift(1,3),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,65535),s}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function parse_Formula(e,s,a){var i=e.l+s,o=parse_XLSCell(e);a.biff==2&&++e.l;var c=parse_FormulaValue(e),d=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var h=parse_XLSCellParsedFormula(e,i-e.l,a);return{cell:o,val:c[0],formula:h,shared:d>>3&1,tt:c[1]}}function write_Formula(e,s,a,i,o){var c=write_XLSCell(s,a,o),d=write_FormulaValue(e.v),h=new_buf(6),g=33;h.write_shift(2,g),h.write_shift(4,0);for(var _=new_buf(e.bf.length),b=0;b<e.bf.length;++b)_[b]=e.bf[b];var j=bconcat([c,d,h,_]);return j}function parse_XLSBParsedFormula(e,s,a){var i=e.read_shift(4),o=parse_Rgce(e,i,a),c=e.read_shift(4),d=c>0?parse_RgbExtra(e,c,o,a):null;return[o,d]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(s,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(e){var s="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return s.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(e){var s=e.split(":"),a=s[0].split(".")[0];return[a,s[0].split(".")[1]+(s.length>1?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(e,s,a){var i=0,o=e.length;if(a){if(browser_has_Map?a.has(s):Object.prototype.hasOwnProperty.call(a,s)){for(var c=browser_has_Map?a.get(s):a[s];i<c.length;++i)if(e[c[i]].t===s)return e.Count++,c[i]}}else for(;i<o;++i)if(e[i].t===s)return e.Count++,i;return e[o]={t:s},e.Count++,e.Unique++,a&&(browser_has_Map?(a.has(s)||a.set(s,[]),a.get(s).push(o)):(Object.prototype.hasOwnProperty.call(a,s)||(a[s]=[]),a[s].push(o))),o}function col_obj_w(e,s){var a={min:e+1,max:e+1},i=-1;return s.MDW&&(MDW=s.MDW),s.width!=null?a.customWidth=1:s.wpx!=null?i=px2char(s.wpx):s.wch!=null&&(i=s.wch),i>-1?(a.width=char2width(i),a.customWidth=1):s.width!=null&&(a.width=s.width),s.hidden&&(a.hidden=!0),s.level!=null&&(a.outlineLevel=a.level=s.level),a}function default_margins(e,s){if(e){var a=[.7,.7,.75,.75,.3,.3];s=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function get_cell_style(e,s,a){var i=a.revssf[s.z!=null?s.z:"General"],o=60,c=e.length;if(i==null&&a.ssf){for(;o<392;++o)if(a.ssf[o]==null){SSF_load(s.z,o),a.ssf[o]=s.z,a.revssf[s.z]=i=o;break}}for(o=0;o!=c;++o)if(e[o].numFmtId===i)return o;return e[c]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function safe_format(e,s,a,i,o,c){try{i.cellNF&&(e.z=table_fmt[s])}catch(h){if(i.WTF)throw h}if(!(e.t==="z"&&!i.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!i||i.cellText!==!1)&&e.t!=="z")try{if(table_fmt[s]==null&&SSF_load(SSFImplicit[s]||"General",s),e.t==="e")e.w=e.w||BErr[e.v];else if(s===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var d=datenum(e.v);(d|0)===d?e.w=d.toString(10):e.w=SSF_general_num(d)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(s,datenum(e.v),_ssfopts):e.w=SSF_format(s,e.v,_ssfopts)}catch(h){if(i.WTF)throw h}if(i.cellStyles&&a!=null)try{e.s=c.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(o.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=o.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(o.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=o.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(h){if(i.WTF&&c.Fills)throw h}}}function check_ws(e,s,a){if(e&&e["!ref"]){var i=safe_decode_range(e["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}function parse_ws_xml_dim(e,s){var a=safe_decode_range(s);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=encode_range(a))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,s,a,i,o,c,d){if(!e)return e;i||(i={"!id":{}});var h=s.dense?[]:{},g={s:{r:2e6,c:2e6},e:{r:0,c:0}},_="",b="",j=e.match(sheetdataregex);j?(_=e.slice(0,j.index),b=e.slice(j.index+j[0].length)):_=b=e;var _e=_.match(sheetprregex);_e?parse_ws_xml_sheetpr(_e[0],h,o,a):(_e=_.match(sheetprregex2))&&parse_ws_xml_sheetpr2(_e[0],_e[1]||"",h,o,a);var tt=(_.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(tt>0){var rt=_.slice(tt,tt+50).match(dimregex);rt&&parse_ws_xml_dim(h,rt[1])}var et=_.match(svsregex);et&&et[1]&&parse_ws_xml_sheetviews(et[1],o);var st=[];if(s.cellStyles){var at=_.match(colregex);at&&parse_ws_xml_cols(st,at)}j&&parse_ws_xml_data(j[1],h,s,g,c,d);var it=b.match(afregex);it&&(h["!autofilter"]=parse_ws_xml_autofilter(it[0]));var nt=[],ot=b.match(mergecregex);if(ot)for(tt=0;tt!=ot.length;++tt)nt[tt]=safe_decode_range(ot[tt].slice(ot[tt].indexOf('"')+1));var dt=b.match(hlinkregex);dt&&parse_ws_xml_hlinks(h,dt,i);var ht=b.match(marginregex);if(ht&&(h["!margins"]=parse_ws_xml_margins(parsexmltag(ht[0]))),!h["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(h["!ref"]=encode_range(g)),s.sheetRows>0&&h["!ref"]){var lt=safe_decode_range(h["!ref"]);s.sheetRows<=+lt.e.r&&(lt.e.r=s.sheetRows-1,lt.e.r>g.e.r&&(lt.e.r=g.e.r),lt.e.r<lt.s.r&&(lt.s.r=lt.e.r),lt.e.c>g.e.c&&(lt.e.c=g.e.c),lt.e.c<lt.s.c&&(lt.s.c=lt.e.c),h["!fullref"]=h["!ref"],h["!ref"]=encode_range(lt))}return st.length>0&&(h["!cols"]=st),nt.length>0&&(h["!merges"]=nt),h}function write_ws_xml_merges(e){if(e.length===0)return"";for(var s='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)s+='<mergeCell ref="'+encode_range(e[a])+'"/>';return s+"</mergeCells>"}function parse_ws_xml_sheetpr(e,s,a,i){var o=parsexmltag(e);a.Sheets[i]||(a.Sheets[i]={}),o.codeName&&(a.Sheets[i].CodeName=unescapexml(utf8read(o.codeName)))}function parse_ws_xml_sheetpr2(e,s,a,i,o){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),a,i,o)}function write_ws_xml_sheetpr(e,s,a,i,o){var c=!1,d={},h=null;if(i.bookType!=="xlsx"&&s.vbaraw){var g=s.SheetNames[a];try{s.Workbook&&(g=s.Workbook.Sheets[a].CodeName||g)}catch{}c=!0,d.codeName=utf8write(escapexml(g))}if(e&&e["!outline"]){var _={summaryBelow:1,summaryRight:1};e["!outline"].above&&(_.summaryBelow=0),e["!outline"].left&&(_.summaryRight=0),h=(h||"")+writextag("outlinePr",null,_)}!c&&!h||(o[o.length]=writextag("sheetPr",h,d))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var s={sheet:1};return sheetprot_deffalse.forEach(function(a){e[a]!=null&&e[a]&&(s[a]="1")}),sheetprot_deftrue.forEach(function(a){e[a]!=null&&!e[a]&&(s[a]="0")}),e.password&&(s.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,s)}function parse_ws_xml_hlinks(e,s,a){for(var i=Array.isArray(e),o=0;o!=s.length;++o){var c=parsexmltag(utf8read(s[o]),!0);if(!c.ref)return;var d=((a||{})["!id"]||[])[c.id];d?(c.Target=d.Target,c.location&&(c.Target+="#"+unescapexml(c.location))):(c.Target="#"+unescapexml(c.location),d={Target:c.Target,TargetMode:"Internal"}),c.Rel=d,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var h=safe_decode_range(c.ref),g=h.s.r;g<=h.e.r;++g)for(var _=h.s.c;_<=h.e.c;++_){var b=encode_cell({c:_,r:g});i?(e[g]||(e[g]=[]),e[g][_]||(e[g][_]={t:"z",v:void 0}),e[g][_].l=c):(e[b]||(e[b]={t:"z",v:void 0}),e[b].l=c)}}}function parse_ws_xml_margins(e){var s={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(s[a]=parseFloat(e[a]))}),s}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function parse_ws_xml_cols(e,s){for(var a=!1,i=0;i!=s.length;++i){var o=parsexmltag(s[i],!0);o.hidden&&(o.hidden=parsexmlbool(o.hidden));var c=parseInt(o.min,10)-1,d=parseInt(o.max,10)-1;for(o.outlineLevel&&(o.level=+o.outlineLevel||0),delete o.min,delete o.max,o.width=+o.width,!a&&o.width&&(a=!0,find_mdw_colw(o.width)),process_col(o);c<=d;)e[c++]=dup(o)}}function write_ws_xml_cols(e,s){for(var a=["<cols>"],i,o=0;o!=s.length;++o)(i=s[o])&&(a[a.length]=writextag("col",null,col_obj_w(o,i)));return a[a.length]="</cols>",a.join("")}function parse_ws_xml_autofilter(e){var s={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return s}function write_ws_xml_autofilter(e,s,a,i){var o=typeof e.ref=="string"?e.ref:encode_range(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var c=a.Workbook.Names,d=decode_range(o);d.s.r==d.e.r&&(d.e.r=decode_range(s["!ref"]).e.r,o=encode_range(d));for(var h=0;h<c.length;++h){var g=c[h];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==i){g.Ref="'"+a.SheetNames[i]+"'!"+o;break}}return h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+a.SheetNames[i]+"'!"+o}),writextag("autoFilter",null,{ref:o})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,s){s.Views||(s.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(a,i){var o=parsexmltag(a);s.Views[i]||(s.Views[i]={}),+o.zoomScale&&(s.Views[i].zoom=+o.zoomScale),parsexmlbool(o.rightToLeft)&&(s.Views[i].RTL=!0)})}function write_ws_xml_sheetviews(e,s,a,i){var o={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,o),{})}function write_ws_xml_cell(e,s,a,i){if(e.c&&a["!comments"].push([s,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var o="",c=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=BErr[e.v];break;case"d":i&&i.cellDates?o=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",o=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:o=e.v;break}var h=writetag("v",escapexml(o)),g={r:s},_=get_cell_style(i.cellXfs,e,i);switch(_!==0&&(g.s=_),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){h=writetag("v",""+get_sst_id(i.Strings,e.v,i.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=c&&(e.t=c,e.v=d),typeof e.f=="string"&&e.f){var b=e.F&&e.F.slice(0,s.length)==s?{t:"array",ref:e.F}:null;h=writextag("f",escapexml(e.f),b)+(e.v!=null?h:"")}return e.l&&a["!links"].push([s,e.l]),e.D&&(g.cm=1),writextag("c",h,g)}var parse_ws_xml_data=function(){var e=/<(?:\w+:)?c[ \/>]/,s=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,o=/ref=["']([^"']*)["']/,c=matchtag("v"),d=matchtag("f");return function(g,_,b,j,_e,tt){for(var rt=0,et="",st=[],at=[],it=0,nt=0,ot=0,dt="",ht,lt,gt=0,yt=0,Tt,mt,Et=0,Ft=0,Vt=Array.isArray(tt.CellXf),Mt,Ct=[],kt=[],jt=Array.isArray(_),ut=[],Lt={},Pt=!1,ft=!!b.sheetStubs,Rt=g.split(s),bt=0,At=Rt.length;bt!=At;++bt){et=Rt[bt].trim();var Ut=et.length;if(Ut!==0){var Xt=0;e:for(rt=0;rt<Ut;++rt)switch(et[rt]){case">":if(et[rt-1]!="/"){++rt;break e}if(b&&b.cellStyles){if(lt=parsexmltag(et.slice(Xt,rt),!0),gt=lt.r!=null?parseInt(lt.r,10):gt+1,yt=-1,b.sheetRows&&b.sheetRows<gt)continue;Lt={},Pt=!1,lt.ht&&(Pt=!0,Lt.hpt=parseFloat(lt.ht),Lt.hpx=pt2px(Lt.hpt)),lt.hidden=="1"&&(Pt=!0,Lt.hidden=!0),lt.outlineLevel!=null&&(Pt=!0,Lt.level=+lt.outlineLevel),Pt&&(ut[gt-1]=Lt)}break;case"<":Xt=rt;break}if(Xt>=rt)break;if(lt=parsexmltag(et.slice(Xt,rt),!0),gt=lt.r!=null?parseInt(lt.r,10):gt+1,yt=-1,!(b.sheetRows&&b.sheetRows<gt)){j.s.r>gt-1&&(j.s.r=gt-1),j.e.r<gt-1&&(j.e.r=gt-1),b&&b.cellStyles&&(Lt={},Pt=!1,lt.ht&&(Pt=!0,Lt.hpt=parseFloat(lt.ht),Lt.hpx=pt2px(Lt.hpt)),lt.hidden=="1"&&(Pt=!0,Lt.hidden=!0),lt.outlineLevel!=null&&(Pt=!0,Lt.level=+lt.outlineLevel),Pt&&(ut[gt-1]=Lt)),st=et.slice(rt).split(e);for(var Gt=0;Gt!=st.length&&st[Gt].trim().charAt(0)=="<";++Gt);for(st=st.slice(Gt),rt=0;rt!=st.length;++rt)if(et=st[rt].trim(),et.length!==0){if(at=et.match(a),it=rt,nt=0,ot=0,et="<c "+(et.slice(0,1)=="<"?">":"")+et,at!=null&&at.length===2){for(it=0,dt=at[1],nt=0;nt!=dt.length&&!((ot=dt.charCodeAt(nt)-64)<1||ot>26);++nt)it=26*it+ot;--it,yt=it}else++yt;for(nt=0;nt!=et.length&&et.charCodeAt(nt)!==62;++nt);if(++nt,lt=parsexmltag(et.slice(0,nt),!0),lt.r||(lt.r=encode_cell({r:gt-1,c:yt})),dt=et.slice(nt),ht={t:""},(at=dt.match(c))!=null&&at[1]!==""&&(ht.v=unescapexml(at[1])),b.cellFormula){if((at=dt.match(d))!=null&&at[1]!==""){if(ht.f=unescapexml(utf8read(at[1])).replace(/\r\n/g,`
`),b.xlfn||(ht.f=_xlfn(ht.f)),at[0].indexOf('t="array"')>-1)ht.F=(dt.match(o)||[])[1],ht.F.indexOf(":")>-1&&Ct.push([safe_decode_range(ht.F),ht.F]);else if(at[0].indexOf('t="shared"')>-1){mt=parsexmltag(at[0]);var zt=unescapexml(utf8read(at[1]));b.xlfn||(zt=_xlfn(zt)),kt[parseInt(mt.si,10)]=[mt,zt,lt.r]}}else(at=dt.match(/<f[^>]*\/>/))&&(mt=parsexmltag(at[0]),kt[mt.si]&&(ht.f=shift_formula_xlsx(kt[mt.si][1],kt[mt.si][2],lt.r)));var Wt=decode_cell(lt.r);for(nt=0;nt<Ct.length;++nt)Wt.r>=Ct[nt][0].s.r&&Wt.r<=Ct[nt][0].e.r&&Wt.c>=Ct[nt][0].s.c&&Wt.c<=Ct[nt][0].e.c&&(ht.F=Ct[nt][1])}if(lt.t==null&&ht.v===void 0)if(ht.f||ht.F)ht.v=0,ht.t="n";else if(ft)ht.t="z";else continue;else ht.t=lt.t||"n";switch(j.s.c>yt&&(j.s.c=yt),j.e.c<yt&&(j.e.c=yt),ht.t){case"n":if(ht.v==""||ht.v==null){if(!ft)continue;ht.t="z"}else ht.v=parseFloat(ht.v);break;case"s":if(typeof ht.v>"u"){if(!ft)continue;ht.t="z"}else Tt=strs[parseInt(ht.v,10)],ht.v=Tt.t,ht.r=Tt.r,b.cellHTML&&(ht.h=Tt.h);break;case"str":ht.t="s",ht.v=ht.v!=null?utf8read(ht.v):"",b.cellHTML&&(ht.h=escapehtml(ht.v));break;case"inlineStr":at=dt.match(i),ht.t="s",at!=null&&(Tt=parse_si(at[1]))?(ht.v=Tt.t,b.cellHTML&&(ht.h=Tt.h)):ht.v="";break;case"b":ht.v=parsexmlbool(ht.v);break;case"d":b.cellDates?ht.v=parseDate(ht.v,1):(ht.v=datenum(parseDate(ht.v,1)),ht.t="n");break;case"e":(!b||b.cellText!==!1)&&(ht.w=ht.v),ht.v=RBErr[ht.v];break}if(Et=Ft=0,Mt=null,Vt&&lt.s!==void 0&&(Mt=tt.CellXf[lt.s],Mt!=null&&(Mt.numFmtId!=null&&(Et=Mt.numFmtId),b.cellStyles&&Mt.fillId!=null&&(Ft=Mt.fillId))),safe_format(ht,Et,Ft,b,_e,tt),b.cellDates&&Vt&&ht.t=="n"&&fmt_is_date(table_fmt[Et])&&(ht.t="d",ht.v=numdate(ht.v)),lt.cm&&b.xlmeta){var er=(b.xlmeta.Cell||[])[+lt.cm-1];er&&er.type=="XLDAPR"&&(ht.D=!0)}if(jt){var St=decode_cell(lt.r);_[St.r]||(_[St.r]=[]),_[St.r][St.c]=ht}else _[lt.r]=ht}}}}ut.length>0&&(_["!rows"]=ut)}}();function write_ws_xml_data(e,s,a,i){var o=[],c=[],d=safe_decode_range(e["!ref"]),h="",g,_="",b=[],j=0,_e=0,tt=e["!rows"],rt=Array.isArray(e),et={r:_},st,at=-1;for(_e=d.s.c;_e<=d.e.c;++_e)b[_e]=encode_col(_e);for(j=d.s.r;j<=d.e.r;++j){for(c=[],_=encode_row(j),_e=d.s.c;_e<=d.e.c;++_e){g=b[_e]+_;var it=rt?(e[j]||[])[_e]:e[g];it!==void 0&&(h=write_ws_xml_cell(it,g,e,s))!=null&&c.push(h)}(c.length>0||tt&&tt[j])&&(et={r:_},tt&&tt[j]&&(st=tt[j],st.hidden&&(et.hidden=1),at=-1,st.hpx?at=px2pt(st.hpx):st.hpt&&(at=st.hpt),at>-1&&(et.ht=at,et.customHeight=1),st.level&&(et.outlineLevel=st.level)),o[o.length]=writextag("row",c.join(""),et))}if(tt)for(;j<tt.length;++j)tt&&tt[j]&&(et={r:j+1},st=tt[j],st.hidden&&(et.hidden=1),at=-1,st.hpx?at=px2pt(st.hpx):st.hpt&&(at=st.hpt),at>-1&&(et.ht=at,et.customHeight=1),st.level&&(et.outlineLevel=st.level),o[o.length]=writextag("row","",et));return o.join("")}function write_ws_xml(e,s,a,i){var o=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],c=a.SheetNames[e],d=0,h="",g=a.Sheets[c];g==null&&(g={});var _=g["!ref"]||"A1",b=safe_decode_range(_);if(b.e.c>16383||b.e.r>1048575){if(s.WTF)throw new Error("Range "+_+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575),_=encode_range(b)}i||(i={}),g["!comments"]=[];var j=[];write_ws_xml_sheetpr(g,a,e,s,o),o[o.length]=writextag("dimension",null,{ref:_}),o[o.length]=write_ws_xml_sheetviews(g,s,e,a),s.sheetFormat&&(o[o.length]=writextag("sheetFormatPr",null,{defaultRowHeight:s.sheetFormat.defaultRowHeight||"16",baseColWidth:s.sheetFormat.baseColWidth||"10",outlineLevelRow:s.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(o[o.length]=write_ws_xml_cols(g,g["!cols"])),o[d=o.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(h=write_ws_xml_data(g,s),h.length>0&&(o[o.length]=h)),o.length>d+1&&(o[o.length]="</sheetData>",o[d]=o[d].replace("/>",">")),g["!protect"]&&(o[o.length]=write_ws_xml_protection(g["!protect"])),g["!autofilter"]!=null&&(o[o.length]=write_ws_xml_autofilter(g["!autofilter"],g,a,e)),g["!merges"]!=null&&g["!merges"].length>0&&(o[o.length]=write_ws_xml_merges(g["!merges"]));var _e=-1,tt,rt=-1;return g["!links"].length>0&&(o[o.length]="<hyperlinks>",g["!links"].forEach(function(et){et[1].Target&&(tt={ref:et[0]},et[1].Target.charAt(0)!="#"&&(rt=add_rels(i,-1,escapexml(et[1].Target).replace(/#.*$/,""),RELS.HLINK),tt["r:id"]="rId"+rt),(_e=et[1].Target.indexOf("#"))>-1&&(tt.location=escapexml(et[1].Target.slice(_e+1))),et[1].Tooltip&&(tt.tooltip=escapexml(et[1].Tooltip)),o[o.length]=writextag("hyperlink",null,tt))}),o[o.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(o[o.length]=write_ws_xml_margins(g["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&(o[o.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:_}))),j.length>0&&(rt=add_rels(i,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),o[o.length]=writextag("drawing",null,{"r:id":"rId"+rt}),g["!drawing"]=j),g["!comments"].length>0&&(rt=add_rels(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),o[o.length]=writextag("legacyDrawing",null,{"r:id":"rId"+rt}),g["!legacy"]=rt),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtRowHdr(e,s){var a={},i=e.l+s;a.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=i,c&7&&(a.level=c&7),c&16&&(a.hidden=!0),c&32&&(a.hpt=o/20),a}function write_BrtRowHdr(e,s,a){var i=new_buf(145),o=(a["!rows"]||[])[e]||{};i.write_shift(4,e),i.write_shift(4,0);var c=320;o.hpx?c=px2pt(o.hpx)*20:o.hpt&&(c=o.hpt*20),i.write_shift(2,c),i.write_shift(1,0);var d=0;o.level&&(d|=o.level),o.hidden&&(d|=16),(o.hpx||o.hpt)&&(d|=32),i.write_shift(1,d),i.write_shift(1,0);var h=0,g=i.l;i.l+=4;for(var _={r:e,c:0},b=0;b<16;++b)if(!(s.s.c>b+1<<10||s.e.c<b<<10)){for(var j=-1,_e=-1,tt=b<<10;tt<b+1<<10;++tt){_.c=tt;var rt=Array.isArray(a)?(a[_.r]||[])[_.c]:a[encode_cell(_)];rt&&(j<0&&(j=tt),_e=tt)}j<0||(++h,i.write_shift(4,j),i.write_shift(4,_e))}var et=i.l;return i.l=g,i.write_shift(4,h),i.l=et,i.length>i.l?i.slice(0,i.l):i}function write_row_header(e,s,a,i){var o=write_BrtRowHdr(i,a,s);(o.length>17||(s["!rows"]||[])[i])&&write_record(e,0,o)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,s){var a={},i=e[e.l];return++e.l,a.above=!(i&64),a.left=!(i&128),e.l+=18,a.name=parse_XLSBCodeName(e),a}function write_BrtWsProp(e,s,a){a==null&&(a=new_buf(84+4*e.length));var i=192;s&&(s.above&&(i&=-65),s.left&&(i&=-129)),a.write_shift(1,i);for(var o=1;o<3;++o)a.write_shift(1,0);return write_BrtColor({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),write_XLSBCodeName(e,a),a.slice(0,a.l)}function parse_BrtCellBlank(e){var s=parse_XLSBCell(e);return[s]}function write_BrtCellBlank(e,s,a){return a==null&&(a=new_buf(8)),write_XLSBCell(s,a)}function parse_BrtShortBlank(e){var s=parse_XLSBShortCell(e);return[s]}function write_BrtShortBlank(e,s,a){return a==null&&(a=new_buf(4)),write_XLSBShortCell(s,a)}function parse_BrtCellBool(e){var s=parse_XLSBCell(e),a=e.read_shift(1);return[s,a,"b"]}function write_BrtCellBool(e,s,a){return a==null&&(a=new_buf(9)),write_XLSBCell(s,a),a.write_shift(1,e.v?1:0),a}function parse_BrtShortBool(e){var s=parse_XLSBShortCell(e),a=e.read_shift(1);return[s,a,"b"]}function write_BrtShortBool(e,s,a){return a==null&&(a=new_buf(5)),write_XLSBShortCell(s,a),a.write_shift(1,e.v?1:0),a}function parse_BrtCellError(e){var s=parse_XLSBCell(e),a=e.read_shift(1);return[s,a,"e"]}function write_BrtCellError(e,s,a){return a==null&&(a=new_buf(9)),write_XLSBCell(s,a),a.write_shift(1,e.v),a}function parse_BrtShortError(e){var s=parse_XLSBShortCell(e),a=e.read_shift(1);return[s,a,"e"]}function write_BrtShortError(e,s,a){return a==null&&(a=new_buf(8)),write_XLSBShortCell(s,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}function parse_BrtCellIsst(e){var s=parse_XLSBCell(e),a=e.read_shift(4);return[s,a,"s"]}function write_BrtCellIsst(e,s,a){return a==null&&(a=new_buf(12)),write_XLSBCell(s,a),a.write_shift(4,s.v),a}function parse_BrtShortIsst(e){var s=parse_XLSBShortCell(e),a=e.read_shift(4);return[s,a,"s"]}function write_BrtShortIsst(e,s,a){return a==null&&(a=new_buf(8)),write_XLSBShortCell(s,a),a.write_shift(4,s.v),a}function parse_BrtCellReal(e){var s=parse_XLSBCell(e),a=parse_Xnum(e);return[s,a,"n"]}function write_BrtCellReal(e,s,a){return a==null&&(a=new_buf(16)),write_XLSBCell(s,a),write_Xnum(e.v,a),a}function parse_BrtShortReal(e){var s=parse_XLSBShortCell(e),a=parse_Xnum(e);return[s,a,"n"]}function write_BrtShortReal(e,s,a){return a==null&&(a=new_buf(12)),write_XLSBShortCell(s,a),write_Xnum(e.v,a),a}function parse_BrtCellRk(e){var s=parse_XLSBCell(e),a=parse_RkNumber(e);return[s,a,"n"]}function write_BrtCellRk(e,s,a){return a==null&&(a=new_buf(12)),write_XLSBCell(s,a),write_RkNumber(e.v,a),a}function parse_BrtShortRk(e){var s=parse_XLSBShortCell(e),a=parse_RkNumber(e);return[s,a,"n"]}function write_BrtShortRk(e,s,a){return a==null&&(a=new_buf(8)),write_XLSBShortCell(s,a),write_RkNumber(e.v,a),a}function parse_BrtCellRString(e){var s=parse_XLSBCell(e),a=parse_RichStr(e);return[s,a,"is"]}function parse_BrtCellSt(e){var s=parse_XLSBCell(e),a=parse_XLWideString(e);return[s,a,"str"]}function write_BrtCellSt(e,s,a){return a==null&&(a=new_buf(12+4*e.v.length)),write_XLSBCell(s,a),write_XLWideString(e.v,a),a.length>a.l?a.slice(0,a.l):a}function parse_BrtShortSt(e){var s=parse_XLSBShortCell(e),a=parse_XLWideString(e);return[s,a,"str"]}function write_BrtShortSt(e,s,a){return a==null&&(a=new_buf(8+4*e.v.length)),write_XLSBShortCell(s,a),write_XLWideString(e.v,a),a.length>a.l?a.slice(0,a.l):a}function parse_BrtFmlaBool(e,s,a){var i=e.l+s,o=parse_XLSBCell(e);o.r=a["!row"];var c=e.read_shift(1),d=[o,c,"b"];if(a.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,i-e.l,a);d[3]=stringify_formula(h,null,o,a.supbooks,a)}else e.l=i;return d}function parse_BrtFmlaError(e,s,a){var i=e.l+s,o=parse_XLSBCell(e);o.r=a["!row"];var c=e.read_shift(1),d=[o,c,"e"];if(a.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,i-e.l,a);d[3]=stringify_formula(h,null,o,a.supbooks,a)}else e.l=i;return d}function parse_BrtFmlaNum(e,s,a){var i=e.l+s,o=parse_XLSBCell(e);o.r=a["!row"];var c=parse_Xnum(e),d=[o,c,"n"];if(a.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,i-e.l,a);d[3]=stringify_formula(h,null,o,a.supbooks,a)}else e.l=i;return d}function parse_BrtFmlaString(e,s,a){var i=e.l+s,o=parse_XLSBCell(e);o.r=a["!row"];var c=parse_XLWideString(e),d=[o,c,"str"];if(a.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,i-e.l,a);d[3]=stringify_formula(h,null,o,a.supbooks,a)}else e.l=i;return d}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,s){return s==null&&(s=new_buf(4)),s.write_shift(4,e),s}function parse_BrtHLink(e,s){var a=e.l+s,i=parse_UncheckedRfX(e),o=parse_XLNullableWideString(e),c=parse_XLWideString(e),d=parse_XLWideString(e),h=parse_XLWideString(e);e.l=a;var g={rfx:i,relId:o,loc:c,display:h};return d&&(g.Tooltip=d),g}function write_BrtHLink(e,s){var a=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},a),write_RelID("rId"+s,a);var i=e[1].Target.indexOf("#"),o=i==-1?"":e[1].Target.slice(i+1);return write_XLWideString(o||"",a),write_XLWideString(e[1].Tooltip||"",a),write_XLWideString("",a),a.slice(0,a.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,s,a){var i=e.l+s,o=parse_RfX(e),c=e.read_shift(1),d=[o];if(d[2]=c,a.cellFormula){var h=parse_XLSBArrayParsedFormula(e,i-e.l,a);d[1]=h}else e.l=i;return d}function parse_BrtShrFmla(e,s,a){var i=e.l+s,o=parse_UncheckedRfX(e),c=[o];if(a.cellFormula){var d=parse_XLSBSharedParsedFormula(e,i-e.l,a);c[1]=d,e.l=i}else e.l=i;return c}function write_BrtColInfo(e,s,a){a==null&&(a=new_buf(18));var i=col_obj_w(e,s);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,(i.width||10)*256),a.write_shift(4,0);var o=0;return s.hidden&&(o|=1),typeof i.width=="number"&&(o|=2),s.level&&(o|=s.level<<8),a.write_shift(2,o),a}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var s={};return BrtMarginKeys.forEach(function(a){s[a]=parse_Xnum(e)}),s}function write_BrtMargins(e,s){return s==null&&(s=new_buf(6*8)),default_margins(e),BrtMarginKeys.forEach(function(a){write_Xnum(e[a],s)}),s}function parse_BrtBeginWsView(e){var s=e.read_shift(2);return e.l+=28,{RTL:s&32}}function write_BrtBeginWsView(e,s,a){a==null&&(a=new_buf(30));var i=924;return(((s||{}).Views||[])[0]||{}).RTL&&(i|=32),a.write_shift(2,i),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function write_BrtCellIgnoreEC(e){var s=new_buf(24);return s.write_shift(4,4),s.write_shift(4,1),write_UncheckedRfX(e,s),s}function write_BrtSheetProtection(e,s){return s==null&&(s=new_buf(16*4+2)),s.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),s.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?s.write_shift(4,e[a[0]]!=null&&!e[a[0]]?1:0):s.write_shift(4,e[a[0]]!=null&&e[a[0]]?0:1)}),s}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,s,a,i,o,c,d){if(!e)return e;var h=s||{};i||(i={"!id":{}});var g=h.dense?[]:{},_,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=!1,_e=!1,tt,rt,et,st,at,it,nt,ot,dt,ht=[];h.biff=12,h["!row"]=0;var lt=0,gt=!1,yt=[],Tt={},mt=h.supbooks||o.supbooks||[[]];if(mt.sharedf=Tt,mt.arrayf=yt,mt.SheetNames=o.SheetNames||o.Sheets.map(function(jt){return jt.name}),!h.supbooks&&(h.supbooks=mt,o.Names))for(var Et=0;Et<o.Names.length;++Et)mt[0][Et+1]=o.Names[Et];var Ft=[],Vt=[],Mt=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var Ct;if(recordhopper(e,function(ut,Lt,Pt){if(!_e)switch(Pt){case 148:_=ut;break;case 0:tt=ut,h.sheetRows&&h.sheetRows<=tt.r&&(_e=!0),ot=encode_row(st=tt.r),h["!row"]=tt.r,(ut.hidden||ut.hpt||ut.level!=null)&&(ut.hpt&&(ut.hpx=pt2px(ut.hpt)),Vt[ut.r]=ut);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(rt={t:ut[2]},ut[2]){case"n":rt.v=ut[1];break;case"s":nt=strs[ut[1]],rt.v=nt.t,rt.r=nt.r;break;case"b":rt.v=!!ut[1];break;case"e":rt.v=ut[1],h.cellText!==!1&&(rt.w=BErr[rt.v]);break;case"str":rt.t="s",rt.v=ut[1];break;case"is":rt.t="s",rt.v=ut[1].t;break}if((et=d.CellXf[ut[0].iStyleRef])&&safe_format(rt,et.numFmtId,null,h,c,d),at=ut[0].c==-1?at+1:ut[0].c,h.dense?(g[st]||(g[st]=[]),g[st][at]=rt):g[encode_col(at)+ot]=rt,h.cellFormula){for(gt=!1,lt=0;lt<yt.length;++lt){var ft=yt[lt];tt.r>=ft[0].s.r&&tt.r<=ft[0].e.r&&at>=ft[0].s.c&&at<=ft[0].e.c&&(rt.F=encode_range(ft[0]),gt=!0)}!gt&&ut.length>3&&(rt.f=ut[3])}if(b.s.r>tt.r&&(b.s.r=tt.r),b.s.c>at&&(b.s.c=at),b.e.r<tt.r&&(b.e.r=tt.r),b.e.c<at&&(b.e.c=at),h.cellDates&&et&&rt.t=="n"&&fmt_is_date(table_fmt[et.numFmtId])){var Rt=SSF_parse_date_code(rt.v);Rt&&(rt.t="d",rt.v=new Date(Rt.y,Rt.m-1,Rt.d,Rt.H,Rt.M,Rt.S,Rt.u))}Ct&&(Ct.type=="XLDAPR"&&(rt.D=!0),Ct=void 0);break;case 1:case 12:if(!h.sheetStubs||j)break;rt={t:"z",v:void 0},at=ut[0].c==-1?at+1:ut[0].c,h.dense?(g[st]||(g[st]=[]),g[st][at]=rt):g[encode_col(at)+ot]=rt,b.s.r>tt.r&&(b.s.r=tt.r),b.s.c>at&&(b.s.c=at),b.e.r<tt.r&&(b.e.r=tt.r),b.e.c<at&&(b.e.c=at),Ct&&(Ct.type=="XLDAPR"&&(rt.D=!0),Ct=void 0);break;case 176:ht.push(ut);break;case 49:Ct=((h.xlmeta||{}).Cell||[])[ut-1];break;case 494:var bt=i["!id"][ut.relId];for(bt?(ut.Target=bt.Target,ut.loc&&(ut.Target+="#"+ut.loc),ut.Rel=bt):ut.relId==""&&(ut.Target="#"+ut.loc),st=ut.rfx.s.r;st<=ut.rfx.e.r;++st)for(at=ut.rfx.s.c;at<=ut.rfx.e.c;++at)h.dense?(g[st]||(g[st]=[]),g[st][at]||(g[st][at]={t:"z",v:void 0}),g[st][at].l=ut):(it=encode_cell({c:at,r:st}),g[it]||(g[it]={t:"z",v:void 0}),g[it].l=ut);break;case 426:if(!h.cellFormula)break;yt.push(ut),dt=h.dense?g[st][at]:g[encode_col(at)+ot],dt.f=stringify_formula(ut[1],b,{r:tt.r,c:at},mt,h),dt.F=encode_range(ut[0]);break;case 427:if(!h.cellFormula)break;Tt[encode_cell(ut[0].s)]=ut[1],dt=h.dense?g[st][at]:g[encode_col(at)+ot],dt.f=stringify_formula(ut[1],b,{r:tt.r,c:at},mt,h);break;case 60:if(!h.cellStyles)break;for(;ut.e>=ut.s;)Ft[ut.e--]={width:ut.w/256,hidden:!!(ut.flags&1),level:ut.level},Mt||(Mt=!0,find_mdw_colw(ut.w/256)),process_col(Ft[ut.e+1]);break;case 161:g["!autofilter"]={ref:encode_range(ut)};break;case 476:g["!margins"]=ut;break;case 147:o.Sheets[a]||(o.Sheets[a]={}),ut.name&&(o.Sheets[a].CodeName=ut.name),(ut.above||ut.left)&&(g["!outline"]={above:ut.above,left:ut.left});break;case 137:o.Views||(o.Views=[{}]),o.Views[0]||(o.Views[0]={}),ut.RTL&&(o.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:j=!0;break;case 36:j=!1;break;case 37:j=!0;break;case 38:j=!1;break;default:if(!Lt.T){if(!j||h.WTF)throw new Error("Unexpected record 0x"+Pt.toString(16))}}},h),delete h.supbooks,delete h["!row"],!g["!ref"]&&(b.s.r<2e6||_&&(_.e.r>0||_.e.c>0||_.s.r>0||_.s.c>0))&&(g["!ref"]=encode_range(_||b)),h.sheetRows&&g["!ref"]){var kt=safe_decode_range(g["!ref"]);h.sheetRows<=+kt.e.r&&(kt.e.r=h.sheetRows-1,kt.e.r>b.e.r&&(kt.e.r=b.e.r),kt.e.r<kt.s.r&&(kt.s.r=kt.e.r),kt.e.c>b.e.c&&(kt.e.c=b.e.c),kt.e.c<kt.s.c&&(kt.s.c=kt.e.c),g["!fullref"]=g["!ref"],g["!ref"]=encode_range(kt))}return ht.length>0&&(g["!merges"]=ht),Ft.length>0&&(g["!cols"]=Ft),Vt.length>0&&(g["!rows"]=Vt),g}function write_ws_bin_cell(e,s,a,i,o,c,d){if(s.v===void 0)return!1;var h="";switch(s.t){case"b":h=s.v?"1":"0";break;case"d":s=dup(s),s.z=s.z||table_fmt[14],s.v=datenum(parseDate(s.v)),s.t="n";break;case"n":case"e":h=""+s.v;break;default:h=s.v;break}var g={r:a,c:i};switch(g.s=get_cell_style(o.cellXfs,s,o),s.l&&c["!links"].push([encode_cell(g),s.l]),s.c&&c["!comments"].push([encode_cell(g),s.c]),s.t){case"s":case"str":return o.bookSST?(h=get_sst_id(o.Strings,s.v,o.revStrings),g.t="s",g.v=h,d?write_record(e,18,write_BrtShortIsst(s,g)):write_record(e,7,write_BrtCellIsst(s,g))):(g.t="str",d?write_record(e,17,write_BrtShortSt(s,g)):write_record(e,6,write_BrtCellSt(s,g))),!0;case"n":return s.v==(s.v|0)&&s.v>-1e3&&s.v<1e3?d?write_record(e,13,write_BrtShortRk(s,g)):write_record(e,2,write_BrtCellRk(s,g)):d?write_record(e,16,write_BrtShortReal(s,g)):write_record(e,5,write_BrtCellReal(s,g)),!0;case"b":return g.t="b",d?write_record(e,15,write_BrtShortBool(s,g)):write_record(e,4,write_BrtCellBool(s,g)),!0;case"e":return g.t="e",d?write_record(e,14,write_BrtShortError(s,g)):write_record(e,3,write_BrtCellError(s,g)),!0}return d?write_record(e,12,write_BrtShortBlank(s,g)):write_record(e,1,write_BrtCellBlank(s,g)),!0}function write_CELLTABLE(e,s,a,i){var o=safe_decode_range(s["!ref"]||"A1"),c,d="",h=[];write_record(e,145);var g=Array.isArray(s),_=o.e.r;s["!rows"]&&(_=Math.max(o.e.r,s["!rows"].length-1));for(var b=o.s.r;b<=_;++b){d=encode_row(b),write_row_header(e,s,o,b);var j=!1;if(b<=o.e.r)for(var _e=o.s.c;_e<=o.e.c;++_e){b===o.s.r&&(h[_e]=encode_col(_e)),c=h[_e]+d;var tt=g?(s[b]||[])[_e]:s[c];if(!tt){j=!1;continue}j=write_ws_bin_cell(e,tt,b,_e,i,s,j)}}write_record(e,146)}function write_MERGECELLS(e,s){!s||!s["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(s["!merges"].length)),s["!merges"].forEach(function(a){write_record(e,176,write_BrtMergeCell(a))}),write_record(e,178))}function write_COLINFOS(e,s){!s||!s["!cols"]||(write_record(e,390),s["!cols"].forEach(function(a,i){a&&write_record(e,60,write_BrtColInfo(i,a))}),write_record(e,391))}function write_IGNOREECS(e,s){!s||!s["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(s["!ref"]))),write_record(e,650))}function write_HLINKS(e,s,a){s["!links"].forEach(function(i){if(i[1].Target){var o=add_rels(a,-1,i[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(i,o))}}),delete s["!links"]}function write_LEGACYDRAWING(e,s,a,i){if(s["!comments"].length>0){var o=add_rels(i,-1,"../drawings/vmlDrawing"+(a+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+o)),s["!legacy"]=o}}function write_AUTOFILTER(e,s,a,i){if(s["!autofilter"]){var o=s["!autofilter"],c=typeof o.ref=="string"?o.ref:encode_range(o.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var d=a.Workbook.Names,h=decode_range(c);h.s.r==h.e.r&&(h.e.r=decode_range(s["!ref"]).e.r,c=encode_range(h));for(var g=0;g<d.length;++g){var _=d[g];if(_.Name=="_xlnm._FilterDatabase"&&_.Sheet==i){_.Ref="'"+a.SheetNames[i]+"'!"+c;break}}g==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+a.SheetNames[i]+"'!"+c}),write_record(e,161,write_UncheckedRfX(safe_decode_range(c))),write_record(e,162)}}function write_WSVIEWS2(e,s,a){write_record(e,133),write_record(e,137,write_BrtBeginWsView(s,a)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,s){s["!protect"]&&write_record(e,535,write_BrtSheetProtection(s["!protect"]))}function write_ws_bin(e,s,a,i){var o=buf_array(),c=a.SheetNames[e],d=a.Sheets[c]||{},h=c;try{a&&a.Workbook&&(h=a.Workbook.Sheets[e].CodeName||h)}catch{}var g=safe_decode_range(d["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(s.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return d["!links"]=[],d["!comments"]=[],write_record(o,129),(a.vbaraw||d["!outline"])&&write_record(o,147,write_BrtWsProp(h,d["!outline"])),write_record(o,148,write_BrtWsDim(g)),write_WSVIEWS2(o,d,a.Workbook),write_COLINFOS(o,d),write_CELLTABLE(o,d,e,s),write_SHEETPROTECT(o,d),write_AUTOFILTER(o,d,a,e),write_MERGECELLS(o,d),write_HLINKS(o,d,i),d["!margins"]&&write_record(o,476,write_BrtMargins(d["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&write_IGNOREECS(o,d),write_LEGACYDRAWING(o,d,e,i),write_record(o,130),o.end()}function parse_Cache(e){var s=[],a=e.match(/^<c:numCache>/),i;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var d=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);d&&(s[+d[1]]=a?+d[2]:d[2])});var o=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){i=c.replace(/<.*?>/g,"")}),[s,o,i]}function parse_chart(e,s,a,i,o,c){var d=c||{"!type":"chart"};if(!e)return c;var h=0,g=0,_="A",b={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(j){var _e=parse_Cache(j);b.s.r=b.s.c=0,b.e.c=h,_=encode_col(h),_e[0].forEach(function(tt,rt){d[_+encode_row(rt)]={t:"n",v:tt,z:_e[1]},g=rt}),b.e.r<g&&(b.e.r=g),++h}),h>0&&(d["!ref"]=encode_range(b)),d}function parse_cs_xml(e,s,a,i,o){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},d,h=e.match(sheetprregex);return h&&parse_ws_xml_sheetpr(h[0],c,o,a),(d=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=d[1]),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}function parse_BrtCsProp(e,s){e.l+=10;var a=parse_XLWideString(e);return{name:a}}function parse_cs_bin(e,s,a,i,o){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},d=!1;return recordhopper(e,function(g,_,b){switch(b){case 550:c["!rel"]=g;break;case 651:o.Sheets[a]||(o.Sheets[a]={}),g.name&&(o.Sheets[a].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:break;case 38:break;default:if(!(_.T>0)){if(!(_.T<0)){if(!d||s.WTF)throw new Error("Unexpected record 0x"+b.toString(16))}}}},s),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,s){for(var a=0;a!=e.length;++a)for(var i=e[a],o=0;o!=s.length;++o){var c=s[o];if(i[c[0]]==null)i[c[0]]=c[1];else switch(c[2]){case"bool":typeof i[c[0]]=="string"&&(i[c[0]]=parsexmlbool(i[c[0]]));break;case"int":typeof i[c[0]]=="string"&&(i[c[0]]=parseInt(i[c[0]],10));break}}}function push_defaults(e,s){for(var a=0;a!=s.length;++a){var i=s[a];if(e[i[0]]==null)e[i[0]]=i[1];else switch(i[2]){case"bool":typeof e[i[0]]=="string"&&(e[i[0]]=parsexmlbool(e[i[0]]));break;case"int":typeof e[i[0]]=="string"&&(e[i[0]]=parseInt(e[i[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,s){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return badchars.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function check_wb_names(e,s,a){e.forEach(function(i,o){check_ws_name(i);for(var c=0;c<o;++c)if(i==e[c])throw new Error("Duplicate Sheet Name: "+i);if(a){var d=s&&s[o]&&s[o].CodeName||i;if(d.charCodeAt(0)==95&&d.length>22)throw new Error("Bad Code Name: Worksheet"+d)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var s=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,s,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)check_ws(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,s){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,o="xmlns",c={},d=0;if(e.replace(tagregex,function(g,_){var b=parsexmltag(g);switch(strip_ns(b[0])){case"<?xml":break;case"<workbook":g.match(wbnsregex)&&(o="xmlns"+g.match(/<(\w+):/)[1]),a.xmlns=b[o];break;case"</workbook>":break;case"<fileVersion":delete b[0],a.AppVersion=b;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(j){if(b[j[0]]!=null)switch(j[2]){case"bool":a.WBProps[j[0]]=parsexmlbool(b[j[0]]);break;case"int":a.WBProps[j[0]]=parseInt(b[j[0]],10);break;default:a.WBProps[j[0]]=b[j[0]]}}),b.codeName&&(a.WBProps.CodeName=utf8read(b.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete b[0],a.WBView.push(b);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(b.state){case"hidden":b.Hidden=1;break;case"veryHidden":b.Hidden=2;break;default:b.Hidden=0}delete b.state,b.name=unescapexml(utf8read(b.name)),delete b[0],a.Sheets.push(b);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":c={},c.Name=utf8read(b.name),b.comment&&(c.Comment=b.comment),b.localSheetId&&(c.Sheet=+b.localSheetId),parsexmlbool(b.hidden||"0")&&(c.Hidden=!0),d=_+g.length;break;case"</definedName>":c.Ref=unescapexml(utf8read(e.slice(d,_))),a.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete b[0],a.CalcPr=b;break;case"<calcPr/>":delete b[0],a.CalcPr=b;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&s.WTF)throw new Error("unrecognized "+b[0]+" in workbook")}return g}),XMLNS_main.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return parse_wb_defaults(a),a}function write_wb_xml(e){var s=[XML_HEADER];s[s.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(h){e.Workbook.WBProps[h[0]]!=null&&e.Workbook.WBProps[h[0]]!=h[1]&&(i[h[0]]=e.Workbook.WBProps[h[0]])}),e.Workbook.WBProps.CodeName&&(i.codeName=e.Workbook.WBProps.CodeName,delete i.CodeName)),s[s.length]=writextag("workbookPr",null,i);var o=e.Workbook&&e.Workbook.Sheets||[],c=0;if(o&&o[0]&&o[0].Hidden){for(s[s.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!o[c]||!o[c].Hidden);++c);c==e.SheetNames.length&&(c=0),s[s.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',s[s.length]="</bookViews>"}for(s[s.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var d={name:escapexml(e.SheetNames[c].slice(0,31))};if(d.sheetId=""+(c+1),d["r:id"]="rId"+(c+1),o[c])switch(o[c].Hidden){case 1:d.state="hidden";break;case 2:d.state="veryHidden";break}s[s.length]=writextag("sheet",null,d)}return s[s.length]="</sheets>",a&&(s[s.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(h){var g={name:h.Name};h.Comment&&(g.comment=h.Comment),h.Sheet!=null&&(g.localSheetId=""+h.Sheet),h.Hidden&&(g.hidden="1"),h.Ref&&(s[s.length]=writextag("definedName",escapexml(h.Ref),g))}),s[s.length]="</definedNames>"),s.length>2&&(s[s.length]="</workbook>",s[1]=s[1].replace("/>",">")),s.join("")}function parse_BrtBundleSh(e,s){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=parse_RelID(e),a.name=parse_XLWideString(e),a}function write_BrtBundleSh(e,s){return s||(s=new_buf(127)),s.write_shift(4,e.Hidden),s.write_shift(4,e.iTabID),write_RelID(e.strRelID,s),write_XLWideString(e.name.slice(0,31),s),s.length>s.l?s.slice(0,s.l):s}function parse_BrtWbProp(e,s){var a={},i=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var o=s>8?parse_XLWideString(e):"";return o.length>0&&(a.CodeName=o),a.autoCompressPictures=!!(i&65536),a.backupFile=!!(i&64),a.checkCompatibility=!!(i&4096),a.date1904=!!(i&1),a.filterPrivacy=!!(i&8),a.hidePivotFieldList=!!(i&1024),a.promptedSolutions=!!(i&16),a.publishItems=!!(i&2048),a.refreshAllConnections=!!(i&262144),a.saveExternalLinkValues=!!(i&128),a.showBorderUnselectedTables=!!(i&4),a.showInkAnnotation=!!(i&32),a.showObjects=["all","placeholders","none"][i>>13&3],a.showPivotChartFilter=!!(i&32768),a.updateLinks=["userSet","never","always"][i>>8&3],a}function write_BrtWbProp(e,s){s||(s=new_buf(72));var a=0;return e&&e.filterPrivacy&&(a|=8),s.write_shift(4,a),s.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",s),s.slice(0,s.l)}function parse_BrtFRTArchID$(e,s){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=s-8,a}function parse_BrtName(e,s,a){var i=e.l+s;e.l+=4,e.l+=1;var o=e.read_shift(4),c=parse_XLNameWideString(e),d=parse_XLSBNameParsedFormula(e,0,a),h=parse_XLNullableWideString(e);e.l=i;var g={Name:c,Ptg:d};return o<268435455&&(g.Sheet=o),h&&(g.Comment=h),g}function parse_wb_bin(e,s){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],o=!1;s||(s={}),s.biff=12;var c=[],d=[[]];return d.SheetNames=[],d.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(g,_,b){switch(b){case 156:d.SheetNames.push(g.name),a.Sheets.push(g);break;case 153:a.WBProps=g;break;case 39:g.Sheet!=null&&(s.SID=g.Sheet),g.Ref=stringify_formula(g.Ptg,null,null,d,s),delete s.SID,delete g.Ptg,c.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:d[0].length?d.push([b,g]):d[0]=[b,g],d[d.length-1].XTI=[];break;case 362:d.length===0&&(d[0]=[],d[0].XTI=[]),d[d.length-1].XTI=d[d.length-1].XTI.concat(g),d.XTI=d.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(b),o=!0;break;case 36:i.pop(),o=!1;break;case 37:i.push(b),o=!0;break;case 38:i.pop(),o=!1;break;case 16:break;default:if(!_.T){if(!o||s.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+b.toString(16))}}},s),parse_wb_defaults(a),a.Names=c,a.supbooks=d,a}function write_BUNDLESHS(e,s){write_record(e,143);for(var a=0;a!=s.SheetNames.length;++a){var i=s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[a]&&s.Workbook.Sheets[a].Hidden||0,o={Hidden:i,iTabID:a+1,strRelID:"rId"+(a+1),name:s.SheetNames[a]};write_record(e,156,write_BrtBundleSh(o))}write_record(e,144)}function write_BrtFileVersion(e,s){s||(s=new_buf(127));for(var a=0;a!=4;++a)s.write_shift(4,0);return write_XLWideString("SheetJS",s),write_XLWideString(XLSX.version,s),write_XLWideString(XLSX.version,s),write_XLWideString("7262",s),s.length>s.l?s.slice(0,s.l):s}function write_BrtBookView(e,s){s||(s=new_buf(29)),s.write_shift(-4,0),s.write_shift(-4,460),s.write_shift(4,28800),s.write_shift(4,17600),s.write_shift(4,500),s.write_shift(4,e),s.write_shift(4,e);var a=120;return s.write_shift(1,a),s.length>s.l?s.slice(0,s.l):s}function write_BOOKVIEWS(e,s){if(!(!s.Workbook||!s.Workbook.Sheets)){for(var a=s.Workbook.Sheets,i=0,o=-1,c=-1;i<a.length;++i)!a[i]||!a[i].Hidden&&o==-1?o=i:a[i].Hidden==1&&c==-1&&(c=i);c>o||(write_record(e,135),write_record(e,158,write_BrtBookView(o)),write_record(e,136))}}function write_wb_bin(e,s){var a=buf_array();return write_record(a,131),write_record(a,128,write_BrtFileVersion()),write_record(a,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(a,e),write_BUNDLESHS(a,e),write_record(a,132),a.end()}function parse_wb(e,s,a){return s.slice(-4)===".bin"?parse_wb_bin(e,a):parse_wb_xml(e,a)}function parse_ws(e,s,a,i,o,c,d,h){return s.slice(-4)===".bin"?parse_ws_bin(e,i,a,o,c,d,h):parse_ws_xml(e,i,a,o,c,d,h)}function parse_cs(e,s,a,i,o,c,d,h){return s.slice(-4)===".bin"?parse_cs_bin(e,i,a,o,c):parse_cs_xml(e,i,a,o,c)}function parse_ms(e,s,a,i,o,c,d,h){return s.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,s,a,i,o,c,d,h){return s.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,s,a,i){return s.slice(-4)===".bin"?parse_sty_bin(e,a,i):parse_sty_xml(e,a,i)}function parse_theme(e,s,a){return parse_theme_xml(e,a)}function parse_sst(e,s,a){return s.slice(-4)===".bin"?parse_sst_bin(e,a):parse_sst_xml(e,a)}function parse_cmnt(e,s,a){return s.slice(-4)===".bin"?parse_comments_bin(e,a):parse_comments_xml(e,a)}function parse_cc(e,s,a){return s.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,s,a,i){return a.slice(-4)===".bin"?parse_xlink_bin(e,s,a,i):void 0}function parse_xlmeta(e,s,a){return s.slice(-4)===".bin"?parse_xlmeta_bin(e,s,a):parse_xlmeta_xml(e,s,a)}function write_wb(e,s,a){return(s.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,s,a,i,o){return(s.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,a,i,o)}function write_sty(e,s,a){return(s.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,a)}function write_sst(e,s,a){return(s.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,a)}function write_cmnt(e,s,a){return(s.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,s){var a=e.split(/\s+/),i=[];if(i[0]=a[0],a.length===1)return i;var o=e.match(attregexg2),c,d,h,g;if(o)for(g=0;g!=o.length;++g)c=o[g].match(attregex2),(d=c[1].indexOf(":"))===-1?i[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?h="xmlns"+c[1].slice(6):h=c[1].slice(d+1),i[h]=c[2].slice(1,c[2].length-1));return i}function xlml_parsexmltagobj(e){var s=e.split(/\s+/),a={};if(s.length===1)return a;var i=e.match(attregexg2),o,c,d,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(attregex2),(c=o[1].indexOf(":"))===-1?a[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?d="xmlns"+o[1].slice(6):d=o[1].slice(c+1),a[d]=o[2].slice(1,o[2].length-1));return a}var XLMLFormatMap;function xlml_format(e,s){var a=XLMLFormatMap[e]||unescapexml(e);return a==="General"?SSF_general(s):SSF_format(a,s)}function xlml_set_custprop(e,s,a,i){var o=i;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":o=parsexmlbool(i);break;case"i2":case"int":o=parseInt(i,10);break;case"r4":case"float":o=parseFloat(i);break;case"date":case"dateTime.tz":o=parseDate(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[unescapexml(s)]=o}function safe_format_xlml(e,s,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:s==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(s||"General",e.v)}catch(c){if(a.WTF)throw c}try{var i=XLMLFormatMap[s]||s||"General";if(a.cellNF&&(e.z=i),a.cellDates&&e.t=="n"&&fmt_is_date(i)){var o=SSF_parse_date_code(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(c){if(a.WTF)throw c}}}function process_style_xlml(e,s,a){if(a.cellStyles&&s.Interior){var i=s.Interior;i.Pattern&&(i.patternType=XLMLPatternTypeMap[i.Pattern]||i.Pattern)}e[s.ID]=s}function parse_xlml_data(e,s,a,i,o,c,d,h,g,_){var b="General",j=i.StyleID,_e={};_=_||{};var tt=[],rt=0;for(j===void 0&&h&&(j=h.StyleID),j===void 0&&d&&(j=d.StyleID);c[j]!==void 0&&(c[j].nf&&(b=c[j].nf),c[j].Interior&&tt.push(c[j].Interior),!!c[j].Parent);)j=c[j].Parent;switch(a.Type){case"Boolean":i.t="b",i.v=parsexmlbool(e);break;case"String":i.t="s",i.r=xlml_fixstr(unescapexml(e)),i.v=e.indexOf("<")>-1?unescapexml(s||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),i.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=unescapexml(e):i.v<60&&(i.v=i.v-1),(!b||b=="General")&&(b="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=RBErr[e],_.cellText!==!1&&(i.w=e);break;default:e==""&&s==""?i.t="z":(i.t="s",i.v=xlml_fixstr(s||e));break}if(safe_format_xlml(i,b,_),_.cellFormula!==!1)if(i.Formula){var et=unescapexml(i.Formula);et.charCodeAt(0)==61&&(et=et.slice(1)),i.f=rc_to_a1(et,o),delete i.Formula,i.ArrayRange=="RC"?i.F=rc_to_a1("RC:RC",o):i.ArrayRange&&(i.F=rc_to_a1(i.ArrayRange,o),g.push([safe_decode_range(i.F),i.F]))}else for(rt=0;rt<g.length;++rt)o.r>=g[rt][0].s.r&&o.r<=g[rt][0].e.r&&o.c>=g[rt][0].s.c&&o.c<=g[rt][0].e.c&&(i.F=g[rt][1]);_.cellStyles&&(tt.forEach(function(st){!_e.patternType&&st.patternType&&(_e.patternType=st.patternType)}),i.s=_e),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,s){var a=s||{};make_ssf();var i=debom(xlml_normalize(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(i=utf8read(i));var o=i.slice(0,1024).toLowerCase(),c=!1;if(o=o.replace(/".*?"/g,""),(o.indexOf(">")&1023)>Math.min(o.indexOf(",")&1023,o.indexOf(";")&1023)){var d=dup(a);return d.type="string",PRN.to_workbook(i,d)}if(o.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Zt){o.indexOf("<"+Zt)>=0&&(c=!0)}),c)return html_to_workbook(i,a);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var h,g=[],_,b={},j=[],_e=a.dense?[]:{},tt="",rt={},et={},st=xlml_parsexmltag('<Data ss:Type="String">'),at=0,it=0,nt=0,ot={s:{r:2e6,c:2e6},e:{r:0,c:0}},dt={},ht={},lt="",gt=0,yt=[],Tt={},mt={},Et=0,Ft=[],Vt=[],Mt={},Ct=[],kt,jt=!1,ut=[],Lt=[],Pt={},ft=0,Rt=0,bt={Sheets:[],WBProps:{date1904:!1}},At={};xlmlregex.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var Ut="";h=xlmlregex.exec(i);)switch(h[3]=(Ut=h[3]).toLowerCase()){case"data":if(Ut=="data"){if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&g.push([h[3],!0]);break}if(g[g.length-1][1])break;h[1]==="/"?parse_xlml_data(i.slice(at,h.index),lt,st,g[g.length-1][0]=="comment"?Mt:rt,{c:it,r:nt},dt,Ct[it],et,ut,a):(lt="",st=xlml_parsexmltag(h[0]),at=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(Vt.length>0&&(rt.c=Vt),(!a.sheetRows||a.sheetRows>nt)&&rt.v!==void 0&&(a.dense?(_e[nt]||(_e[nt]=[]),_e[nt][it]=rt):_e[encode_col(it)+encode_row(nt)]=rt),rt.HRef&&(rt.l={Target:unescapexml(rt.HRef)},rt.HRefScreenTip&&(rt.l.Tooltip=rt.HRefScreenTip),delete rt.HRef,delete rt.HRefScreenTip),(rt.MergeAcross||rt.MergeDown)&&(ft=it+(parseInt(rt.MergeAcross,10)|0),Rt=nt+(parseInt(rt.MergeDown,10)|0),yt.push({s:{c:it,r:nt},e:{c:ft,r:Rt}})),!a.sheetStubs)rt.MergeAcross?it=ft+1:++it;else if(rt.MergeAcross||rt.MergeDown){for(var Xt=it;Xt<=ft;++Xt)for(var Gt=nt;Gt<=Rt;++Gt)(Xt>it||Gt>nt)&&(a.dense?(_e[Gt]||(_e[Gt]=[]),_e[Gt][Xt]={t:"z"}):_e[encode_col(Xt)+encode_row(Gt)]={t:"z"});it=ft+1}else++it;else rt=xlml_parsexmltagobj(h[0]),rt.Index&&(it=+rt.Index-1),it<ot.s.c&&(ot.s.c=it),it>ot.e.c&&(ot.e.c=it),h[0].slice(-2)==="/>"&&++it,Vt=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(nt<ot.s.r&&(ot.s.r=nt),nt>ot.e.r&&(ot.e.r=nt),h[0].slice(-2)==="/>"&&(et=xlml_parsexmltag(h[0]),et.Index&&(nt=+et.Index-1)),it=0,++nt):(et=xlml_parsexmltag(h[0]),et.Index&&(nt=+et.Index-1),Pt={},(et.AutoFitHeight=="0"||et.Height)&&(Pt.hpx=parseInt(et.Height,10),Pt.hpt=px2pt(Pt.hpx),Lt[nt]=Pt),et.Hidden=="1"&&(Pt.hidden=!0,Lt[nt]=Pt));break;case"worksheet":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"));j.push(tt),ot.s.r<=ot.e.r&&ot.s.c<=ot.e.c&&(_e["!ref"]=encode_range(ot),a.sheetRows&&a.sheetRows<=ot.e.r&&(_e["!fullref"]=_e["!ref"],ot.e.r=a.sheetRows-1,_e["!ref"]=encode_range(ot))),yt.length&&(_e["!merges"]=yt),Ct.length>0&&(_e["!cols"]=Ct),Lt.length>0&&(_e["!rows"]=Lt),b[tt]=_e}else ot={s:{r:2e6,c:2e6},e:{r:0,c:0}},nt=it=0,g.push([h[3],!1]),_=xlml_parsexmltag(h[0]),tt=unescapexml(_.Name),_e=a.dense?[]:{},yt=[],ut=[],Lt=[],At={name:tt,Hidden:0},bt.Sheets.push(At);break;case"table":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"))}else{if(h[0].slice(-2)=="/>")break;g.push([h[3],!1]),Ct=[],jt=!1}break;case"style":h[1]==="/"?process_style_xlml(dt,ht,a):ht=xlml_parsexmltag(h[0]);break;case"numberformat":ht.nf=unescapexml(xlml_parsexmltag(h[0]).Format||"General"),XLMLFormatMap[ht.nf]&&(ht.nf=XLMLFormatMap[ht.nf]);for(var zt=0;zt!=392&&table_fmt[zt]!=ht.nf;++zt);if(zt==392){for(zt=57;zt!=392;++zt)if(table_fmt[zt]==null){SSF_load(ht.nf,zt);break}}break;case"column":if(g[g.length-1][0]!=="table")break;if(kt=xlml_parsexmltag(h[0]),kt.Hidden&&(kt.hidden=!0,delete kt.Hidden),kt.Width&&(kt.wpx=parseInt(kt.Width,10)),!jt&&kt.wpx>10){jt=!0,MDW=DEF_MDW;for(var Wt=0;Wt<Ct.length;++Wt)Ct[Wt]&&process_col(Ct[Wt])}jt&&process_col(kt),Ct[kt.Index-1||Ct.length]=kt;for(var er=0;er<+kt.Span;++er)Ct[Ct.length]=dup(kt);break;case"namedrange":if(h[1]==="/")break;bt.Names||(bt.Names=[]);var St=parsexmltag(h[0]),ir={Name:St.Name,Ref:rc_to_a1(St.RefersTo.slice(1),{r:0,c:0})};bt.Sheets.length>0&&(ir.Sheet=bt.Sheets.length-1),bt.Names.push(ir);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?lt+=i.slice(gt,h.index):gt=h.index+h[0].length;break;case"interior":if(!a.cellStyles)break;ht.Interior=xlml_parsexmltag(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?xlml_set_prop(Tt,Ut,i.slice(Et,h.index)):Et=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"))}else g.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"));xlml_clean_comment(Mt),Vt.push(Mt)}else g.push([h[3],!1]),_=xlml_parsexmltag(h[0]),Mt={a:_.Author};break;case"autofilter":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"))}else if(h[0].charAt(h[0].length-2)!=="/"){var nr=xlml_parsexmltag(h[0]);_e["!autofilter"]={ref:rc_to_a1(nr.Range).replace(/\$/g,"")},g.push([h[3],!0])}break;case"name":break;case"datavalidation":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&g.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((_=g.pop())[0]!==h[3])throw new Error("Bad state: "+_.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&g.push([h[3],!0]);break;case"null":break;default:if(g.length==0&&h[3]=="document"||g.length==0&&h[3]=="uof")return parse_fods(i,a);var ar=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ar=!1}break;case"componentoptions":switch(h[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ar=!1}break;case"excelworkbook":switch(h[3]){case"date1904":bt.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ar=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":break;case"height":break;case"width":break;default:ar=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(i.slice(Et,h.index)){case"SheetHidden":At.Hidden=1;break;case"SheetVeryHidden":At.Hidden=2;break}else Et=h.index+h[0].length;break;case"header":_e["!margins"]||default_margins(_e["!margins"]={},"xlml"),isNaN(+parsexmltag(h[0]).Margin)||(_e["!margins"].header=+parsexmltag(h[0]).Margin);break;case"footer":_e["!margins"]||default_margins(_e["!margins"]={},"xlml"),isNaN(+parsexmltag(h[0]).Margin)||(_e["!margins"].footer=+parsexmltag(h[0]).Margin);break;case"pagemargins":var $t=parsexmltag(h[0]);_e["!margins"]||default_margins(_e["!margins"]={},"xlml"),isNaN(+$t.Top)||(_e["!margins"].top=+$t.Top),isNaN(+$t.Left)||(_e["!margins"].left=+$t.Left),isNaN(+$t.Right)||(_e["!margins"].right=+$t.Right),isNaN(+$t.Bottom)||(_e["!margins"].bottom=+$t.Bottom);break;case"displayrighttoleft":bt.Views||(bt.Views=[]),bt.Views[0]||(bt.Views[0]={}),bt.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_e["!outline"]||(_e["!outline"]={}),_e["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_e["!outline"]||(_e["!outline"]={}),_e["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ar=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ar=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ar=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ar=!1}break;case"querytable":switch(h[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ar=!1}break;case"datavalidation":switch(h[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ar=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ar=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ar=!1}break;case"smarttags":break;default:ar=!1;break}if(ar||h[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?xlml_set_custprop(mt,Ut,Ft,i.slice(Et,h.index)):(Ft=h,Et=h.index+h[0].length);break}if(a.WTF)throw"Unrecognized tag: "+h[3]+"|"+g.join("|")}var Nt={};return!a.bookSheets&&!a.bookProps&&(Nt.Sheets=b),Nt.SheetNames=j,Nt.Workbook=bt,Nt.SSF=dup(table_fmt),Nt.Props=Tt,Nt.Custprops=mt,Nt}function parse_xlml(e,s){switch(fix_read_opts(s=s||{}),s.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),s);case"binary":case"buffer":case"file":return parse_xlml_xml(e,s);case"array":return parse_xlml_xml(a2s(e),s)}}function write_props_xlml(e,s){var a=[];return e.Props&&a.push(xlml_write_docprops(e.Props,s)),e.Custprops&&a.push(xlml_write_custprops(e.Props,e.Custprops)),a.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,s){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return s.cellXfs.forEach(function(i,o){var c=[];c.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[i.numFmtId])}));var d={"ss:ID":"s"+(21+o)};a.push(writextag("Style",c.join(""),d))}),writextag("Styles",a.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var s=e.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||a.push(write_name_xlml(o)))}return writextag("Names",a.join(""))}function write_ws_xlml_names(e,s,a,i){if(!e||!((i||{}).Workbook||{}).Names)return"";for(var o=i.Workbook.Names,c=[],d=0;d<o.length;++d){var h=o[d];h.Sheet==a&&(h.Name.match(/^_xlfn\./)||c.push(write_name_xlml(h)))}return c.join("")}function write_ws_xlml_wsopts(e,s,a,i){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[a])if(i.Workbook.Sheets[a].Hidden)o.push(writextag("Visible",i.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<a&&!(i.Workbook.Sheets[c]&&!i.Workbook.Sheets[c].Hidden);++c);c==a&&o.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(writetag("ProtectContents","True")),e["!protect"].objects&&o.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&o.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?o.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&o.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(d){e["!protect"][d[0]]&&o.push("<"+d[1]+"/>")})),o.length==0?"":writextag("WorksheetOptions",o.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(s){var a=xlml_unfixstr(s.t||""),i=writextag("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",i,{"ss:Author":s.a})}).join("")}function write_ws_xlml_cell(e,s,a,i,o,c,d){if(!e||e.v==null&&e.f==null)return"";var h={};if(e.f&&(h["ss:Formula"]="="+escapexml(a1_to_rc(e.f,d))),e.F&&e.F.slice(0,s.length)==s){var g=decode_cell(e.F.slice(s.length+1));h["ss:ArrayRange"]="RC:R"+(g.r==d.r?"":"["+(g.r-d.r)+"]")+"C"+(g.c==d.c?"":"["+(g.c-d.c)+"]")}if(e.l&&e.l.Target&&(h["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(h["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),a["!merges"])for(var _=a["!merges"],b=0;b!=_.length;++b)_[b].s.c!=d.c||_[b].s.r!=d.r||(_[b].e.c>_[b].s.c&&(h["ss:MergeAcross"]=_[b].e.c-_[b].s.c),_[b].e.r>_[b].s.r&&(h["ss:MergeDown"]=_[b].e.r-_[b].s.r));var j="",_e="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":j="Number",_e=String(e.v);break;case"b":j="Boolean",_e=e.v?"1":"0";break;case"e":j="Error",_e=BErr[e.v];break;case"d":j="DateTime",_e=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":j="String",_e=escapexlml(e.v||"");break}var tt=get_cell_style(i.cellXfs,e,i);h["ss:StyleID"]="s"+(21+tt),h["ss:Index"]=d.c+1;var rt=e.v!=null?_e:"",et=e.t=="z"?"":'<Data ss:Type="'+j+'">'+rt+"</Data>";return(e.c||[]).length>0&&(et+=write_ws_xlml_comment(e.c)),writextag("Cell",et,h)}function write_ws_xlml_row(e,s){var a='<Row ss:Index="'+(e+1)+'"';return s&&(s.hpt&&!s.hpx&&(s.hpx=pt2px(s.hpt)),s.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+s.hpx+'"'),s.hidden&&(a+=' ss:Hidden="1"')),a+">"}function write_ws_xlml_table(e,s,a,i){if(!e["!ref"])return"";var o=safe_decode_range(e["!ref"]),c=e["!merges"]||[],d=0,h=[];e["!cols"]&&e["!cols"].forEach(function(st,at){process_col(st);var it=!!st.width,nt=col_obj_w(at,st),ot={"ss:Index":at+1};it&&(ot["ss:Width"]=width2px(nt.width)),st.hidden&&(ot["ss:Hidden"]="1"),h.push(writextag("Column",null,ot))});for(var g=Array.isArray(e),_=o.s.r;_<=o.e.r;++_){for(var b=[write_ws_xlml_row(_,(e["!rows"]||[])[_])],j=o.s.c;j<=o.e.c;++j){var _e=!1;for(d=0;d!=c.length;++d)if(!(c[d].s.c>j)&&!(c[d].s.r>_)&&!(c[d].e.c<j)&&!(c[d].e.r<_)){(c[d].s.c!=j||c[d].s.r!=_)&&(_e=!0);break}if(!_e){var tt={r:_,c:j},rt=encode_cell(tt),et=g?(e[_]||[])[j]:e[rt];b.push(write_ws_xlml_cell(et,rt,e,s,a,i,tt))}}b.push("</Row>"),b.length>2&&h.push(b.join(""))}return h.join("")}function write_ws_xlml(e,s,a){var i=[],o=a.SheetNames[e],c=a.Sheets[o],d=c?write_ws_xlml_names(c,s,e,a):"";return d.length>0&&i.push("<Names>"+d+"</Names>"),d=c?write_ws_xlml_table(c,s,e,a):"",d.length>0&&i.push("<Table>"+d+"</Table>"),i.push(write_ws_xlml_wsopts(c,s,e,a)),i.join("")}function write_xlml(e,s){s||(s={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),s.revssf=evert_num(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF,s.cellXfs=[],get_cell_style(s.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(write_props_xlml(e,s)),a.push(write_wb_xlml()),a.push(""),a.push("");for(var i=0;i<e.SheetNames.length;++i)a.push(writextag("Worksheet",write_ws_xlml(i,s,e),{"ss:Name":escapexml(e.SheetNames[i])}));return a[2]=write_sty_xlml(e,s),a[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",a.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(e){var s={},a=e.content;if(a.l=28,s.AnsiUserType=a.read_shift(0,"lpstr-ansi"),s.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(a),a.length-a.l<=4)return s;var i=a.read_shift(4);if(i==0||i>40||(a.l-=4,s.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(i=a.read_shift(4),i!==1907505652)||(s.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(a),i=a.read_shift(4),i==0||i>40))return s;a.l-=4,s.Reserved2=a.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,s,a,i,o){var c=i,d=[],h=a.slice(a.l,a.l+c);if(o&&o.enc&&o.enc.insitu&&h.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:o.enc.insitu(h)}d.push(h),a.l+=c;for(var g=__readUInt16LE(a,a.l),_=XLSRecordEnum[g],b=0;_!=null&&CONTINUE_RT.indexOf(g)>-1;)c=__readUInt16LE(a,a.l+2),b=a.l+4,g==2066?b+=4:(g==2165||g==2175)&&(b+=12),h=a.slice(b,a.l+4+c),d.push(h),a.l+=4+c,_=XLSRecordEnum[g=__readUInt16LE(a,a.l)];var j=bconcat(d);prep_blob(j,0);var _e=0;j.lens=[];for(var tt=0;tt<d.length;++tt)j.lens.push(_e),_e+=d[tt].length;if(j.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+j.length+" < "+i;return s.f(j,j.length,o)}function safe_format_xf(e,s,a){if(e.t!=="z"&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,s.cellNF&&(e.z=table_fmt[i])}catch(c){if(s.WTF)throw c}if(!s||s.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:i===0||i=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(i,e.v,{date1904:!!a,dateNF:s&&s.dateNF})}catch(c){if(s.WTF)throw c}if(s.cellDates&&i&&e.t=="n"&&fmt_is_date(table_fmt[i]||String(i))){var o=SSF_parse_date_code(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}}function make_cell(e,s,a){return{v:e,ixfe:s,t:a}}function parse_workbook(e,s){var a={opts:{}},i={},o=s.dense?[]:{},c={},d={},h=null,g=[],_="",b={},j,_e="",tt,rt,et,st,at={},it=[],nt,ot,dt=[],ht=[],lt={Sheets:[],WBProps:{date1904:!1},Views:[{}]},gt={},yt=function(rr){return rr<8?XLSIcv[rr]:rr<64&&ht[rr-8]||XLSIcv[rr]},Tt=function(rr,ur,mr){var fr=ur.XF.data;if(!(!fr||!fr.patternType||!mr||!mr.cellStyles)){ur.s={},ur.s.patternType=fr.patternType;var Sr;(Sr=rgb2Hex(yt(fr.icvFore)))&&(ur.s.fgColor={rgb:Sr}),(Sr=rgb2Hex(yt(fr.icvBack)))&&(ur.s.bgColor={rgb:Sr})}},mt=function(rr,ur,mr){if(!(Pt>1)&&!(mr.sheetRows&&rr.r>=mr.sheetRows)){if(mr.cellStyles&&ur.XF&&ur.XF.data&&Tt(rr,ur,mr),delete ur.ixfe,delete ur.XF,j=rr,_e=encode_cell(rr),(!d||!d.s||!d.e)&&(d={s:{r:0,c:0},e:{r:0,c:0}}),rr.r<d.s.r&&(d.s.r=rr.r),rr.c<d.s.c&&(d.s.c=rr.c),rr.r+1>d.e.r&&(d.e.r=rr.r+1),rr.c+1>d.e.c&&(d.e.c=rr.c+1),mr.cellFormula&&ur.f){for(var fr=0;fr<it.length;++fr)if(!(it[fr][0].s.c>rr.c||it[fr][0].s.r>rr.r)&&!(it[fr][0].e.c<rr.c||it[fr][0].e.r<rr.r)){ur.F=encode_range(it[fr][0]),(it[fr][0].s.c!=rr.c||it[fr][0].s.r!=rr.r)&&delete ur.f,ur.f&&(ur.f=""+stringify_formula(it[fr][1],d,rr,ut,Et));break}}mr.dense?(o[rr.r]||(o[rr.r]=[]),o[rr.r][rr.c]=ur):o[_e]=ur}},Et={enc:!1,sbcch:0,snames:[],sharedf:at,arrayf:it,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!s&&!!s.cellStyles,WTF:!!s&&!!s.wtf};s.password&&(Et.password=s.password);var Ft,Vt=[],Mt=[],Ct=[],kt=[],jt=!1,ut=[];ut.SheetNames=Et.snames,ut.sharedf=Et.sharedf,ut.arrayf=Et.arrayf,ut.names=[],ut.XTI=[];var Lt=0,Pt=0,ft=0,Rt=[],bt=[],At;Et.codepage=1200,set_cp(1200);for(var Ut=!1;e.l<e.length-1;){var Xt=e.l,Gt=e.read_shift(2);if(Gt===0&&Lt===10)break;var zt=e.l===e.length?0:e.read_shift(2),Wt=XLSRecordEnum[Gt];if(Wt&&Wt.f){if(s.bookSheets&&Lt===133&&Gt!==133)break;if(Lt=Gt,Wt.r===2||Wt.r==12){var er=e.read_shift(2);if(zt-=2,!Et.enc&&er!==Gt&&((er&255)<<8|er>>8)!==Gt)throw new Error("rt mismatch: "+er+"!="+Gt);Wt.r==12&&(e.l+=10,zt-=10)}var St={};if(Gt===10?St=Wt.f(e,zt,Et):St=slurp(Gt,Wt,e,zt,Et),Pt==0&&[9,521,1033,2057].indexOf(Lt)===-1)continue;switch(Gt){case 34:a.opts.Date1904=lt.WBProps.date1904=St;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(Et.enc||(e.l=0),Et.enc=St,!s.password)throw new Error("File is password-protected");if(St.valid==null)throw new Error("Encryption scheme unsupported");if(!St.valid)throw new Error("Password is incorrect");break;case 92:Et.lastuser=St;break;case 66:var ir=Number(St);switch(ir){case 21010:ir=1200;break;case 32768:ir=1e4;break;case 32769:ir=1252;break}set_cp(Et.codepage=ir),Ut=!0;break;case 317:Et.rrtabid=St;break;case 25:Et.winlocked=St;break;case 439:a.opts.RefreshAll=St;break;case 12:a.opts.CalcCount=St;break;case 16:a.opts.CalcDelta=St;break;case 17:a.opts.CalcIter=St;break;case 13:a.opts.CalcMode=St;break;case 14:a.opts.CalcPrecision=St;break;case 95:a.opts.CalcSaveRecalc=St;break;case 15:Et.CalcRefMode=St;break;case 2211:a.opts.FullCalc=St;break;case 129:St.fDialog&&(o["!type"]="dialog"),St.fBelow||((o["!outline"]||(o["!outline"]={})).above=!0),St.fRight||((o["!outline"]||(o["!outline"]={})).left=!0);break;case 224:dt.push(St);break;case 430:ut.push([St]),ut[ut.length-1].XTI=[];break;case 35:case 547:ut[ut.length-1].push(St);break;case 24:case 536:At={Name:St.Name,Ref:stringify_formula(St.rgce,d,null,ut,Et)},St.itab>0&&(At.Sheet=St.itab-1),ut.names.push(At),ut[0]||(ut[0]=[],ut[0].XTI=[]),ut[ut.length-1].push(St),St.Name=="_xlnm._FilterDatabase"&&St.itab>0&&St.rgce&&St.rgce[0]&&St.rgce[0][0]&&St.rgce[0][0][0]=="PtgArea3d"&&(bt[St.itab-1]={ref:encode_range(St.rgce[0][0][1][2])});break;case 22:Et.ExternCount=St;break;case 23:ut.length==0&&(ut[0]=[],ut[0].XTI=[]),ut[ut.length-1].XTI=ut[ut.length-1].XTI.concat(St),ut.XTI=ut.XTI.concat(St);break;case 2196:if(Et.biff<8)break;At!=null&&(At.Comment=St[1]);break;case 18:o["!protect"]=St;break;case 19:St!==0&&Et.WTF&&console.error("Password verifier: "+St);break;case 133:c[St.pos]=St,Et.snames.push(St.name);break;case 10:{if(--Pt)break;if(d.e){if(d.e.r>0&&d.e.c>0){if(d.e.r--,d.e.c--,o["!ref"]=encode_range(d),s.sheetRows&&s.sheetRows<=d.e.r){var nr=d.e.r;d.e.r=s.sheetRows-1,o["!fullref"]=o["!ref"],o["!ref"]=encode_range(d),d.e.r=nr}d.e.r++,d.e.c++}Vt.length>0&&(o["!merges"]=Vt),Mt.length>0&&(o["!objects"]=Mt),Ct.length>0&&(o["!cols"]=Ct),kt.length>0&&(o["!rows"]=kt),lt.Sheets.push(gt)}_===""?b=o:i[_]=o,o=s.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Et.biff===8&&(Et.biff={9:2,521:3,1033:4}[Gt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[St.BIFFVer]||8),Et.biffguess=St.BIFFVer==0,St.BIFFVer==0&&St.dt==4096&&(Et.biff=5,Ut=!0,set_cp(Et.codepage=28591)),Et.biff==8&&St.BIFFVer==0&&St.dt==16&&(Et.biff=2),Pt++)break;if(o=s.dense?[]:{},Et.biff<8&&!Ut&&(Ut=!0,set_cp(Et.codepage=s.codepage||1252)),Et.biff<5||St.BIFFVer==0&&St.dt==4096){_===""&&(_="Sheet1"),d={s:{r:0,c:0},e:{r:0,c:0}};var ar={pos:e.l-zt,name:_};c[ar.pos]=ar,Et.snames.push(_)}else _=(c[Xt]||{name:""}).name;St.dt==32&&(o["!type"]="chart"),St.dt==64&&(o["!type"]="macro"),Vt=[],Mt=[],Et.arrayf=it=[],Ct=[],kt=[],jt=!1,gt={Hidden:(c[Xt]||{hs:0}).hs,name:_}}break;case 515:case 3:case 2:o["!type"]=="chart"&&(s.dense?(o[St.r]||[])[St.c]:o[encode_cell({c:St.c,r:St.r})])&&++St.c,nt={ixfe:St.ixfe,XF:dt[St.ixfe]||{},v:St.val,t:"n"},ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:St.c,r:St.r},nt,s);break;case 5:case 517:nt={ixfe:St.ixfe,XF:dt[St.ixfe],v:St.val,t:St.t},ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:St.c,r:St.r},nt,s);break;case 638:nt={ixfe:St.ixfe,XF:dt[St.ixfe],v:St.rknum,t:"n"},ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:St.c,r:St.r},nt,s);break;case 189:for(var $t=St.c;$t<=St.C;++$t){var Nt=St.rkrec[$t-St.c][0];nt={ixfe:Nt,XF:dt[Nt],v:St.rkrec[$t-St.c][1],t:"n"},ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:$t,r:St.r},nt,s)}break;case 6:case 518:case 1030:{if(St.val=="String"){h=St;break}if(nt=make_cell(St.val,St.cell.ixfe,St.tt),nt.XF=dt[nt.ixfe],s.cellFormula){var Zt=St.formula;if(Zt&&Zt[0]&&Zt[0][0]&&Zt[0][0][0]=="PtgExp"){var sr=Zt[0][0][1][0],cr=Zt[0][0][1][1],dr=encode_cell({r:sr,c:cr});at[dr]?nt.f=""+stringify_formula(St.formula,d,St.cell,ut,Et):nt.F=((s.dense?(o[sr]||[])[cr]:o[dr])||{}).F}else nt.f=""+stringify_formula(St.formula,d,St.cell,ut,Et)}ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt(St.cell,nt,s),h=St}break;case 7:case 519:if(h)h.val=St,nt=make_cell(St,h.cell.ixfe,"s"),nt.XF=dt[nt.ixfe],s.cellFormula&&(nt.f=""+stringify_formula(h.formula,d,h.cell,ut,Et)),ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt(h.cell,nt,s),h=null;else throw new Error("String record expects Formula");break;case 33:case 545:{it.push(St);var Er=encode_cell(St[0].s);if(tt=s.dense?(o[St[0].s.r]||[])[St[0].s.c]:o[Er],s.cellFormula&&tt){if(!h||!Er||!tt)break;tt.f=""+stringify_formula(St[1],d,St[0],ut,Et),tt.F=encode_range(St[0])}}break;case 1212:{if(!s.cellFormula)break;if(_e){if(!h)break;at[encode_cell(h.cell)]=St[0],tt=s.dense?(o[h.cell.r]||[])[h.cell.c]:o[encode_cell(h.cell)],(tt||{}).f=""+stringify_formula(St[0],d,j,ut,Et)}}break;case 253:nt=make_cell(g[St.isst].t,St.ixfe,"s"),g[St.isst].h&&(nt.h=g[St.isst].h),nt.XF=dt[nt.ixfe],ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:St.c,r:St.r},nt,s);break;case 513:s.sheetStubs&&(nt={ixfe:St.ixfe,XF:dt[St.ixfe],t:"z"},ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:St.c,r:St.r},nt,s));break;case 190:if(s.sheetStubs)for(var gr=St.c;gr<=St.C;++gr){var xr=St.ixfe[gr-St.c];nt={ixfe:xr,XF:dt[xr],t:"z"},ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:gr,r:St.r},nt,s)}break;case 214:case 516:case 4:nt=make_cell(St.val,St.ixfe,"s"),nt.XF=dt[nt.ixfe],ft>0&&(nt.z=Rt[nt.ixfe>>8&63]),safe_format_xf(nt,s,a.opts.Date1904),mt({c:St.c,r:St.r},nt,s);break;case 0:case 512:Pt===1&&(d=St);break;case 252:g=St;break;case 1054:if(Et.biff==4){Rt[ft++]=St[1];for(var vr=0;vr<ft+163&&table_fmt[vr]!=St[1];++vr);vr>=163&&SSF_load(St[1],ft+163)}else SSF_load(St[1],St[0]);break;case 30:{Rt[ft++]=St;for(var yr=0;yr<ft+163&&table_fmt[yr]!=St;++yr);yr>=163&&SSF_load(St,ft+163)}break;case 229:Vt=Vt.concat(St);break;case 93:Mt[St.cmo[0]]=Et.lastobj=St;break;case 438:Et.lastobj.TxO=St;break;case 127:Et.lastobj.ImData=St;break;case 440:for(st=St[0].s.r;st<=St[0].e.r;++st)for(et=St[0].s.c;et<=St[0].e.c;++et)tt=s.dense?(o[st]||[])[et]:o[encode_cell({c:et,r:st})],tt&&(tt.l=St[1]);break;case 2048:for(st=St[0].s.r;st<=St[0].e.r;++st)for(et=St[0].s.c;et<=St[0].e.c;++et)tt=s.dense?(o[st]||[])[et]:o[encode_cell({c:et,r:st})],tt&&tt.l&&(tt.l.Tooltip=St[1]);break;case 28:{if(Et.biff<=5&&Et.biff>=2)break;tt=s.dense?(o[St[0].r]||[])[St[0].c]:o[encode_cell(St[0])];var br=Mt[St[2]];tt||(s.dense?(o[St[0].r]||(o[St[0].r]=[]),tt=o[St[0].r][St[0].c]={t:"z"}):tt=o[encode_cell(St[0])]={t:"z"},d.e.r=Math.max(d.e.r,St[0].r),d.s.r=Math.min(d.s.r,St[0].r),d.e.c=Math.max(d.e.c,St[0].c),d.s.c=Math.min(d.s.c,St[0].c)),tt.c||(tt.c=[]),rt={a:St[1],t:br.TxO.t},tt.c.push(rt)}break;case 2173:update_xfext(dt[St.ixfe],St.ext);break;case 125:{if(!Et.cellStyles)break;for(;St.e>=St.s;)Ct[St.e--]={width:St.w/256,level:St.level||0,hidden:!!(St.flags&1)},jt||(jt=!0,find_mdw_colw(St.w/256)),process_col(Ct[St.e+1])}break;case 520:{var pr={};St.level!=null&&(kt[St.r]=pr,pr.level=St.level),St.hidden&&(kt[St.r]=pr,pr.hidden=!0),St.hpt&&(kt[St.r]=pr,pr.hpt=St.hpt,pr.hpx=pt2px(St.hpt))}break;case 38:case 39:case 40:case 41:o["!margins"]||default_margins(o["!margins"]={}),o["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Gt]]=St;break;case 161:o["!margins"]||default_margins(o["!margins"]={}),o["!margins"].header=St.header,o["!margins"].footer=St.footer;break;case 574:St.RTL&&(lt.Views[0].RTL=!0);break;case 146:ht=St;break;case 2198:Ft=St;break;case 140:ot=St;break;case 442:_?gt.CodeName=St||gt.name:lt.WBProps.CodeName=St||"ThisWorkbook";break}}else Wt||console.error("Missing Info for XLS Record 0x"+Gt.toString(16)),e.l+=zt}return a.SheetNames=keys(c).sort(function(_r,rr){return Number(_r)-Number(rr)}).map(function(_r){return c[_r].name}),s.bookSheets||(a.Sheets=i),!a.SheetNames.length&&b["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=b)):a.Preamble=b,a.Sheets&&bt.forEach(function(_r,rr){a.Sheets[a.SheetNames[rr]]["!autofilter"]=_r}),a.Strings=g,a.SSF=dup(table_fmt),Et.enc&&(a.Encryption=Et.enc),Ft&&(a.Themes=Ft),a.Metadata={},ot!==void 0&&(a.Metadata.Country=ot),ut.names.length>0&&(lt.Names=ut.names),a.Workbook=lt,a}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,s,a){var i=CFB.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var o=parse_PropertySetStream(i,DocSummaryPIDDSI,PSCLSID.DSI);for(var c in o)s[c]=o[c]}catch(_){if(a.WTF)throw _}var d=CFB.find(e,"/!SummaryInformation");if(d&&d.size>0)try{var h=parse_PropertySetStream(d,SummaryPIDSI,PSCLSID.SI);for(var g in h)s[g]==null&&(s[g]=h[g])}catch(_){if(a.WTF)throw _}s.HeadingPairs&&s.TitlesOfParts&&(load_props_pairs(s.HeadingPairs,s.TitlesOfParts,s,a),delete s.HeadingPairs,delete s.TitlesOfParts)}function write_xls_props(e,s){var a=[],i=[],o=[],c=0,d,h=evert_key(DocSummaryPIDDSI,"n"),g=evert_key(SummaryPIDSI,"n");if(e.Props)for(d=keys(e.Props),c=0;c<d.length;++c)(Object.prototype.hasOwnProperty.call(h,d[c])?a:Object.prototype.hasOwnProperty.call(g,d[c])?i:o).push([d[c],e.Props[d[c]]]);if(e.Custprops)for(d=keys(e.Custprops),c=0;c<d.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},d[c])||(Object.prototype.hasOwnProperty.call(h,d[c])?a:Object.prototype.hasOwnProperty.call(g,d[c])?i:o).push([d[c],e.Custprops[d[c]]]);var _=[];for(c=0;c<o.length;++c)XLSPSSkip.indexOf(o[c][0])>-1||PseudoPropsPairs.indexOf(o[c][0])>-1||o[c][1]!=null&&_.push(o[c]);i.length&&CFB.utils.cfb_add(s,"/SummaryInformation",write_PropertySetStream(i,PSCLSID.SI,g,SummaryPIDSI)),(a.length||_.length)&&CFB.utils.cfb_add(s,"/DocumentSummaryInformation",write_PropertySetStream(a,PSCLSID.DSI,h,DocSummaryPIDDSI,_.length?_:null,PSCLSID.UDI))}function parse_xlscfb(e,s){s||(s={}),fix_read_opts(s),reset_cp(),s.codepage&&set_ansi(s.codepage);var a,i;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");a=CFB.find(e,"!CompObj"),i=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(s.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),i={content:e}}var o,c;if(a&&parse_compobj(a),s.bookProps&&!s.bookSheets)o={};else{var d=has_buf?"buffer":"array";if(i&&i.content)o=parse_workbook(i.content,s);else if((c=CFB.find(e,"PerfectOffice_MAIN"))&&c.content)o=WK_.to_workbook(c.content,(s.type=d,s));else if((c=CFB.find(e,"NativeContent_MAIN"))&&c.content)o=WK_.to_workbook(c.content,(s.type=d,s));else throw(c=CFB.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");s.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(o.vbaraw=make_vba_xls(e))}var h={};return e.FullPaths&&parse_xls_props(e,h,s),o.Props=o.Custprops=h,s.bookFiles&&(o.cfb=e),o}function write_xlscfb(e,s){var a=s||{},i=CFB.utils.cfb_new({root:"R"}),o="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":o="/Workbook",a.biff=8;break;case"biff5":o="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return CFB.utils.cfb_add(i,o,write_biff_buf(e,a)),a.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,i),a.biff==8&&e.vbaraw&&fill_vba_xls(i,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),i}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,s,a,i){var o=s;if(!isNaN(o)){var c=i||(a||[]).length||0,d=e.next(4);d.write_shift(2,o),d.write_shift(2,c),c>0&&is_buf(a)&&e.push(a)}}function write_biff_continue(e,s,a,i){var o=(a||[]).length||0;if(o<=8224)return write_biff_rec(e,s,a,o);var c=s;if(!isNaN(c)){for(var d=a.parts||[],h=0,g=0,_=0;_+(d[h]||8224)<=8224;)_+=d[h]||8224,h++;var b=e.next(4);for(b.write_shift(2,c),b.write_shift(2,_),e.push(a.slice(g,g+_)),g+=_;g<o;){for(b=e.next(4),b.write_shift(2,60),_=0;_+(d[h]||8224)<=8224;)_+=d[h]||8224,h++;b.write_shift(2,_),e.push(a.slice(g,g+_)),g+=_}}}function write_BIFF2Cell(e,s,a){return e||(e=new_buf(7)),e.write_shift(2,s),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,s,a,i){var o=new_buf(9);return write_BIFF2Cell(o,e,s),write_Bes(a,i||"b",o),o}function write_BIFF2LABEL(e,s,a){var i=new_buf(8+2*a.length);return write_BIFF2Cell(i,e,s),i.write_shift(1,a.length),i.write_shift(a.length,a,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function write_ws_biff2_cell(e,s,a,i){if(s.v!=null)switch(s.t){case"d":case"n":var o=s.t=="d"?datenum(parseDate(s.v)):s.v;o==(o|0)&&o>=0&&o<65536?write_biff_rec(e,2,write_BIFF2INT(a,i,o)):write_biff_rec(e,3,write_BIFF2NUM(a,i,o));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(a,i,s.v,s.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(a,i,(s.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,a,i))}function write_ws_biff2(e,s,a,i){var o=Array.isArray(s),c=safe_decode_range(s["!ref"]||"A1"),d,h="",g=[];if(c.e.c>255||c.e.r>16383){if(i.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),d=encode_range(c)}for(var _=c.s.r;_<=c.e.r;++_){h=encode_row(_);for(var b=c.s.c;b<=c.e.c;++b){_===c.s.r&&(g[b]=encode_col(b)),d=g[b]+h;var j=o?(s[_]||[])[b]:s[d];j&&write_ws_biff2_cell(e,j,_,b)}}}function write_biff2_buf(e,s){for(var a=s||{},i=buf_array(),o=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==a.sheet&&(o=c);if(o==0&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return write_biff_rec(i,a.biff==4?1033:a.biff==3?521:9,write_BOF(e,16,a)),write_ws_biff2(i,e.Sheets[e.SheetNames[o]],o,a),write_biff_rec(i,10),i.end()}function write_FONTS_biff8(e,s,a){write_biff_rec(e,49,write_Font({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},a))}function write_FMTS_biff8(e,s,a){s&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var o=i[0];o<=i[1];++o)s[o]!=null&&write_biff_rec(e,1054,write_Format(o,s[o],a))})}function write_FEAT(e,s){var a=new_buf(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),write_biff_rec(e,2151,a),a=new_buf(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),write_Ref8U(safe_decode_range(s["!ref"]||"A1"),a),a.write_shift(4,4),write_biff_rec(e,2152,a)}function write_CELLXFS_biff8(e,s){for(var a=0;a<16;++a)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,s));s.cellXfs.forEach(function(i){write_biff_rec(e,224,write_XF(i,0,s))})}function write_ws_biff8_hlinks(e,s){for(var a=0;a<s["!links"].length;++a){var i=s["!links"][a];write_biff_rec(e,440,write_HLink(i)),i[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(i))}delete s["!links"]}function write_ws_cols_biff8(e,s){if(s){var a=0;s.forEach(function(i,o){++a<=256&&i&&write_biff_rec(e,125,write_ColInfo(col_obj_w(o,i),o))})}}function write_ws_biff8_cell(e,s,a,i,o){var c=16+get_cell_style(o.cellXfs,s,o);if(s.v==null&&!s.bf){write_biff_rec(e,513,write_XLSCell(a,i,c));return}if(s.bf)write_biff_rec(e,6,write_Formula(s,a,i,o,c));else switch(s.t){case"d":case"n":var d=s.t=="d"?datenum(parseDate(s.v)):s.v;write_biff_rec(e,515,write_Number(a,i,d,c));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(a,i,s.v,c,o,s.t));break;case"s":case"str":if(o.bookSST){var h=get_sst_id(o.Strings,s.v,o.revStrings);write_biff_rec(e,253,write_LabelSst(a,i,h,c))}else write_biff_rec(e,516,write_Label(a,i,(s.v||"").slice(0,255),c,o));break;default:write_biff_rec(e,513,write_XLSCell(a,i,c))}}function write_ws_biff8(e,s,a){var i=buf_array(),o=a.SheetNames[e],c=a.Sheets[o]||{},d=(a||{}).Workbook||{},h=(d.Sheets||[])[e]||{},g=Array.isArray(c),_=s.biff==8,b,j="",_e=[],tt=safe_decode_range(c["!ref"]||"A1"),rt=_?65536:16384;if(tt.e.c>255||tt.e.r>=rt){if(s.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");tt.e.c=Math.min(tt.e.c,255),tt.e.r=Math.min(tt.e.c,rt-1)}write_biff_rec(i,2057,write_BOF(a,16,s)),write_biff_rec(i,13,writeuint16(1)),write_biff_rec(i,12,writeuint16(100)),write_biff_rec(i,15,writebool(!0)),write_biff_rec(i,17,writebool(!1)),write_biff_rec(i,16,write_Xnum(.001)),write_biff_rec(i,95,writebool(!0)),write_biff_rec(i,42,writebool(!1)),write_biff_rec(i,43,writebool(!1)),write_biff_rec(i,130,writeuint16(1)),write_biff_rec(i,128,write_Guts()),write_biff_rec(i,131,writebool(!1)),write_biff_rec(i,132,writebool(!1)),_&&write_ws_cols_biff8(i,c["!cols"]),write_biff_rec(i,512,write_Dimensions(tt,s)),_&&(c["!links"]=[]);for(var et=tt.s.r;et<=tt.e.r;++et){j=encode_row(et);for(var st=tt.s.c;st<=tt.e.c;++st){et===tt.s.r&&(_e[st]=encode_col(st)),b=_e[st]+j;var at=g?(c[et]||[])[st]:c[b];at&&(write_ws_biff8_cell(i,at,et,st,s),_&&at.l&&c["!links"].push([b,at.l]))}}var it=h.CodeName||h.name||o;return _&&write_biff_rec(i,574,write_Window2((d.Views||[])[0])),_&&(c["!merges"]||[]).length&&write_biff_rec(i,229,write_MergeCells(c["!merges"])),_&&write_ws_biff8_hlinks(i,c),write_biff_rec(i,442,write_XLUnicodeString(it)),_&&write_FEAT(i,c),write_biff_rec(i,10),i.end()}function write_biff8_global(e,s,a){var i=buf_array(),o=(e||{}).Workbook||{},c=o.Sheets||[],d=o.WBProps||{},h=a.biff==8,g=a.biff==5;if(write_biff_rec(i,2057,write_BOF(e,5,a)),a.bookType=="xla"&&write_biff_rec(i,135),write_biff_rec(i,225,h?writeuint16(1200):null),write_biff_rec(i,193,writezeroes(2)),g&&write_biff_rec(i,191),g&&write_biff_rec(i,192),write_biff_rec(i,226),write_biff_rec(i,92,write_WriteAccess("SheetJS",a)),write_biff_rec(i,66,writeuint16(h?1200:1252)),h&&write_biff_rec(i,353,writeuint16(0)),h&&write_biff_rec(i,448),write_biff_rec(i,317,write_RRTabId(e.SheetNames.length)),h&&e.vbaraw&&write_biff_rec(i,211),h&&e.vbaraw){var _=d.CodeName||"ThisWorkbook";write_biff_rec(i,442,write_XLUnicodeString(_))}write_biff_rec(i,156,writeuint16(17)),write_biff_rec(i,25,writebool(!1)),write_biff_rec(i,18,writebool(!1)),write_biff_rec(i,19,writeuint16(0)),h&&write_biff_rec(i,431,writebool(!1)),h&&write_biff_rec(i,444,writeuint16(0)),write_biff_rec(i,61,write_Window1()),write_biff_rec(i,64,writebool(!1)),write_biff_rec(i,141,writeuint16(0)),write_biff_rec(i,34,writebool(safe1904(e)=="true")),write_biff_rec(i,14,writebool(!0)),h&&write_biff_rec(i,439,writebool(!1)),write_biff_rec(i,218,writeuint16(0)),write_FONTS_biff8(i,e,a),write_FMTS_biff8(i,e.SSF,a),write_CELLXFS_biff8(i,a),h&&write_biff_rec(i,352,writebool(!1));var b=i.end(),j=buf_array();h&&write_biff_rec(j,140,write_Country()),h&&a.Strings&&write_biff_continue(j,252,write_SST(a.Strings)),write_biff_rec(j,10);var _e=j.end(),tt=buf_array(),rt=0,et=0;for(et=0;et<e.SheetNames.length;++et)rt+=(h?12:11)+(h?2:1)*e.SheetNames[et].length;var st=b.length+rt+_e.length;for(et=0;et<e.SheetNames.length;++et){var at=c[et]||{};write_biff_rec(tt,133,write_BoundSheet8({pos:st,hs:at.Hidden||0,dt:0,name:e.SheetNames[et]},a)),st+=s[et].length}var it=tt.end();if(rt!=it.length)throw new Error("BS8 "+rt+" != "+it.length);var nt=[];return b.length&&nt.push(b),it.length&&nt.push(it),_e.length&&nt.push(_e),bconcat(nt)}function write_biff8_buf(e,s){var a=s||{},i=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),a.revssf=evert_num(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,fix_write_opts(a),a.cellXfs=[],get_cell_style(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)i[i.length]=write_ws_biff8(o,a,e);return i.unshift(write_biff8_global(e,i,a)),bconcat(i)}function write_biff_buf(e,s){for(var a=0;a<=e.SheetNames.length;++a){var i=e.Sheets[e.SheetNames[a]];if(!(!i||!i["!ref"])){var o=decode_range(i["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var c=s||{};switch(c.biff||2){case 8:case 5:return write_biff8_buf(e,s);case 4:case 3:case 2:return write_biff2_buf(e,s)}throw new Error("invalid type "+c.bookType+" for BIFF")}function html_to_sheet(e,s){var a=s||{},i=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var o=e.match(/<table/i);if(!o)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),d=o.index,h=c&&c.index||e.length,g=split_regex(e.slice(d,h),/(:?<tr[^>]*>)/i,"<tr>"),_=-1,b=0,j=0,_e=0,tt={s:{r:1e7,c:1e7},e:{r:0,c:0}},rt=[];for(d=0;d<g.length;++d){var et=g[d].trim(),st=et.slice(0,3).toLowerCase();if(st=="<tr"){if(++_,a.sheetRows&&a.sheetRows<=_){--_;break}b=0;continue}if(!(st!="<td"&&st!="<th")){var at=et.split(/<\/t[dh]>/i);for(h=0;h<at.length;++h){var it=at[h].trim();if(it.match(/<t[dh]/i)){for(var nt=it,ot=0;nt.charAt(0)=="<"&&(ot=nt.indexOf(">"))>-1;)nt=nt.slice(ot+1);for(var dt=0;dt<rt.length;++dt){var ht=rt[dt];ht.s.c==b&&ht.s.r<_&&_<=ht.e.r&&(b=ht.e.c+1,dt=-1)}var lt=parsexmltag(it.slice(0,it.indexOf(">")));_e=lt.colspan?+lt.colspan:1,((j=+lt.rowspan)>1||_e>1)&&rt.push({s:{r:_,c:b},e:{r:_+(j||1)-1,c:b+_e-1}});var gt=lt.t||lt["data-t"]||"";if(!nt.length){b+=_e;continue}if(nt=htmldecode(nt),tt.s.r>_&&(tt.s.r=_),tt.e.r<_&&(tt.e.r=_),tt.s.c>b&&(tt.s.c=b),tt.e.c<b&&(tt.e.c=b),!nt.length){b+=_e;continue}var yt={t:"s",v:nt};a.raw||!nt.trim().length||gt=="s"||(nt==="TRUE"?yt={t:"b",v:!0}:nt==="FALSE"?yt={t:"b",v:!1}:isNaN(fuzzynum(nt))?isNaN(fuzzydate(nt).getDate())||(yt={t:"d",v:parseDate(nt)},a.cellDates||(yt={t:"n",v:datenum(yt.v)}),yt.z=a.dateNF||table_fmt[14]):yt={t:"n",v:fuzzynum(nt)}),a.dense?(i[_]||(i[_]=[]),i[_][b]=yt):i[encode_cell({r:_,c:b})]=yt,b+=_e}}}}return i["!ref"]=encode_range(tt),rt.length&&(i["!merges"]=rt),i}function make_html_row(e,s,a,i){for(var o=e["!merges"]||[],c=[],d=s.s.c;d<=s.e.c;++d){for(var h=0,g=0,_=0;_<o.length;++_)if(!(o[_].s.r>a||o[_].s.c>d)&&!(o[_].e.r<a||o[_].e.c<d)){if(o[_].s.r<a||o[_].s.c<d){h=-1;break}h=o[_].e.r-o[_].s.r+1,g=o[_].e.c-o[_].s.c+1;break}if(!(h<0)){var b=encode_cell({r:a,c:d}),j=i.dense?(e[a]||[])[d]:e[b],_e=j&&j.v!=null&&(j.h||escapehtml(j.w||(format_cell(j),j.w)||""))||"",tt={};h>1&&(tt.rowspan=h),g>1&&(tt.colspan=g),i.editable?_e='<span contenteditable="true">'+_e+"</span>":j&&(tt["data-t"]=j&&j.t||"z",j.v!=null&&(tt["data-v"]=j.v),j.z!=null&&(tt["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(_e='<a href="'+j.l.Target+'">'+_e+"</a>")),tt.id=(i.id||"sjs")+"-"+b,c.push(writextag("td",_e,tt))}}var rt="<tr>";return rt+c.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,s){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return sheet_to_workbook(html_to_sheet(a[0],s),s);var i=book_new();return a.forEach(function(o,c){book_append_sheet(i,html_to_sheet(o,s),"Sheet"+(c+1))}),i}function make_html_preamble(e,s,a){var i=[];return i.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function sheet_to_html(e,s){var a=s||{},i=a.header!=null?a.header:HTML_BEGIN,o=a.footer!=null?a.footer:HTML_END,c=[i],d=decode_range(e["!ref"]);a.dense=Array.isArray(e),c.push(make_html_preamble(e,d,a));for(var h=d.s.r;h<=d.e.r;++h)c.push(make_html_row(e,d,h,a));return c.push("</table>"+o),c.join("")}function sheet_add_dom(e,s,a){var i=a||{},o=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var d=typeof i.origin=="string"?decode_cell(i.origin):i.origin;o=d.r,c=d.c}var h=s.getElementsByTagName("tr"),g=Math.min(i.sheetRows||1e7,h.length),_={s:{r:0,c:0},e:{r:o,c}};if(e["!ref"]){var b=decode_range(e["!ref"]);_.s.r=Math.min(_.s.r,b.s.r),_.s.c=Math.min(_.s.c,b.s.c),_.e.r=Math.max(_.e.r,b.e.r),_.e.c=Math.max(_.e.c,b.e.c),o==-1&&(_.e.r=o=b.e.r+1)}var j=[],_e=0,tt=e["!rows"]||(e["!rows"]=[]),rt=0,et=0,st=0,at=0,it=0,nt=0;for(e["!cols"]||(e["!cols"]=[]);rt<h.length&&et<g;++rt){var ot=h[rt];if(is_dom_element_hidden(ot)){if(i.display)continue;tt[et]={hidden:!0}}var dt=ot.children;for(st=at=0;st<dt.length;++st){var ht=dt[st];if(!(i.display&&is_dom_element_hidden(ht))){var lt=ht.hasAttribute("data-v")?ht.getAttribute("data-v"):ht.hasAttribute("v")?ht.getAttribute("v"):htmldecode(ht.innerHTML),gt=ht.getAttribute("data-z")||ht.getAttribute("z");for(_e=0;_e<j.length;++_e){var yt=j[_e];yt.s.c==at+c&&yt.s.r<et+o&&et+o<=yt.e.r&&(at=yt.e.c+1-c,_e=-1)}nt=+ht.getAttribute("colspan")||1,((it=+ht.getAttribute("rowspan")||1)>1||nt>1)&&j.push({s:{r:et+o,c:at+c},e:{r:et+o+(it||1)-1,c:at+c+(nt||1)-1}});var Tt={t:"s",v:lt},mt=ht.getAttribute("data-t")||ht.getAttribute("t")||"";lt!=null&&(lt.length==0?Tt.t=mt||"z":i.raw||lt.trim().length==0||mt=="s"||(lt==="TRUE"?Tt={t:"b",v:!0}:lt==="FALSE"?Tt={t:"b",v:!1}:isNaN(fuzzynum(lt))?isNaN(fuzzydate(lt).getDate())||(Tt={t:"d",v:parseDate(lt)},i.cellDates||(Tt={t:"n",v:datenum(Tt.v)}),Tt.z=i.dateNF||table_fmt[14]):Tt={t:"n",v:fuzzynum(lt)})),Tt.z===void 0&&gt!=null&&(Tt.z=gt);var Et="",Ft=ht.getElementsByTagName("A");if(Ft&&Ft.length)for(var Vt=0;Vt<Ft.length&&!(Ft[Vt].hasAttribute("href")&&(Et=Ft[Vt].getAttribute("href"),Et.charAt(0)!="#"));++Vt);Et&&Et.charAt(0)!="#"&&(Tt.l={Target:Et}),i.dense?(e[et+o]||(e[et+o]=[]),e[et+o][at+c]=Tt):e[encode_cell({c:at+c,r:et+o})]=Tt,_.e.c<at+c&&(_.e.c=at+c),at+=nt}}++et}return j.length&&(e["!merges"]=(e["!merges"]||[]).concat(j)),_.e.r=Math.max(_.e.r,et-1+o),e["!ref"]=encode_range(_),et>=g&&(e["!fullref"]=encode_range((_.e.r=h.length-rt+et-1+o,_))),e}function parse_dom_table(e,s){var a=s||{},i=a.dense?[]:{};return sheet_add_dom(i,e,s)}function table_to_book(e,s){return sheet_to_workbook(parse_dom_table(e,s),s)}function is_dom_element_hidden(e){var s="",a=get_get_computed_style_function(e);return a&&(s=a(e).getPropertyValue("display")),s||(s=e.style&&e.style.display),s==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var s=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,o){return Array(parseInt(o,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=unescapexml(s.replace(/<[^>]*>/g,""));return[a]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,s){var a=s||{},i=xlml_normalize(e),o=[],c,d,h={name:""},g="",_=0,b,j,_e={},tt=[],rt=a.dense?[]:{},et,st,at={value:""},it="",nt=0,ot=[],dt=-1,ht=-1,lt={s:{r:1e6,c:1e7},e:{r:0,c:0}},gt=0,yt={},Tt=[],mt={},Et=0,Ft=0,Vt=[],Mt=1,Ct=1,kt=[],jt={Names:[]},ut={},Lt=["",""],Pt=[],ft={},Rt="",bt=0,At=!1,Ut=!1,Xt=0;for(xlmlregex.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");et=xlmlregex.exec(i);)switch(et[3]=et[3].replace(/_.*$/,"")){case"table":case"":et[1]==="/"?(lt.e.c>=lt.s.c&&lt.e.r>=lt.s.r?rt["!ref"]=encode_range(lt):rt["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=lt.e.r&&(rt["!fullref"]=rt["!ref"],lt.e.r=a.sheetRows-1,rt["!ref"]=encode_range(lt)),Tt.length&&(rt["!merges"]=Tt),Vt.length&&(rt["!rows"]=Vt),b.name=b.||b.name,typeof JSON<"u"&&JSON.stringify(b),tt.push(b.name),_e[b.name]=rt,Ut=!1):et[0].charAt(et[0].length-2)!=="/"&&(b=parsexmltag(et[0],!1),dt=ht=-1,lt.s.r=lt.s.c=1e7,lt.e.r=lt.e.c=0,rt=a.dense?[]:{},Tt=[],Vt=[],Ut=!0);break;case"table-row-group":et[1]==="/"?--gt:++gt;break;case"table-row":case"":if(et[1]==="/"){dt+=Mt,Mt=1;break}if(j=parsexmltag(et[0],!1),j.?dt=j.-1:dt==-1&&(dt=0),Mt=+j["number-rows-repeated"]||1,Mt<10)for(Xt=0;Xt<Mt;++Xt)gt>0&&(Vt[dt+Xt]={level:gt});ht=-1;break;case"covered-table-cell":et[1]!=="/"&&++ht,a.sheetStubs&&(a.dense?(rt[dt]||(rt[dt]=[]),rt[dt][ht]={t:"z"}):rt[encode_cell({r:dt,c:ht})]={t:"z"}),it="",ot=[];break;case"table-cell":case"":if(et[0].charAt(et[0].length-2)==="/")++ht,at=parsexmltag(et[0],!1),Ct=parseInt(at["number-columns-repeated"]||"1",10),st={t:"z",v:null},at.formula&&a.cellFormula!=!1&&(st.f=ods_to_csf_formula(unescapexml(at.formula))),(at.||at["value-type"])=="string"&&(st.t="s",st.v=unescapexml(at["string-value"]||""),a.dense?(rt[dt]||(rt[dt]=[]),rt[dt][ht]=st):rt[encode_cell({r:dt,c:ht})]=st),ht+=Ct-1;else if(et[1]!=="/"){++ht,it="",nt=0,ot=[],Ct=1;var Gt=Mt?dt+Mt-1:dt;if(ht>lt.e.c&&(lt.e.c=ht),ht<lt.s.c&&(lt.s.c=ht),dt<lt.s.r&&(lt.s.r=dt),Gt>lt.e.r&&(lt.e.r=Gt),at=parsexmltag(et[0],!1),Pt=[],ft={},st={t:at.||at["value-type"],v:null},a.cellFormula)if(at.formula&&(at.formula=unescapexml(at.formula)),at["number-matrix-columns-spanned"]&&at["number-matrix-rows-spanned"]&&(Et=parseInt(at["number-matrix-rows-spanned"],10)||0,Ft=parseInt(at["number-matrix-columns-spanned"],10)||0,mt={s:{r:dt,c:ht},e:{r:dt+Et-1,c:ht+Ft-1}},st.F=encode_range(mt),kt.push([mt,st.F])),at.formula)st.f=ods_to_csf_formula(at.formula);else for(Xt=0;Xt<kt.length;++Xt)dt>=kt[Xt][0].s.r&&dt<=kt[Xt][0].e.r&&ht>=kt[Xt][0].s.c&&ht<=kt[Xt][0].e.c&&(st.F=kt[Xt][1]);switch((at["number-columns-spanned"]||at["number-rows-spanned"])&&(Et=parseInt(at["number-rows-spanned"],10)||0,Ft=parseInt(at["number-columns-spanned"],10)||0,mt={s:{r:dt,c:ht},e:{r:dt+Et-1,c:ht+Ft-1}},Tt.push(mt)),at["number-columns-repeated"]&&(Ct=parseInt(at["number-columns-repeated"],10)),st.t){case"boolean":st.t="b",st.v=parsexmlbool(at["boolean-value"]);break;case"float":st.t="n",st.v=parseFloat(at.value);break;case"percentage":st.t="n",st.v=parseFloat(at.value);break;case"currency":st.t="n",st.v=parseFloat(at.value);break;case"date":st.t="d",st.v=parseDate(at["date-value"]),a.cellDates||(st.t="n",st.v=datenum(st.v)),st.z="m/d/yy";break;case"time":st.t="n",st.v=parse_isodur(at["time-value"])/86400,a.cellDates&&(st.t="d",st.v=numdate(st.v)),st.z="HH:MM:SS";break;case"number":st.t="n",st.v=parseFloat(at.);break;default:if(st.t==="string"||st.t==="text"||!st.t)st.t="s",at["string-value"]!=null&&(it=unescapexml(at["string-value"]),ot=[]);else throw new Error("Unsupported value type "+st.t)}}else{if(At=!1,st.t==="s"&&(st.v=it||"",ot.length&&(st.R=ot),At=nt==0),ut.Target&&(st.l=ut),Pt.length>0&&(st.c=Pt,Pt=[]),it&&a.cellText!==!1&&(st.w=it),At&&(st.t="z",delete st.v),(!At||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=dt))for(var zt=0;zt<Mt;++zt){if(Ct=parseInt(at["number-columns-repeated"]||"1",10),a.dense)for(rt[dt+zt]||(rt[dt+zt]=[]),rt[dt+zt][ht]=zt==0?st:dup(st);--Ct>0;)rt[dt+zt][ht+Ct]=dup(st);else for(rt[encode_cell({r:dt+zt,c:ht})]=st;--Ct>0;)rt[encode_cell({r:dt+zt,c:ht+Ct})]=dup(st);lt.e.c<=ht&&(lt.e.c=ht)}Ct=parseInt(at["number-columns-repeated"]||"1",10),ht+=Ct-1,Ct=0,st={},it="",ot=[]}ut={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(et[1]==="/"){if((c=o.pop())[0]!==et[3])throw"Bad state: "+c}else et[0].charAt(et[0].length-2)!=="/"&&o.push([et[3],!0]);break;case"annotation":if(et[1]==="/"){if((c=o.pop())[0]!==et[3])throw"Bad state: "+c;ft.t=it,ot.length&&(ft.R=ot),ft.a=Rt,Pt.push(ft)}else et[0].charAt(et[0].length-2)!=="/"&&o.push([et[3],!1]);Rt="",bt=0,it="",nt=0,ot=[];break;case"creator":et[1]==="/"?Rt=i.slice(bt,et.index):bt=et.index+et[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(et[1]==="/"){if((c=o.pop())[0]!==et[3])throw"Bad state: "+c}else et[0].charAt(et[0].length-2)!=="/"&&o.push([et[3],!1]);it="",nt=0,ot=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(et[1]==="/"){if(yt[h.name]=g,(c=o.pop())[0]!==et[3])throw"Bad state: "+c}else et[0].charAt(et[0].length-2)!=="/"&&(g="",h=parsexmltag(et[0],!1),o.push([et[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(o[o.length-1][0]){case"time-style":case"date-style":d=parsexmltag(et[0],!1),g+=number_formats_ods[et[3]][d.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(o[o.length-1][0]){case"time-style":case"date-style":d=parsexmltag(et[0],!1),g+=number_formats_ods[et[3]][d.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(et[0].slice(-2)==="/>")break;if(et[1]==="/")switch(o[o.length-1][0]){case"number-style":case"date-style":case"time-style":g+=i.slice(_,et.index);break}else _=et.index+et[0].length;break;case"named-range":d=parsexmltag(et[0],!1),Lt=ods_to_csf_3D(d["cell-range-address"]);var Wt={Name:d.name,Ref:Lt[0]+"!"+Lt[1]};Ut&&(Wt.Sheet=tt.length),jt.Names.push(Wt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(o[o.length-1][0])>-1)break;if(et[1]==="/"&&(!at||!at["string-value"])){var er=parse_text_p(i.slice(nt,et.index));it=(it.length>0?it+`
`:"")+er[0]}else parsexmltag(et[0],!1),nt=et.index+et[0].length;break;case"s":break;case"database-range":if(et[1]==="/")break;try{Lt=ods_to_csf_3D(parsexmltag(et[0])["target-range-address"]),_e[Lt[0]]["!autofilter"]={ref:Lt[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(et[1]!=="/"){if(ut=parsexmltag(et[0],!1),!ut.href)break;ut.Target=unescapexml(ut.href),delete ut.href,ut.Target.charAt(0)=="#"&&ut.Target.indexOf(".")>-1?(Lt=ods_to_csf_3D(ut.Target.slice(1)),ut.Target="#"+Lt[0]+"!"+Lt[1]):ut.Target.match(/^\.\.[\\\/]/)&&(ut.Target=ut.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(et[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(et)}}var St={Sheets:_e,SheetNames:tt,Workbook:jt};return a.bookSheets&&delete St.Sheets,St}function parse_ods(e,s){s=s||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),s);var a=getzipstr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var i=parse_content_xml(utf8read(a),s);return safegetzipfile(e,"meta.xml")&&(i.Props=parse_core_props(getzipdata(e,"meta.xml"))),i}function parse_fods(e,s){return parse_content_xml(e,s)}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),s="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+s}}(),write_content_ods=function(){var e=function(c){return escapexml(c).replace(/  +/g,function(d){return'<text:s text:c="'+d.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},s=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,i=function(c,d,h){var g=[];g.push('      <table:table table:name="'+escapexml(d.SheetNames[h])+`" table:style-name="ta1">
`);var _=0,b=0,j=decode_range(c["!ref"]||"A1"),_e=c["!merges"]||[],tt=0,rt=Array.isArray(c);if(c["!cols"])for(b=0;b<=j.e.c;++b)g.push("        <table:table-column"+(c["!cols"][b]?' table:style-name="co'+c["!cols"][b].ods+'"':"")+`></table:table-column>
`);var et="",st=c["!rows"]||[];for(_=0;_<j.s.r;++_)et=st[_]?' table:style-name="ro'+st[_].ods+'"':"",g.push("        <table:table-row"+et+`></table:table-row>
`);for(;_<=j.e.r;++_){for(et=st[_]?' table:style-name="ro'+st[_].ods+'"':"",g.push("        <table:table-row"+et+`>
`),b=0;b<j.s.c;++b)g.push(s);for(;b<=j.e.c;++b){var at=!1,it={},nt="";for(tt=0;tt!=_e.length;++tt)if(!(_e[tt].s.c>b)&&!(_e[tt].s.r>_)&&!(_e[tt].e.c<b)&&!(_e[tt].e.r<_)){(_e[tt].s.c!=b||_e[tt].s.r!=_)&&(at=!0),it["table:number-columns-spanned"]=_e[tt].e.c-_e[tt].s.c+1,it["table:number-rows-spanned"]=_e[tt].e.r-_e[tt].s.r+1;break}if(at){g.push(a);continue}var ot=encode_cell({r:_,c:b}),dt=rt?(c[_]||[])[b]:c[ot];if(dt&&dt.f&&(it["table:formula"]=escapexml(csf_to_ods_formula(dt.f)),dt.F&&dt.F.slice(0,ot.length)==ot)){var ht=decode_range(dt.F);it["table:number-matrix-columns-spanned"]=ht.e.c-ht.s.c+1,it["table:number-matrix-rows-spanned"]=ht.e.r-ht.s.r+1}if(!dt){g.push(s);continue}switch(dt.t){case"b":nt=dt.v?"TRUE":"FALSE",it["office:value-type"]="boolean",it["office:boolean-value"]=dt.v?"true":"false";break;case"n":nt=dt.w||String(dt.v||0),it["office:value-type"]="float",it["office:value"]=dt.v||0;break;case"s":case"str":nt=dt.v==null?"":dt.v,it["office:value-type"]="string";break;case"d":nt=dt.w||parseDate(dt.v).toISOString(),it["office:value-type"]="date",it["office:date-value"]=parseDate(dt.v).toISOString(),it["table:style-name"]="ce1";break;default:g.push(s);continue}var lt=e(nt);if(dt.l&&dt.l.Target){var gt=dt.l.Target;gt=gt.charAt(0)=="#"?"#"+csf_to_ods_3D(gt.slice(1)):gt,gt.charAt(0)!="#"&&!gt.match(/^\w+:/)&&(gt="../"+gt),lt=writextag("text:a",lt,{"xlink:href":gt.replace(/&/g,"&amp;")})}g.push("          "+writextag("table:table-cell",writextag("text:p",lt,{}),it)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},o=function(c,d){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var h=0;d.SheetNames.map(function(_){return d.Sheets[_]}).forEach(function(_){if(_&&_["!cols"]){for(var b=0;b<_["!cols"].length;++b)if(_["!cols"][b]){var j=_["!cols"][b];if(j.width==null&&j.wpx==null&&j.wch==null)continue;process_col(j),j.ods=h;var _e=_["!cols"][b].wpx+"px";c.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_e+`"/>
`),c.push(`  </style:style>
`),++h}}});var g=0;d.SheetNames.map(function(_){return d.Sheets[_]}).forEach(function(_){if(_&&_["!rows"]){for(var b=0;b<_["!rows"].length;++b)if(_["!rows"][b]){_["!rows"][b].ods=g;var j=_["!rows"][b].hpx+"px";c.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+j+`"/>
`),c.push(`  </style:style>
`),++g}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(d,h){var g=[XML_HEADER],_=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),b=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+_+b+`>
`),g.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+_+`>
`),o(g,d),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var j=0;j!=d.SheetNames.length;++j)g.push(i(d.Sheets[d.SheetNames[j]],d,j));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}}();function write_ods(e,s){if(s.bookType=="fods")return write_content_ods(e,s);var a=zip_new(),i="",o=[],c=[];return i="mimetype",zip_add_file(a,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",zip_add_file(a,i,write_content_ods(e,s)),o.push([i,"text/xml"]),c.push([i,"ContentFile"]),i="styles.xml",zip_add_file(a,i,write_styles_ods(e,s)),o.push([i,"text/xml"]),c.push([i,"StylesFile"]),i="meta.xml",zip_add_file(a,i,XML_HEADER+write_meta_ods()),o.push([i,"text/xml"]),c.push([i,"MetadataFile"]),i="manifest.rdf",zip_add_file(a,i,write_rdf(c)),o.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",zip_add_file(a,i,write_manifest(o)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,s){e:for(var a=0;a<=e.length-s.length;++a){for(var i=0;i<s.length;++i)if(e[a+i]!=s[i])continue e;return!0}return!1}function u8concat(e){var s=e.reduce(function(o,c){return o+c.length},0),a=new Uint8Array(s),i=0;return e.forEach(function(o){a.set(o,i),i+=o.length}),a}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,s){for(var a=(e[s+15]&127)<<7|e[s+14]>>1,i=e[s+14]&1,o=s+13;o>=s;--o)i=i*256+e[o];return(e[s+15]&128?-i:i)*Math.pow(10,a-6176)}function writeDecimal128LE(e,s,a){var i=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,o=a/Math.pow(10,i-6176);e[s+15]|=i>>7,e[s+14]|=(i&127)<<1;for(var c=0;o>=1;++c,o/=256)e[s+c]=o&255;e[s+15]|=a>=0?0:128}function parse_varint49(e,s){var a=s?s[0]:0,i=e[a]&127;e:if(e[a++]>=128&&(i|=(e[a]&127)<<7,e[a++]<128||(i|=(e[a]&127)<<14,e[a++]<128)||(i|=(e[a]&127)<<21,e[a++]<128)||(i+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(i+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(i+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return s&&(s[0]=a),i}function write_varint49(e){var s=new Uint8Array(7);s[0]=e&127;var a=1;e:if(e>127){if(s[a-1]|=128,s[a]=e>>7&127,++a,e<=16383||(s[a-1]|=128,s[a]=e>>14&127,++a,e<=2097151)||(s[a-1]|=128,s[a]=e>>21&127,++a,e<=268435455)||(s[a-1]|=128,s[a]=e/256>>>21&127,++a,e<=34359738367)||(s[a-1]|=128,s[a]=e/65536>>>21&127,++a,e<=4398046511103))break e;s[a-1]|=128,s[a]=e/16777216>>>21&127,++a}return s.slice(0,a)}function varint_to_i32(e){var s=0,a=e[s]&127;e:if(e[s++]>=128){if(a|=(e[s]&127)<<7,e[s++]<128||(a|=(e[s]&127)<<14,e[s++]<128)||(a|=(e[s]&127)<<21,e[s++]<128))break e;a|=(e[s]&127)<<28}return a}function parse_shallow(e){for(var s=[],a=[0];a[0]<e.length;){var i=a[0],o=parse_varint49(e,a),c=o&7;o=Math.floor(o/8);var d=0,h;if(o==0)break;switch(c){case 0:{for(var g=a[0];e[a[0]++]>=128;);h=e.slice(g,a[0])}break;case 5:d=4,h=e.slice(a[0],a[0]+d),a[0]+=d;break;case 1:d=8,h=e.slice(a[0],a[0]+d),a[0]+=d;break;case 2:d=parse_varint49(e,a),h=e.slice(a[0],a[0]+d),a[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(o," at offset ").concat(i))}var _={data:h,type:c};s[o]==null?s[o]=[_]:s[o].push(_)}return s}function write_shallow(e){var s=[];return e.forEach(function(a,i){a.forEach(function(o){o.data&&(s.push(write_varint49(i*8+o.type)),o.type==2&&s.push(write_varint49(o.data.length)),s.push(o.data))})}),u8concat(s)}function mappa(e,s){return(e==null?void 0:e.map(function(a){return s(a.data)}))||[]}function parse_iwa_file(e){for(var s,a=[],i=[0];i[0]<e.length;){var o=parse_varint49(e,i),c=parse_shallow(e.slice(i[0],i[0]+o));i[0]+=o;var d={id:varint_to_i32(c[1][0].data),messages:[]};c[2].forEach(function(h){var g=parse_shallow(h.data),_=varint_to_i32(g[3][0].data);d.messages.push({meta:g,data:e.slice(i[0],i[0]+_)}),i[0]+=_}),(s=c[3])!=null&&s[0]&&(d.merge=varint_to_i32(c[3][0].data)>>>0>0),a.push(d)}return a}function write_iwa_file(e){var s=[];return e.forEach(function(a){var i=[];i[1]=[{data:write_varint49(a.id),type:0}],i[2]=[],a.merge!=null&&(i[3]=[{data:write_varint49(+!!a.merge),type:0}]);var o=[];a.messages.forEach(function(d){o.push(d.data),d.meta[3]=[{type:0,data:write_varint49(d.data.length)}],i[2].push({data:write_shallow(d.meta),type:2})});var c=write_shallow(i);s.push(write_varint49(c.length)),s.push(c),o.forEach(function(d){return s.push(d)})}),u8concat(s)}function parse_snappy_chunk(e,s){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],i=parse_varint49(s,a),o=[];a[0]<s.length;){var c=s[a[0]]&3;if(c==0){var d=s[a[0]++]>>2;if(d<60)++d;else{var h=d-59;d=s[a[0]],h>1&&(d|=s[a[0]+1]<<8),h>2&&(d|=s[a[0]+2]<<16),h>3&&(d|=s[a[0]+3]<<24),d>>>=0,d++,a[0]+=h}o.push(s.slice(a[0],a[0]+d)),a[0]+=d;continue}else{var g=0,_=0;if(c==1?(_=(s[a[0]]>>2&7)+4,g=(s[a[0]++]&224)<<3,g|=s[a[0]++]):(_=(s[a[0]++]>>2)+1,c==2?(g=s[a[0]]|s[a[0]+1]<<8,a[0]+=2):(g=(s[a[0]]|s[a[0]+1]<<8|s[a[0]+2]<<16|s[a[0]+3]<<24)>>>0,a[0]+=4)),o=[u8concat(o)],g==0)throw new Error("Invalid offset 0");if(g>o[0].length)throw new Error("Invalid offset beyond length");if(_>=g)for(o.push(o[0].slice(-g)),_-=g;_>=o[o.length-1].length;)o.push(o[o.length-1]),_-=o[o.length-1].length;o.push(o[0].slice(-g,-g+_))}}var b=u8concat(o);if(b.length!=i)throw new Error("Unexpected length: ".concat(b.length," != ").concat(i));return b}function decompress_iwa_file(e){for(var s=[],a=0;a<e.length;){var i=e[a++],o=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,s.push(parse_snappy_chunk(i,e.slice(a,a+o))),a+=o}if(a!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(s)}function compress_iwa_file(e){for(var s=[],a=0;a<e.length;){var i=Math.min(e.length-a,268435455),o=new Uint8Array(4);s.push(o);var c=write_varint49(i),d=c.length;s.push(c),i<=60?(d++,s.push(new Uint8Array([i-1<<2]))):i<=256?(d+=2,s.push(new Uint8Array([240,i-1&255]))):i<=65536?(d+=3,s.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(d+=4,s.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(d+=5,s.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),s.push(e.slice(a,a+i)),d+=i,o[0]=0,o[1]=d&255,o[2]=d>>8&255,o[3]=d>>16&255,a+=i}return u8concat(s)}function parse_old_storage(e,s,a,i){var o=u8_to_dataview(e),c=o.getUint32(4,!0),d=(i>1?12:8)+popcnt(c&(i>1?3470:398))*4,h=-1,g=-1,_=NaN,b=new Date(2001,0,1);c&512&&(h=o.getUint32(d,!0),d+=4),d+=popcnt(c&(i>1?12288:4096))*4,c&16&&(g=o.getUint32(d,!0),d+=4),c&32&&(_=o.getFloat64(d,!0),d+=8),c&64&&(b.setTime(b.getTime()+o.getFloat64(d,!0)*1e3),d+=8);var j;switch(e[2]){case 0:break;case 2:j={t:"n",v:_};break;case 3:j={t:"s",v:s[g]};break;case 5:j={t:"d",v:b};break;case 6:j={t:"b",v:_>0};break;case 7:j={t:"n",v:_/86400};break;case 8:j={t:"e",v:0};break;case 9:if(h>-1)j={t:"s",v:a[h]};else if(g>-1)j={t:"s",v:s[g]};else if(!isNaN(_))j={t:"n",v:_};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return j}function parse_new_storage(e,s,a){var i=u8_to_dataview(e),o=i.getUint32(8,!0),c=12,d=-1,h=-1,g=NaN,_=NaN,b=new Date(2001,0,1);o&1&&(g=readDecimal128LE(e,c),c+=16),o&2&&(_=i.getFloat64(c,!0),c+=8),o&4&&(b.setTime(b.getTime()+i.getFloat64(c,!0)*1e3),c+=8),o&8&&(h=i.getUint32(c,!0),c+=4),o&16&&(d=i.getUint32(c,!0),c+=4);var j;switch(e[1]){case 0:break;case 2:j={t:"n",v:g};break;case 3:j={t:"s",v:s[h]};break;case 5:j={t:"d",v:b};break;case 6:j={t:"b",v:_>0};break;case 7:j={t:"n",v:_/86400};break;case 8:j={t:"e",v:0};break;case 9:if(d>-1)j={t:"s",v:a[d]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(o&31," : ").concat(e.slice(0,4)));break;case 10:j={t:"n",v:g};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(o&31," : ").concat(e.slice(0,4)))}return j}function write_new_storage(e,s){var a=new Uint8Array(32),i=u8_to_dataview(a),o=12,c=0;switch(a[0]=5,e.t){case"n":a[1]=2,writeDecimal128LE(a,o,e.v),c|=1,o+=16;break;case"b":a[1]=6,i.setFloat64(o,e.v?1:0,!0),c|=2,o+=8;break;case"s":if(s.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,i.setUint32(o,s.indexOf(e.v),!0),c|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(8,c,!0),a.slice(0,o)}function write_old_storage(e,s){var a=new Uint8Array(32),i=u8_to_dataview(a),o=12,c=0;switch(a[0]=3,e.t){case"n":a[2]=2,i.setFloat64(o,e.v,!0),c|=32,o+=8;break;case"b":a[2]=6,i.setFloat64(o,e.v?1:0,!0),c|=32,o+=8;break;case"s":if(s.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,i.setUint32(o,s.indexOf(e.v),!0),c|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(4,c,!0),a.slice(0,o)}function parse_cell_storage(e,s,a){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,s,a,e[0]);case 5:return parse_new_storage(e,s,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var s=parse_shallow(e);return parse_varint49(s[1][0].data)}function parse_TST_TableDataList(e,s){var a=parse_shallow(s.data),i=varint_to_i32(a[1][0].data),o=a[3],c=[];return(o||[]).forEach(function(d){var h=parse_shallow(d.data),g=varint_to_i32(h[1][0].data)>>>0;switch(i){case 1:c[g]=u8str(h[3][0].data);break;case 8:{var _=e[parse_TSP_Reference(h[9][0].data)][0],b=parse_shallow(_.data),j=e[parse_TSP_Reference(b[1][0].data)][0],_e=varint_to_i32(j.meta[1][0].data);if(_e!=2001)throw new Error("2000 unexpected reference to ".concat(_e));var tt=parse_shallow(j.data);c[g]=tt[3].map(function(rt){return u8str(rt.data)}).join("")}break}}),c}function parse_TST_TileRowInfo(e,s){var a,i,o,c,d,h,g,_,b,j,_e,tt,rt,et,st=parse_shallow(e),at=varint_to_i32(st[1][0].data)>>>0,it=varint_to_i32(st[2][0].data)>>>0,nt=((i=(a=st[8])==null?void 0:a[0])==null?void 0:i.data)&&varint_to_i32(st[8][0].data)>0||!1,ot,dt;if((c=(o=st[7])==null?void 0:o[0])!=null&&c.data&&s!=0)ot=(h=(d=st[7])==null?void 0:d[0])==null?void 0:h.data,dt=(_=(g=st[6])==null?void 0:g[0])==null?void 0:_.data;else if((j=(b=st[4])==null?void 0:b[0])!=null&&j.data&&s!=1)ot=(tt=(_e=st[4])==null?void 0:_e[0])==null?void 0:tt.data,dt=(et=(rt=st[3])==null?void 0:rt[0])==null?void 0:et.data;else throw"NUMBERS Tile missing ".concat(s," cell storage");for(var ht=nt?4:1,lt=u8_to_dataview(ot),gt=[],yt=0;yt<ot.length/2;++yt){var Tt=lt.getUint16(yt*2,!0);Tt<65535&&gt.push([yt,Tt])}if(gt.length!=it)throw"Expected ".concat(it," cells, found ").concat(gt.length);var mt=[];for(yt=0;yt<gt.length-1;++yt)mt[gt[yt][0]]=dt.subarray(gt[yt][1]*ht,gt[yt+1][1]*ht);return gt.length>=1&&(mt[gt[gt.length-1][0]]=dt.subarray(gt[gt.length-1][1]*ht)),{R:at,cells:mt}}function parse_TST_Tile(e,s){var a,i=parse_shallow(s.data),o=(a=i==null?void 0:i[7])!=null&&a[0]?varint_to_i32(i[7][0].data)>>>0>0?1:0:-1,c=mappa(i[5],function(d){return parse_TST_TileRowInfo(d,o)});return{nrows:varint_to_i32(i[4][0].data)>>>0,data:c.reduce(function(d,h){return d[h.R]||(d[h.R]=[]),h.cells.forEach(function(g,_){if(d[h.R][_])throw new Error("Duplicate cell r=".concat(h.R," c=").concat(_));d[h.R][_]=g}),d},[])}}function parse_TST_TableModelArchive(e,s,a){var i,o=parse_shallow(s.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(varint_to_i32(o[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(o[6][0].data));if(c.e.c=(varint_to_i32(o[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(o[7][0].data));a["!ref"]=encode_range(c);var d=parse_shallow(o[4][0].data),h=parse_TST_TableDataList(e,e[parse_TSP_Reference(d[4][0].data)][0]),g=(i=d[17])!=null&&i[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(d[17][0].data)][0]):[],_=parse_shallow(d[3][0].data),b=0;_[1].forEach(function(j){var _e=parse_shallow(j.data),tt=e[parse_TSP_Reference(_e[2][0].data)][0],rt=varint_to_i32(tt.meta[1][0].data);if(rt!=6002)throw new Error("6001 unexpected reference to ".concat(rt));var et=parse_TST_Tile(e,tt);et.data.forEach(function(st,at){st.forEach(function(it,nt){var ot=encode_cell({r:b+at,c:nt}),dt=parse_cell_storage(it,h,g);dt&&(a[ot]=dt)})}),b+=et.nrows})}function parse_TST_TableInfoArchive(e,s){var a=parse_shallow(s.data),i={"!ref":"A1"},o=e[parse_TSP_Reference(a[2][0].data)],c=varint_to_i32(o[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return parse_TST_TableModelArchive(e,o[0],i),i}function parse_TN_SheetArchive(e,s){var a,i=parse_shallow(s.data),o={name:(a=i[1])!=null&&a[0]?u8str(i[1][0].data):"",sheets:[]},c=mappa(i[2],parse_TSP_Reference);return c.forEach(function(d){e[d].forEach(function(h){var g=varint_to_i32(h.meta[1][0].data);g==6e3&&o.sheets.push(parse_TST_TableInfoArchive(e,h))})}),o}function parse_TN_DocumentArchive(e,s){var a=book_new(),i=parse_shallow(s.data),o=mappa(i[1],parse_TSP_Reference);if(o.forEach(function(c){e[c].forEach(function(d){var h=varint_to_i32(d.meta[1][0].data);if(h==2){var g=parse_TN_SheetArchive(e,d);g.sheets.forEach(function(_,b){book_append_sheet(a,_,b==0?g.name:g.name+"_"+b,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function parse_numbers_iwa(e){var s,a,i,o,c={},d=[];if(e.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var _;try{_=decompress_iwa_file(g.content)}catch(j){return console.log("?? "+g.content.length+" "+(j.message||j))}var b;try{b=parse_iwa_file(_)}catch(j){return console.log("## "+(j.message||j))}b.forEach(function(j){c[j.id]=j.messages,d.push(j.id)})}}),!d.length)throw new Error("File has no messages");var h=((o=(i=(a=(s=c==null?void 0:c[1])==null?void 0:s[0])==null?void 0:a.meta)==null?void 0:i[1])==null?void 0:o[0].data)&&varint_to_i32(c[1][0].meta[1][0].data)==1&&c[1][0];if(h||d.forEach(function(g){c[g].forEach(function(_){var b=varint_to_i32(_.meta[1][0].data)>>>0;if(b==1)if(!h)h=_;else throw new Error("Document has multiple roots")})}),!h)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(c,h)}function write_tile_row(e,s,a){var i,o,c,d;if(!((i=e[6])!=null&&i[0])||!((o=e[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var h=((d=(c=e[8])==null?void 0:c[0])==null?void 0:d.data)&&varint_to_i32(e[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var g=0,_=u8_to_dataview(e[7][0].data),b=0,j=[],_e=u8_to_dataview(e[4][0].data),tt=0,rt=[],et=0;et<s.length;++et){if(s[et]==null){_.setUint16(et*2,65535,!0),_e.setUint16(et*2,65535);continue}_.setUint16(et*2,b,!0),_e.setUint16(et*2,tt,!0);var st,at;switch(typeof s[et]){case"string":st=write_new_storage({t:"s",v:s[et]},a),at=write_old_storage({t:"s",v:s[et]},a);break;case"number":st=write_new_storage({t:"n",v:s[et]},a),at=write_old_storage({t:"n",v:s[et]},a);break;case"boolean":st=write_new_storage({t:"b",v:s[et]},a),at=write_old_storage({t:"b",v:s[et]},a);break;default:throw new Error("Unsupported value "+s[et])}j.push(st),b+=st.length,rt.push(at),tt+=at.length,++g}for(e[2][0].data=write_varint49(g);et<e[7][0].data.length/2;++et)_.setUint16(et*2,65535,!0),_e.setUint16(et*2,65535,!0);return e[6][0].data=u8concat(j),e[3][0].data=u8concat(rt),g}function write_numbers_iwa(e,s){if(!s||!s.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=decode_range(a["!ref"]);i.s.r=i.s.c=0;var o=!1;i.e.c>9&&(o=!0,i.e.c=9),i.e.r>49&&(o=!0,i.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(encode_range(i)));var c=sheet_to_json(a,{range:i,header:1}),d=["~Sh33tJ5~"];c.forEach(function(Rt){return Rt.forEach(function(bt){typeof bt=="string"&&d.push(bt)})});var h={},g=[],_=CFB.read(s.numbers,{type:"base64"});_.FileIndex.map(function(Rt,bt){return[Rt,_.FullPaths[bt]]}).forEach(function(Rt){var bt=Rt[0],At=Rt[1];if(bt.type==2&&bt.name.match(/\.iwa/)){var Ut=bt.content,Xt=decompress_iwa_file(Ut),Gt=parse_iwa_file(Xt);Gt.forEach(function(zt){g.push(zt.id),h[zt.id]={deps:[],location:At,type:varint_to_i32(zt.messages[0].meta[1][0].data)}})}}),g.sort(function(Rt,bt){return Rt-bt});var b=g.filter(function(Rt){return Rt>1}).map(function(Rt){return[Rt,write_varint49(Rt)]});_.FileIndex.map(function(Rt,bt){return[Rt,_.FullPaths[bt]]}).forEach(function(Rt){var bt=Rt[0];if(Rt[1],!!bt.name.match(/\.iwa/)){var At=parse_iwa_file(decompress_iwa_file(bt.content));At.forEach(function(Ut){Ut.messages.forEach(function(Xt){b.forEach(function(Gt){Ut.messages.some(function(zt){return varint_to_i32(zt.meta[1][0].data)!=11006&&u8contains(zt.data,Gt[1])})&&h[Gt[0]].deps.push(Ut.id)})})})}});for(var j=CFB.find(_,h[1].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),tt,rt=0;rt<_e.length;++rt){var et=_e[rt];et.id==1&&(tt=et)}var st=parse_TSP_Reference(parse_shallow(tt.messages[0].data)[1][0].data);for(j=CFB.find(_,h[st].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),rt=0;rt<_e.length;++rt)et=_e[rt],et.id==st&&(tt=et);for(st=parse_TSP_Reference(parse_shallow(tt.messages[0].data)[2][0].data),j=CFB.find(_,h[st].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),rt=0;rt<_e.length;++rt)et=_e[rt],et.id==st&&(tt=et);for(st=parse_TSP_Reference(parse_shallow(tt.messages[0].data)[2][0].data),j=CFB.find(_,h[st].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),rt=0;rt<_e.length;++rt)et=_e[rt],et.id==st&&(tt=et);var at=parse_shallow(tt.messages[0].data);{at[6][0].data=write_varint49(i.e.r+1),at[7][0].data=write_varint49(i.e.c+1);var it=parse_TSP_Reference(at[46][0].data),nt=CFB.find(_,h[it].location),ot=parse_iwa_file(decompress_iwa_file(nt.content));{for(var dt=0;dt<ot.length&&ot[dt].id!=it;++dt);if(ot[dt].id!=it)throw"Bad ColumnRowUIDMapArchive";var ht=parse_shallow(ot[dt].messages[0].data);ht[1]=[],ht[2]=[],ht[3]=[];for(var lt=0;lt<=i.e.c;++lt){var gt=[];gt[1]=gt[2]=[{type:0,data:write_varint49(lt+420690)}],ht[1].push({type:2,data:write_shallow(gt)}),ht[2].push({type:0,data:write_varint49(lt)}),ht[3].push({type:0,data:write_varint49(lt)})}ht[4]=[],ht[5]=[],ht[6]=[];for(var yt=0;yt<=i.e.r;++yt)gt=[],gt[1]=gt[2]=[{type:0,data:write_varint49(yt+726270)}],ht[4].push({type:2,data:write_shallow(gt)}),ht[5].push({type:0,data:write_varint49(yt)}),ht[6].push({type:0,data:write_varint49(yt)});ot[dt].messages[0].data=write_shallow(ht)}nt.content=compress_iwa_file(write_iwa_file(ot)),nt.size=nt.content.length,delete at[46];var Tt=parse_shallow(at[4][0].data);{Tt[7][0].data=write_varint49(i.e.r+1);var mt=parse_shallow(Tt[1][0].data),Et=parse_TSP_Reference(mt[2][0].data);nt=CFB.find(_,h[Et].location),ot=parse_iwa_file(decompress_iwa_file(nt.content));{if(ot[0].id!=Et)throw"Bad HeaderStorageBucket";var Ft=parse_shallow(ot[0].messages[0].data);for(yt=0;yt<c.length;++yt){var Vt=parse_shallow(Ft[2][0].data);Vt[1][0].data=write_varint49(yt),Vt[4][0].data=write_varint49(c[yt].length),Ft[2][yt]={type:Ft[2][0].type,data:write_shallow(Vt)}}ot[0].messages[0].data=write_shallow(Ft)}nt.content=compress_iwa_file(write_iwa_file(ot)),nt.size=nt.content.length;var Mt=parse_TSP_Reference(Tt[2][0].data);nt=CFB.find(_,h[Mt].location),ot=parse_iwa_file(decompress_iwa_file(nt.content));{if(ot[0].id!=Mt)throw"Bad HeaderStorageBucket";for(Ft=parse_shallow(ot[0].messages[0].data),lt=0;lt<=i.e.c;++lt)Vt=parse_shallow(Ft[2][0].data),Vt[1][0].data=write_varint49(lt),Vt[4][0].data=write_varint49(i.e.r+1),Ft[2][lt]={type:Ft[2][0].type,data:write_shallow(Vt)};ot[0].messages[0].data=write_shallow(Ft)}nt.content=compress_iwa_file(write_iwa_file(ot)),nt.size=nt.content.length;var Ct=parse_TSP_Reference(Tt[4][0].data);(function(){for(var Rt=CFB.find(_,h[Ct].location),bt=parse_iwa_file(decompress_iwa_file(Rt.content)),At,Ut=0;Ut<bt.length;++Ut){var Xt=bt[Ut];Xt.id==Ct&&(At=Xt)}var Gt=parse_shallow(At.messages[0].data);{Gt[3]=[];var zt=[];d.forEach(function(St,ir){zt[1]=[{type:0,data:write_varint49(ir)}],zt[2]=[{type:0,data:write_varint49(1)}],zt[3]=[{type:2,data:stru8(St)}],Gt[3].push({type:2,data:write_shallow(zt)})})}At.messages[0].data=write_shallow(Gt);var Wt=write_iwa_file(bt),er=compress_iwa_file(Wt);Rt.content=er,Rt.size=Rt.content.length})();var kt=parse_shallow(Tt[3][0].data);{var jt=kt[1][0];delete kt[2];var ut=parse_shallow(jt.data);{var Lt=parse_TSP_Reference(ut[2][0].data);(function(){for(var Rt=CFB.find(_,h[Lt].location),bt=parse_iwa_file(decompress_iwa_file(Rt.content)),At,Ut=0;Ut<bt.length;++Ut){var Xt=bt[Ut];Xt.id==Lt&&(At=Xt)}var Gt=parse_shallow(At.messages[0].data);{delete Gt[6],delete kt[7];var zt=new Uint8Array(Gt[5][0].data);Gt[5]=[];for(var Wt=0,er=0;er<=i.e.r;++er){var St=parse_shallow(zt);Wt+=write_tile_row(St,c[er],d),St[1][0].data=write_varint49(er),Gt[5].push({data:write_shallow(St),type:2})}Gt[1]=[{type:0,data:write_varint49(i.e.c+1)}],Gt[2]=[{type:0,data:write_varint49(i.e.r+1)}],Gt[3]=[{type:0,data:write_varint49(Wt)}],Gt[4]=[{type:0,data:write_varint49(i.e.r+1)}]}At.messages[0].data=write_shallow(Gt);var ir=write_iwa_file(bt),nr=compress_iwa_file(ir);Rt.content=nr,Rt.size=Rt.content.length})()}jt.data=write_shallow(ut)}Tt[3][0].data=write_shallow(kt)}at[4][0].data=write_shallow(Tt)}tt.messages[0].data=write_shallow(at);var Pt=write_iwa_file(_e),ft=compress_iwa_file(Pt);return j.content=ft,j.size=j.content.length,_}function fix_opts_func(e){return function(a){for(var i=0;i!=e.length;++i){var o=e[i];a[o[0]]===void 0&&(a[o[0]]=o[1]),o[2]==="n"&&(a[o[0]]=Number(a[o[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,s){if(!e)return 0;try{e=s.map(function(i){return i.id||(i.id=i.strRelID),[i.name,e["!id"][i.id].Target,get_sheet_type(e["!id"][i.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,s,a,i,o,c,d,h,g,_,b,j){try{c[i]=parse_rels(getzipstr(e,a,!0),s);var _e=getzipdata(e,s),tt;switch(h){case"sheet":tt=parse_ws(_e,s,o,g,c[i],_,b,j);break;case"chart":if(tt=parse_cs(_e,s,o,g,c[i],_,b,j),!tt||!tt["!drawel"])break;var rt=resolve_path(tt["!drawel"].Target,s),et=get_rels_path(rt),st=parse_drawing(getzipstr(e,rt,!0),parse_rels(getzipstr(e,et,!0),rt)),at=resolve_path(st,rt),it=get_rels_path(at);tt=parse_chart(getzipstr(e,at,!0),at,g,parse_rels(getzipstr(e,it,!0),at),_,tt);break;case"macro":tt=parse_ms(_e,s,o,g,c[i],_,b,j);break;case"dialog":tt=parse_ds(_e,s,o,g,c[i],_,b,j);break;default:throw new Error("Unrecognized sheet type "+h)}d[i]=tt;var nt=[];c&&c[i]&&keys(c[i]).forEach(function(ot){var dt="";if(c[i][ot].Type==RELS.CMNT){dt=resolve_path(c[i][ot].Target,s);var ht=parse_cmnt(getzipdata(e,dt,!0),dt,g);if(!ht||!ht.length)return;sheet_insert_comments(tt,ht,!1)}c[i][ot].Type==RELS.TCMNT&&(dt=resolve_path(c[i][ot].Target,s),nt=nt.concat(parse_tcmnt_xml(getzipdata(e,dt,!0),g)))}),nt&&nt.length&&sheet_insert_comments(tt,nt,!0,g.people||[])}catch(ot){if(g.WTF)throw ot}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,s){if(make_ssf(),s=s||{},fix_read_opts(s),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,s);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var a=CFB.utils.cfb_new();return zipentries(e).forEach(function(Vt){zip_add_file(a,Vt,getzipbin(e,Vt))}),parse_numbers_iwa(a)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=zipentries(e),o=parse_ct(getzipstr(e,"[Content_Types].xml")),c=!1,d,h;if(o.workbooks.length===0&&(h="xl/workbook.xml",getzipdata(e,h,!0)&&o.workbooks.push(h)),o.workbooks.length===0){if(h="xl/workbook.bin",!getzipdata(e,h,!0))throw new Error("Could not find workbook");o.workbooks.push(h),c=!0}o.workbooks[0].slice(-3)=="bin"&&(c=!0);var g={},_={};if(!s.bookSheets&&!s.bookProps){if(strs=[],o.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(o.sst)),o.sst,s)}catch(Vt){if(s.WTF)throw Vt}s.cellStyles&&o.themes.length&&(g=parse_theme(getzipstr(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],s)),o.style&&(_=parse_sty(getzipdata(e,strip_front_slash(o.style)),o.style,g,s))}o.links.map(function(Vt){try{var Mt=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(Vt))),Vt);return parse_xlink(getzipdata(e,strip_front_slash(Vt)),Mt,Vt,s)}catch{}});var b=parse_wb(getzipdata(e,strip_front_slash(o.workbooks[0])),o.workbooks[0],s),j={},_e="";o.coreprops.length&&(_e=getzipdata(e,strip_front_slash(o.coreprops[0]),!0),_e&&(j=parse_core_props(_e)),o.extprops.length!==0&&(_e=getzipdata(e,strip_front_slash(o.extprops[0]),!0),_e&&parse_ext_props(_e,j,s)));var tt={};(!s.bookSheets||s.bookProps)&&o.custprops.length!==0&&(_e=getzipstr(e,strip_front_slash(o.custprops[0]),!0),_e&&(tt=parse_cust_props(_e,s)));var rt={};if((s.bookSheets||s.bookProps)&&(b.Sheets?d=b.Sheets.map(function(Mt){return Mt.name}):j.Worksheets&&j.SheetNames.length>0&&(d=j.SheetNames),s.bookProps&&(rt.Props=j,rt.Custprops=tt),s.bookSheets&&typeof d<"u"&&(rt.SheetNames=d),s.bookSheets?rt.SheetNames:s.bookProps))return rt;d={};var et={};s.bookDeps&&o.calcchain&&(et=parse_cc(getzipdata(e,strip_front_slash(o.calcchain)),o.calcchain));var st=0,at={},it,nt;{var ot=b.Sheets;j.Worksheets=ot.length,j.SheetNames=[];for(var dt=0;dt!=ot.length;++dt)j.SheetNames[dt]=ot[dt].name}var ht=c?"bin":"xml",lt=o.workbooks[0].lastIndexOf("/"),gt=(o.workbooks[0].slice(0,lt+1)+"_rels/"+o.workbooks[0].slice(lt+1)+".rels").replace(/^\//,"");safegetzipfile(e,gt)||(gt="xl/_rels/workbook."+ht+".rels");var yt=parse_rels(getzipstr(e,gt,!0),gt.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(s.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(o.metadata[0])),o.metadata[0],s)),(o.people||[]).length>=1&&(s.people=parse_people_xml(getzipdata(e,strip_front_slash(o.people[0])),s)),yt&&(yt=safe_parse_wbrels(yt,b.Sheets));var Tt=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(st=0;st!=j.Worksheets;++st){var mt="sheet";if(yt&&yt[st]?(it="xl/"+yt[st][1].replace(/[\/]?xl\//,""),safegetzipfile(e,it)||(it=yt[st][1]),safegetzipfile(e,it)||(it=gt.replace(/_rels\/.*$/,"")+yt[st][1]),mt=yt[st][2]):(it="xl/worksheets/sheet"+(st+1-Tt)+"."+ht,it=it.replace(/sheet0\./,"sheet.")),nt=it.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),s&&s.sheets!=null)switch(typeof s.sheets){case"number":if(st!=s.sheets)continue e;break;case"string":if(j.SheetNames[st].toLowerCase()!=s.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(s.sheets)){for(var Et=!1,Ft=0;Ft!=s.sheets.length;++Ft)typeof s.sheets[Ft]=="number"&&s.sheets[Ft]==st&&(Et=1),typeof s.sheets[Ft]=="string"&&s.sheets[Ft].toLowerCase()==j.SheetNames[st].toLowerCase()&&(Et=1);if(!Et)continue e}}safe_parse_sheet(e,it,nt,j.SheetNames[st],st,at,d,mt,s,b,g,_)}return rt={Directory:o,Workbook:b,Props:j,Custprops:tt,Deps:et,Sheets:d,SheetNames:j.SheetNames,Strings:strs,Styles:_,Themes:g,SSF:dup(table_fmt)},s&&s.bookFiles&&(e.files?(rt.keys=i,rt.files=e.files):(rt.keys=[],rt.files={},e.FullPaths.forEach(function(Vt,Mt){Vt=Vt.replace(/^Root Entry[\/]/,""),rt.keys.push(Vt),rt.files[Vt]=e.FileIndex[Mt]}))),s&&s.bookVBA&&(o.vba.length>0?rt.vbaraw=getzipdata(e,strip_front_slash(o.vba[0]),!0):o.defaults&&o.defaults.bin===CT_VBA&&(rt.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),rt}function parse_xlsxcfb(e,s){var a=s||{},i="Workbook",o=CFB.find(e,i);try{if(i="/!DataSpaces/Version",o=CFB.find(e,i),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(parse_DataSpaceVersionInfo(o.content),i="/!DataSpaces/DataSpaceMap",o=CFB.find(e,i),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=parse_DataSpaceMap(o.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",o=CFB.find(e,i),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);var d=parse_DataSpaceDefinition(o.content);if(d.length!=1||d[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",o=CFB.find(e,i),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);parse_Primary(o.content)}catch{}if(i="/EncryptionInfo",o=CFB.find(e,i),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);var h=parse_EncryptionInfo(o.content);if(i="/EncryptedPackage",o=CFB.find(e,i),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(h[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(h[1],o.content,a.password||"",a);if(h[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(h[1],o.content,a.password||"",a);throw new Error("File is password-protected")}function write_zip(e,s){return s.bookType=="ods"?write_ods(e,s):s.bookType=="numbers"?write_numbers_iwa(e,s):s.bookType=="xlsb"?write_zip_xlsxb(e,s):write_zip_xlsx(e,s)}function write_zip_xlsxb(e,s){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),s.revssf=evert_num(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,browser_has_Map?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var a=s.bookType=="xlsb"?"bin":"xml",i=VBAFMTS.indexOf(s.bookType)>-1,o=new_ct();fix_write_opts(s=s||{});var c=zip_new(),d="",h=0;if(s.cellXfs=[],get_cell_style(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",zip_add_file(c,d,write_core_props(e.Props,s)),o.coreprops.push(d),add_rels(s.rels,2,d,RELS.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],_=0;_<e.SheetNames.length;++_)(e.Workbook.Sheets[_]||{}).Hidden!=2&&g.push(e.SheetNames[_]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(c,d,write_ext_props(e.Props)),o.extprops.push(d),add_rels(s.rels,3,d,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(d="docProps/custom.xml",zip_add_file(c,d,write_cust_props(e.Custprops)),o.custprops.push(d),add_rels(s.rels,4,d,RELS.CUST_PROPS)),h=1;h<=e.SheetNames.length;++h){var b={"!id":{}},j=e.Sheets[e.SheetNames[h-1]],_e=(j||{})["!type"]||"sheet";switch(_e){case"chart":default:d="xl/worksheets/sheet"+h+"."+a,zip_add_file(c,d,write_ws(h-1,d,s,e,b)),o.sheets.push(d),add_rels(s.wbrels,-1,"worksheets/sheet"+h+"."+a,RELS.WS[0])}if(j){var tt=j["!comments"],rt=!1,et="";tt&&tt.length>0&&(et="xl/comments"+h+"."+a,zip_add_file(c,et,write_cmnt(tt,et)),o.comments.push(et),add_rels(b,-1,"../comments"+h+"."+a,RELS.CMNT),rt=!0),j["!legacy"]&&rt&&zip_add_file(c,"xl/drawings/vmlDrawing"+h+".vml",write_comments_vml(h,j["!comments"])),delete j["!comments"],delete j["!legacy"]}b["!id"].rId1&&zip_add_file(c,get_rels_path(d),write_rels(b))}return s.Strings!=null&&s.Strings.length>0&&(d="xl/sharedStrings."+a,zip_add_file(c,d,write_sst(s.Strings,d,s)),o.strs.push(d),add_rels(s.wbrels,-1,"sharedStrings."+a,RELS.SST)),d="xl/workbook."+a,zip_add_file(c,d,write_wb(e,d)),o.workbooks.push(d),add_rels(s.rels,1,d,RELS.WB),d="xl/theme/theme1.xml",zip_add_file(c,d,write_theme(e.Themes,s)),o.themes.push(d),add_rels(s.wbrels,-1,"theme/theme1.xml",RELS.THEME),d="xl/styles."+a,zip_add_file(c,d,write_sty(e,d,s)),o.styles.push(d),add_rels(s.wbrels,-1,"styles."+a,RELS.STY),e.vbaraw&&i&&(d="xl/vbaProject.bin",zip_add_file(c,d,e.vbaraw),o.vba.push(d),add_rels(s.wbrels,-1,"vbaProject.bin",RELS.VBA)),d="xl/metadata."+a,zip_add_file(c,d,write_xlmeta(d)),o.metadata.push(d),add_rels(s.wbrels,-1,"metadata."+a,RELS.XLMETA),zip_add_file(c,"[Content_Types].xml",write_ct(o,s)),zip_add_file(c,"_rels/.rels",write_rels(s.rels)),zip_add_file(c,"xl/_rels/workbook."+a+".rels",write_rels(s.wbrels)),delete s.revssf,delete s.ssf,c}function write_zip_xlsx(e,s){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),s.revssf=evert_num(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,browser_has_Map?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var a="xml",i=VBAFMTS.indexOf(s.bookType)>-1,o=new_ct();fix_write_opts(s=s||{});var c=zip_new(),d="",h=0;if(s.cellXfs=[],get_cell_style(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",zip_add_file(c,d,write_core_props(e.Props,s)),o.coreprops.push(d),add_rels(s.rels,2,d,RELS.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],_=0;_<e.SheetNames.length;++_)(e.Workbook.Sheets[_]||{}).Hidden!=2&&g.push(e.SheetNames[_]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(c,d,write_ext_props(e.Props)),o.extprops.push(d),add_rels(s.rels,3,d,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(d="docProps/custom.xml",zip_add_file(c,d,write_cust_props(e.Custprops)),o.custprops.push(d),add_rels(s.rels,4,d,RELS.CUST_PROPS));var b=["SheetJ5"];for(s.tcid=0,h=1;h<=e.SheetNames.length;++h){var j={"!id":{}},_e=e.Sheets[e.SheetNames[h-1]],tt=(_e||{})["!type"]||"sheet";switch(tt){case"chart":default:d="xl/worksheets/sheet"+h+"."+a,zip_add_file(c,d,write_ws_xml(h-1,s,e,j)),o.sheets.push(d),add_rels(s.wbrels,-1,"worksheets/sheet"+h+"."+a,RELS.WS[0])}if(_e){var rt=_e["!comments"],et=!1,st="";if(rt&&rt.length>0){var at=!1;rt.forEach(function(it){it[1].forEach(function(nt){nt.T==!0&&(at=!0)})}),at&&(st="xl/threadedComments/threadedComment"+h+"."+a,zip_add_file(c,st,write_tcmnt_xml(rt,b,s)),o.threadedcomments.push(st),add_rels(j,-1,"../threadedComments/threadedComment"+h+"."+a,RELS.TCMNT)),st="xl/comments"+h+"."+a,zip_add_file(c,st,write_comments_xml(rt)),o.comments.push(st),add_rels(j,-1,"../comments"+h+"."+a,RELS.CMNT),et=!0}_e["!legacy"]&&et&&zip_add_file(c,"xl/drawings/vmlDrawing"+h+".vml",write_comments_vml(h,_e["!comments"])),delete _e["!comments"],delete _e["!legacy"]}j["!id"].rId1&&zip_add_file(c,get_rels_path(d),write_rels(j))}return s.Strings!=null&&s.Strings.length>0&&(d="xl/sharedStrings."+a,zip_add_file(c,d,write_sst_xml(s.Strings,s)),o.strs.push(d),add_rels(s.wbrels,-1,"sharedStrings."+a,RELS.SST)),d="xl/workbook."+a,zip_add_file(c,d,write_wb_xml(e)),o.workbooks.push(d),add_rels(s.rels,1,d,RELS.WB),d="xl/theme/theme1.xml",zip_add_file(c,d,write_theme(e.Themes,s)),o.themes.push(d),add_rels(s.wbrels,-1,"theme/theme1.xml",RELS.THEME),d="xl/styles."+a,zip_add_file(c,d,write_sty_xml(e,s)),o.styles.push(d),add_rels(s.wbrels,-1,"styles."+a,RELS.STY),e.vbaraw&&i&&(d="xl/vbaProject.bin",zip_add_file(c,d,e.vbaraw),o.vba.push(d),add_rels(s.wbrels,-1,"vbaProject.bin",RELS.VBA)),d="xl/metadata."+a,zip_add_file(c,d,write_xlmeta_xml()),o.metadata.push(d),add_rels(s.wbrels,-1,"metadata."+a,RELS.XLMETA),b.length>1&&(d="xl/persons/person.xml",zip_add_file(c,d,write_people_xml(b)),o.people.push(d),add_rels(s.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(c,"[Content_Types].xml",write_ct(o,s)),zip_add_file(c,"_rels/.rels",write_rels(s.rels)),zip_add_file(c,"xl/_rels/workbook."+a+".rels",write_rels(s.wbrels)),delete s.revssf,delete s.ssf,c}function firstbyte(e,s){var a="";switch((s||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=Base64_decode(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(s&&s.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function read_cfb(e,s){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,s):parse_xlscfb(e,s)}function read_zip(e,s){var a,i=e,o=s||{};return o.type||(o.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),a=zip_read(i,o),parse_zip(a,o)}function read_plaintext(e,s){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return parse_xlml(e.slice(a),s);default:break e}return PRN.to_workbook(e,s)}function read_plaintext_raw(e,s){var a="",i=firstbyte(e,s);switch(s.type){case"base64":a=Base64_decode(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=cc2str(e);break;default:throw new Error("Unrecognized type "+s.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(a=utf8read(a)),s.type="binary",read_plaintext(a,s)}function read_utf16(e,s){var a=e;return s.type=="base64"&&(a=Base64_decode(a)),a=$cptable.utils.decode(1200,a.slice(2),"str"),s.type="binary",read_plaintext(a,s)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,s,a,i){return i?(a.type="string",PRN.to_workbook(e,a)):PRN.to_workbook(s,a)}function readSync(e,s){reset_cp();var a=s||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(a=dup(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var i=e,o=[0,0,0,0],c=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),_ssfopts={},a.dateNF&&(_ssfopts.dateNF=a.dateNF),a.type||(a.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=has_buf?"buffer":"binary",i=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(a.type="array")),a.type=="string"&&(c=!0,a.type="binary",a.codepage=65001,i=bstrify(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var d=new ArrayBuffer(3),h=new Uint8Array(d);if(h.foo="bar",!h.foo)return a=dup(a),a.type="array",readSync(ab2a(i),a)}switch((o=firstbyte(i,a))[0]){case 208:if(o[1]===207&&o[2]===17&&o[3]===224&&o[4]===161&&o[5]===177&&o[6]===26&&o[7]===225)return read_cfb(CFB.read(i,a),a);break;case 9:if(o[1]<=8)return parse_xlscfb(i,a);break;case 60:return parse_xlml(i,a);case 73:if(o[1]===73&&o[2]===42&&o[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(o[1]===68)return read_wb_ID(i,a);break;case 84:if(o[1]===65&&o[2]===66&&o[3]===76)return DIF.to_workbook(i,a);break;case 80:return o[1]===75&&o[2]<9&&o[3]<9?read_zip(i,a):read_prn(e,i,a,c);case 239:return o[3]===60?parse_xlml(i,a):read_prn(e,i,a,c);case 255:if(o[1]===254)return read_utf16(i,a);if(o[1]===0&&o[2]===2&&o[3]===0)return WK_.to_workbook(i,a);break;case 0:if(o[1]===0&&(o[2]>=2&&o[3]===0||o[2]===0&&(o[3]===8||o[3]===9)))return WK_.to_workbook(i,a);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(i,a);case 123:if(o[1]===92&&o[2]===114&&o[3]===116)return RTF.to_workbook(i,a);break;case 10:case 13:case 32:return read_plaintext_raw(i,a);case 137:if(o[1]===80&&o[2]===78&&o[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(o[0])>-1&&o[2]<=12&&o[3]<=31?DBF.to_workbook(i,a):read_prn(e,i,a,c)}function write_cfb_ctr(e,s){switch(s.type){case"base64":case"binary":break;case"buffer":case"array":s.type="";break;case"file":return write_dl(s.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");default:throw new Error("Unrecognized type "+s.type)}return CFB.write(e,s)}function write_zip_type(e,s){var a=dup(s||{}),i=write_zip(e,a);return write_zip_denouement(i,a)}function write_zip_denouement(e,s){var a={},i=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(s.compression&&(a.compression="DEFLATE"),s.password)a.type=i;else switch(s.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");case"buffer":case"file":a.type=i;break;default:throw new Error("Unrecognized type "+s.type)}var o=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!s.compression}):e.generate(a);if(typeof Deno<"u"&&typeof o=="string"){if(s.type=="binary"||s.type=="base64")return o;o=new Uint8Array(s2ab(o))}return s.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(o,s.password),s):s.type==="file"?write_dl(s.file,o):s.type=="string"?utf8read(o):o}function write_cfb_type(e,s){var a=s||{},i=write_xlscfb(e,a);return write_cfb_ctr(i,a)}function write_string_type(e,s,a){a||(a="");var i=a+e;switch(s.type){case"base64":return Base64_encode(utf8write(i));case"binary":return utf8write(i);case"string":return e;case"file":return write_dl(s.file,i,"utf8");case"buffer":return has_buf?Buffer_from(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):write_string_type(i,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function write_stxt_type(e,s){switch(s.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(s.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function write_binary_type(e,s){switch(s.type){case"string":case"base64":case"binary":for(var a="",i=0;i<e.length;++i)a+=String.fromCharCode(e[i]);return s.type=="base64"?Base64_encode(a):s.type=="string"?utf8read(a):a;case"file":return write_dl(s.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+s.type)}}function writeSync(e,s){reset_cp(),check_wb(e);var a=dup(s||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var i=writeSync(e,a);return a.type="array",s2ab(i)}var o=0;if(a.sheet&&(typeof a.sheet=="number"?o=a.sheet:o=e.SheetNames.indexOf(a.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,a),a);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[o]],a),a);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[o]],a),a);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[o]],a),a,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"fods":return write_string_type(write_ods(e,a),a);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[o]],a),a);case"wk3":return write_binary_type(WK_.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),write_binary_type(write_biff_buf(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),write_cfb_type(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var s={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(e.bookType=a.slice(1)),e.bookType=s[e.bookType]||e.bookType}}function writeFileSync(e,s,a){var i={};return i.type="file",i.file=s,resolve_book_type(i),writeSync(e,i)}function make_json_row(e,s,a,i,o,c,d,h){var g=encode_row(a),_=h.defval,b=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),j=!0,_e=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(_e,"__rowNum__",{value:a,enumerable:!1})}catch{_e.__rowNum__=a}else _e.__rowNum__=a;if(!d||e[a])for(var tt=s.s.c;tt<=s.e.c;++tt){var rt=d?e[a][tt]:e[i[tt]+g];if(rt===void 0||rt.t===void 0){if(_===void 0)continue;c[tt]!=null&&(_e[c[tt]]=_);continue}var et=rt.v;switch(rt.t){case"z":if(et==null)break;continue;case"e":et=et==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+rt.t)}if(c[tt]!=null){if(et==null)if(rt.t=="e"&&et===null)_e[c[tt]]=null;else if(_!==void 0)_e[c[tt]]=_;else if(b&&et===null)_e[c[tt]]=null;else continue;else _e[c[tt]]=b&&(rt.t!=="n"||rt.t==="n"&&h.rawNumbers!==!1)?et:format_cell(rt,et,h);et!=null&&(j=!1)}}return{row:_e,isempty:j}}function sheet_to_json(e,s){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},i=0,o=1,c=[],d=0,h="",g={s:{r:0,c:0},e:{r:0,c:0}},_=s||{},b=_.range!=null?_.range:e["!ref"];switch(_.header===1?i=1:_.header==="A"?i=2:Array.isArray(_.header)?i=3:_.header==null&&(i=0),typeof b){case"string":g=safe_decode_range(b);break;case"number":g=safe_decode_range(e["!ref"]),g.s.r=b;break;default:g=b}i>0&&(o=0);var j=encode_row(g.s.r),_e=[],tt=[],rt=0,et=0,st=Array.isArray(e),at=g.s.r,it=0,nt={};st&&!e[at]&&(e[at]=[]);var ot=_.skipHidden&&e["!cols"]||[],dt=_.skipHidden&&e["!rows"]||[];for(it=g.s.c;it<=g.e.c;++it)if(!(ot[it]||{}).hidden)switch(_e[it]=encode_col(it),a=st?e[at][it]:e[_e[it]+j],i){case 1:c[it]=it-g.s.c;break;case 2:c[it]=_e[it];break;case 3:c[it]=_.header[it-g.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),h=d=format_cell(a,null,_),et=nt[d]||0,!et)nt[d]=1;else{do h=d+"_"+et++;while(nt[h]);nt[d]=et,nt[h]=1}c[it]=h}for(at=g.s.r+o;at<=g.e.r;++at)if(!(dt[at]||{}).hidden){var ht=make_json_row(e,g,at,_e,i,c,st,_);(ht.isempty===!1||(i===1?_.blankrows!==!1:_.blankrows))&&(tt[rt++]=ht.row)}return tt.length=rt,tt}var qreg=/"/g;function make_csv_row(e,s,a,i,o,c,d,h){for(var g=!0,_=[],b="",j=encode_row(a),_e=s.s.c;_e<=s.e.c;++_e)if(i[_e]){var tt=h.dense?(e[a]||[])[_e]:e[i[_e]+j];if(tt==null)b="";else if(tt.v!=null){g=!1,b=""+(h.rawNumbers&&tt.t=="n"?tt.v:format_cell(tt,null,h));for(var rt=0,et=0;rt!==b.length;++rt)if((et=b.charCodeAt(rt))===o||et===c||et===34||h.forceQuotes){b='"'+b.replace(qreg,'""')+'"';break}b=="ID"&&(b='"ID"')}else tt.f!=null&&!tt.F?(g=!1,b="="+tt.f,b.indexOf(",")>=0&&(b='"'+b.replace(qreg,'""')+'"')):b="";_.push(b)}return h.blankrows===!1&&g?null:_.join(d)}function sheet_to_csv(e,s){var a=[],i=s??{};if(e==null||e["!ref"]==null)return"";var o=safe_decode_range(e["!ref"]),c=i.FS!==void 0?i.FS:",",d=c.charCodeAt(0),h=i.RS!==void 0?i.RS:`
`,g=h.charCodeAt(0),_=new RegExp((c=="|"?"\\|":c)+"+$"),b="",j=[];i.dense=Array.isArray(e);for(var _e=i.skipHidden&&e["!cols"]||[],tt=i.skipHidden&&e["!rows"]||[],rt=o.s.c;rt<=o.e.c;++rt)(_e[rt]||{}).hidden||(j[rt]=encode_col(rt));for(var et=0,st=o.s.r;st<=o.e.r;++st)(tt[st]||{}).hidden||(b=make_csv_row(e,o,st,j,d,g,c,i),b!=null&&(i.strip&&(b=b.replace(_,"")),(b||i.blankrows!==!1)&&a.push((et++?h:"")+b)));return delete i.dense,a.join("")}function sheet_to_txt(e,s){s||(s={}),s.FS="	",s.RS=`
`;var a=sheet_to_csv(e,s);return a}function sheet_to_formulae(e){var s="",a,i="";if(e==null||e["!ref"]==null)return[];var o=safe_decode_range(e["!ref"]),c="",d=[],h,g=[],_=Array.isArray(e);for(h=o.s.c;h<=o.e.c;++h)d[h]=encode_col(h);for(var b=o.s.r;b<=o.e.r;++b)for(c=encode_row(b),h=o.s.c;h<=o.e.c;++h)if(s=d[h]+c,a=_?(e[b]||[])[h]:e[s],i="",a!==void 0){if(a.F!=null){if(s=a.F,!a.f)continue;i=a.f,s.indexOf(":")==-1&&(s=s+":"+s)}if(a.f!=null)i=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)i=""+a.v;else if(a.t=="b")i=a.v?"TRUE":"FALSE";else if(a.w!==void 0)i="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?i="'"+a.v:i=""+a.v}}g[g.length]=s+"="+i}return g}function sheet_add_json(e,s,a){var i=a||{},o=+!i.skipHeader,c=e||{},d=0,h=0;if(c&&i.origin!=null)if(typeof i.origin=="number")d=i.origin;else{var g=typeof i.origin=="string"?decode_cell(i.origin):i.origin;d=g.r,h=g.c}var _,b={s:{c:0,r:0},e:{c:h,r:d+s.length-1+o}};if(c["!ref"]){var j=safe_decode_range(c["!ref"]);b.e.c=Math.max(b.e.c,j.e.c),b.e.r=Math.max(b.e.r,j.e.r),d==-1&&(d=j.e.r+1,b.e.r=d+s.length-1+o)}else d==-1&&(d=0,b.e.r=s.length-1+o);var _e=i.header||[],tt=0;s.forEach(function(et,st){keys(et).forEach(function(at){(tt=_e.indexOf(at))==-1&&(_e[tt=_e.length]=at);var it=et[at],nt="z",ot="",dt=encode_cell({c:h+tt,r:d+st+o});_=ws_get_cell_stub(c,dt),it&&typeof it=="object"&&!(it instanceof Date)?c[dt]=it:(typeof it=="number"?nt="n":typeof it=="boolean"?nt="b":typeof it=="string"?nt="s":it instanceof Date?(nt="d",i.cellDates||(nt="n",it=datenum(it)),ot=i.dateNF||table_fmt[14]):it===null&&i.nullError&&(nt="e",it=0),_?(_.t=nt,_.v=it,delete _.w,delete _.R,ot&&(_.z=ot)):c[dt]=_={t:nt,v:it},ot&&(_.z=ot))})}),b.e.c=Math.max(b.e.c,h+_e.length-1);var rt=encode_row(d);if(o)for(tt=0;tt<_e.length;++tt)c[encode_col(tt+h)+rt]={t:"s",v:_e[tt]};return c["!ref"]=encode_range(b),c}function json_to_sheet(e,s){return sheet_add_json(null,e,s)}function ws_get_cell_stub(e,s,a){if(typeof s=="string"){if(Array.isArray(e)){var i=decode_cell(s);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[s]||(e[s]={t:"z"})}return typeof s!="number"?ws_get_cell_stub(e,encode_cell(s)):ws_get_cell_stub(e,encode_cell({r:s,c:a||0}))}function wb_sheet_idx(e,s){if(typeof s=="number"){if(s>=0&&e.SheetNames.length>s)return s;throw new Error("Cannot find sheet # "+s)}else if(typeof s=="string"){var a=e.SheetNames.indexOf(s);if(a>-1)return a;throw new Error("Cannot find sheet name |"+s+"|")}else throw new Error("Cannot find sheet |"+s+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,s,a,i){var o=1;if(!a)for(;o<=65535&&e.SheetNames.indexOf(a="Sheet"+o)!=-1;++o,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(a)>=0){var c=a.match(/(^.*?)(\d+)$/);o=c&&+c[2]||0;var d=c&&c[1]||a;for(++o;o<=65535&&e.SheetNames.indexOf(a=d+o)!=-1;++o);}if(check_ws_name(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=s,a}function book_set_sheet_visibility(e,s,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=wb_sheet_idx(e,s);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[i].Hidden=a}function cell_set_number_format(e,s){return e.z=s,e}function cell_set_hyperlink(e,s,a){return s?(e.l={Target:s},a&&(e.l.Tooltip=a)):delete e.l,e}function cell_set_internal_link(e,s,a){return cell_set_hyperlink(e,"#"+s,a)}function cell_add_comment(e,s,a){e.c||(e.c=[]),e.c.push({t:s,a:a||"SheetJS"})}function sheet_set_array_formula(e,s,a,i){for(var o=typeof s!="string"?s:safe_decode_range(s),c=typeof s=="string"?s:encode_range(s),d=o.s.r;d<=o.e.r;++d)for(var h=o.s.c;h<=o.e.c;++h){var g=ws_get_cell_stub(e,d,h);g.t="n",g.F=c,delete g.v,d==o.s.r&&h==o.s.c&&(g.f=a,i&&(g.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const EmailExtractor=()=>{const[e,s]=reactExports.useState(""),[a,i]=reactExports.useState([]),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState("success"),[b,j]=reactExports.useState(!0),[_e,tt]=reactExports.useState(!0);reactExports.useState(!1);const[rt,et]=reactExports.useState(!1);useSecurity();const st=reactExports.useRef(null),at=reactExports.useCallback((mt,Et)=>{h(mt),_(Et),c(!0)},[]),it=mt=>{if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(mt))return!1;const Ft=mt.split("@"),Vt=Ft[0],Mt=Ft[1];return!(Vt.length>64||Vt.startsWith(".")||Vt.endsWith(".")||Vt.includes("..")||Mt.startsWith("-")||Mt.endsWith("-")||Mt.includes("..")||Mt.split(".").some(kt=>kt.length>63))},nt=reactExports.useCallback(async(mt,Et=!1)=>{et(!0);try{const Ft=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,Mt=(mt.match(Ft)||[]).filter(it).map(kt=>kt.toLowerCase()),Ct=[...new Set(Mt)];if(i(Ct),Ct.length>0)if(Et&&_e)try{await navigator.clipboard.writeText(Ct.join(`
`)),at(`Extracted ${Ct.length} emails and copied to clipboard!`,"success")}catch{at(`Extracted ${Ct.length} emails (copy failed)`,"warning")}else at(`Extracted ${Ct.length} unique emails!`,"success");else at("No valid emails found in the text.","warning")}catch{at("Error processing text. Please try again.","error")}finally{et(!1)}},[at,_e]),ot=async mt=>{try{const Et=readSync(mt,{type:"array"});let Ft="";for(const Vt of Et.SheetNames){const Mt=Et.Sheets[Vt];utils.sheet_to_json(Mt,{header:1}).forEach(kt=>{Array.isArray(kt)&&kt.forEach(jt=>{jt&&(Ft+=String(jt)+" ")})})}s(Ft),at("Excel file processed successfully!","success"),b&&await nt(Ft,!0)}catch{at("Failed to process Excel file","error")}},dt=async mt=>{var Ft;const Et=(Ft=mt.target.files)==null?void 0:Ft[0];if(Et){et(!0);try{const Vt=Et.name.toLowerCase();if(Vt.endsWith(".txt")){const Mt=await Et.text();s(Mt),at("TXT file uploaded successfully!","success"),b&&await nt(Mt,!0)}else if(Vt.endsWith(".xlsx")||Vt.endsWith(".xls")){const Mt=await Et.arrayBuffer();await ot(Mt)}else at("Unsupported file type. Only TXT and Excel files are allowed.","error")}catch{at("Error processing file. Please try again.","error")}finally{et(!1),st.current&&(st.current.value="")}}},ht=async()=>{if(a.length===0){at("No emails to copy!","warning");return}try{await navigator.clipboard.writeText(a.join(`
`)),at("Emails copied to clipboard!","success")}catch{at("Failed to copy emails!","error")}},lt=()=>{if(a.length===0){at("No emails to download!","warning");return}const mt=new Blob([a.join(`
`)],{type:"text/plain"}),Et=URL.createObjectURL(mt),Ft=document.createElement("a");Ft.href=Et,Ft.download="extracted_emails.txt",document.body.appendChild(Ft),Ft.click(),document.body.removeChild(Ft),URL.revokeObjectURL(Et),at("Emails downloaded as TXT file!","success")},gt=()=>{if(a.length===0){at("No emails to download!","warning");return}const mt=utils.aoa_to_sheet([["Email"],...a.map(Ft=>[Ft])]),Et=utils.book_new();utils.book_append_sheet(Et,mt,"Emails"),writeFileSync(Et,"extracted_emails.xlsx"),at("Emails downloaded as Excel file!","success")},yt=async()=>{try{const mt=await navigator.clipboard.readText();s(mt),at("Text pasted from clipboard!","success"),b&&await nt(mt,!0)}catch{at("Failed to paste from clipboard!","error")}},Tt=()=>{s(""),i([]),at("All data cleared!","success")};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-purple-500/30 to-purple-400/10 py-8 px-4",children:[jsxRuntimeExports.jsx("div",{className:"container mx-auto max-w-6xl space-y-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-xl p-6",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Input Text"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:mt=>j(!b),className:`px-3 py-1.5 text-sm font-medium rounded-lg flex items-center gap-2 transition-all duration-200 ${b?"bg-blue-500 text-white shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"}`,children:[b?"":""," Auto Extract"]}),jsxRuntimeExports.jsxs("button",{onClick:mt=>tt(!_e),className:`px-3 py-1.5 text-sm font-medium rounded-lg flex items-center gap-2 transition-all duration-200 ${_e?"bg-blue-500 text-white shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"}`,children:[_e?"":""," Auto Copy"]}),jsxRuntimeExports.jsxs("button",{onClick:yt,className:"px-4 py-2 bg-blue-500 text-white rounded-lg font-medium shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30 transition-all duration-200 flex items-center gap-2",disabled:rt,children:[jsxRuntimeExports.jsx(Copy,{size:16}),"Paste"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("textarea",{value:e,onChange:mt=>{s(mt.target.value),b&&nt(mt.target.value,!0)},placeholder:"Paste your text containing email addresses here...",className:"w-full h-[350px] p-4 border border-gray-200 dark:border-gray-600 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none dark:bg-gray-700/50 dark:text-white placeholder-gray-400 dark:placeholder-gray-500",disabled:rt}),rt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/5 backdrop-blur-[1px] flex items-center justify-center rounded-2xl",children:jsxRuntimeExports.jsx(LoadingSpinner,{size:"lg"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>nt(e),className:"px-4 py-2.5 bg-emerald-500 text-white rounded-xl font-medium shadow-lg shadow-emerald-500/20 hover:shadow-emerald-500/30 transition-all duration-200 flex items-center gap-2 flex-1",disabled:rt||!e,children:[jsxRuntimeExports.jsx(Mail,{size:18}),"Extract Emails"]}),jsxRuntimeExports.jsxs("button",{onClick:Tt,className:"px-4 py-2.5 bg-red-500 text-white rounded-xl font-medium shadow-lg shadow-red-500/20 hover:shadow-red-500/30 transition-all duration-200 flex items-center gap-2",disabled:rt||!e,children:[jsxRuntimeExports.jsx(Trash2,{size:18}),"Clear All"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{var mt;return(mt=st.current)==null?void 0:mt.click()},className:"px-4 py-2.5 bg-orange-500 text-white rounded-xl font-medium shadow-lg shadow-orange-500/20 hover:shadow-orange-500/30 transition-all duration-200 flex items-center gap-2",disabled:rt,children:[jsxRuntimeExports.jsx(Upload,{size:18}),"Upload File"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-xl p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:["Extracted Emails (",a.length,")"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:ht,className:"px-4 py-2 bg-blue-500 text-white rounded-lg font-medium shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30 transition-all duration-200 flex items-center gap-2",disabled:rt||a.length===0,children:[jsxRuntimeExports.jsx(Copy,{size:16}),"Copy"]}),jsxRuntimeExports.jsxs("button",{onClick:lt,className:"px-4 py-2 bg-purple-500 text-white rounded-lg font-medium shadow-lg shadow-purple-500/20 hover:shadow-purple-500/30 transition-all duration-200 flex items-center gap-2",disabled:rt||a.length===0,children:[jsxRuntimeExports.jsx(Download,{size:16}),"TXT"]}),jsxRuntimeExports.jsxs("button",{onClick:gt,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg font-medium shadow-lg shadow-emerald-500/20 hover:shadow-emerald-500/30 transition-all duration-200 flex items-center gap-2",disabled:rt||a.length===0,children:[jsxRuntimeExports.jsx(Download,{size:16}),"Excel"]})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 border border-gray-100 dark:border-gray-600 rounded-2xl h-[400px] overflow-y-auto",children:a.length>0?jsxRuntimeExports.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:a.map((mt,Et)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-3 hover:bg-white dark:hover:bg-gray-700 group transition-colors duration-150",children:[jsxRuntimeExports.jsx(Mail,{size:16,className:"text-gray-400 dark:text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium flex-1",children:mt}),jsxRuntimeExports.jsx("button",{onClick:()=>{navigator.clipboard.writeText(mt),at("Email copied to clipboard!","success")},className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:jsxRuntimeExports.jsx(Copy,{size:14,className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"})})]},Et))}):jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 p-6",children:[jsxRuntimeExports.jsx(Mail,{size:48,className:"mb-3 opacity-30"}),jsxRuntimeExports.jsx("p",{className:"text-center font-medium",children:"No emails extracted yet"}),jsxRuntimeExports.jsx("p",{className:"text-sm opacity-75 mt-1",children:'Paste text and click "Extract Emails"'})]})})]})]})}),jsxRuntimeExports.jsx("input",{type:"file",ref:st,onChange:dt,accept:".txt,.xlsx,.xls",className:"hidden"}),o&&jsxRuntimeExports.jsx(SecurityPopup,{show:o,message:d,type:g,onClose:()=>c(!1)})]})},DuplicateRemover=()=>{const[e,s]=reactExports.useState(""),[a,i]=reactExports.useState([]),[o,c]=reactExports.useState({total:0,unique:0,removed:0}),[d,h]=reactExports.useState(!1),[g,_]=reactExports.useState(""),[b,j]=reactExports.useState("success");useSecurity();const _e=(dt,ht)=>{_(dt),j(ht),h(!0)},tt=reactExports.useCallback(()=>{if(!e.trim()){_e("Please enter some text first!","warning");return}const dt=e.split(/\r?\n/).map(gt=>gt.trim()).filter(gt=>gt!==""),ht=new Set,lt=dt.filter(gt=>ht.has(gt)?!1:(ht.add(gt),!0));i(lt),c({total:dt.length,unique:lt.length,removed:dt.length-lt.length}),_e(`Removed ${dt.length-lt.length} duplicates!`,"success")},[e]),rt=()=>{if(a.length===0){_e("No data to sort! Remove duplicates first.","warning");return}const dt=[...a].sort();i(dt),_e("Lines sorted alphabetically!","success")},et=async()=>{if(a.length===0){_e("No data to copy!","warning");return}try{await navigator.clipboard.writeText(a.join(`
`)),_e("Copied to clipboard!","success")}catch{_e("Failed to copy!","error")}},st=()=>{if(a.length===0){_e("No data to download!","warning");return}const dt=new Blob([a.join(`
`)],{type:"text/plain"}),ht=URL.createObjectURL(dt),lt=document.createElement("a");lt.href=ht,lt.download="unique_lines.txt",document.body.appendChild(lt),lt.click(),document.body.removeChild(lt),URL.revokeObjectURL(ht),_e("File downloaded successfully!","success")},at=async()=>{try{const dt=await navigator.clipboard.readText();s(dt),_e("Text pasted from clipboard!","success")}catch{_e("Failed to paste from clipboard!","error")}},it=()=>{s(""),i([]),c({total:0,unique:0,removed:0}),_e("All data cleared!","success")},nt=()=>{s(""),_e("Input cleared!","success")},ot=()=>{i([]),c({total:0,unique:0,removed:0}),_e("Output cleared!","success")};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Input Text"}),jsxRuntimeExports.jsxs("button",{onClick:at,className:"flex items-center space-x-2 px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Upload,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Paste"})]})]}),jsxRuntimeExports.jsx("textarea",{value:e,onChange:dt=>s(dt.target.value),className:"w-full h-64 p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none bg-white/50 backdrop-blur-sm",placeholder:"Paste your text with duplicates here..."}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-3 mt-4",children:[jsxRuntimeExports.jsxs("button",{onClick:tt,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-200 transform hover:scale-105",children:[jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Remove Duplicates"})]}),jsxRuntimeExports.jsxs("button",{onClick:rt,className:"flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Sort A-Z"})]}),jsxRuntimeExports.jsxs("button",{onClick:nt,className:"flex items-center space-x-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Clear Input"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Processed Text (",a.length," lines)"]}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsxs("button",{onClick:et,className:"flex items-center space-x-2 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Copy"})]}),jsxRuntimeExports.jsxs("button",{onClick:st,className:"flex items-center space-x-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Download"})]}),jsxRuntimeExports.jsxs("button",{onClick:ot,className:"flex items-center space-x-2 px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Clear"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"h-64 overflow-y-auto bg-gray-50 rounded-xl p-4 border",children:a.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-2",children:a.map((dt,ht)=>jsxRuntimeExports.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200",children:jsxRuntimeExports.jsx("span",{className:"text-gray-800 font-mono text-sm",children:dt})},ht))}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Copy,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"No processed text yet"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:'Add text and click "Remove Duplicates"'})]})})})]})]}),o.total>0&&jsxRuntimeExports.jsxs("div",{className:"mt-6 bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[jsxRuntimeExports.jsx(BarChart3,{className:"w-6 h-6 text-purple-600"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Processing Statistics"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:o.total}),jsxRuntimeExports.jsx("div",{className:"text-blue-100",children:"Total Lines"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:o.unique}),jsxRuntimeExports.jsx("div",{className:"text-green-100",children:"Unique Lines"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:o.removed}),jsxRuntimeExports.jsx("div",{className:"text-red-100",children:"Duplicates Removed"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 text-center",children:jsxRuntimeExports.jsxs("button",{onClick:it,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-xl hover:from-red-600 hover:to-pink-700 transition-all duration-200 transform hover:scale-105 mx-auto",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{children:"Clear Everything"})]})})]}),d&&jsxRuntimeExports.jsx(SecurityPopup,{show:d,message:g,type:b,onClose:()=>h(!1)})]})},UserAgentMixer=()=>{const[e,s]=reactExports.useState([{id:"1",name:"iPhone",userAgents:[]},{id:"2",name:"Samsung",userAgents:[]},{id:"3",name:"Motorola",userAgents:[]}]),[a,i]=reactExports.useState([]),[o,c]=reactExports.useState(""),[d,h]=reactExports.useState(!1),[g,_]=reactExports.useState(""),[b,j]=reactExports.useState("success"),{logout:_e}=useSecurity(),[tt,rt]=reactExports.useState(!1),[et,st]=reactExports.useState(!1);reactExports.useState("");const at=reactExports.useRef(null),it=(Ct,kt)=>{_(Ct),j(kt),h(!0)},nt=Ct=>typeof Ct=="string"&&Ct.length>20&&(Ct.toLowerCase().includes("mozilla")||Ct.toLowerCase().includes("applewebkit")||Ct.toLowerCase().includes("chrome")),ot=Ct=>{const kt=new Set;return Ct.map(jt=>jt.trim()).filter(jt=>jt.length>0).filter(nt).filter(jt=>{const ut=jt.toLowerCase();return kt.has(ut)?!1:(kt.add(ut),!0)})},dt=(Ct,kt)=>{const jt=kt.split(/\r?\n/).filter(Boolean),ut=ot(jt);s(Lt=>Lt.map(Pt=>Pt.id===Ct?{...Pt,userAgents:ut}:Pt))},ht=Ct=>{const kt=e.find(jt=>jt.id===Ct);kt&&window.confirm(`Are you sure you want to clear all user agents for "${kt.name}"?`)&&(s(jt=>jt.map(ut=>ut.id===Ct?{...ut,userAgents:[]}:ut)),it(`Cleared user agents for "${kt.name}"!`,"success"))},lt=()=>{if(!o.trim()){it("Please enter a device name!","warning");return}if(e.some(kt=>kt.name.toLowerCase()===o.toLowerCase())){it("Device name already exists!","error");return}const Ct={id:Date.now().toString(),name:o.trim(),userAgents:[]};s(kt=>[...kt,Ct]),c(""),it(`Device "${Ct.name}" added successfully!`,"success")},gt=Ct=>{const kt=e.find(jt=>jt.id===Ct);kt&&window.confirm(`Are you sure you want to delete "${kt.name}"?`)&&(s(jt=>jt.filter(ut=>ut.id!==Ct)),it(`Device "${kt.name}" removed successfully!`,"success"))},yt=async Ct=>{try{const kt=await navigator.clipboard.readText(),jt=e.find(ut=>ut.id===Ct);if(jt){const ut=jt.userAgents.join(`
`),Lt=ut?`${ut}
${kt}`:kt;dt(Ct,Lt),it("User agents pasted successfully!","success")}}catch{it("Failed to paste from clipboard!","error")}},Tt=(Ct,kt)=>{var Pt;const jt=(Pt=Ct.target.files)==null?void 0:Pt[0];if(!jt)return;const ut=new FileReader,Lt=e.find(ft=>ft.id===kt);Lt&&(jt.name.endsWith(".txt")?(ut.onload=()=>{const ft=ut.result,Rt=Lt.userAgents.join(`
`),bt=Rt?`${Rt}
${ft}`:ft;dt(kt,bt),it("TXT file uploaded successfully!","success")},ut.readAsText(jt)):jt.name.endsWith(".xlsx")&&(ut.onload=ft=>{var Rt;try{const bt=new Uint8Array((Rt=ft.target)==null?void 0:Rt.result),At=readSync(bt,{type:"array"}),Ut=At.Sheets[At.SheetNames[0]],Gt=utils.sheet_to_json(Ut,{header:1}).flat().filter(er=>typeof er=="string"&&er.trim()),zt=Lt.userAgents.join(`
`),Wt=zt?`${zt}
${Gt.join(`
`)}`:Gt.join(`
`);dt(kt,Wt),it("Excel file uploaded successfully!","success")}catch{it("Error processing Excel file!","error")}},ut.readAsArrayBuffer(jt)),Ct.target.value="")};reactExports.useCallback(()=>{e.forEach(Pt=>{const ft=document.querySelector(`#device-${Pt.id} textarea`);ft&&dt(Pt.id,ft.value)});const Ct=e.find(Pt=>Pt.name.toLowerCase()==="iphone"),kt=Ct?[...Ct.userAgents]:[];if(!kt.length){it("At least one iPhone user agent is required!","error");return}const jt=e.filter(Pt=>Pt.name.toLowerCase()!=="iphone").map(Pt=>({name:Pt.name,list:[...Pt.userAgents]})).filter(Pt=>Pt.list.length>0);if(!jt.length){i(kt),it(`Mixed ${kt.length} user agents successfully!`,"success");return}const ut=[];let Lt=0;for(;kt.length||jt.some(Pt=>Pt.list.length);){const Pt=jt.reduce((Rt,bt)=>Rt+bt.list.length,0),ft=Pt?Math.ceil(kt.length/(Pt+1)):kt.length;for(let Rt=0;Rt<ft&&kt.length;Rt++)ut.push(kt.shift());if(Pt){let Rt=0;for(;Rt<jt.length;){const bt=jt[Lt];if(Lt=(Lt+1)%jt.length,Rt++,bt.list.length){ut.push(bt.list.shift());break}}}}i(ut),it(`Mixed ${ut.length} user agents successfully!`,"success")},[e]);const mt=async()=>{if(a.length===0){it("No mixed user agents to copy!","warning");return}try{await navigator.clipboard.writeText(a.join(`
`)),it("Mixed user agents copied to clipboard!","success")}catch{it("Failed to copy user agents!","error")}},Et=()=>{if(a.length===0){it("No mixed user agents to download!","warning");return}const Ct=new Blob([a.join(`
`)],{type:"text/plain"}),kt=URL.createObjectURL(Ct),jt=document.createElement("a");jt.href=kt,jt.download="mixed-user-agents.txt",document.body.appendChild(jt),jt.click(),document.body.removeChild(jt),URL.revokeObjectURL(kt),it("User agents downloaded as TXT file!","success")},Ft=()=>{if(a.length===0){it("No mixed user agents to download!","warning");return}try{const Ct=utils.aoa_to_sheet(a.map(jt=>[jt])),kt=utils.book_new();utils.book_append_sheet(kt,Ct,"UserAgents"),writeFileSync(kt,"mixed-user-agents.xlsx"),it("User agents downloaded as Excel file!","success")}catch{it("Error creating Excel file!","error")}},Vt=()=>{e.forEach(Pt=>{const ft=document.querySelector(`#device-${Pt.id} textarea`);ft&&dt(Pt.id,ft.value)});const Ct=e.find(Pt=>Pt.name.toLowerCase()==="iphone"),kt=Ct?[...Ct.userAgents]:[];if(!kt.length){it("At least one iPhone user agent is required!","error");return}const jt=e.filter(Pt=>Pt.name.toLowerCase()!=="iphone").map(Pt=>({name:Pt.name,list:[...Pt.userAgents]})).filter(Pt=>Pt.list.length>0);if(!jt.length){i(kt),it(`Mixed ${kt.length} user agents successfully!`,"success");return}const ut=[];let Lt=0;for(;kt.length||jt.some(Pt=>Pt.list.length);){const Pt=jt.reduce((Rt,bt)=>Rt+bt.list.length,0),ft=Pt?Math.ceil(kt.length/(Pt+1)):kt.length;for(let Rt=0;Rt<ft&&kt.length;Rt++)ut.push(kt.shift());if(Pt){let Rt=0;for(;Rt<jt.length;){const bt=jt[Lt];if(Lt=(Lt+1)%jt.length,Rt++,bt.list.length){ut.push(bt.list.shift());break}}}}i(ut),it(`Mixed ${ut.length} user agents successfully!`,"success")},Mt=()=>{s(Ct=>Ct.map(kt=>({...kt,userAgents:[]}))),i([]),it("All user agents cleared!","success")};return jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold mb-4 md:mb-0",children:"User Agent Mixer"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 justify-center md:justify-end",children:[jsxRuntimeExports.jsxs(Link,{to:"/",className:"btn btn-outline-secondary flex items-center gap-2",children:[jsxRuntimeExports.jsx(Home,{size:20})," Home"]}),jsxRuntimeExports.jsxs("button",{onClick:_e,className:"btn btn-outline-danger flex items-center gap-2",children:[jsxRuntimeExports.jsx(LogOut,{size:20})," Logout"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.map(Ct=>jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow p-4 relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold",children:Ct.name}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ht(Ct.id),className:"p-1 hover:bg-gray-100 rounded",children:jsxRuntimeExports.jsx(Trash2,{size:18,className:"text-red-500"})}),Ct.id!=="1"&&Ct.id!=="2"&&Ct.id!=="3"&&jsxRuntimeExports.jsx("button",{onClick:()=>gt(Ct.id),className:"p-1 hover:bg-gray-100 rounded",children:jsxRuntimeExports.jsx(X,{size:18,className:"text-gray-500"})})]})]}),jsxRuntimeExports.jsx("textarea",{value:Ct.userAgents.join(`
`),onChange:kt=>dt(Ct.id,kt.target.value),className:"w-full h-[150px] p-3 border rounded mb-4 text-sm",placeholder:`Paste ${Ct.name} user agents here...`}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>yt(Ct.id),className:"btn btn-secondary flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx(File$1,{size:16})," Paste"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{var kt;return(kt=at.current)==null?void 0:kt.click()},className:"btn btn-primary flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx(Upload,{size:16})," Upload"]}),jsxRuntimeExports.jsx("input",{type:"file",ref:at,className:"hidden",accept:".txt,.xlsx",onChange:kt=>Tt(kt,Ct.id)})]})]},Ct.id)),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:Ct=>c(Ct.target.value),className:"flex-1 p-2 border rounded",placeholder:"Enter device name..."}),jsxRuntimeExports.jsxs("button",{onClick:lt,className:"btn btn-success flex items-center gap-2",children:[jsxRuntimeExports.jsx(Plus,{size:20})," Add"]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold",children:"Mixed User Agents"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsxs("button",{onClick:()=>rt(!tt),className:"btn btn-outline-primary flex items-center gap-2",children:[tt?jsxRuntimeExports.jsx(ToggleRight,{size:20}):jsxRuntimeExports.jsx(ToggleLeft,{size:20}),"Auto Mix"]})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsxs("button",{onClick:()=>st(!et),className:"btn btn-outline-primary flex items-center gap-2",children:[et?jsxRuntimeExports.jsx(ToggleRight,{size:20}):jsxRuntimeExports.jsx(ToggleLeft,{size:20}),"Auto Copy"]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[jsxRuntimeExports.jsxs("button",{onClick:Vt,className:"btn btn-primary flex items-center gap-2",children:[jsxRuntimeExports.jsx(Shuffle,{size:20})," Mix"]}),jsxRuntimeExports.jsxs("button",{onClick:mt,className:"btn btn-secondary flex items-center gap-2",children:[jsxRuntimeExports.jsx(Copy,{size:20})," Copy"]}),jsxRuntimeExports.jsxs("button",{onClick:Et,className:"btn btn-info flex items-center gap-2",children:[jsxRuntimeExports.jsx(Download,{size:20})," TXT"]}),jsxRuntimeExports.jsxs("button",{onClick:Ft,className:"btn btn-success flex items-center gap-2",children:[jsxRuntimeExports.jsx(Download,{size:20})," Excel"]}),jsxRuntimeExports.jsxs("button",{onClick:Mt,className:"btn btn-danger flex items-center gap-2",children:[jsxRuntimeExports.jsx(Trash2,{size:20})," Clear"]})]}),jsxRuntimeExports.jsx("textarea",{value:a.join(`
`),readOnly:!0,className:"w-full h-[200px] p-3 border rounded bg-gray-50",placeholder:"Mixed user agents will appear here..."})]}),jsxRuntimeExports.jsx(SecurityPopup,{show:d,message:g,type:b,onClose:()=>h(!1)})]})},motorolaVersions=[["moto g84 5G","13","T3TC33.23-39-5-2"],["moto g54 5G","13","T3TC33.23-39-5-2"],["moto g53 5G","13","T3TC33.23-39-5-2"],["moto g73 5G","13","T3TC33.23-39-5-2"],["moto g72","12","S3SAS32.45-28-2-2"],["moto g52","12","S3SAS32.45-28-2-2"],["moto g42","12","S3SAS32.45-28-2-2"],["moto g32","12","S3SAS32.45-28-2-2"],["moto g22","12","S3SAS32.45-28-2-2"],["moto g13","13","T3TC33.23-39-5-2"],["moto g23","13","T3TC33.23-39-5-2"],["moto e13","13","T3TC33.23-39-5-2"],["moto e22","12","S3SAS32.45-28-2-2"],["moto e32","12","S3SAS32.45-28-2-2"],["moto e40","11","RRBS31.Q3-75-14-2"]],androidFbChromeMapping={11:[["515","103.0.5060.129"],["516","105.0.5195.136"]],12:[["516","108.0.5359.128"],["517","110.0.5481.153"]],13:[["517","116.0.5845.172"],["518","119.0.6045.163"]]},pixelDevices=[["Pixel 7","13","TQ3A.230901.001"],["Pixel 7 Pro","13","TQ3A.230901.001"],["Pixel 7a","13","TQ3A.230901.001"],["Pixel 6","13","TQ3A.230901.001"],["Pixel 6 Pro","13","TQ3A.230901.001"],["Pixel 6a","13","TQ3A.230901.001"],["Pixel 5","13","TQ3A.230901.001"],["Pixel 5a","13","TQ3A.230901.001"],["Pixel 4a","13","TQ3A.230901.001"],["Pixel 4","13","TQ3A.230901.001"],["Pixel 4 XL","13","TQ3A.230901.001"]],pixelFbVersions=["515.0.0.36.158","516.0.0.42.117","517.0.0.44.116"],pixelChromeVersion="116.0.5845.172",languages=["en_US","es_US"],screenScaling=["2","3"],iabmvOptions=["1"],fbrv_used=new Set,UserAgentGenerator=()=>{const[e,s]=reactExports.useState([{type:"iphone",percentage:25,enabled:!0},{type:"samsung",percentage:25,enabled:!0},{type:"motorola",percentage:25,enabled:!0},{type:"pixel",percentage:25,enabled:!0}]),[a,i]=reactExports.useState(100),[o,c]=reactExports.useState([]),[d,h]=reactExports.useState(!1);reactExports.useState(!1),reactExports.useState(""),reactExports.useState("success"),reactExports.useState(null),useSecurity();const{isDarkMode:g}=useTheme(),[_,b]=reactExports.useState([]),[j,_e]=reactExports.useState([]),[tt,rt]=reactExports.useState([]),[et,st]=reactExports.useState([]),[at,it]=reactExports.useState(!0);reactExports.useEffect(()=>{nt()},[]);const nt=async()=>{try{it(!0);const{data:kt,error:jt}=await supabase.from("ios_device_ranges").select("*");if(jt)throw jt;b(kt);const{data:ut,error:Lt}=await supabase.from("ios_versions").select("*");if(Lt)throw Lt;_e(ut);const{data:Pt,error:ft}=await supabase.from("fb_versions").select("*");if(ft)throw ft;rt(Pt);const{data:Rt,error:bt}=await supabase.from("samsung_configs").select("*");if(bt)throw bt;st(Rt)}catch(kt){console.error("Error fetching configurations:",kt)}finally{it(!1)}},ot=(kt,jt)=>{console.log(`${jt}: ${kt}`)},dt=kt=>kt.split(".").slice(0,2).join("."),ht=(kt,jt)=>{const ut=kt.split(".").map(Number),Lt=jt.split(".").map(Number);for(let Pt=0;Pt<Math.max(ut.length,Lt.length);Pt++){const ft=ut[Pt]||0,Rt=Lt[Pt]||0;if(ft!==Rt)return ft-Rt}return 0},lt=kt=>{const jt=["0","1","2","3","4","5","6","7","8","9"],ut=jt[Math.floor(Math.random()*jt.length)];return`${kt}.${ut}`},gt=kt=>{const jt=tt.find(Pt=>Pt.major===kt);if(!jt)return"0";const ut=jt.min_fbbv,Lt=jt.max_fbbv;return Math.floor(ut+Math.random()*(Lt-ut+1)).toString()},yt=()=>{let kt;do kt=Math.floor(Math.random()*9e8)+1e8;while(fbrv_used.has(kt));return fbrv_used.add(kt),kt},Tt=()=>{if(_.length===0||j.length===0||tt.length===0)return"No configuration data available";const kt=_[Math.floor(Math.random()*_.length)],jt=j.filter(Gt=>{const zt=dt(Gt.version);return ht(zt,dt(kt.minVersion))>=0&&ht(zt,dt(kt.maxVersion))<=0});if(jt.length===0)return Tt();const ut=jt[Math.floor(Math.random()*jt.length)],Pt=tt[Math.floor(Math.random()*tt.length)].major,ft=lt(Pt),Rt=gt(Pt),bt=screenScaling[Math.floor(Math.random()*screenScaling.length)],At=languages[Math.floor(Math.random()*languages.length)];let Ut="",Xt="";return Math.random()<.1?Ut=";FBOP/80":(Xt=`;FBOP/5;FBRV/${yt()}`,Math.random()<.9&&(Xt+=`;IABMV/${iabmvOptions[Math.floor(Math.random()*iabmvOptions.length)]}`)),`Mozilla/5.0 (iPhone; CPU iPhone OS ${ut.version.replace(/\./g,"_")} like Mac OS X) AppleWebKit/${ut.webkit_version} (KHTML, like Gecko) Mobile/${ut.build} [FBAN/FBIOS;FBAV/${ft};FBBV/${Rt};FBDV/${kt.deviceModel};FBMD/iPhone;FBSN/iOS;FBSV/${ut.version};FBSS/${bt};FBID/phone;FBLC/${At}${Ut}${Xt}]`},mt=()=>tt.length===0?"0":tt[Math.floor(Math.random()*tt.length)].major,Et=()=>{const kt=["116.0.5845.172","117.0.5938.153","118.0.6045.163","119.0.6045.163"];return kt[Math.floor(Math.random()*kt.length)]},Ft=()=>{if(et.length===0)return"No Samsung configuration data available";const kt=et[Math.floor(Math.random()*et.length)],jt=mt(),ut=(jt.startsWith("517")&&["14","15"].includes(kt.android_version),"IABMV/1"),Lt=Et();return`Mozilla/5.0 (Linux; Android ${kt.android_version}; ${kt.model} Build/${kt.build_number}; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/${Lt} Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/${jt};${ut};]`},Vt=()=>{const[kt,jt,ut]=motorolaVersions[Math.floor(Math.random()*motorolaVersions.length)],[Lt,Pt]=androidFbChromeMapping[jt][Math.floor(Math.random()*androidFbChromeMapping[jt].length)],ft=iabmvOptions[Math.floor(Math.random()*iabmvOptions.length)],Rt=lt(Lt);return`Mozilla/5.0 (Linux; Android ${jt}; ${kt} Build/${ut}; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/${Pt} Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/${Rt};IABMV/${ft}]`},Mt=()=>{const[kt,jt,ut]=pixelDevices[Math.floor(Math.random()*pixelDevices.length)],Lt=pixelFbVersions[Math.floor(Math.random()*pixelFbVersions.length)],Pt=Lt.startsWith("515")?"4":"3";return`Mozilla/5.0 (Linux; Android ${jt}; ${kt} Build/${ut}; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/${pixelChromeVersion} Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/${Lt};IABMV/${Pt};]`},Ct=kt=>{switch(kt){case"iphone":return Tt();case"samsung":return Ft();case"motorola":return Vt();case"pixel":return Mt();default:return Tt()}};return reactExports.useCallback(async()=>{const kt=e.filter(ut=>ut.enabled&&ut.percentage>0);if(kt.length===0){ot("Please set percentages for at least one device type!","warning");return}if(a<1||a>1e4){ot("Total amount must be between 1 and 10,000!","warning");return}const jt=kt.reduce((ut,Lt)=>ut+Lt.percentage,0);if(jt===0){ot("Please set percentages for enabled devices!","warning");return}h(!0);try{const ut=[];let Lt=0;for(const Pt of kt){const ft=Pt.percentage/jt*100,Rt=Math.round(ft/100*a);for(let bt=0;bt<Rt;bt++)ut.push({userAgent:Ct(Pt.type),deviceType:Pt.type,index:Lt++})}for(;ut.length<a;){const Pt=kt[Math.floor(Math.random()*kt.length)];ut.push({userAgent:Ct(Pt.type),deviceType:Pt.type,index:Lt++})}for(;ut.length>a;)ut.pop();for(let Pt=ut.length-1;Pt>0;Pt--){const ft=Math.floor(Math.random()*(Pt+1));[ut[Pt],ut[ft]]=[ut[ft],ut[Pt]]}c(ut),ot(`Generated ${ut.length} user agents successfully!`,"success")}catch{ot("Failed to generate user agents!","error")}finally{h(!1)}},[e,a]),jsxRuntimeExports.jsxs("div",{className:`container mx-auto px-4 py-8 ${g?"text-white":"text-gray-800"}`,children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold mb-8",children:"User Agent Generator"}),at?jsxRuntimeExports.jsx("div",{className:"text-center",children:"Loading configurations..."}):jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:`${g?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6`,children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold mb-4",children:"iPhone User Agent"}),jsxRuntimeExports.jsx("button",{onClick:()=>{const kt=Tt();navigator.clipboard.writeText(kt),ot("iPhone User Agent copied to clipboard!","success")},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"Generate & Copy"})]}),jsxRuntimeExports.jsxs("div",{className:`${g?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6`,children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Samsung User Agent"}),jsxRuntimeExports.jsx("button",{onClick:()=>{const kt=Ft();navigator.clipboard.writeText(kt),ot("Samsung User Agent copied to clipboard!","success")},className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors",children:"Generate & Copy"})]})]})]})},TextFormatter=()=>{const[e,s]=reactExports.useState(""),[a,i]=reactExports.useState(""),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState("success");useSecurity();const b=(at,it)=>{h(at),_(it),c(!0)},j=reactExports.useCallback(at=>{if(!e.trim()){b("Please enter some text first!","warning");return}let it="";switch(at){case"uppercase":it=e.toUpperCase();break;case"lowercase":it=e.toLowerCase();break;case"titlecase":it=e.replace(/\w\S*/g,mt=>mt.charAt(0).toUpperCase()+mt.substr(1).toLowerCase());break;case"sentencecase":it=e.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g,mt=>mt.toUpperCase());break;case"removeSpaces":it=e.replace(/\s+/g,"");break;case"removeExtraSpaces":it=e.replace(/\s+/g," ").trim();break;case"removeLineBreaks":it=e.replace(/\r?\n|\r/g," ").replace(/\s+/g," ").trim();break;case"addLineBreaks":it=e.replace(/\.\s+/g,`.
`).replace(/\?\s+/g,`?
`).replace(/\!\s+/g,`!
`);break;case"reverse":it=e.split("").reverse().join("");break;case"removeNumbers":it=e.replace(/\d/g,"");break;case"removeSpecialChars":it=e.replace(/[^a-zA-Z0-9\s]/g,"");break;case"extractEmails":const nt=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,ot=e.match(nt)||[];it=[...new Set(ot)].join(`
`);break;case"extractUrls":const dt=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/g,ht=e.match(dt)||[];it=[...new Set(ht)].join(`
`);break;case"wordCount":const lt=e.trim().split(/\s+/).filter(mt=>mt.length>0),gt=e.length,yt=e.replace(/\s/g,"").length,Tt=e.split(/\r\n|\r|\n/).length;it=`Words: ${lt.length}
Characters: ${gt}
Characters (no spaces): ${yt}
Lines: ${Tt}`;break;default:it=e}i(it),b("Text formatted successfully!","success")},[e]),_e=async()=>{if(!a.trim()){b("No formatted text to copy!","warning");return}try{await navigator.clipboard.writeText(a),b("Text copied to clipboard!","success")}catch{b("Failed to copy text!","error")}},tt=()=>{if(!a.trim()){b("No formatted text to download!","warning");return}const at=new Blob([a],{type:"text/plain"}),it=URL.createObjectURL(at),nt=document.createElement("a");nt.href=it,nt.download="formatted-text.txt",document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(it),b("Text downloaded as TXT file!","success")},rt=async()=>{try{const at=await navigator.clipboard.readText();s(at),b("Text pasted from clipboard!","success")}catch{b("Failed to paste from clipboard!","error")}},et=()=>{s(""),i(""),b("All data cleared!","success")},st=[{id:"uppercase",label:"UPPERCASE",color:"bg-blue-500 hover:bg-blue-600"},{id:"lowercase",label:"lowercase",color:"bg-green-500 hover:bg-green-600"},{id:"titlecase",label:"Title Case",color:"bg-purple-500 hover:bg-purple-600"},{id:"sentencecase",label:"Sentence case",color:"bg-orange-500 hover:bg-orange-600"},{id:"removeSpaces",label:"Remove Spaces",color:"bg-red-500 hover:bg-red-600"},{id:"removeExtraSpaces",label:"Remove Extra Spaces",color:"bg-pink-500 hover:bg-pink-600"},{id:"removeLineBreaks",label:"Remove Line Breaks",color:"bg-indigo-500 hover:bg-indigo-600"},{id:"addLineBreaks",label:"Add Line Breaks",color:"bg-teal-500 hover:bg-teal-600"},{id:"reverse",label:"Reverse Text",color:"bg-yellow-500 hover:bg-yellow-600"},{id:"removeNumbers",label:"Remove Numbers",color:"bg-gray-500 hover:bg-gray-600"},{id:"removeSpecialChars",label:"Remove Special Chars",color:"bg-cyan-500 hover:bg-cyan-600"},{id:"extractEmails",label:"Extract Emails",color:"bg-emerald-500 hover:bg-emerald-600"},{id:"extractUrls",label:"Extract URLs",color:"bg-lime-500 hover:bg-lime-600"},{id:"wordCount",label:"Word Count",color:"bg-violet-500 hover:bg-violet-600"}];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Input Text"}),jsxRuntimeExports.jsxs("button",{onClick:rt,className:"flex items-center space-x-2 px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Upload,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Paste"})]})]}),jsxRuntimeExports.jsx("textarea",{value:e,onChange:at=>s(at.target.value),className:"w-full h-64 p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none bg-white/50 backdrop-blur-sm",placeholder:"Enter your text here to format..."}),jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Formatting Options"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-2",children:st.map(at=>jsxRuntimeExports.jsxs("button",{onClick:()=>j(at.id),className:`flex items-center justify-center space-x-2 px-3 py-2 text-white rounded-lg transition-colors duration-200 text-sm ${at.color}`,children:[jsxRuntimeExports.jsx(Settings,{className:"w-3 h-3"}),jsxRuntimeExports.jsx("span",{children:at.label})]},at.id))})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-3 mt-4",children:jsxRuntimeExports.jsxs("button",{onClick:et,className:"flex items-center space-x-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Clear All"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Formatted Text"}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsxs("button",{onClick:_e,className:"flex items-center space-x-2 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Copy"})]}),jsxRuntimeExports.jsxs("button",{onClick:tt,className:"flex items-center space-x-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Download"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"h-64 overflow-y-auto bg-gray-50 rounded-xl p-4 border",children:a?jsxRuntimeExports.jsx("div",{className:"whitespace-pre-wrap font-mono text-sm text-gray-800",children:a}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Type,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"No formatted text yet"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Enter text and choose a formatting option"})]})})})]})]}),e&&jsxRuntimeExports.jsxs("div",{className:"mt-6 bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Text Statistics"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:e.trim().split(/\s+/).filter(at=>at.length>0).length}),jsxRuntimeExports.jsx("div",{className:"text-blue-100",children:"Words"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:e.length}),jsxRuntimeExports.jsx("div",{className:"text-green-100",children:"Characters"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:e.replace(/\s/g,"").length}),jsxRuntimeExports.jsx("div",{className:"text-purple-100",children:"No Spaces"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:e.split(/\r\n|\r|\n/).length}),jsxRuntimeExports.jsx("div",{className:"text-orange-100",children:"Lines"})]})]})]})]}),o&&jsxRuntimeExports.jsx(SecurityPopup,{show:o,message:d,type:g,onClose:()=>c(!1)})]})},PasswordGenerator=()=>{const{isDarkMode:e}=useTheme(),[s,a]=reactExports.useState(""),[i,o]=reactExports.useState(12),[c,d]=reactExports.useState(!0),[h,g]=reactExports.useState(!0),[_,b]=reactExports.useState(!0),[j,_e]=reactExports.useState(!1),tt=()=>{let et="";if(c&&(et+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),h&&(et+="abcdefghijklmnopqrstuvwxyz"),_&&(et+="0123456789"),j&&(et+="!@#$%^&*()_+-=[]{}|;:,.<>?"),et===""){alert("Please select at least one character type");return}let st="";for(let at=0;at<i;at++)st+=et.charAt(Math.floor(Math.random()*et.length));a(st)},rt=()=>{navigator.clipboard.writeText(s),alert("Password copied to clipboard!")};return jsxRuntimeExports.jsx("div",{className:`min-h-screen ${e?"bg-gray-900":"bg-gray-100"} py-8`,children:jsxRuntimeExports.jsx("div",{className:"max-w-2xl mx-auto px-4",children:jsxRuntimeExports.jsxs("div",{className:`${e?"bg-gray-800 text-white":"bg-white"} rounded-lg shadow-md p-6`,children:[jsxRuntimeExports.jsx("h1",{className:`text-3xl font-bold ${e?"text-white":"text-gray-800"} mb-6`,children:"Password Generator"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:`block text-sm font-medium ${e?"text-gray-300":"text-gray-700"} mb-2`,children:["Password Length: ",i]}),jsxRuntimeExports.jsx("input",{type:"range",min:"4",max:"50",value:i,onChange:et=>o(parseInt(et.target.value)),className:`w-full h-2 ${e?"bg-gray-700":"bg-gray-200"} rounded-lg appearance-none cursor-pointer`})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("label",{className:`flex items-center ${e?"text-gray-300":""}`,children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:c,onChange:et=>d(et.target.checked),className:"mr-2"}),"Uppercase Letters"]}),jsxRuntimeExports.jsxs("label",{className:`flex items-center ${e?"text-gray-300":""}`,children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:h,onChange:et=>g(et.target.checked),className:"mr-2"}),"Lowercase Letters"]}),jsxRuntimeExports.jsxs("label",{className:`flex items-center ${e?"text-gray-300":""}`,children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:_,onChange:et=>b(et.target.checked),className:"mr-2"}),"Numbers"]}),jsxRuntimeExports.jsxs("label",{className:`flex items-center ${e?"text-gray-300":""}`,children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:j,onChange:et=>_e(et.target.checked),className:"mr-2"}),"Symbols"]})]}),jsxRuntimeExports.jsx("button",{onClick:tt,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Generate Password"}),s&&jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[jsxRuntimeExports.jsx("label",{className:`block text-sm font-medium ${e?"text-gray-300":"text-gray-700"} mb-2`,children:"Generated Password:"}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("input",{type:"text",value:s,readOnly:!0,className:`flex-1 p-3 border ${e?"border-gray-700 bg-gray-700 text-white":"border-gray-300 bg-gray-50"} rounded-l-lg font-mono`}),jsxRuntimeExports.jsx("button",{onClick:rt,className:"bg-green-600 text-white px-4 py-3 rounded-r-lg hover:bg-green-700 transition-colors",children:"Copy"})]})]})]})]})})})},EmailAliasManager=()=>{const[e,s]=reactExports.useState("muthassim358@gmail.com"),[a,i]=reactExports.useState(""),[o,c]=reactExports.useState(""),[d,h]=reactExports.useState([]),[g,_]=reactExports.useState(!1),[b,j]=reactExports.useState(!1),[_e,tt]=reactExports.useState(!1),[rt,et]=reactExports.useState(""),[st,at]=reactExports.useState("success"),{logout:it,currentProfile:nt}=useSecurity(),ot=(mt,Et)=>{et(mt),at(Et),tt(!0)};reactExports.useEffect(()=>{dt()},[]);const dt=()=>{try{const mt=localStorage.getItem("emailAliasCredentials");if(mt){const Et=JSON.parse(mt);h(Et),ot(`${Et.length} credentials loaded successfully!`,"success")}}catch(mt){console.error("Error loading credentials:",mt),ot("Error loading saved credentials","error")}},ht=mt=>{try{localStorage.setItem("emailAliasCredentials",JSON.stringify(mt))}catch(Et){console.error("Error saving credentials:",Et),ot("Error saving credentials","error")}},lt=async()=>{if(!a||!o){ot("All fields are required!","warning");return}const mt=`${e.split("@")[0]}+${a}@gmail.com`,Et={id:Date.now().toString(),website:a,email:mt,password:o,owner:(nt==null?void 0:nt.name)||"User",createdAt:new Date().toISOString()};try{_(!0);const Ft=[...d,Et];h(Ft),ht(Ft),ot(`Alias created for ${a}!`,"success")}catch(Ft){console.error("Save error:",Ft),ot("Error saving data: "+(Ft.message||"Unknown error"),"error")}i(""),c(""),_(!1)},gt=async(mt,Et)=>{if(window.confirm(`Are you sure you want to delete the credential for ${Et}?`))try{const Ft=d.filter(Vt=>Vt.id!==mt);h(Ft),ht(Ft),ot(`Credential for ${Et} deleted!`,"success")}catch(Ft){console.error("Delete error:",Ft),ot("Error deleting credential: "+(Ft.message||"Unknown error"),"error")}},yt=async(mt,Et)=>{try{await navigator.clipboard.writeText(mt),ot(`${Et} copied to clipboard!`,"success")}catch{ot("Failed to copy to clipboard!","error")}},Tt=()=>{const mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let Et="";for(let Ft=0;Ft<16;Ft++)Et+=mt.charAt(Math.floor(Math.random()*mt.length));c(Et),ot("Random password generated!","success")};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Create New Email Alias"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Main Email"}),jsxRuntimeExports.jsx("input",{type:"email",value:e,onChange:mt=>s(mt.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/50 backdrop-blur-sm",placeholder:"your-email@gmail.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website/Service"}),jsxRuntimeExports.jsx("input",{type:"text",value:a,onChange:mt=>i(mt.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/50 backdrop-blur-sm",placeholder:"e.g., amazon, facebook, netflix"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:mt=>c(mt.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/50 backdrop-blur-sm",placeholder:"Enter password"}),jsxRuntimeExports.jsx("button",{onClick:Tt,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors duration-200",title:"Generate Random Password",children:""})]})]}),a&&jsxRuntimeExports.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-blue-800",children:[jsxRuntimeExports.jsx("strong",{children:" Generated Alias:"})," ",`${e.split("@")[0]}+${a}@gmail.com`]})}),jsxRuntimeExports.jsxs("button",{onClick:lt,disabled:g,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:[jsxRuntimeExports.jsx(Plus,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{children:g?"Creating...":"Create & Save Alias"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Statistics"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:d.length}),jsxRuntimeExports.jsx("div",{className:"text-blue-100",children:"Total Aliases"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:new Set(d.map(mt=>mt.website)).size}),jsxRuntimeExports.jsx("div",{className:"text-green-100",children:"Unique Sites"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:nt!=null&&nt.name?"":""}),jsxRuntimeExports.jsx("div",{className:"text-purple-100",children:"Authenticated"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:jsxRuntimeExports.jsx(Database,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("div",{className:"text-orange-100",children:"Local Storage"})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Security Options"}),jsxRuntimeExports.jsxs("button",{onClick:()=>j(!b),className:"flex items-center space-x-2 px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200",children:[b?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"}),jsxRuntimeExports.jsxs("span",{children:[b?"Hide":"Show"," Passwords"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),jsxRuntimeExports.jsx("span",{className:"text-gray-700",children:"Secure Key Authentication"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),jsxRuntimeExports.jsx("span",{className:"text-gray-700",children:"Local Storage Encryption"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),jsxRuntimeExports.jsx("span",{className:"text-gray-700",children:"User-specific Data Isolation"})]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Your Email Aliases"}),jsxRuntimeExports.jsxs("span",{className:"bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-semibold",children:[d.length," aliases"]})]}),g?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mt-2",children:"Loading credentials..."})]}):d.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(Mail,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"No email aliases created yet"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Create your first alias above"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-4",children:d.map((mt,Et)=>jsxRuntimeExports.jsx("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200 hover:shadow-md transition-shadow duration-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold text-gray-800 text-lg",children:[" ",mt.website]}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded",children:mt.createdAt?new Date(mt.createdAt).toLocaleDateString():"Unknown"})]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700",children:" Email:"}),jsxRuntimeExports.jsx("button",{onClick:()=>yt(mt.email,"Email"),className:"p-1 text-blue-500 hover:text-blue-700 transition-colors duration-200",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"font-mono text-sm text-gray-800 mt-1 break-all",children:mt.email})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700",children:" Password:"}),jsxRuntimeExports.jsx("button",{onClick:()=>yt(mt.password,"Password"),className:"p-1 text-blue-500 hover:text-blue-700 transition-colors duration-200",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"font-mono text-sm text-gray-800 mt-1",children:b?mt.password:"".repeat(mt.password.length)})]})]}),mt.owner&&jsxRuntimeExports.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Created by: ",mt.owner]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>gt(mt.id,mt.website),className:"ml-4 p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all duration-200",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})},mt.id||Et))})]})]}),_e&&jsxRuntimeExports.jsx(SecurityPopup,{show:_e,message:rt,type:st,onClose:()=>tt(!1)})]})},zipCodeDatabase={10001:{city:"New York",state:"NY"},10002:{city:"New York",state:"NY"},10003:{city:"New York",state:"NY"},10004:{city:"New York",state:"NY"},10005:{city:"New York",state:"NY"},90210:{city:"Beverly Hills",state:"CA"},90211:{city:"Beverly Hills",state:"CA"},90212:{city:"Beverly Hills",state:"CA"},60601:{city:"Chicago",state:"IL"},60602:{city:"Chicago",state:"IL"},60603:{city:"Chicago",state:"IL"},60604:{city:"Chicago",state:"IL"},33101:{city:"Miami",state:"FL"},33102:{city:"Miami",state:"FL"},33109:{city:"Miami Beach",state:"FL"},33139:{city:"Miami Beach",state:"FL"},"02101":{city:"Boston",state:"MA"},"02102":{city:"Boston",state:"MA"},"02103":{city:"Boston",state:"MA"},"02108":{city:"Boston",state:"MA"},77001:{city:"Houston",state:"TX"},77002:{city:"Houston",state:"TX"},77003:{city:"Houston",state:"TX"},77004:{city:"Houston",state:"TX"},98101:{city:"Seattle",state:"WA"},98102:{city:"Seattle",state:"WA"},98103:{city:"Seattle",state:"WA"},98104:{city:"Seattle",state:"WA"},30301:{city:"Atlanta",state:"GA"},30302:{city:"Atlanta",state:"GA"},30303:{city:"Atlanta",state:"GA"},30309:{city:"Atlanta",state:"GA"},85001:{city:"Phoenix",state:"AZ"},85002:{city:"Phoenix",state:"AZ"},85003:{city:"Phoenix",state:"AZ"},85004:{city:"Phoenix",state:"AZ"},19101:{city:"Philadelphia",state:"PA"},19102:{city:"Philadelphia",state:"PA"},19103:{city:"Philadelphia",state:"PA"},19104:{city:"Philadelphia",state:"PA"},89101:{city:"Las Vegas",state:"NV"},89102:{city:"Las Vegas",state:"NV"},89103:{city:"Las Vegas",state:"NV"},89104:{city:"Las Vegas",state:"NV"},97201:{city:"Portland",state:"OR"},97202:{city:"Portland",state:"OR"},97203:{city:"Portland",state:"OR"},97204:{city:"Portland",state:"OR"},80201:{city:"Denver",state:"CO"},80202:{city:"Denver",state:"CO"},80203:{city:"Denver",state:"CO"},80204:{city:"Denver",state:"CO"},20001:{city:"Washington",state:"DC"},20002:{city:"Washington",state:"DC"},20003:{city:"Washington",state:"DC"},20004:{city:"Washington",state:"DC"},37201:{city:"Nashville",state:"TN"},37202:{city:"Nashville",state:"TN"},37203:{city:"Nashville",state:"TN"},37204:{city:"Nashville",state:"TN"},63101:{city:"St. Louis",state:"MO"},63102:{city:"St. Louis",state:"MO"},63103:{city:"St. Louis",state:"MO"},63104:{city:"St. Louis",state:"MO"},55401:{city:"Minneapolis",state:"MN"},55402:{city:"Minneapolis",state:"MN"},55403:{city:"Minneapolis",state:"MN"},55404:{city:"Minneapolis",state:"MN"},53201:{city:"Milwaukee",state:"WI"},53202:{city:"Milwaukee",state:"WI"},53203:{city:"Milwaukee",state:"WI"},53204:{city:"Milwaukee",state:"WI"},45201:{city:"Cincinnati",state:"OH"},45202:{city:"Cincinnati",state:"OH"},45203:{city:"Cincinnati",state:"OH"},45204:{city:"Cincinnati",state:"OH"},64101:{city:"Kansas City",state:"MO"},64102:{city:"Kansas City",state:"MO"},64103:{city:"Kansas City",state:"MO"},64104:{city:"Kansas City",state:"MO"},70112:{city:"New Orleans",state:"LA"},70113:{city:"New Orleans",state:"LA"},70114:{city:"New Orleans",state:"LA"},70115:{city:"New Orleans",state:"LA"},84101:{city:"Salt Lake City",state:"UT"},84102:{city:"Salt Lake City",state:"UT"},84103:{city:"Salt Lake City",state:"UT"},84104:{city:"Salt Lake City",state:"UT"},73101:{city:"Oklahoma City",state:"OK"},73102:{city:"Oklahoma City",state:"OK"},73103:{city:"Oklahoma City",state:"OK"},73104:{city:"Oklahoma City",state:"OK"},35201:{city:"Birmingham",state:"AL"},35202:{city:"Birmingham",state:"AL"},35203:{city:"Birmingham",state:"AL"},35204:{city:"Birmingham",state:"AL"},29401:{city:"Charleston",state:"SC"},29402:{city:"Charleston",state:"SC"},29403:{city:"Charleston",state:"SC"},29404:{city:"Charleston",state:"SC"},27601:{city:"Raleigh",state:"NC"},27602:{city:"Raleigh",state:"NC"},27603:{city:"Raleigh",state:"NC"},27604:{city:"Raleigh",state:"NC"},23219:{city:"Richmond",state:"VA"},23220:{city:"Richmond",state:"VA"},23221:{city:"Richmond",state:"VA"},23222:{city:"Richmond",state:"VA"},"04101":{city:"Portland",state:"ME"},"04102":{city:"Portland",state:"ME"},"04103":{city:"Portland",state:"ME"},"04104":{city:"Portland",state:"ME"},"05401":{city:"Burlington",state:"VT"},"05402":{city:"Burlington",state:"VT"},"05403":{city:"Burlington",state:"VT"},"05404":{city:"Burlington",state:"VT"},"03101":{city:"Manchester",state:"NH"},"03102":{city:"Manchester",state:"NH"},"03103":{city:"Manchester",state:"NH"},"03104":{city:"Manchester",state:"NH"},99501:{city:"Anchorage",state:"AK"},99502:{city:"Anchorage",state:"AK"},99503:{city:"Anchorage",state:"AK"},99504:{city:"Anchorage",state:"AK"},96801:{city:"Honolulu",state:"HI"},96802:{city:"Honolulu",state:"HI"},96803:{city:"Honolulu",state:"HI"},96804:{city:"Honolulu",state:"HI"}},USAddressGenerator=()=>{const[e,s]=reactExports.useState(""),[a,i]=reactExports.useState(null),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState(!1),[b,j]=reactExports.useState(""),[_e,tt]=reactExports.useState("success"),[rt,et]=reactExports.useState(null),[st,at]=reactExports.useState("local"),{logout:it}=useSecurity(),nt=(Mt,Ct)=>{j(Mt),tt(Ct),_(!0)},ot=Mt=>/^\d{5}$/.test(Mt),dt=()=>Math.floor(Math.random()*9999)+1,ht=()=>{const Mt=["Main St","Oak Ave","Pine St","Maple Dr","Cedar Ln","Elm St","Park Ave","First St","Second St","Third St","Washington St","Lincoln Ave","Jefferson Dr","Madison St","Franklin Ave","Roosevelt Blvd","Wilson St","Johnson Ave","Smith Dr","Brown St","Davis Ave","Miller St","Wilson Dr","Moore Ave","Taylor St","Anderson Dr","Thomas Ave","Jackson St","White Dr","Harris Ave","Martin St","Thompson Dr","Garcia Ave","Martinez St","Robinson Dr","Clark Ave","Rodriguez St","Lewis Dr","Lee Ave","Walker St","Hall Dr","Allen Ave","Young St","King Dr","Sunset Blvd","Broadway","Fifth Ave","Seventh St","Eighth Ave","Ninth St","Highland Ave","Valley Dr","Hill St","Lake Ave","River Rd","Forest Dr","Garden St","Spring Ave","Summer St","Winter Dr","Autumn Ln","Cherry St","Rose Ave","Lily Dr","Violet St","Iris Ave","Tulip Ln","Daisy St"];return Mt[Math.floor(Math.random()*Mt.length)]},lt=Mt=>{const Ct=zipCodeDatabase[Mt];if(!Ct)throw new Error("ZIP code not found in our database");const kt=dt(),jt=ht(),ut=`${kt} ${jt}`;return{country:"United States",city:Ct.city,state:Ct.state,zipCode:Mt,streetAddress:ut,fullAddress:`${ut}, ${Ct.city}, ${Ct.state} ${Mt}, United States`}},gt=async Mt=>{const Ct=await fetch("238509540805667926",{method:"GET",headers:{Accept:"application/json"},mode:"cors"});if(!Ct.ok)throw new Error("API request failed");const kt=await Ct.json();if(!kt.result||!kt.result.addressMatches||kt.result.addressMatches.length===0)throw new Error("No address found for this ZIP code");const ut=kt.result.addressMatches[0].addressComponents,Lt=dt(),Pt=ht(),ft=`${Lt} ${Pt}`;return{country:"United States",city:ut.city||"Unknown City",state:ut.state||"Unknown State",zipCode:Mt,streetAddress:ft,fullAddress:`${ft}, ${ut.city}, ${ut.state} ${Mt}, United States`}},yt=async()=>{if(!e.trim()){h("Please enter a ZIP code"),nt("Please enter a ZIP code!","warning");return}if(!ot(e.trim())){h("Please enter a valid 5-digit ZIP code"),nt("Please enter a valid 5-digit ZIP code!","error");return}c(!0),h(""),i(null);try{let Mt;try{Mt=await gt(e.trim()),at("api"),nt("Address generated from Census API!","success")}catch(Ct){console.warn("API failed, using local data:",Ct),Mt=lt(e.trim()),at("local"),nt("Address generated from local database!","success")}i(Mt)}catch(Mt){const Ct=Mt instanceof Error?Mt.message:"Failed to generate address";h(Ct),nt(Ct,"error")}finally{c(!1)}},Tt=async(Mt,Ct)=>{try{await navigator.clipboard.writeText(Mt),et(Ct),nt(`${Ct} copied to clipboard!`,"success"),setTimeout(()=>{et(null)},2e3)}catch{nt("Failed to copy to clipboard!","error")}},mt=async()=>{if(!a)return;const Mt=`Country: ${a.country}
City: ${a.city}
State: ${a.state}
ZIP Code: ${a.zipCode}
Street Address: ${a.streetAddress}
Full Address: ${a.fullAddress}`;await Tt(Mt,"Complete Address")},Et=()=>{i(null),s(""),h(""),et(null),nt("Address cleared!","success")},Ft=Mt=>{Mt.key==="Enter"&&yt()},Vt=["10001","90210","60601","33101","02101","77001","98101","30301","85001","19101"];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen p-2 sm:p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto",children:[jsxRuntimeExports.jsx("div",{className:"bg-white/90 backdrop-blur-lg rounded-xl sm:rounded-2xl shadow-2xl p-4 sm:p-6 mb-4 sm:mb-6 border border-white/30",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 sm:p-3 bg-gradient-to-r from-emerald-500 to-blue-600 rounded-xl shadow-lg",children:jsxRuntimeExports.jsx(MapPin,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl sm:text-3xl font-bold bg-gradient-to-r from-emerald-600 to-blue-600 bg-clip-text text-transparent",children:"US Address Generator"}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Generate authentic US addresses by ZIP code"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 w-full sm:w-auto",children:[jsxRuntimeExports.jsxs(Link,{to:"/",className:"flex items-center space-x-2 px-3 sm:px-4 py-2 bg-blue-500 text-white rounded-lg sm:rounded-xl hover:bg-blue-600 transition-colors duration-200 text-sm sm:text-base",children:[jsxRuntimeExports.jsx(Home,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Home"})]}),jsxRuntimeExports.jsxs("button",{onClick:it,className:"flex items-center space-x-2 px-3 sm:px-4 py-2 bg-red-500 text-white rounded-lg sm:rounded-xl hover:bg-red-600 transition-colors duration-200 text-sm sm:text-base",children:[jsxRuntimeExports.jsx(LogOut,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"grid lg:grid-cols-2 gap-4 sm:gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/90 backdrop-blur-lg rounded-xl sm:rounded-2xl shadow-xl p-4 sm:p-6 border border-white/30",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mb-4 sm:mb-6",children:[jsxRuntimeExports.jsx(Globe,{className:"w-5 h-5 text-emerald-600"}),jsxRuntimeExports.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"Generate Address"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"US ZIP Code (5 digits)"}),jsxRuntimeExports.jsx("input",{type:"text",value:e,onChange:Mt=>{const Ct=Mt.target.value.replace(/\D/g,"").slice(0,5);s(Ct),h("")},onKeyPress:Ft,className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg sm:rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-white/70 backdrop-blur-sm text-base sm:text-lg font-mono transition-all duration-200",placeholder:"e.g., 10001",maxLength:5}),d&&jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-red-600",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:d})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:yt,disabled:o||!e.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 sm:px-6 py-2 sm:py-3 bg-gradient-to-r from-emerald-500 to-blue-600 text-white rounded-lg sm:rounded-xl hover:from-emerald-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transform hover:scale-105 transition-all duration-200 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none text-sm sm:text-base",children:[o?jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 sm:w-5 sm:h-5 animate-spin"}):jsxRuntimeExports.jsx(MapPin,{className:"w-4 h-4 sm:w-5 sm:h-5"}),jsxRuntimeExports.jsx("span",{children:o?"Generating...":"Generate"})]}),a&&jsxRuntimeExports.jsxs("button",{onClick:Et,className:"flex items-center space-x-2 px-3 sm:px-4 py-2 sm:py-3 bg-gray-500 text-white rounded-lg sm:rounded-xl hover:bg-gray-600 transition-colors duration-200 text-sm sm:text-base",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Clear"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-blue-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-emerald-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-emerald-800 mb-2 sm:mb-3",children:"Popular ZIP Codes:"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-xs sm:text-sm",children:Vt.map(Mt=>jsxRuntimeExports.jsx("button",{onClick:()=>s(Mt),className:"px-2 sm:px-3 py-1 sm:py-2 bg-white/80 text-emerald-700 rounded-lg hover:bg-white hover:shadow-md transition-all duration-200 font-mono border border-emerald-200",children:Mt},Mt))})]}),a&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600 bg-gray-50 rounded-lg p-2 sm:p-3",children:[jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ${st==="api"?"bg-green-500":"bg-blue-500"}`}),jsxRuntimeExports.jsxs("span",{children:["Data source:"," ",st==="api"?"US Census Bureau API":"Local Database"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/90 backdrop-blur-lg rounded-xl sm:rounded-2xl shadow-xl p-4 sm:p-6 border border-white/30",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"Generated Address"}),a&&jsxRuntimeExports.jsxs("button",{onClick:mt,className:"flex items-center space-x-2 px-3 sm:px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg sm:rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-md text-sm sm:text-base",children:[jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"}),jsxRuntimeExports.jsx("span",{children:"Copy All"})]})]}),a?jsxRuntimeExports.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("label",{className:"text-xs sm:text-sm font-medium text-gray-700",children:" Country"}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(a.country,"Country"),className:`p-1 sm:p-2 rounded-lg transition-all duration-200 ${rt==="Country"?"bg-green-500 text-white":"bg-blue-500 text-white hover:bg-blue-600"}`,children:rt==="Country"?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 sm:w-4 sm:h-4"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-base text-gray-800 font-semibold",children:a.country})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-blue-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("label",{className:"text-xs sm:text-sm font-medium text-blue-700",children:" City"}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(a.city,"City"),className:`p-1 sm:p-2 rounded-lg transition-all duration-200 ${rt==="City"?"bg-green-500 text-white":"bg-blue-500 text-white hover:bg-blue-600"}`,children:rt==="City"?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 sm:w-4 sm:h-4"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-base text-blue-800 font-semibold",children:a.city})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-purple-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("label",{className:"text-xs sm:text-sm font-medium text-purple-700",children:" State"}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(a.state,"State"),className:`p-1 sm:p-2 rounded-lg transition-all duration-200 ${rt==="State"?"bg-green-500 text-white":"bg-blue-500 text-white hover:bg-blue-600"}`,children:rt==="State"?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 sm:w-4 sm:h-4"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-base text-purple-800 font-semibold",children:a.state})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-orange-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("label",{className:"text-xs sm:text-sm font-medium text-orange-700",children:" ZIP Code"}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(a.zipCode,"ZIP Code"),className:`p-1 sm:p-2 rounded-lg transition-all duration-200 ${rt==="ZIP Code"?"bg-green-500 text-white":"bg-blue-500 text-white hover:bg-blue-600"}`,children:rt==="ZIP Code"?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 sm:w-4 sm:h-4"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-base text-orange-800 font-semibold font-mono",children:a.zipCode})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-green-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("label",{className:"text-xs sm:text-sm font-medium text-green-700",children:" Street Address"}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(a.streetAddress,"Street Address"),className:`p-1 sm:p-2 rounded-lg transition-all duration-200 ${rt==="Street Address"?"bg-green-500 text-white":"bg-blue-500 text-white hover:bg-blue-600"}`,children:rt==="Street Address"?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 sm:w-4 sm:h-4"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-base text-green-800 font-semibold",children:a.streetAddress})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border-2 border-indigo-300 shadow-md",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("label",{className:"text-xs sm:text-sm font-medium text-indigo-700",children:"   (Full Address)"}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(a.fullAddress,"Full Address"),className:`p-1 sm:p-2 rounded-lg transition-all duration-200 ${rt==="Full Address"?"bg-green-500 text-white":"bg-indigo-500 text-white hover:bg-indigo-600"}`,children:rt==="Full Address"?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 sm:w-4 sm:h-4"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm sm:text-lg text-indigo-800 font-semibold leading-relaxed break-words",children:a.fullAddress})]})]}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-64 sm:h-80 text-gray-500",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(MapPin,{className:"w-8 h-8 sm:w-12 sm:h-12 mx-auto mb-4 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-base sm:text-lg mb-2",children:"No address generated yet"}),jsxRuntimeExports.jsx("p",{className:"text-xs sm:text-sm",children:'Enter a ZIP code and click "Generate"'}),jsxRuntimeExports.jsxs("div",{className:"mt-4 sm:mt-6 space-y-2 sm:space-y-3 opacity-20",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 sm:p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Country"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700",children:"United States"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 sm:p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"City"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700",children:"New York"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 sm:p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"State"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700",children:"NY"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 sm:p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"ZIP Code"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700 font-mono",children:"10001"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 sm:p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Street Address"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-700",children:"123 Main St"})]})]})]})})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-4 sm:mt-6 bg-white/90 backdrop-blur-lg rounded-xl sm:rounded-2xl shadow-xl p-4 sm:p-6 border border-white/30",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg flex-shrink-0",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 sm:w-5 sm:h-5 text-emerald-600"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-2",children:"How it works"}),jsxRuntimeExports.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 space-y-1 sm:space-y-2",children:[jsxRuntimeExports.jsx("p",{children:" Enter a valid 5-digit US ZIP code"}),jsxRuntimeExports.jsx("p",{children:" The tool attempts to fetch real city/state data from the US Census Bureau API"}),jsxRuntimeExports.jsx("p",{children:" If the API is unavailable, it uses our comprehensive local database"}),jsxRuntimeExports.jsx("p",{children:" A realistic street address is randomly generated for that location"}),jsxRuntimeExports.jsx("p",{children:" Each address component can be copied individually or all together"}),jsxRuntimeExports.jsxs("p",{children:[" Supports ",Object.keys(zipCodeDatabase).length,"+ ZIP codes across all 50 states"]})]})]})]})})]}),g&&jsxRuntimeExports.jsx(SecurityPopup,{show:g,message:b,type:_e,onClose:()=>_(!1)})]})},AdminPanel=()=>{const e=useLocation(),s=useNavigate(),[a,i]=reactExports.useState(""),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState(""),[b,j]=reactExports.useState(""),[_e,tt]=reactExports.useState(!1),[rt,et]=reactExports.useState(!1),[st,at]=reactExports.useState(""),[it,nt]=reactExports.useState("success"),[ot,dt]=reactExports.useState(!1),{apiKeys:ht,addApiKey:lt,removeApiKey:gt,getDeviceFingerprint:yt}=useSecurity(),Tt="adminbilla";reactExports.useEffect(()=>{e.pathname!=="/admin/billa"&&s("/admin/billa")},[e,s]);const mt=(ut,Lt)=>{at(ut),nt(Lt),et(!0)},Et=ut=>{ut.preventDefault(),a===Tt?(c(!0),mt("Admin access granted!","success")):(mt("Invalid admin password!","error"),i(""))},Ft=async ut=>{if(ut.preventDefault(),console.log("Adding key with values:",{newApiKey:d,newKeyName:g,newKeyExpiry:b,isUnlimitedValidity:ot}),!d.trim()){mt("Please enter a valid API key!","warning");return}if(!g.trim()){mt("Please enter a key name!","warning");return}if(!ot&&!b){mt("Please select an expiry date or choose unlimited validity!","warning");return}if(ht.some(Lt=>Lt.key===d)){mt("This API key already exists!","error");return}try{if(ot)console.log("Adding key with unlimited validity (null expiry)"),await lt(d,g,null);else{const Lt=new Date(b);if(Lt<=new Date){mt("Expiry date must be in the future!","error");return}console.log("Adding key with expiry:",Lt.toISOString()),await lt(d,g,Lt.toISOString())}h(""),_(""),j(""),dt(!1),mt("API key added successfully!","success")}catch(Lt){console.error("Error adding API key:",Lt),mt("Failed to add API key. Check console for details.","error")}},Vt=ut=>{window.confirm("Are you sure you want to remove this API key?")&&(gt(ut),mt("API key removed successfully!","success"))},Mt=async ut=>{try{await navigator.clipboard.writeText(ut),mt("Copied to clipboard!","success")}catch{mt("Failed to copy!","error")}},Ct=()=>{const ut="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Lt="";for(let Pt=0;Pt<16;Pt++)Lt+=ut.charAt(Math.floor(Math.random()*ut.length));return`KEY-${Lt}`},kt=ut=>ut?new Date>new Date(ut):!1,jt=ut=>{if(!ut)return 1/0;const Lt=new Date,ft=new Date(ut).getTime()-Lt.getTime(),Rt=Math.ceil(ft/(1e3*60*60*24));return Math.max(0,Rt)};return o?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-400 to-purple-600 p-8",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto",children:[rt&&jsxRuntimeExports.jsx(SecurityPopup,{show:rt,message:st,type:it,onClose:()=>et(!1)}),jsxRuntimeExports.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl p-6 mb-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(Shield,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Admin Control Panel"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Manage API keys and system security"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>s("/admin/ua"),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-gray-100 text-gray-700 hover:bg-gray-200 transition-all",children:[jsxRuntimeExports.jsx(Smartphone,{className:"w-5 h-5"}),"User Agent Config"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>tt(!_e),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-gray-100 text-gray-700 hover:bg-gray-200 transition-all",children:[_e?jsxRuntimeExports.jsx(EyeOff,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Eye,{className:"w-5 h-5"}),_e?"Hide Keys":"Show Keys"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[jsxRuntimeExports.jsx(Key,{className:"w-6 h-6 text-blue-600"}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"API Key Management"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold",children:ht.length}),jsxRuntimeExports.jsx("div",{className:"text-blue-100",children:"Total Keys"})]}),jsxRuntimeExports.jsx(Key,{className:"w-8 h-8 text-blue-200"})]})}),jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold",children:ht.filter(ut=>ut.isActive&&!kt(ut.expiresAt)).length}),jsxRuntimeExports.jsx("div",{className:"text-green-100",children:"Active Keys"})]}),jsxRuntimeExports.jsx(Users,{className:"w-8 h-8 text-green-200"})]})}),jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-6 text-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold",children:ht.filter(ut=>ut.deviceId).length}),jsxRuntimeExports.jsx("div",{className:"text-purple-100",children:"Bound Devices"})]}),jsxRuntimeExports.jsx(Monitor,{className:"w-8 h-8 text-purple-200"})]})}),jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl p-6 text-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold",children:ht.filter(ut=>kt(ut.expiresAt)).length}),jsxRuntimeExports.jsx("div",{className:"text-red-100",children:"Expired Keys"})]}),jsxRuntimeExports.jsx(Clock,{className:"w-8 h-8 text-red-200"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 mb-6 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Add New API Key"}),jsxRuntimeExports.jsxs("form",{onSubmit:Ft,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"API Key"}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:d,onChange:ut=>h(ut.target.value),placeholder:"Enter API key or generate one",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>h(Ct()),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Generate"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:g,onChange:ut=>_(ut.target.value),placeholder:"Enter a name for this key",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",id:"unlimitedValidity",checked:ot,onChange:ut=>{console.log("Unlimited validity checkbox changed:",ut.target.checked),dt(ut.target.checked)},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),jsxRuntimeExports.jsx("label",{htmlFor:"unlimitedValidity",className:"text-sm font-medium text-gray-700",children:"Unlimited Validity (Never Expires)"})]}),!ot&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:b,onChange:ut=>j(ut.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:"Add API Key"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"API Keys Management"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:ht.map(ut=>{const Lt=kt(ut.expiresAt),Pt=jt(ut.expiresAt);return jsxRuntimeExports.jsx("div",{className:`rounded-xl p-4 border hover:shadow-md transition-shadow duration-200 ${Lt?"bg-red-50 border-red-200":Pt<=7?"bg-orange-50 border-orange-200":"bg-gray-50 border-gray-200"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[jsxRuntimeExports.jsx("span",{className:"font-mono text-lg font-semibold text-gray-800",children:_e?ut.key:"".repeat(ut.key.length)}),jsxRuntimeExports.jsx("button",{onClick:()=>Mt(ut.key),className:"p-1 text-blue-500 hover:text-blue-700 transition-colors duration-200",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${Lt?"bg-red-100 text-red-800":Pt<=7?"bg-orange-100 text-orange-800":ut.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Lt?"Expired":Pt<=7?`${Pt} days left`:ut.isActive?"Active":"Inactive"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm text-gray-600",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[jsxRuntimeExports.jsx(Users,{className:"w-4 h-4 text-blue-600"}),jsxRuntimeExports.jsx("span",{className:"font-medium text-blue-800",children:"User"})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-700 font-semibold",children:ut.name})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-4 h-4 text-green-600"}),jsxRuntimeExports.jsx("span",{className:"font-medium text-green-800",children:"Created"})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:new Date(ut.createdAt).toLocaleDateString()})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[jsxRuntimeExports.jsx(Clock,{className:`w-4 h-4 ${Lt?"text-red-600":Pt<=7?"text-orange-600":"text-blue-600"}`}),jsxRuntimeExports.jsx("span",{className:`font-medium ${Lt?"text-red-800":Pt<=7?"text-orange-800":"text-blue-800"}`,children:"Expires"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Expires"}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:ut.expiresAt?new Date(ut.expiresAt).toLocaleDateString():"Unlimited"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[jsxRuntimeExports.jsx(Monitor,{className:"w-4 h-4 text-purple-600"}),jsxRuntimeExports.jsx("span",{className:"font-medium text-purple-800",children:"Location"})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-700 text-xs",children:formatLocation(ut.deviceLocation)}),ut.deviceId&&jsxRuntimeExports.jsx("p",{className:"text-green-600 text-xs mt-1",children:"Device Bound"})]})]}),ut.lastUsed&&jsxRuntimeExports.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Last used:"," ",new Date(ut.lastUsed).toLocaleString()]})]}),jsxRuntimeExports.jsx("div",{className:"mt-3 flex justify-end",children:jsxRuntimeExports.jsx("button",{onClick:()=>Vt(ut.id),className:"px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 text-sm",children:"Remove"})})]})},ut.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"System Information"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Current Device Fingerprint"}),jsxRuntimeExports.jsx("p",{className:"font-mono text-sm text-gray-600 break-all",children:yt()})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Security Status"}),jsxRuntimeExports.jsxs("div",{className:"space-y-1 text-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-green-600",children:" Right-click protection enabled"}),jsxRuntimeExports.jsx("p",{className:"text-green-600",children:" Developer tools blocked"}),jsxRuntimeExports.jsx("p",{className:"text-green-600",children:" Device fingerprinting active"}),jsxRuntimeExports.jsx("p",{className:"text-green-600",children:" Content Security Policy enforced"}),jsxRuntimeExports.jsx("p",{className:"text-green-600",children:" Key expiration monitoring active"})]})]})]})]})]})]})}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center p-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full max-w-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl p-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center mb-8",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(Shield,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-2",children:"Admin Panel"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Restricted Access Area"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:Et,className:"space-y-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("input",{type:"password",value:a,onChange:ut=>i(ut.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl text-gray-800 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter admin password"})}),jsxRuntimeExports.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors duration-200",children:[jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5"}),"Access Admin Panel"]})]})]})}),rt&&jsxRuntimeExports.jsx(SecurityPopup,{show:rt,message:st,type:it,onClose:()=>et(!1)})]})},UserAgentAdmin=()=>{const[e,s]=reactExports.useState(""),[a,i]=reactExports.useState(!1),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState("success"),[b,j]=reactExports.useState([]),[_e,tt]=reactExports.useState([]),[rt,et]=reactExports.useState([]),[st,at]=reactExports.useState([]),[it,nt]=reactExports.useState(null),[ot,dt]=reactExports.useState(null),[ht,lt]=reactExports.useState(null),[gt,yt]=reactExports.useState(null),[Tt,mt]=reactExports.useState({deviceModel:"",minVersion:"",maxVersion:""}),[Et,Ft]=reactExports.useState({version:"",build:"",webkit_version:""}),[Vt,Mt]=reactExports.useState({major:"",min_fbbv:0,max_fbbv:0}),[Ct,kt]=reactExports.useState({model:"",android_version:"",build_number:""}),jt="adminbilla",[ut,Lt]=reactExports.useState("iphone");reactExports.useEffect(()=>{a&&Pt()},[a]);const Pt=async()=>{try{const{data:$t,error:Nt}=await supabase.from("ios_device_ranges").select("*");if(Nt)throw Nt;j($t);const{data:Zt,error:sr}=await supabase.from("ios_versions").select("*");if(sr)throw sr;tt(Zt);const{data:cr,error:dr}=await supabase.from("fb_versions").select("*");if(dr)throw dr;et(cr);const{data:Er,error:gr}=await supabase.from("samsung_configs").select("*");if(gr)throw gr;at(Er)}catch($t){console.error("Error fetching configurations:",$t),ft("Failed to load configurations!","error")}},ft=($t,Nt)=>{h($t),_(Nt),c(!0)},Rt=$t=>{$t.preventDefault(),e===jt?(i(!0),ft("Admin access granted!","success")):(ft("Invalid admin password!","error"),s(""))},bt=async()=>{if(!Vt.major||!Vt.min_fbbv||!Vt.max_fbbv){ft("Please fill all fields for FB version","warning");return}try{const{data:$t,error:Nt}=await supabase.from("fb_versions").insert([Vt]).select();if(Nt)throw Nt;et(Zt=>[...Zt,$t[0]]),Mt({major:"",min_fbbv:0,max_fbbv:0}),ft("FB version added successfully!","success")}catch($t){console.error("Error adding FB version:",$t),ft("Failed to add FB version!","error")}},At=async()=>{if(!Tt.deviceModel||!Tt.minVersion||!Tt.maxVersion){ft("Please fill all fields for iOS device range","warning");return}try{const{data:$t,error:Nt}=await supabase.from("ios_device_ranges").insert([Tt]).select();if(Nt)throw Nt;j(Zt=>[...Zt,$t[0]]),mt({deviceModel:"",minVersion:"",maxVersion:""}),ft("iOS device range added successfully!","success")}catch($t){console.error("Error adding iOS range:",$t),ft("Failed to add iOS device range!","error")}},Ut=async $t=>{if($t.id)try{const{error:Nt}=await supabase.from("ios_device_ranges").update({deviceModel:Tt.deviceModel,minVersion:Tt.minVersion,maxVersion:Tt.maxVersion}).eq("id",$t.id);if(Nt)throw Nt;j(Zt=>Zt.map(sr=>sr.id===$t.id?{...sr,...Tt}:sr)),nt(null),mt({deviceModel:"",minVersion:"",maxVersion:""}),ft("iOS device range updated successfully!","success")}catch(Nt){console.error("Error updating iOS range:",Nt),ft("Failed to update iOS device range!","error")}},Xt=async $t=>{try{const{error:Nt}=await supabase.from("ios_device_ranges").delete().eq("id",$t.id);if(Nt)throw Nt;j(Zt=>Zt.filter(sr=>sr.id!==$t.id)),ft("iOS device range deleted successfully!","success")}catch(Nt){console.error("Error deleting iOS range:",Nt),ft("Failed to delete iOS device range!","error")}},Gt=async()=>{if(!Et.version||!Et.build||!Et.webkit_version){ft("Please fill all fields for iOS version","warning");return}try{const{data:$t,error:Nt}=await supabase.from("ios_versions").insert([Et]).select();if(Nt)throw Nt;tt(Zt=>[...Zt,$t[0]]),Ft({version:"",build:"",webkit_version:""}),ft("iOS version added successfully!","success")}catch($t){console.error("Error adding iOS version:",$t),ft("Failed to add iOS version!","error")}},zt=async $t=>{const Nt=_e[$t];if(Nt!=null&&Nt.id)try{const{error:Zt}=await supabase.from("ios_versions").update(Et).eq("id",Nt.id);if(Zt)throw Zt;tt(sr=>sr.map((cr,dr)=>dr===$t?{...cr,...Et}:cr)),dt(null),Ft({version:"",build:"",webkit_version:""}),ft("iOS version updated successfully!","success")}catch(Zt){console.error("Error updating iOS version:",Zt),ft("Failed to update iOS version!","error")}},Wt=$t=>{tt(Nt=>Nt.filter((Zt,sr)=>sr!==$t)),ft("iOS version deleted successfully!","success")},er=async $t=>{const Nt=rt[$t];if(Nt!=null&&Nt.id)try{const{error:Zt}=await supabase.from("fb_versions").update(Vt).eq("id",Nt.id);if(Zt)throw Zt;et(sr=>sr.map((cr,dr)=>dr===$t?{...cr,...Vt}:cr)),lt(null),Mt({major:"",min_fbbv:0,max_fbbv:0}),ft("FB version updated successfully!","success")}catch(Zt){console.error("Error updating FB version:",Zt),ft("Failed to update FB version!","error")}},St=$t=>{const Nt=rt.filter((Zt,sr)=>sr!==$t);et(Nt),ft("FB version deleted successfully!","success")},ir=async()=>{if(!Ct.model||!Ct.android_version||!Ct.build_number){ft("Please fill all fields for Samsung configuration","warning");return}try{const{data:$t,error:Nt}=await supabase.from("samsung_configs").insert([Ct]).select();if(Nt)throw Nt;at(Zt=>[...Zt,$t[0]]),kt({model:"",android_version:"",build_number:""}),ft("Samsung configuration added successfully!","success")}catch($t){console.error("Error adding Samsung config:",$t),ft("Failed to add Samsung configuration!","error")}},nr=async $t=>{const Nt=st[$t];if(Nt!=null&&Nt.id)try{const{error:Zt}=await supabase.from("samsung_configs").update(Ct).eq("id",Nt.id);if(Zt)throw Zt;at(sr=>sr.map((cr,dr)=>dr===$t?{...cr,...Ct}:cr)),yt(null),kt({model:"",android_version:"",build_number:""}),ft("Samsung configuration updated successfully!","success")}catch(Zt){console.error("Error updating Samsung config:",Zt),ft("Failed to update Samsung configuration!","error")}},ar=$t=>{const Nt=st.filter((Zt,sr)=>sr!==$t);at(Nt),ft("Samsung configuration deleted successfully!","success")};return a?jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-50",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[jsxRuntimeExports.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-blue-500 p-3 rounded-lg",children:jsxRuntimeExports.jsx(Shield,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"User Agent Admin"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Manage device configurations and settings"})]})]})})}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex space-x-4 mb-8",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>Lt("iphone"),className:`flex-1 flex items-center justify-center px-6 py-4 rounded-xl transition-all duration-200 ${ut==="iphone"?"bg-blue-500 text-white shadow-lg transform scale-[1.02]":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[jsxRuntimeExports.jsx(Phone,{className:"mr-3",size:24}),jsxRuntimeExports.jsx("span",{className:"text-lg font-medium",children:"iPhone Configuration"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Lt("samsung"),className:`flex-1 flex items-center justify-center px-6 py-4 rounded-xl transition-all duration-200 ${ut==="samsung"?"bg-blue-500 text-white shadow-lg transform scale-[1.02]":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[jsxRuntimeExports.jsx(Smartphone,{className:"mr-3",size:24}),jsxRuntimeExports.jsx("span",{className:"text-lg font-medium",children:"Samsung Configuration"})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 rounded-xl p-6",children:ut==="iphone"?jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center text-gray-800",children:[jsxRuntimeExports.jsx(Phone,{className:"mr-3 text-blue-500",size:28}),"iOS Device Ranges"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Device Model (e.g., iPhone12,1)",value:Tt.deviceModel,onChange:$t=>mt(Nt=>({...Nt,deviceModel:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Min Version",value:Tt.minVersion,onChange:$t=>mt(Nt=>({...Nt,minVersion:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Max Version",value:Tt.maxVersion,onChange:$t=>mt(Nt=>({...Nt,maxVersion:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"})]}),jsxRuntimeExports.jsxs("button",{onClick:At,className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transform hover:scale-[1.02] transition-all duration-200 flex items-center justify-center font-medium",children:[jsxRuntimeExports.jsx(Plus,{className:"mr-2",size:20}),"Add iOS Range"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:b.map(($t,Nt)=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl flex items-center justify-between hover:bg-gray-100 transition-all duration-200",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-gray-800",children:$t.deviceModel}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600",children:["iOS ",$t.minVersion," - ",$t.maxVersion]})]}),jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:it===$t.deviceModel?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>Ut($t),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Save,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>{nt(null),mt({deviceModel:"",minVersion:"",maxVersion:""})},className:"p-2 text-gray-500 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(X,{size:20})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>{nt($t.deviceModel),mt($t)},className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Pen,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>Xt($t),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Trash2,{size:20})})]})})]},Nt))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center text-gray-800",children:[jsxRuntimeExports.jsx(Settings,{className:"mr-3 text-blue-500",size:28}),"iOS Versions"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Version (e.g., 18.3)",value:Et.version,onChange:$t=>Ft(Nt=>({...Nt,version:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Build (e.g., 22D63)",value:Et.build,onChange:$t=>Ft(Nt=>({...Nt,build:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"WebKit Version",value:Et.webkit_version,onChange:$t=>Ft(Nt=>({...Nt,webkit_version:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"})]}),jsxRuntimeExports.jsxs("button",{onClick:Gt,className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transform hover:scale-[1.02] transition-all duration-200 flex items-center justify-center font-medium",children:[jsxRuntimeExports.jsx(Plus,{className:"mr-2",size:20}),"Add iOS Version"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:_e.map(($t,Nt)=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl flex items-center justify-between hover:bg-gray-100 transition-all duration-200",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"font-semibold text-gray-800",children:["iOS ",$t.version]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600",children:["Build: ",$t.build," | WebKit:"," ",$t.webkit_version]})]}),jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:ot===Nt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>zt(Nt),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Save,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>{dt(null),Ft({version:"",build:"",webkit_version:""})},className:"p-2 text-gray-500 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(X,{size:20})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>{dt(Nt),Ft($t)},className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Pen,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>Wt(Nt),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Trash2,{size:20})})]})})]},Nt))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center text-gray-800",children:[jsxRuntimeExports.jsx(Settings,{className:"mr-3 text-blue-500",size:28}),"FB Versions"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Major Version (e.g., 515)",value:Vt.major,onChange:$t=>Mt(Nt=>({...Nt,major:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"number",placeholder:"Min FBBV",value:Vt.min_fbbv||"",onChange:$t=>Mt(Nt=>({...Nt,min_fbbv:parseInt($t.target.value)||0})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"number",placeholder:"Max FBBV",value:Vt.max_fbbv||"",onChange:$t=>Mt(Nt=>({...Nt,max_fbbv:parseInt($t.target.value)||0})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"})]}),jsxRuntimeExports.jsxs("button",{onClick:bt,className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transform hover:scale-[1.02] transition-all duration-200 flex items-center justify-center font-medium",children:[jsxRuntimeExports.jsx(Plus,{className:"mr-2",size:20}),"Add FB Version"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:rt.map(($t,Nt)=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl flex items-center justify-between hover:bg-gray-100 transition-all duration-200",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"font-semibold text-gray-800",children:["FB ",$t.major]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600",children:["FBBV Range: ",$t.min_fbbv," - ",$t.max_fbbv]})]}),jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:ht===Nt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>er(Nt),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Save,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>{lt(null),Mt({major:"",min_fbbv:0,max_fbbv:0})},className:"p-2 text-gray-500 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(X,{size:20})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>{lt(Nt),Mt($t)},className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Pen,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>St(Nt),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Trash2,{size:20})})]})})]},Nt))})]})]}):jsxRuntimeExports.jsx("div",{className:"space-y-8",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center text-gray-800",children:[jsxRuntimeExports.jsx(Smartphone,{className:"mr-3 text-blue-500",size:28}),"Samsung Device Configurations"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Model (e.g., SM-S908U1)",value:Ct.model,onChange:$t=>kt(Nt=>({...Nt,model:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Android Version (e.g., 14)",value:Ct.android_version,onChange:$t=>kt(Nt=>({...Nt,android_version:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Build Number (e.g., S908U1UES6EXJ1)",value:Ct.build_number,onChange:$t=>kt(Nt=>({...Nt,build_number:$t.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none"})]}),jsxRuntimeExports.jsxs("button",{onClick:ir,className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transform hover:scale-[1.02] transition-all duration-200 flex items-center justify-center font-medium",children:[jsxRuntimeExports.jsx(Plus,{className:"mr-2",size:20}),"Add Samsung Configuration"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:st.map(($t,Nt)=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl flex items-center justify-between hover:bg-gray-100 transition-all duration-200",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-gray-800",children:$t.model}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600",children:["Android ",$t.android_version," | Build:"," ",$t.build_number]})]}),jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:gt===Nt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>nr(Nt),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Save,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>{yt(null),kt({model:"",android_version:"",build_number:""})},className:"p-2 text-gray-500 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(X,{size:20})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>{yt(Nt),kt($t)},className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Pen,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>ar(Nt),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors duration-200",children:jsxRuntimeExports.jsx(Trash2,{size:20})})]})})]},Nt))})]})})})]})]}),jsxRuntimeExports.jsx(SecurityPopup,{show:o,message:d,type:g,onClose:()=>c(!1)})]}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-2xl shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx(Shield,{className:"w-16 h-16 text-blue-500 mx-auto mb-4"}),jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Panel"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mt-2",children:"Restricted Access Area"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:Rt,className:"space-y-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"password",id:"password",value:e,onChange:$t=>s($t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 outline-none",placeholder:"Enter admin password",required:!0}),jsxRuntimeExports.jsx(Shield,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]})}),jsxRuntimeExports.jsxs("button",{type:"submit",className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transform hover:scale-[1.02] transition-all duration-200 font-medium text-lg flex items-center justify-center",children:[jsxRuntimeExports.jsx(Shield,{className:"mr-2",size:20}),"Access Admin Panel"]})]})]}),jsxRuntimeExports.jsx(SecurityPopup,{show:o,message:d,type:g,onClose:()=>c(!1)})]})},GmailManager=()=>{const{currentProfile:e}=useSecurity(),{isDarkMode:s}=useTheme(),[a,i]=reactExports.useState([]),[o,c]=reactExports.useState([]),[d,h]=reactExports.useState(null),[g,_]=reactExports.useState(!1),[b,j]=reactExports.useState(!1),[_e,tt]=reactExports.useState(""),[rt,et]=reactExports.useState(null),[st,at]=reactExports.useState(null),[it,nt]=reactExports.useState(!1),[ot,dt]=reactExports.useState(!1),[ht,lt]=reactExports.useState("unused"),gt=async()=>{if(!e){et({text:"   ",type:"error"});return}_(!0),et(null);try{const Ct=e.keyId,[kt,jt,ut]=await Promise.all([gmailAccountsTable.getUnusedEmails(Ct,20),gmailAccountsTable.getRecentlyUsedEmails(Ct,10),gmailAccountsTable.getStatistics(Ct)]),Lt=kt.map(ft=>({...ft,user_id:Ct})),Pt=jt.map(ft=>({...ft,user_id:Ct}));i(Lt),c(Pt),at(ut),Lt.length===0&&et({text:"         ",type:"info"})}catch(Ct){console.error("Error fetching emails:",Ct),et({text:"             ",type:"error"}),i([]),c([]),at({unused:0,used:0,blacklisted:0,total:0})}finally{_(!1)}},yt=()=>{if(a.length===0){gt().then(()=>{if(a.length>0){const kt=a[0];h(kt),i(jt=>jt.slice(1))}else et({text:"No unused emails available",type:"error"})});return}const Ct=a[0];h(Ct),i(kt=>kt.slice(1))},Tt=Ct=>{navigator.clipboard.writeText(Ct),et({text:"Email copied to clipboard",type:"success"}),setTimeout(()=>et(null),2e3)},mt=async Ct=>{if(d)try{if(_(!0),await gmailAccountsTable.updateEmailStatus(d.id,Ct),Ct==="used"&&Tt(d.email),et({text:` ${Ct==="used"?"   ":""}`,type:"success"}),Ct==="used"&&e&&c(kt=>[{...d,status:"used",updated_at:new Date().toISOString()},...kt.slice(0,9)]),yt(),e){const kt=await gmailAccountsTable.getStatistics(e.keyId);at(kt)}}catch(kt){console.error(`Error marking email as ${Ct}:`,kt),et({text:"    ",type:"error"})}finally{_(!1)}},Et=async Ct=>{if(e)try{_(!0),await gmailAccountsTable.updateEmailStatus(Ct.id,"unused"),c(jt=>jt.filter(ut=>ut.id!==Ct.id)),i(jt=>[...jt,{...Ct,status:"unused"}]);const kt=await gmailAccountsTable.getStatistics(e.keyId);at(kt),et({text:"    ",type:"success"})}catch(kt){console.error("Error marking email as unused:",kt),et({text:"     ",type:"error"})}finally{_(!1)}},Ft=Ct=>{var ut;const kt=(ut=Ct.target.files)==null?void 0:ut[0];if(!kt)return;const jt=new FileReader;jt.onload=Lt=>{var ft;const Pt=(ft=Lt.target)==null?void 0:ft.result;tt(Pt)},jt.readAsText(kt),Ct.target.value=""},Vt=async()=>{if(!e){et({text:"   ",type:"error"});return}if(!_e.trim()){et({text:"      ",type:"error"});return}j(!0),et({text:"  ...",type:"info"});try{const Ct=_e.split(/[\n,]/).map(jt=>jt.trim()).filter(jt=>jt&&jt.includes("@"));if(Ct.length===0){et({text:"     ",type:"error"}),j(!1);return}const kt=await gmailAccountsTable.uploadEmails(Ct,e.keyId);et({text:` ${kt.length}     `,type:"success"}),tt(""),await gt()}catch(Ct){console.error("Upload error:",Ct);let kt="    ";Ct instanceof Error&&(Ct.message.includes("duplicate key")?kt+="      ":Ct.message.includes("invalid_api_key")?kt+="        ":Ct.message.includes("not found")?kt+="         ":Ct.message.includes("No valid emails")?kt+="          ":kt+="           "),et({text:kt,type:"error"})}finally{j(!1)}},Mt=async()=>{if(e)try{nt(!0),et({text:"   ...",type:"info"}),await gmailAccountsTable.deleteEmailsByStatus(e.keyId,ht),et({text:`${ht==="all"?"":ht==="unused"?"":ht==="used"?"":""}     `,type:"success"}),await gt(),dt(!1)}catch(Ct){console.error("Delete error:",Ct),et({text:"    ",type:"error"})}finally{nt(!1)}};return reactExports.useEffect(()=>{e?gt():et({text:"   ",type:"info"})},[e]),jsxRuntimeExports.jsx("div",{className:`min-h-screen ${s?"bg-gray-900":"bg-gradient-to-br from-blue-50 via-white to-purple-50"} py-8 px-4`,children:jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"mb-8 text-center",children:[jsxRuntimeExports.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl mb-4",children:jsxRuntimeExports.jsx(Mail,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsx("h1",{className:`text-3xl font-bold ${s?"text-white":"text-gray-900"} mb-2`,children:"Gmail Manager"}),jsxRuntimeExports.jsx("p",{className:`${s?"text-gray-300":"text-gray-600"} max-w-2xl mx-auto`,children:"Upload, generate and track Gmail accounts with automatic status management"}),e&&jsxRuntimeExports.jsxs("div",{className:"mt-2 text-sm text-blue-600 font-medium",children:["Managing emails for user: ",e.keyName]})]}),jsxRuntimeExports.jsxs("div",{className:`${s?"bg-gray-800":"bg-white"} rounded-2xl shadow-xl p-6 mb-8`,children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:`${s?"bg-blue-900/30":"bg-blue-50"} rounded-xl p-4 text-center relative group`,children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-blue-600",children:(st==null?void 0:st.unused)||0}),jsxRuntimeExports.jsx("div",{className:`text-sm ${s?"text-gray-300":"text-gray-600"}`,children:"Unused"}),st&&st.unused>0&&jsxRuntimeExports.jsx("button",{onClick:()=>{lt("unused"),dt(!0)},className:"absolute top-2 right-2 p-1 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete unused emails",children:jsxRuntimeExports.jsx(Trash2,{size:16})})]}),jsxRuntimeExports.jsxs("div",{className:`${s?"bg-green-900/30":"bg-green-50"} rounded-xl p-4 text-center relative group`,children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-green-600",children:(st==null?void 0:st.used)||0}),jsxRuntimeExports.jsx("div",{className:`text-sm ${s?"text-gray-300":"text-gray-600"}`,children:"Used"}),st&&st.used>0&&jsxRuntimeExports.jsx("button",{onClick:()=>{lt("used"),dt(!0)},className:"absolute top-2 right-2 p-1 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete used emails",children:jsxRuntimeExports.jsx(Trash2,{size:16})})]}),jsxRuntimeExports.jsxs("div",{className:`${s?"bg-red-900/30":"bg-red-50"} rounded-xl p-4 text-center relative group`,children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-red-600",children:(st==null?void 0:st.blacklisted)||0}),jsxRuntimeExports.jsx("div",{className:`text-sm ${s?"text-gray-300":"text-gray-600"}`,children:"Blacklisted"}),st&&st.blacklisted>0&&jsxRuntimeExports.jsx("button",{onClick:()=>{lt("blacklisted"),dt(!0)},className:"absolute top-2 right-2 p-1 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete blacklisted emails",children:jsxRuntimeExports.jsx(Trash2,{size:16})})]}),jsxRuntimeExports.jsxs("div",{className:`${s?"bg-purple-900/30":"bg-purple-50"} rounded-xl p-4 text-center relative group`,children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-purple-600",children:(st==null?void 0:st.total)||0}),jsxRuntimeExports.jsx("div",{className:`text-sm ${s?"text-gray-300":"text-gray-600"}`,children:"Total"}),((st==null?void 0:st.total)||0)>0&&jsxRuntimeExports.jsx("button",{onClick:()=>{lt("all"),dt(!0)},className:"absolute top-2 right-2 p-1 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete all emails",children:jsxRuntimeExports.jsx(Trash2,{size:16})})]})]}),ot&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:`${s?"bg-gray-800":"bg-white"} rounded-lg p-6 max-w-md w-full mx-4`,children:[jsxRuntimeExports.jsx("h3",{className:`text-xl font-semibold mb-4 ${s?"text-white":"text-gray-900"}`,children:"Confirm Delete"}),jsxRuntimeExports.jsxs("p",{className:`mb-6 ${s?"text-gray-300":"text-gray-600"}`,children:["Are you sure you want to delete"," ",ht==="all"?"all":ht," emails?"]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>dt(!1),className:`px-4 py-2 rounded ${s?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-700"}`,disabled:it,children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:Mt,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",disabled:it,children:it?"Deleting...":"Delete"})]})]})}),jsxRuntimeExports.jsxs("div",{className:`mb-8 p-6 border ${s?"border-gray-700":"border-gray-200"} rounded-xl`,children:[jsxRuntimeExports.jsx("h2",{className:`text-xl font-semibold mb-4 ${s?"text-white":"text-gray-900"}`,children:"Gmail Generator"}),e?d?jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:`flex items-center justify-between p-4 ${s?"bg-gray-700":"bg-gray-50"} rounded-lg mb-4`,children:[jsxRuntimeExports.jsx("div",{className:`font-mono text-lg ${s?"text-white":""}`,children:d.email}),jsxRuntimeExports.jsx("button",{onClick:()=>Tt(d.email),className:`p-2 ${s?"hover:bg-gray-600":"hover:bg-gray-200"} rounded-full transition-colors`,title:"Copy to clipboard",children:jsxRuntimeExports.jsx(Copy,{className:`w-5 h-5 ${s?"text-gray-300":"text-gray-600"}`})})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>mt("used"),className:"flex-1 py-2 px-4 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center justify-center",children:[jsxRuntimeExports.jsx(Check,{className:"w-5 h-5 mr-2"}),"Mark as Used & Copy"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>mt("blacklisted"),className:"flex-1 py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-lg flex items-center justify-center",children:[jsxRuntimeExports.jsx(X,{className:"w-5 h-5 mr-2"}),"Blacklist & Skip"]}),jsxRuntimeExports.jsxs("button",{onClick:yt,className:"flex-1 py-2 px-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg flex items-center justify-center",children:[jsxRuntimeExports.jsx(SkipForward,{className:"w-5 h-5 mr-2"}),"Skip"]})]})]}):jsxRuntimeExports.jsxs("div",{className:`flex flex-col items-center justify-center p-6 ${s?"bg-gray-700":"bg-gray-50"} rounded-lg`,children:[jsxRuntimeExports.jsx("p",{className:`mb-4 ${s?"text-gray-300":"text-gray-600"}`,children:a.length>0?"Click the button below to generate a Gmail account":"No unused emails available. Please upload some emails."}),jsxRuntimeExports.jsx("button",{onClick:yt,disabled:a.length===0||g,className:`px-6 py-3 rounded-lg text-white font-medium flex items-center justify-center ${a.length===0||g?"bg-gray-400":"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700"}`,children:g?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-5 h-5 mr-2 animate-spin"}),"Loading..."]}):"Generate Email"})]}):jsxRuntimeExports.jsxs("div",{className:`text-center p-6 ${s?"bg-gray-700":"bg-gray-50"} rounded-lg`,children:[jsxRuntimeExports.jsx("p",{className:`mb-4 ${s?"text-gray-300":"text-gray-600"}`,children:"Please log in to access your Gmail accounts"}),jsxRuntimeExports.jsx("a",{href:"/login",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg",children:"Go to Login"})]})]}),e&&jsxRuntimeExports.jsxs("div",{className:`mb-8 p-6 border ${s?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-50"} rounded-xl`,children:[jsxRuntimeExports.jsx("h2",{className:`text-xl font-semibold mb-4 ${s?"text-white":""}`,children:"Upload Gmail Accounts"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[jsxRuntimeExports.jsxs("label",{className:`flex-1 flex items-center justify-center px-4 py-3 border ${s?"border-gray-600 hover:bg-gray-700":"border-gray-300 hover:bg-gray-100"} rounded-lg cursor-pointer transition-colors`,children:[jsxRuntimeExports.jsx(Upload,{className:"w-5 h-5 mr-2 text-blue-500"}),jsxRuntimeExports.jsx("span",{className:`text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Select File"}),jsxRuntimeExports.jsx("input",{type:"file",accept:".txt,.csv",onChange:Ft,className:"hidden"})]}),jsxRuntimeExports.jsx("button",{onClick:Vt,disabled:!_e||b,className:`flex-1 px-4 py-3 rounded-lg text-white font-medium flex items-center justify-center ${!_e||b?"bg-gray-400":"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700"}`,children:b?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-5 h-5 mr-2 animate-spin"}),"Uploading..."]}):"Upload Emails"})]}),_e&&jsxRuntimeExports.jsxs("div",{className:`mt-2 text-sm ${s?"text-gray-400":"text-gray-500"}`,children:[_e.split(`
`).length," lines detected"]})]}),o.length>0&&jsxRuntimeExports.jsxs("div",{className:`mb-8 p-6 border ${s?"border-gray-700":"border-gray-200"} rounded-xl`,children:[jsxRuntimeExports.jsx("h2",{className:`text-xl font-semibold mb-4 ${s?"text-white":""}`,children:"Recently Used Emails"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o.map(Ct=>jsxRuntimeExports.jsxs("div",{className:`flex items-center justify-between p-3 ${s?"bg-gray-700":"bg-gray-50"} rounded-lg`,children:[jsxRuntimeExports.jsx("div",{className:`font-mono ${s?"text-white":""}`,children:Ct.email}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Tt(Ct.email),className:`p-2 ${s?"hover:bg-gray-600":"hover:bg-gray-200"} rounded-full transition-colors mr-2`,title:"Copy to clipboard",children:jsxRuntimeExports.jsx(Copy,{className:`w-4 h-4 ${s?"text-gray-300":"text-gray-600"}`})}),jsxRuntimeExports.jsx("button",{onClick:()=>Et(Ct),className:`p-2 ${s?"hover:bg-gray-600":"hover:bg-gray-200"} rounded-full transition-colors`,title:"Mark as unused",children:jsxRuntimeExports.jsx(RotateCcw,{className:`w-4 h-4 ${s?"text-gray-300":"text-gray-600"}`})})]})]},Ct.id))})]})]}),rt&&jsxRuntimeExports.jsx("div",{className:`fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg text-white ${rt.type==="success"?"bg-green-600":rt.type==="error"?"bg-red-600":"bg-blue-600"}`,children:rt.text})]})})},NotFoundPage=()=>jsxRuntimeExports.jsx("section",{className:"page_404",children:jsxRuntimeExports.jsx("div",{className:"container",children:jsxRuntimeExports.jsx("div",{className:"row",children:jsxRuntimeExports.jsx("div",{className:"col-sm-12",children:jsxRuntimeExports.jsxs("div",{className:"col-sm-10 col-sm-offset-1 text-center",children:[jsxRuntimeExports.jsxs("div",{className:"four_zero_four_bg",children:[jsxRuntimeExports.jsx("h1",{className:"text-center",children:jsxRuntimeExports.jsx("strong",{children:"404"})}),jsxRuntimeExports.jsx("h2",{className:"text-center",children:"Page not found"})]}),jsxRuntimeExports.jsxs("div",{className:"contant_box_404",children:[jsxRuntimeExports.jsx("h3",{className:"h2",children:"Looks like you're lost"}),jsxRuntimeExports.jsx("p",{children:"The page you are looking for is not available!"}),jsxRuntimeExports.jsx(Link,{to:"/",className:"link_404",children:"Go to Home"})]})]})})})})}),applySecurityMeasures=()=>{document.addEventListener("contextmenu",a=>{a.preventDefault(),showSecurityAlert("Right-click is disabled for security reasons!")}),document.addEventListener("keydown",a=>{if(a.key==="F12"){a.preventDefault(),showSecurityAlert("Developer tools access is restricted!");return}if(a.ctrlKey&&a.shiftKey&&a.key==="I"){a.preventDefault(),showSecurityAlert("Developer tools access is restricted!");return}if(a.ctrlKey&&a.shiftKey&&a.key==="J"){a.preventDefault(),showSecurityAlert("Console access is restricted!");return}if(a.ctrlKey&&a.key==="u"){a.preventDefault(),showSecurityAlert("View source is disabled!");return}if(a.ctrlKey&&a.shiftKey&&a.key==="C"){a.preventDefault(),showSecurityAlert("Element inspector is disabled!");return}});let e={open:!1,orientation:null};const s=160;setInterval(()=>{window.outerHeight-window.innerHeight>s||window.outerWidth-window.innerWidth>s?e.open||(e.open=!0,showSecurityAlert("Developer tools detected! Please close them.")):e.open=!1},500),document.onselectstart=()=>!1,document.ondragstart=()=>!1},showSecurityAlert=e=>{const s=document.createElement("div");s.className="fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse",s.textContent=e,document.body.appendChild(s),setTimeout(()=>{document.body.removeChild(s)},3e3)};(function(){(()=>{console.log("Security layer active")})()})();const UserInfoModal=({show:e,profile:s,onClose:a})=>{const{logout:i}=useSecurity();if(!e||!s)return null;const o=h=>h?new Date(h).toLocaleDateString():"Unlimited",d=s.expiresAt?s.daysUntilExpiry:null;return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50",onClick:a,children:jsxRuntimeExports.jsxs("div",{className:"bg-white/90 rounded-2xl shadow-2xl p-6 max-w-md w-full border border-white/20",onClick:h=>h.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"User Information"}),jsxRuntimeExports.jsx("button",{onClick:a,className:"p-1 rounded-full hover:bg-gray-100 transition-colors duration-200",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-gray-500"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-xl",children:[jsxRuntimeExports.jsx(User,{className:"w-5 h-5 text-blue-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500",children:"Name"}),jsxRuntimeExports.jsx("div",{className:"font-medium text-gray-800",children:s.name})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-xl",children:[jsxRuntimeExports.jsx(Key,{className:"w-5 h-5 text-purple-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500",children:"Key ID"}),jsxRuntimeExports.jsx("div",{className:"font-medium text-gray-800",children:s.id})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-xl",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-5 h-5 text-green-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500",children:"Validity"}),jsxRuntimeExports.jsxs("div",{className:"font-medium text-gray-800",children:[o(s.expiresAt),d!==null&&jsxRuntimeExports.jsxs("span",{className:"ml-2 text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:[d," days left"]})]})]})]}),s.deviceLocation&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50/50 rounded-xl",children:[jsxRuntimeExports.jsx(MapPin,{className:"w-5 h-5 text-blue-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500",children:"Current Login Location"}),jsxRuntimeExports.jsxs("div",{className:"font-medium text-gray-800",children:[s.deviceLocation.city||"Unknown",","," ",s.deviceLocation.country||"Unknown"]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["IP: ",s.deviceLocation.ip||"Unknown"]})]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:jsxRuntimeExports.jsxs("button",{onClick:()=>{a(),i()},className:"w-full flex items-center justify-center space-x-2 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-xl transition-colors duration-200",children:[jsxRuntimeExports.jsx(LogOut,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Logout"})]})})]})})},Navbar=()=>{const{isAuthenticated:e,logout:s,currentProfile:a}=useSecurity(),{isDarkMode:i,toggleDarkMode:o}=useTheme(),[c,d]=reactExports.useState(!1),[h,g]=reactExports.useState(!1),_=()=>{d(!c)};return jsxRuntimeExports.jsxs("nav",{className:"bg-pro-gradient-dark text-white shadow-md",children:[jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between h-16",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsx(NavLink,{to:"/",className:"flex items-center",children:jsxRuntimeExports.jsx(ProLogo,{size:"md",variant:"light"})})}),jsxRuntimeExports.jsx("div",{className:"hidden md:block",children:jsxRuntimeExports.jsxs("div",{className:"ml-10 flex items-center space-x-4",children:[jsxRuntimeExports.jsx(NavLink,{to:"/",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Home"}),jsxRuntimeExports.jsx(NavLink,{to:"/gmail-manager",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Gmail Manager"}),jsxRuntimeExports.jsx(NavLink,{to:"/email-extractor",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Email Extractor"}),jsxRuntimeExports.jsx(NavLink,{to:"/email-alias-manager",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Email Alias"}),jsxRuntimeExports.jsx(NavLink,{to:"/user-agent-generator",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"User Agent"}),jsxRuntimeExports.jsx(NavLink,{to:"/password-generator",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Password Gen"}),jsxRuntimeExports.jsx(NavLink,{to:"/text-formatter",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Text Formatter"})]})}),jsxRuntimeExports.jsx("div",{className:"hidden md:block",children:jsxRuntimeExports.jsxs("div",{className:"ml-4 flex items-center md:ml-6 space-x-3",children:[jsxRuntimeExports.jsx("button",{onClick:o,className:"p-2 rounded-full bg-pro-purple-800 hover:bg-pro-purple-700 transition-colors duration-200 focus:outline-none","aria-label":i?"Switch to light mode":"Switch to dark mode",children:i?jsxRuntimeExports.jsx(Sun,{className:"h-5 w-5 text-yellow-300"}):jsxRuntimeExports.jsx(Moon,{className:"h-5 w-5 text-white"})}),e&&a&&jsxRuntimeExports.jsx("button",{onClick:()=>g(!0),className:"p-2 rounded-full bg-pro-purple-800 hover:bg-pro-purple-700 transition-colors duration-200 focus:outline-none","aria-label":"Show user information",children:jsxRuntimeExports.jsx(User,{className:"h-5 w-5 text-white"})}),e?jsxRuntimeExports.jsx("button",{onClick:s,className:"px-3 py-2 rounded-md text-sm font-medium bg-red-600 hover:bg-red-700",children:"Logout"}):jsxRuntimeExports.jsx(NavLink,{to:"/login",className:({isActive:b})=>b?"bg-pro-purple-700 px-3 py-2 rounded-md text-sm font-medium":"px-3 py-2 rounded-md text-sm font-medium hover:bg-pro-purple-700",children:"Login"})]})}),jsxRuntimeExports.jsxs("div",{className:"md:hidden flex items-center space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:o,className:"p-2 rounded-full bg-pro-purple-800 hover:bg-pro-purple-700 transition-colors duration-200 focus:outline-none","aria-label":i?"Switch to light mode":"Switch to dark mode",children:i?jsxRuntimeExports.jsx(Sun,{className:"h-5 w-5 text-yellow-300"}):jsxRuntimeExports.jsx(Moon,{className:"h-5 w-5 text-white"})}),e&&a&&jsxRuntimeExports.jsx("button",{onClick:()=>g(!0),className:"p-2 rounded-full bg-pro-purple-800 hover:bg-pro-purple-700 transition-colors duration-200 focus:outline-none","aria-label":"Show user information",children:jsxRuntimeExports.jsx(User,{className:"h-5 w-5 text-white"})}),jsxRuntimeExports.jsxs("button",{type:"button",onClick:_,className:"inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-pro-purple-700 focus:outline-none","aria-controls":"mobile-menu","aria-expanded":c,children:[jsxRuntimeExports.jsx("span",{className:"sr-only",children:"Open main menu"}),jsxRuntimeExports.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})]})]})}),c&&jsxRuntimeExports.jsx("div",{className:"md:hidden absolute top-16 left-0 w-full bg-pro-gradient-dark shadow-lg z-50",children:jsxRuntimeExports.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[jsxRuntimeExports.jsx(NavLink,{to:"/",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Home"}),jsxRuntimeExports.jsx(NavLink,{to:"/gmail-manager",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Gmail Manager"}),jsxRuntimeExports.jsx(NavLink,{to:"/email-extractor",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Email Extractor"}),jsxRuntimeExports.jsx(NavLink,{to:"/email-alias-manager",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Email Alias"}),jsxRuntimeExports.jsx(NavLink,{to:"/user-agent-generator",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"User Agent"}),jsxRuntimeExports.jsx(NavLink,{to:"/password-generator",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Password Gen"}),jsxRuntimeExports.jsx(NavLink,{to:"/text-formatter",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Text Formatter"}),e?jsxRuntimeExports.jsx("button",{onClick:()=>{s(),d(!1)},className:"w-full text-left px-3 py-2 rounded-md text-base font-medium bg-red-600 hover:bg-red-700",children:"Logout"}):jsxRuntimeExports.jsx(NavLink,{to:"/login",className:({isActive:b})=>b?"block bg-pro-purple-700 px-3 py-2 rounded-md text-base font-medium":"block px-3 py-2 rounded-md text-base font-medium hover:bg-pro-purple-700",onClick:()=>d(!1),children:"Login"})]})}),jsxRuntimeExports.jsx(UserInfoModal,{show:h,onClose:()=>g(!1),profile:a})]})},Layout=({children:e})=>{const{isAuthenticated:s}=useSecurity(),{isDarkMode:a}=useTheme(),o=useLocation().pathname.startsWith("/admin");return jsxRuntimeExports.jsxs("div",{className:`min-h-screen flex flex-col ${a?"bg-gradient-to-br from-gray-900 to-gray-800":"bg-gradient-to-br from-blue-50 via-white to-purple-50"}`,children:[s&&!o&&jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsx("div",{className:`flex-grow p-4 ${a?"text-white":"text-gray-800"}`,children:e})]})};function App(){const{isAuthenticated:e}=useSecurity();return reactExports.useEffect(()=>{applySecurityMeasures()},[]),jsxRuntimeExports.jsx(Layout,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:e?jsxRuntimeExports.jsx(HomePage,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/email-extractor",element:e?jsxRuntimeExports.jsx(EmailExtractor,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/duplicate-remover",element:e?jsxRuntimeExports.jsx(DuplicateRemover,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/user-agent-mixer",element:e?jsxRuntimeExports.jsx(UserAgentMixer,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/user-agent-generator",element:e?jsxRuntimeExports.jsx(UserAgentGenerator,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/text-formatter",element:e?jsxRuntimeExports.jsx(TextFormatter,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/password-generator",element:e?jsxRuntimeExports.jsx(PasswordGenerator,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/email-alias-manager",element:e?jsxRuntimeExports.jsx(EmailAliasManager,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/us-address-generator",element:e?jsxRuntimeExports.jsx(USAddressGenerator,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/gmail-manager",element:e?jsxRuntimeExports.jsx(GmailManager,{}):jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/admin/billa",element:jsxRuntimeExports.jsx(AdminPanel,{})}),jsxRuntimeExports.jsx(Route,{path:"/admin/ua",element:jsxRuntimeExports.jsx(UserAgentAdmin,{})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFoundPage,{})})]})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(SecurityProvider,{children:jsxRuntimeExports.jsx(ThemeProvider,{children:jsxRuntimeExports.jsx(App,{})})})})}));
